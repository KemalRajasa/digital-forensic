(()=>{(self.webpackChunkms_maps=self.webpackChunkms_maps||[]).push([[7878,7100,2466,5530,9848,305,9854,5,1185,7628,9810],{96302:function(ct,Ye){/* @preserve
 * Leaflet 1.5.0+master.91ab2ec, a JS library for interactive maps. http://leafletjs.com
 * (c) 2010-2018 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(B,Q){Q(Ye)})(this,function(B){"use strict";function Q(o){var d,P,U,Y;for(P=1,U=arguments.length;P<U;P++){Y=arguments[P];for(d in Y)o[d]=Y[d]}return o}function W(o,d){var P=Array.prototype.slice;if(o.bind)return o.bind.apply(o,P.call(arguments,1));var U=P.call(arguments,2);return function(){return o.apply(d,U.length?U.concat(P.call(arguments)):arguments)}}function h(o){return o._leaflet_id=o._leaflet_id||++cr,o._leaflet_id}function K(o,d,P){var U,Y,me,Ke;return Ke=function(){U=!1,Y&&(me.apply(P,Y),Y=!1)},me=function(){U?Y=arguments:(o.apply(P,arguments),setTimeout(Ke,d),U=!0)}}function k(o,d,P){var U=d[1],Y=d[0],me=U-Y;return o===U&&P?o:((o-Y)%me+me)%me+Y}function A(){return!1}function z(o,d){var P=Math.pow(10,d===void 0?6:d);return Math.round(o*P)/P}function R(o){return o.trim?o.trim():o.replace(/^\s+|\s+$/g,"")}function C(o){return R(o).split(/\s+/)}function x(o,d){o.hasOwnProperty("options")||(o.options=o.options?jr(o.options):{});for(var P in d)o.options[P]=d[P];return o.options}function v(o,d,P){var U=[];for(var Y in o)U.push(encodeURIComponent(P?Y.toUpperCase():Y)+"="+encodeURIComponent(o[Y]));return(d&&d.indexOf("?")!==-1?"&":"?")+U.join("&")}function m(o,d){return o.replace(Ei,function(P,U){var Y=d[U];if(Y===void 0)throw new Error("No value provided for variable "+P);return typeof Y=="function"&&(Y=Y(d)),Y})}function T(o,d){for(var P=0;P<o.length;P++)if(o[P]===d)return P;return-1}function I(o){return window["webkit"+o]||window["moz"+o]||window["ms"+o]}function F(o){var d=+new Date,P=Math.max(0,16-(d-Hr));return Hr=d+P,window.setTimeout(o,P)}function q(o,d,P){if(!P||Ln!==F)return Ln.call(window,W(o,d));o.call(d)}function re(o){o&&ja.call(window,o)}function ne(){}function se(o){if(typeof L!="undefined"&&L&&L.Mixin){o=Dn(o)?o:[o];for(var d=0;d<o.length;d++)o[d]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}function X(o,d,P){this.x=P?Math.round(o):o,this.y=P?Math.round(d):d}function ce(o,d,P){return o instanceof X?o:Dn(o)?new X(o[0],o[1]):o==null?o:typeof o=="object"&&"x"in o&&"y"in o?new X(o.x,o.y):new X(o,d,P)}function Me(o,d){if(o)for(var P=d?[o,d]:o,U=0,Y=P.length;U<Y;U++)this.extend(P[U])}function Be(o,d){return!o||o instanceof Me?o:new Me(o,d)}function ot(o,d){if(o)for(var P=d?[o,d]:o,U=0,Y=P.length;U<Y;U++)this.extend(P[U])}function Ue(o,d){return o instanceof ot?o:new ot(o,d)}function ht(o,d,P){if(isNaN(o)||isNaN(d))throw new Error("Invalid LatLng object: ("+o+", "+d+")");this.lat=+o,this.lng=+d,P!==void 0&&(this.alt=+P)}function Et(o,d,P){return o instanceof ht?o:Dn(o)&&typeof o[0]!="object"?o.length===3?new ht(o[0],o[1],o[2]):o.length===2?new ht(o[0],o[1]):null:o==null?o:typeof o=="object"&&"lat"in o?new ht(o.lat,"lng"in o?o.lng:o.lon,o.alt):d===void 0?null:new ht(o,d,P)}function bi(o,d,P,U){if(Dn(o))return this._a=o[0],this._b=o[1],this._c=o[2],void(this._d=o[3]);this._a=o,this._b=d,this._c=P,this._d=U}function gt(o,d,P,U){return new bi(o,d,P,U)}function Qe(o){return document.createElementNS("http://www.w3.org/2000/svg",o)}function we(o,d){var P,U,Y,me,Ke,Tt,wt="";for(P=0,Y=o.length;P<Y;P++){for(U=0,me=(Ke=o[P]).length;U<me;U++)Tt=Ke[U],wt+=(U?"L":"M")+Tt.x+" "+Tt.y;wt+=d?Ca?"z":"x":""}return wt||"M0 0"}function Ae(o){return navigator.userAgent.toLowerCase().indexOf(o)>=0}function it(o,d,P,U){return d==="touchstart"?ei(o,P,U):d==="touchmove"?Ci(o,P,U):d==="touchend"&&xt(o,P,U),this}function Lt(o,d,P){var U=o["_leaflet_"+d+P];return d==="touchstart"?o.removeEventListener(so,U,!1):d==="touchmove"?o.removeEventListener(na,U,!1):d==="touchend"&&(o.removeEventListener(Va,U,!1),o.removeEventListener(Ea,U,!1)),this}function ei(o,d,P){var U=W(function(Y){if(Y.pointerType!=="mouse"&&Y.MSPOINTER_TYPE_MOUSE&&Y.pointerType!==Y.MSPOINTER_TYPE_MOUSE){if(!(Ds.indexOf(Y.target.tagName)<0))return;Xr(Y)}Bi(Y,d)});o["_leaflet_touchstart"+P]=U,o.addEventListener(so,U,!1),ga||(document.documentElement.addEventListener(so,Si,!0),document.documentElement.addEventListener(na,ui,!0),document.documentElement.addEventListener(Va,ni,!0),document.documentElement.addEventListener(Ea,ni,!0),ga=!0)}function Si(o){Oo[o.pointerId]=o,Ka++}function ui(o){Oo[o.pointerId]&&(Oo[o.pointerId]=o)}function ni(o){delete Oo[o.pointerId],Ka--}function Bi(o,d){o.touches=[];for(var P in Oo)o.touches.push(Oo[P]);o.changedTouches=[o],d(o)}function Ci(o,d,P){var U=function(Y){(Y.pointerType!==Y.MSPOINTER_TYPE_MOUSE&&Y.pointerType!=="mouse"||Y.buttons!==0)&&Bi(Y,d)};o["_leaflet_touchmove"+P]=U,o.addEventListener(na,U,!1)}function xt(o,d,P){var U=function(Y){Bi(Y,d)};o["_leaflet_touchend"+P]=U,o.addEventListener(Va,U,!1),o.addEventListener(Ea,U,!1)}function ze(o,d,P){function U(pt){var _i;if(qn){if(!on||pt.pointerType==="mouse")return;_i=Ka}else _i=pt.touches.length;if(!(_i>1)){var Hi=Date.now(),Er=Hi-(me||Hi);Ke=pt.touches?pt.touches[0]:pt,Tt=Er>0&&Er<=wt,me=Hi}}function Y(pt){if(Tt&&!Ke.cancelBubble){if(qn){if(!on||pt.pointerType==="mouse")return;var _i,Hi,Er={};for(Hi in Ke)_i=Ke[Hi],Er[Hi]=_i&&_i.bind?_i.bind(Ke):_i;Ke=Er}Ke.type="dblclick",d(Ke),me=null}}var me,Ke,Tt=!1,wt=250;return o[io+$r+P]=U,o[io+qo+P]=Y,o[io+"dblclick"+P]=d,o.addEventListener($r,U,!1),o.addEventListener(qo,Y,!1),o.addEventListener("dblclick",d,!1),this}function oe(o,d){var P=o[io+$r+d],U=o[io+qo+d],Y=o[io+"dblclick"+d];return o.removeEventListener($r,P,!1),o.removeEventListener(qo,U,!1),on||o.removeEventListener("dblclick",Y,!1),this}function de(o){return typeof o=="string"?document.getElementById(o):o}function Re(o,d){var P=o.style[d]||o.currentStyle&&o.currentStyle[d];if((!P||P==="auto")&&document.defaultView){var U=document.defaultView.getComputedStyle(o,null);P=U?U[d]:null}return P==="auto"?null:P}function He(o,d,P){var U=document.createElement(o);return U.className=d||"",P&&P.appendChild(U),U}function mt(o){var d=o.parentNode;d&&d.removeChild(o)}function Ft(o){for(;o.firstChild;)o.removeChild(o.firstChild)}function Gt(o){var d=o.parentNode;d&&d.lastChild!==o&&d.appendChild(o)}function Bt(o){var d=o.parentNode;d&&d.firstChild!==o&&d.insertBefore(o,d.firstChild)}function Kt(o,d){if(o.classList!==void 0)return o.classList.contains(d);var P=zi(o);return P.length>0&&new RegExp("(^|\\s)"+d+"(\\s|$)").test(P)}function qt(o,d){if(o.classList!==void 0)for(var P=C(d),U=0,Y=P.length;U<Y;U++)o.classList.add(P[U]);else if(!Kt(o,d)){var me=zi(o);Ii(o,(me?me+" ":"")+d)}}function fi(o,d){o.classList!==void 0?o.classList.remove(d):Ii(o,R((" "+zi(o)+" ").replace(" "+d+" "," ")))}function Ii(o,d){o.className.baseVal===void 0?o.className=d:o.className.baseVal=d}function zi(o){return o.correspondingElement&&(o=o.correspondingElement),o.className.baseVal===void 0?o.className:o.className.baseVal}function Yt(o,d){"opacity"in o.style?o.style.opacity=d:"filter"in o.style&&ur(o,d)}function ur(o,d){var P=!1,U="DXImageTransform.Microsoft.Alpha";try{P=o.filters.item(U)}catch(Y){if(d===1)return}d=Math.round(100*d),P?(P.Enabled=d!==100,P.Opacity=d):o.style.filter+=" progid:"+U+"(opacity="+d+")"}function yi(o){for(var d=document.documentElement.style,P=0;P<o.length;P++)if(o[P]in d)return o[P];return!1}function hr(o,d,P){var U=d||new X(0,0);o.style[Io]=(da?"translate("+U.x+"px,"+U.y+"px)":"translate3d("+U.x+"px,"+U.y+"px,0)")+(P?" scale("+P+")":"")}function ir(o,d){o._leaflet_pos=d,pn?hr(o,d):(o.style.left=d.x+"px",o.style.top=d.y+"px")}function zr(o){return o._leaflet_pos||new X(0,0)}function rn(){Ni(window,"dragstart",Xr)}function Br(){wr(window,"dragstart",Xr)}function nn(o){for(;o.tabIndex===-1;)o=o.parentNode;o.style&&(wn(),Lo=o,Go=o.style.outline,o.style.outline="none",Ni(window,"keydown",wn))}function wn(){Lo&&(Lo.style.outline=Go,Lo=void 0,Go=void 0,wr(window,"keydown",wn))}function Pn(o){do o=o.parentNode;while(!(o.offsetWidth&&o.offsetHeight||o===document.body));return o}function An(o){var d=o.getBoundingClientRect();return{x:d.width/o.offsetWidth||1,y:d.height/o.offsetHeight||1,boundingClientRect:d}}function Ni(o,d,P,U){if(typeof d=="object")for(var Y in d)mn(o,Y,d[Y],P);else for(var me=0,Ke=(d=C(d)).length;me<Ke;me++)mn(o,d[me],P,U);return this}function wr(o,d,P,U){if(typeof d=="object")for(var Y in d)ho(o,Y,d[Y],P);else if(d)for(var me=0,Ke=(d=C(d)).length;me<Ke;me++)ho(o,d[me],P,U);else{for(var Tt in o[l])ho(o,Tt,o[l][Tt]);delete o[l]}return this}function mn(o,d,P,U){var Y=d+h(P)+(U?"_"+h(U):"");if(o[l]&&o[l][Y])return this;var me=function(Tt){return P.call(U||o,Tt||window.event)},Ke=me;qn&&d.indexOf("touch")===0?it(o,d,me,Y):!Mr||d!=="dblclick"||!ze||qn&&pa?"addEventListener"in o?d==="mousewheel"?o.addEventListener("onwheel"in o?"wheel":"mousewheel",me,!1):d==="mouseenter"||d==="mouseleave"?(me=function(Tt){Tt=Tt||window.event,ue(o,Tt)&&Ke(Tt)},o.addEventListener(d==="mouseenter"?"mouseover":"mouseout",me,!1)):(d==="click"&&ca&&(me=function(Tt){be(Tt,Ke)}),o.addEventListener(d,me,!1)):"attachEvent"in o&&o.attachEvent("on"+d,me):ze(o,me,Y),o[l]=o[l]||{},o[l][Y]=me}function ho(o,d,P,U){var Y=d+h(P)+(U?"_"+h(U):""),me=o[l]&&o[l][Y];if(!me)return this;qn&&d.indexOf("touch")===0?Lt(o,d,Y):!Mr||d!=="dblclick"||!oe||qn&&pa?"removeEventListener"in o?d==="mousewheel"?o.removeEventListener("onwheel"in o?"wheel":"mousewheel",me,!1):o.removeEventListener(d==="mouseenter"?"mouseover":d==="mouseleave"?"mouseout":d,me,!1):"detachEvent"in o&&o.detachEvent("on"+d,me):oe(o,Y),o[l][Y]=null}function Cr(o){return o.stopPropagation?o.stopPropagation():o.originalEvent?o.originalEvent._stopped=!0:o.cancelBubble=!0,le(o),this}function Po(o){return mn(o,"mousewheel",Cr),this}function Gn(o){return Ni(o,"mousedown touchstart dblclick",Cr),mn(o,"click",$),this}function Xr(o){return o.preventDefault?o.preventDefault():o.returnValue=!1,this}function ln(o){return Xr(o),Cr(o),this}function co(o,d){if(!d)return new X(o.clientX,o.clientY);var P=An(d),U=P.boundingClientRect;return new X((o.clientX-U.left)/P.x-d.clientLeft,(o.clientY-U.top)/P.y-d.clientTop)}function Fr(o){return on?o.wheelDeltaY/2:o.deltaY&&o.deltaMode===0?-o.deltaY/i:o.deltaY&&o.deltaMode===1?20*-o.deltaY:o.deltaY&&o.deltaMode===2?60*-o.deltaY:o.deltaX||o.deltaZ?0:o.wheelDelta?(o.wheelDeltaY||o.wheelDelta)/2:o.detail&&Math.abs(o.detail)<32765?20*-o.detail:o.detail?o.detail/-32765*60:0}function $(o){s[o.type]=!0}function le(o){var d=s[o.type];return s[o.type]=!1,d}function ue(o,d){var P=d.relatedTarget;if(!P)return!0;try{for(;P&&P!==o;)P=P.parentNode}catch(U){return!1}return P!==o}function be(o,d){var P=o.timeStamp||o.originalEvent&&o.originalEvent.timeStamp,U=ko&&P-ko;U&&U>100&&U<500||o.target._simulatedClick&&!o._simulated?ln(o):(ko=P,d(o))}function Oe(o,d){if(!d||!o.length)return o.slice();var P=d*d;return o=tt(o,P),o=xe(o,P)}function je(o,d,P){return Math.sqrt(Dt(o,d,P,!0))}function xe(o,d){var P=o.length,U=new(typeof Uint8Array!=void 0+""?Uint8Array:Array)(P);U[0]=U[P-1]=1,Le(o,U,d,0,P-1);var Y,me=[];for(Y=0;Y<P;Y++)U[Y]&&me.push(o[Y]);return me}function Le(o,d,P,U,Y){var me,Ke,Tt,wt=0;for(Ke=U+1;Ke<=Y-1;Ke++)(Tt=Dt(o[Ke],o[U],o[Y],!0))>wt&&(me=Ke,wt=Tt);wt>P&&(d[me]=1,Le(o,d,P,U,me),Le(o,d,P,me,Y))}function tt(o,d){for(var P=[o[0]],U=1,Y=0,me=o.length;U<me;U++)ft(o[U],o[Y])>d&&(P.push(o[U]),Y=U);return Y<me-1&&P.push(o[me-1]),P}function rt(o,d,P,U,Y){var me,Ke,Tt,wt=U?Fe:Wt(o,P),pt=Wt(d,P);for(Fe=pt;;){if(!(wt|pt))return[o,d];if(wt&pt)return!1;Tt=Wt(Ke=Mt(o,d,me=wt||pt,P,Y),P),me===wt?(o=Ke,wt=Tt):(d=Ke,pt=Tt)}}function Mt(o,d,P,U,Y){var me,Ke,Tt=d.x-o.x,wt=d.y-o.y,pt=U.min,_i=U.max;return 8&P?(me=o.x+Tt*(_i.y-o.y)/wt,Ke=_i.y):4&P?(me=o.x+Tt*(pt.y-o.y)/wt,Ke=pt.y):2&P?(me=_i.x,Ke=o.y+wt*(_i.x-o.x)/Tt):1&P&&(me=pt.x,Ke=o.y+wt*(pt.x-o.x)/Tt),new X(me,Ke,Y)}function Wt(o,d){var P=0;return o.x<d.min.x?P|=1:o.x>d.max.x&&(P|=2),o.y<d.min.y?P|=4:o.y>d.max.y&&(P|=8),P}function ft(o,d){var P=d.x-o.x,U=d.y-o.y;return P*P+U*U}function Dt(o,d,P,U){var Y,me=d.x,Ke=d.y,Tt=P.x-me,wt=P.y-Ke,pt=Tt*Tt+wt*wt;return pt>0&&((Y=((o.x-me)*Tt+(o.y-Ke)*wt)/pt)>1?(me=P.x,Ke=P.y):Y>0&&(me+=Tt*Y,Ke+=wt*Y)),Tt=o.x-me,wt=o.y-Ke,U?Tt*Tt+wt*wt:new X(me,Ke)}function ai(o){return!Dn(o[0])||typeof o[0][0]!="object"&&o[0][0]!==void 0}function dt(o){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),ai(o)}function Zt(o,d,P){var U,Y,me,Ke,Tt,wt,pt,_i,Hi,Er=[1,4,2,8];for(Y=0,pt=o.length;Y<pt;Y++)o[Y]._code=Wt(o[Y],d);for(Ke=0;Ke<4;Ke++){for(_i=Er[Ke],U=[],Y=0,me=(pt=o.length)-1;Y<pt;me=Y++)Tt=o[Y],wt=o[me],Tt._code&_i?wt._code&_i||((Hi=Mt(wt,Tt,_i,d,P))._code=Wt(Hi,d),U.push(Hi)):(wt._code&_i&&((Hi=Mt(wt,Tt,_i,d,P))._code=Wt(Hi,d),U.push(Hi)),U.push(Tt));o=U}return o}function ii(o,d){var P,U,Y,me,Ke=o.type==="Feature"?o.geometry:o,Tt=Ke?Ke.coordinates:null,wt=[],pt=d&&d.pointToLayer,_i=d&&d.coordsToLatLng||ri;if(!Tt&&!Ke)return null;switch(Ke.type){case"Point":return P=_i(Tt),pt?pt(o,P):new vi(P);case"MultiPoint":for(Y=0,me=Tt.length;Y<me;Y++)P=_i(Tt[Y]),wt.push(pt?pt(o,P):new vi(P));return new Rt(wt);case"LineString":case"MultiLineString":return U=ki(Tt,Ke.type==="LineString"?0:1,_i),new Oi(U,d);case"Polygon":case"MultiPolygon":return U=ki(Tt,Ke.type==="Polygon"?1:2,_i),new Ui(U,d);case"GeometryCollection":for(Y=0,me=Ke.geometries.length;Y<me;Y++){var Hi=ii({geometry:Ke.geometries[Y],type:"Feature",properties:o.properties},d);Hi&&wt.push(Hi)}return new Rt(wt);default:throw new Error("Invalid GeoJSON object.")}}function ri(o){return new ht(o[1],o[0],o[2])}function ki(o,d,P){for(var U,Y=[],me=0,Ke=o.length;me<Ke;me++)U=d?ki(o[me],d-1,P):(P||ri)(o[me]),Y.push(U);return Y}function si(o,d){return d=typeof d=="number"?d:6,o.alt!==void 0?[z(o.lng,d),z(o.lat,d),z(o.alt,d)]:[z(o.lng,d),z(o.lat,d)]}function Gi(o,d,P,U){for(var Y=[],me=0,Ke=o.length;me<Ke;me++)Y.push(d?Gi(o[me],d-1,P,U):si(o[me],U));return!d&&P&&Y.push(Y[0]),Y}function $i(o,d){return o.feature?Q({},o.feature,{geometry:d}):dr(d)}function dr(o){return o.type==="Feature"||o.type==="FeatureCollection"?o:{type:"Feature",properties:{},geometry:o}}function Vi(o,d){return new xi(o,d)}function Ki(o,d){return new br(o,d)}function un(o){return _a?new Oa(o):null}function _r(o){return Ca||ma?new kr(o):null}var hn=Object.freeze;Object.freeze=function(o){return o};var jr=Object.create||function(){function o(){}return function(d){return o.prototype=d,new o}}(),cr=0,Ei=/\{ *([\w_-]+) *\}/g,Dn=Array.isArray||function(o){return Object.prototype.toString.call(o)==="[object Array]"},Rn="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",Hr=0,Ln=window.requestAnimationFrame||I("RequestAnimationFrame")||F,ja=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(o){window.clearTimeout(o)},Ta=(Object.freeze||Object)({freeze:hn,extend:Q,create:jr,bind:W,lastId:cr,stamp:h,throttle:K,wrapNum:k,falseFn:A,formatNum:z,trim:R,splitWords:C,setOptions:x,getParamString:v,template:m,isArray:Dn,indexOf:T,emptyImageUrl:Rn,requestFn:Ln,cancelFn:ja,requestAnimFrame:q,cancelAnimFrame:re});ne.extend=function(o){var d=function(){this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},P=d.__super__=this.prototype,U=jr(P);U.constructor=d,d.prototype=U;for(var Y in this)this.hasOwnProperty(Y)&&Y!=="prototype"&&Y!=="__super__"&&(d[Y]=this[Y]);return o.statics&&(Q(d,o.statics),delete o.statics),o.includes&&(se(o.includes),Q.apply(null,[U].concat(o.includes)),delete o.includes),U.options&&(o.options=Q(jr(U.options),o.options)),Q(U,o),U._initHooks=[],U.callInitHooks=function(){if(!this._initHooksCalled){P.callInitHooks&&P.callInitHooks.call(this),this._initHooksCalled=!0;for(var me=0,Ke=U._initHooks.length;me<Ke;me++)U._initHooks[me].call(this)}},d},ne.include=function(o){return Q(this.prototype,o),this},ne.mergeOptions=function(o){return Q(this.prototype.options,o),this},ne.addInitHook=function(o){var d=Array.prototype.slice.call(arguments,1),P=typeof o=="function"?o:function(){this[o].apply(this,d)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(P),this};var gr={on:function(o,d,P){if(typeof o=="object")for(var U in o)this._on(U,o[U],d);else for(var Y=0,me=(o=C(o)).length;Y<me;Y++)this._on(o[Y],d,P);return this},off:function(o,d,P){if(o)if(typeof o=="object")for(var U in o)this._off(U,o[U],d);else for(var Y=0,me=(o=C(o)).length;Y<me;Y++)this._off(o[Y],d,P);else delete this._events;return this},_on:function(o,d,P){this._events=this._events||{};var U=this._events[o];U||(U=[],this._events[o]=U),P===this&&(P=void 0);for(var Y={fn:d,ctx:P},me=U,Ke=0,Tt=me.length;Ke<Tt;Ke++)if(me[Ke].fn===d&&me[Ke].ctx===P)return;me.push(Y)},_off:function(o,d,P){var U,Y,me;if(this._events&&(U=this._events[o]))if(d){if(P===this&&(P=void 0),U)for(Y=0,me=U.length;Y<me;Y++){var Ke=U[Y];if(Ke.ctx===P&&Ke.fn===d)return Ke.fn=A,this._firingCount&&(this._events[o]=U=U.slice()),void U.splice(Y,1)}}else{for(Y=0,me=U.length;Y<me;Y++)U[Y].fn=A;delete this._events[o]}},fire:function(o,d,P){if(!this.listens(o,P))return this;var U=Q({},d,{type:o,target:this,sourceTarget:d&&d.sourceTarget||this});if(this._events){var Y=this._events[o];if(Y){this._firingCount=this._firingCount+1||1;for(var me=0,Ke=Y.length;me<Ke;me++){var Tt=Y[me];Tt.fn.call(Tt.ctx||this,U)}this._firingCount--}}return P&&this._propagateEvent(U),this},listens:function(o,d){var P=this._events&&this._events[o];if(P&&P.length)return!0;if(d){for(var U in this._eventParents)if(this._eventParents[U].listens(o,d))return!0}return!1},once:function(o,d,P){if(typeof o=="object"){for(var U in o)this.once(U,o[U],d);return this}var Y=W(function(){this.off(o,d,P).off(o,Y,P)},this);return this.on(o,d,P).on(o,Y,P)},addEventParent:function(o){return this._eventParents=this._eventParents||{},this._eventParents[h(o)]=o,this},removeEventParent:function(o){return this._eventParents&&delete this._eventParents[h(o)],this},_propagateEvent:function(o){for(var d in this._eventParents)this._eventParents[d].fire(o.type,Q({layer:o.target,propagatedFrom:o.target},o),!0)}};gr.addEventListener=gr.on,gr.removeEventListener=gr.clearAllEventListeners=gr.off,gr.addOneTimeEventListener=gr.once,gr.fireEvent=gr.fire,gr.hasEventListeners=gr.listens;var jo=ne.extend(gr),gn=Math.trunc||function(o){return o>0?Math.floor(o):Math.ceil(o)};X.prototype={clone:function(){return new X(this.x,this.y)},add:function(o){return this.clone()._add(ce(o))},_add:function(o){return this.x+=o.x,this.y+=o.y,this},subtract:function(o){return this.clone()._subtract(ce(o))},_subtract:function(o){return this.x-=o.x,this.y-=o.y,this},divideBy:function(o){return this.clone()._divideBy(o)},_divideBy:function(o){return this.x/=o,this.y/=o,this},multiplyBy:function(o){return this.clone()._multiplyBy(o)},_multiplyBy:function(o){return this.x*=o,this.y*=o,this},scaleBy:function(o){return new X(this.x*o.x,this.y*o.y)},unscaleBy:function(o){return new X(this.x/o.x,this.y/o.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=gn(this.x),this.y=gn(this.y),this},distanceTo:function(o){var d=(o=ce(o)).x-this.x,P=o.y-this.y;return Math.sqrt(d*d+P*P)},equals:function(o){return(o=ce(o)).x===this.x&&o.y===this.y},contains:function(o){return o=ce(o),Math.abs(o.x)<=Math.abs(this.x)&&Math.abs(o.y)<=Math.abs(this.y)},toString:function(){return"Point("+z(this.x)+", "+z(this.y)+")"}},Me.prototype={extend:function(o){return o=ce(o),this.min||this.max?(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(o.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(o.y,this.max.y)):(this.min=o.clone(),this.max=o.clone()),this},getCenter:function(o){return new X((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,o)},getBottomLeft:function(){return new X(this.min.x,this.max.y)},getTopRight:function(){return new X(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(o){var d,P;return(o=typeof o[0]=="number"||o instanceof X?ce(o):Be(o))instanceof Me?(d=o.min,P=o.max):d=P=o,d.x>=this.min.x&&P.x<=this.max.x&&d.y>=this.min.y&&P.y<=this.max.y},intersects:function(o){o=Be(o);var d=this.min,P=this.max,U=o.min,Y=o.max,me=Y.x>=d.x&&U.x<=P.x,Ke=Y.y>=d.y&&U.y<=P.y;return me&&Ke},overlaps:function(o){o=Be(o);var d=this.min,P=this.max,U=o.min,Y=o.max,me=Y.x>d.x&&U.x<P.x,Ke=Y.y>d.y&&U.y<P.y;return me&&Ke},isValid:function(){return!(!this.min||!this.max)}},ot.prototype={extend:function(o){var d,P,U=this._southWest,Y=this._northEast;if(o instanceof ht)d=o,P=o;else{if(!(o instanceof ot))return o?this.extend(Et(o)||Ue(o)):this;if(d=o._southWest,P=o._northEast,!d||!P)return this}return U||Y?(U.lat=Math.min(d.lat,U.lat),U.lng=Math.min(d.lng,U.lng),Y.lat=Math.max(P.lat,Y.lat),Y.lng=Math.max(P.lng,Y.lng)):(this._southWest=new ht(d.lat,d.lng),this._northEast=new ht(P.lat,P.lng)),this},pad:function(o){var d=this._southWest,P=this._northEast,U=Math.abs(d.lat-P.lat)*o,Y=Math.abs(d.lng-P.lng)*o;return new ot(new ht(d.lat-U,d.lng-Y),new ht(P.lat+U,P.lng+Y))},getCenter:function(){return new ht((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ht(this.getNorth(),this.getWest())},getSouthEast:function(){return new ht(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(o){o=typeof o[0]=="number"||o instanceof ht||"lat"in o?Et(o):Ue(o);var d,P,U=this._southWest,Y=this._northEast;return o instanceof ot?(d=o.getSouthWest(),P=o.getNorthEast()):d=P=o,d.lat>=U.lat&&P.lat<=Y.lat&&d.lng>=U.lng&&P.lng<=Y.lng},intersects:function(o){o=Ue(o);var d=this._southWest,P=this._northEast,U=o.getSouthWest(),Y=o.getNorthEast(),me=Y.lat>=d.lat&&U.lat<=P.lat,Ke=Y.lng>=d.lng&&U.lng<=P.lng;return me&&Ke},overlaps:function(o){o=Ue(o);var d=this._southWest,P=this._northEast,U=o.getSouthWest(),Y=o.getNorthEast(),me=Y.lat>d.lat&&U.lat<P.lat,Ke=Y.lng>d.lng&&U.lng<P.lng;return me&&Ke},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(o,d){return!!o&&(o=Ue(o),this._southWest.equals(o.getSouthWest(),d)&&this._northEast.equals(o.getNorthEast(),d))},isValid:function(){return!(!this._southWest||!this._northEast)}},ht.prototype={equals:function(o,d){return!!o&&(o=Et(o),Math.max(Math.abs(this.lat-o.lat),Math.abs(this.lng-o.lng))<=(d===void 0?1e-9:d))},toString:function(o){return"LatLng("+z(this.lat,o)+", "+z(this.lng,o)+")"},distanceTo:function(o){return cn.distance(this,Et(o))},wrap:function(){return cn.wrapLatLng(this)},toBounds:function(o){var d=180*o/40075017,P=d/Math.cos(Math.PI/180*this.lat);return Ue([this.lat-d,this.lng-P],[this.lat+d,this.lng+P])},clone:function(){return new ht(this.lat,this.lng,this.alt)}};var Ur={latLngToPoint:function(o,d){var P=this.projection.project(o),U=this.scale(d);return this.transformation._transform(P,U)},pointToLatLng:function(o,d){var P=this.scale(d),U=this.transformation.untransform(o,P);return this.projection.unproject(U)},project:function(o){return this.projection.project(o)},unproject:function(o){return this.projection.unproject(o)},scale:function(o){return 256*Math.pow(2,o)},zoom:function(o){return Math.log(o/256)/Math.LN2},getProjectedBounds:function(o){if(this.infinite)return null;var d=this.projection.bounds,P=this.scale(o);return new Me(this.transformation.transform(d.min,P),this.transformation.transform(d.max,P))},infinite:!1,wrapLatLng:function(o){var d=this.wrapLng?k(o.lng,this.wrapLng,!0):o.lng;return new ht(this.wrapLat?k(o.lat,this.wrapLat,!0):o.lat,d,o.alt)},wrapLatLngBounds:function(o){var d=o.getCenter(),P=this.wrapLatLng(d),U=d.lat-P.lat,Y=d.lng-P.lng;if(U===0&&Y===0)return o;var me=o.getSouthWest(),Ke=o.getNorthEast();return new ot(new ht(me.lat-U,me.lng-Y),new ht(Ke.lat-U,Ke.lng-Y))}},cn=Q({},Ur,{wrapLng:[-180,180],R:6371e3,distance:function(o,d){var P=Math.PI/180,U=o.lat*P,Y=d.lat*P,me=Math.sin((d.lat-o.lat)*P/2),Ke=Math.sin((d.lng-o.lng)*P/2),Tt=me*me+Math.cos(U)*Math.cos(Y)*Ke*Ke,wt=2*Math.atan2(Math.sqrt(Tt),Math.sqrt(1-Tt));return this.R*wt}}),Ir={R:6378137,MAX_LATITUDE:85.0511287798,project:function(o){var d=Math.PI/180,P=this.MAX_LATITUDE,U=Math.max(Math.min(P,o.lat),-P),Y=Math.sin(U*d);return new X(this.R*o.lng*d,this.R*Math.log((1+Y)/(1-Y))/2)},unproject:function(o){var d=180/Math.PI;return new ht((2*Math.atan(Math.exp(o.y/this.R))-Math.PI/2)*d,o.x*d/this.R)},bounds:function(){var o=6378137*Math.PI;return new Me([-o,-o],[o,o])}()};bi.prototype={transform:function(o,d){return this._transform(o.clone(),d)},_transform:function(o,d){return d=d||1,o.x=d*(this._a*o.x+this._b),o.y=d*(this._c*o.y+this._d),o},untransform:function(o,d){return d=d||1,new X((o.x/d-this._b)/this._a,(o.y/d-this._d)/this._c)}};var Wn,yn,Sa,Zn=Q({},cn,{code:"EPSG:3857",projection:Ir,transformation:function(){var o=.5/(Math.PI*Ir.R);return gt(o,.5,-o,.5)}()}),Ps=Q({},Zn,{code:"EPSG:900913"}),Yr=document.documentElement.style,Qr="ActiveXObject"in window,zn=Qr&&!document.addEventListener,on="msLaunchUri"in navigator&&!("documentMode"in document),Co=Ae("webkit"),ca=Ae("android"),ao=Ae("android 2")||Ae("android 3"),Ua=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),as=ca&&Ae("Google")&&Ua<537&&!("AudioNode"in window),Na=!!window.opera,pa=Ae("chrome"),Ga=Ae("gecko")&&!Co&&!Na&&!Qr,Wa=!pa&&Ae("safari"),ia=Ae("phantom"),Uo="OTransition"in Yr,ra=navigator.platform.indexOf("Win")===0,da=Qr&&"transition"in Yr,fa="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!ao,Vn="MozPerspective"in Yr,pn=!window.L_DISABLE_3D&&(da||fa||Vn)&&!Uo&&!ia,Kn=typeof orientation!="undefined"||Ae("mobile"),Ko=Kn&&Co,Eo=Kn&&fa,Hn=!window.PointerEvent&&window.MSPointerEvent,qn=!(!window.PointerEvent&&!Hn),Mr=!window.L_NO_TOUCH&&(qn||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),qr=Kn&&Na,Ho=Kn&&Ga,No=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_a=!!document.createElement("canvas").getContext,Ca=!(!document.createElementNS||!Qe("svg").createSVGRect),ma=!Ca&&function(){try{var o=document.createElement("div");o.innerHTML='<v:shape adj="1"/>';var d=o.firstChild;return d.style.behavior="url(#default#VML)",d&&typeof d.adj=="object"}catch(P){return!1}}(),Za=(Object.freeze||Object)({isTouching:!1,ie:Qr,ielt9:zn,edge:on,webkit:Co,android:ca,android23:ao,androidStock:as,opera:Na,chrome:pa,gecko:Ga,safari:Wa,phantom:ia,opera12:Uo,win:ra,ie3d:da,webkit3d:fa,gecko3d:Vn,any3d:pn,mobile:Kn,mobileWebkit:Ko,mobileWebkit3d:Eo,msPointer:Hn,pointer:qn,touch:Mr,mobileOpera:qr,mobileGecko:Ho,retina:No,canvas:_a,svg:Ca,vml:ma}),so=Hn?"MSPointerDown":"pointerdown",na=Hn?"MSPointerMove":"pointermove",Va=Hn?"MSPointerUp":"pointerup",Ea=Hn?"MSPointerCancel":"pointercancel",Ds=["INPUT","SELECT","OPTION"],Oo={},ga=!1,Ka=0,$r=Hn?"MSPointerDown":qn?"pointerdown":"touchstart",qo=Hn?"MSPointerUp":qn?"pointerup":"touchend",io="_leaflet_",Io=yi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),po=yi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Jo=po==="webkitTransition"||po==="OTransition"?po+"End":"transitionend";if("onselectstart"in document)Wn=function(){Ni(window,"selectstart",Xr)},yn=function(){wr(window,"selectstart",Xr)};else{var fo=yi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Wn=function(){if(fo){var o=document.documentElement.style;Sa=o[fo],o[fo]="none"}},yn=function(){fo&&(document.documentElement.style[fo]=Sa,Sa=void 0)}}var Lo,Go,ko,O=(Object.freeze||Object)({TRANSFORM:Io,TRANSITION:po,TRANSITION_END:Jo,get:de,getStyle:Re,create:He,remove:mt,empty:Ft,toFront:Gt,toBack:Bt,hasClass:Kt,addClass:qt,removeClass:fi,setClass:Ii,getClass:zi,setOpacity:Yt,testProp:yi,setTransform:hr,setPosition:ir,getPosition:zr,disableTextSelection:Wn,enableTextSelection:yn,disableImageDrag:rn,enableImageDrag:Br,preventOutline:nn,restoreOutline:wn,getSizedParentNode:Pn,getScale:An}),l="_leaflet_events",i=ra&&pa?2*window.devicePixelRatio:Ga?window.devicePixelRatio:1,s={},_=(Object.freeze||Object)({on:Ni,off:wr,stopPropagation:Cr,disableScrollPropagation:Po,disableClickPropagation:Gn,preventDefault:Xr,stop:ln,getMousePosition:co,getWheelDelta:Fr,fakeStop:$,skipped:le,isExternalTarget:ue,addListener:Ni,removeListener:wr}),b=jo.extend({run:function(o,d,P,U){this.stop(),this._el=o,this._inProgress=!0,this._duration=P||.25,this._easeOutPower=1/Math.max(U||.5,.2),this._startPos=zr(o),this._offset=d.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=q(this._animate,this),this._step()},_step:function(o){var d=+new Date-this._startTime,P=1e3*this._duration;d<P?this._runFrame(this._easeOut(d/P),o):(this._runFrame(1),this._complete())},_runFrame:function(o,d){var P=this._startPos.add(this._offset.multiplyBy(o));d&&P._round(),ir(this._el,P),this.fire("step")},_complete:function(){re(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(o){return 1-Math.pow(1-o,this._easeOutPower)}}),D=jo.extend({options:{crs:Zn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(o,d){d=x(this,d),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(o),this._initLayout(),this._onResize=W(this._onResize,this),this._initEvents(),d.maxBounds&&this.setMaxBounds(d.maxBounds),d.zoom!==void 0&&(this._zoom=this._limitZoom(d.zoom)),d.center&&d.zoom!==void 0&&this.setView(Et(d.center),d.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=po&&pn&&!qr&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ni(this._proxy,Jo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(o,d,P){return d=d===void 0?this._zoom:this._limitZoom(d),o=this._limitCenter(Et(o),d,this.options.maxBounds),P=P||{},this._stop(),this._loaded&&!P.reset&&P!==!0&&(P.animate!==void 0&&(P.zoom=Q({animate:P.animate},P.zoom),P.pan=Q({animate:P.animate,duration:P.duration},P.pan)),this._zoom!==d?this._tryAnimatedZoom&&this._tryAnimatedZoom(o,d,P.zoom):this._tryAnimatedPan(o,P.pan))?(clearTimeout(this._sizeTimer),this):(this._resetView(o,d),this)},setZoom:function(o,d){return this._loaded?this.setView(this.getCenter(),o,{zoom:d}):(this._zoom=o,this)},zoomIn:function(o,d){return o=o||(pn?this.options.zoomDelta:1),this.setZoom(this._zoom+o,d)},zoomOut:function(o,d){return o=o||(pn?this.options.zoomDelta:1),this.setZoom(this._zoom-o,d)},setZoomAround:function(o,d,P){var U=this.getZoomScale(d),Y=this.getSize().divideBy(2),me=(o instanceof X?o:this.latLngToContainerPoint(o)).subtract(Y).multiplyBy(1-1/U),Ke=this.containerPointToLatLng(Y.add(me));return this.setView(Ke,d,{zoom:P})},_getBoundsCenterZoom:function(o,d){d=d||{},o=o.getBounds?o.getBounds():Ue(o);var P=ce(d.paddingTopLeft||d.padding||[0,0]),U=ce(d.paddingBottomRight||d.padding||[0,0]),Y=this.getBoundsZoom(o,!1,P.add(U));if((Y=typeof d.maxZoom=="number"?Math.min(d.maxZoom,Y):Y)===1/0)return{center:o.getCenter(),zoom:Y};var me=U.subtract(P).divideBy(2),Ke=this.project(o.getSouthWest(),Y),Tt=this.project(o.getNorthEast(),Y);return{center:this.unproject(Ke.add(Tt).divideBy(2).add(me),Y),zoom:Y}},fitBounds:function(o,d){if(!(o=Ue(o)).isValid())throw new Error("Bounds are not valid.");var P=this._getBoundsCenterZoom(o,d);return this.setView(P.center,P.zoom,d)},fitWorld:function(o){return this.fitBounds([[-90,-180],[90,180]],o)},panTo:function(o,d){return this.setView(o,this._zoom,{pan:d})},panBy:function(o,d){if(o=ce(o).round(),d=d||{},!o.x&&!o.y)return this.fire("moveend");if(d.animate!==!0&&!this.getSize().contains(o))return this._resetView(this.unproject(this.project(this.getCenter()).add(o)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new b,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),d.noMoveStart||this.fire("movestart"),d.animate!==!1){qt(this._mapPane,"leaflet-pan-anim");var P=this._getMapPanePos().subtract(o).round();this._panAnim.run(this._mapPane,P,d.duration||.25,d.easeLinearity)}else this._rawPanBy(o),this.fire("move").fire("moveend");return this},flyTo:function(o,d,P){function U(Sr){var go=(ti*ti-Ao*Ao+(Sr?-1:1)*qa*qa*va*va)/(2*(Sr?ti:Ao)*qa*va),Rs=Math.sqrt(go*go+1)-go;return Rs<1e-9?-18:Math.log(Rs)}function Y(Sr){return(Math.exp(Sr)-Math.exp(-Sr))/2}function me(Sr){return(Math.exp(Sr)+Math.exp(-Sr))/2}function Ke(Sr){return Y(Sr)/me(Sr)}function Tt(Sr){return Ao*(me(Jn)/me(Jn+ba*Sr))}function wt(Sr){return Ao*(me(Jn)*Ke(Jn+ba*Sr)-Y(Jn))/qa}function pt(Sr){return 1-Math.pow(1-Sr,1.5)}function _i(){var Sr=(Date.now()-mo)/Ls,go=pt(Sr)*us;Sr<=1?(this._flyToFrame=q(_i,this),this._move(this.unproject(Hi.add(Er.subtract(Hi).multiplyBy(wt(go)/va)),vn),this.getScaleZoom(Ao/Tt(go),vn),{flyTo:!0})):this._move(o,d)._moveEnd(!0)}if((P=P||{}).animate===!1||!pn)return this.setView(o,d,P);this._stop();var Hi=this.project(this.getCenter()),Er=this.project(o),Mn=this.getSize(),vn=this._zoom;o=Et(o),d=d===void 0?vn:d;var Ao=Math.max(Mn.x,Mn.y),ti=Ao*this.getZoomScale(vn,d),va=Er.distanceTo(Hi)||1,ba=1.42,qa=ba*ba,Jn=U(0),mo=Date.now(),us=(U(1)-Jn)/ba,Ls=P.duration?1e3*P.duration:1e3*us*.8;return this._moveStart(!0,P.noMoveStart),_i.call(this),this},flyToBounds:function(o,d){var P=this._getBoundsCenterZoom(o,d);return this.flyTo(P.center,P.zoom,d)},setMaxBounds:function(o){return(o=Ue(o)).isValid()?(this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this.options.maxBounds=o,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this.off("moveend",this._panInsideMaxBounds))},setMinZoom:function(o){var d=this.options.minZoom;return this.options.minZoom=o,this._loaded&&d!==o&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(o):this},setMaxZoom:function(o){var d=this.options.maxZoom;return this.options.maxZoom=o,this._loaded&&d!==o&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(o):this},panInsideBounds:function(o,d){this._enforcingBounds=!0;var P=this.getCenter(),U=this._limitCenter(P,this._zoom,Ue(o));return P.equals(U)||this.panTo(U,d),this._enforcingBounds=!1,this},panInside:function(o,d){var P=ce((d=d||{}).paddingTopLeft||d.padding||[0,0]),U=ce(d.paddingBottomRight||d.padding||[0,0]),Y=this.getCenter(),me=this.project(Y),Ke=this.project(o),Tt=this.getPixelBounds(),wt=Tt.getSize().divideBy(2),pt=Be([Tt.min.add(P),Tt.max.subtract(U)]);if(!pt.contains(Ke)){this._enforcingBounds=!0;var _i=me.subtract(Ke),Hi=ce(Ke.x+_i.x,Ke.y+_i.y);(Ke.x<pt.min.x||Ke.x>pt.max.x)&&(Hi.x=me.x-_i.x,_i.x>0?Hi.x+=wt.x-P.x:Hi.x-=wt.x-U.x),(Ke.y<pt.min.y||Ke.y>pt.max.y)&&(Hi.y=me.y-_i.y,_i.y>0?Hi.y+=wt.y-P.y:Hi.y-=wt.y-U.y),this.panTo(this.unproject(Hi),d),this._enforcingBounds=!1}return this},invalidateSize:function(o){if(!this._loaded)return this;o=Q({animate:!1,pan:!0},o===!0?{animate:!0}:o);var d=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var P=this.getSize(),U=d.divideBy(2).round(),Y=P.divideBy(2).round(),me=U.subtract(Y);return me.x||me.y?(o.animate&&o.pan?this.panBy(me):(o.pan&&this._rawPanBy(me),this.fire("move"),o.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(W(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:d,newSize:P})):this},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(o){if(o=this._locateOptions=Q({timeout:1e4,watch:!1},o),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var d=W(this._handleGeolocationResponse,this),P=W(this._handleGeolocationError,this);return o.watch?this._locationWatchId=navigator.geolocation.watchPosition(d,P,o):navigator.geolocation.getCurrentPosition(d,P,o),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(o){var d=o.code,P=o.message||(d===1?"permission denied":d===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:d,message:"Geolocation error: "+P+"."})},_handleGeolocationResponse:function(o){var d=new ht(o.coords.latitude,o.coords.longitude),P=d.toBounds(2*o.coords.accuracy),U=this._locateOptions;if(U.setView){var Y=this.getBoundsZoom(P);this.setView(d,U.maxZoom?Math.min(Y,U.maxZoom):Y)}var me={latlng:d,bounds:P,timestamp:o.timestamp};for(var Ke in o.coords)typeof o.coords[Ke]=="number"&&(me[Ke]=o.coords[Ke]);this.fire("locationfound",me)},addHandler:function(o,d){if(!d)return this;var P=this[o]=new d(this);return this._handlers.push(P),this.options[o]&&P.enable(),this},remove:function(){if(this._initEvents(!0),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch(d){this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),mt(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(re(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var o;for(o in this._layers)this._layers[o].remove();for(o in this._panes)mt(this._panes[o]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(o,d){var P=He("div","leaflet-pane"+(o?" leaflet-"+o.replace("Pane","")+"-pane":""),d||this._mapPane);return o&&(this._panes[o]=P),P},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var o=this.getPixelBounds();return new ot(this.unproject(o.getBottomLeft()),this.unproject(o.getTopRight()))},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(o,d,P){o=Ue(o),P=ce(P||[0,0]);var U=this.getZoom()||0,Y=this.getMinZoom(),me=this.getMaxZoom(),Ke=o.getNorthWest(),Tt=o.getSouthEast(),wt=this.getSize().subtract(P),pt=Be(this.project(Tt,U),this.project(Ke,U)).getSize(),_i=pn?this.options.zoomSnap:1,Hi=wt.x/pt.x,Er=wt.y/pt.y,Mn=d?Math.max(Hi,Er):Math.min(Hi,Er);return U=this.getScaleZoom(Mn,U),_i&&(U=Math.round(U/(_i/100))*(_i/100),U=d?Math.ceil(U/_i)*_i:Math.floor(U/_i)*_i),Math.max(Y,Math.min(me,U))},getSize:function(){return this._size&&!this._sizeChanged||(this._size=new X(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(o,d){var P=this._getTopLeftPoint(o,d);return new Me(P,P.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(o){return this.options.crs.getProjectedBounds(o===void 0?this.getZoom():o)},getPane:function(o){return typeof o=="string"?this._panes[o]:o},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(o,d){var P=this.options.crs;return d=d===void 0?this._zoom:d,P.scale(o)/P.scale(d)},getScaleZoom:function(o,d){var P=this.options.crs;d=d===void 0?this._zoom:d;var U=P.zoom(o*P.scale(d));return isNaN(U)?1/0:U},project:function(o,d){return d=d===void 0?this._zoom:d,this.options.crs.latLngToPoint(Et(o),d)},unproject:function(o,d){return d=d===void 0?this._zoom:d,this.options.crs.pointToLatLng(ce(o),d)},layerPointToLatLng:function(o){var d=ce(o).add(this.getPixelOrigin());return this.unproject(d)},latLngToLayerPoint:function(o,d){d=d===void 0||d;var P=this.project(Et(o));return(P=d?P._round():P)._subtract(this.getPixelOrigin())},wrapLatLng:function(o){return this.options.crs.wrapLatLng(Et(o))},wrapLatLngBounds:function(o){return this.options.crs.wrapLatLngBounds(Ue(o))},distance:function(o,d){return this.options.crs.distance(Et(o),Et(d))},containerPointToLayerPoint:function(o){return ce(o).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(o){return ce(o).add(this._getMapPanePos())},containerPointToLatLng:function(o){var d=this.containerPointToLayerPoint(ce(o));return this.layerPointToLatLng(d)},latLngToContainerPoint:function(o,d){return d=d===void 0||d,this.layerPointToContainerPoint(this.latLngToLayerPoint(Et(o),d))},mouseEventToContainerPoint:function(o){return co(o,this._container)},mouseEventToLayerPoint:function(o){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(o))},mouseEventToLatLng:function(o){return this.layerPointToLatLng(this.mouseEventToLayerPoint(o))},_initContainer:function(o){var d=this._container=de(o);if(!d)throw new Error("Map container not found.");if(d._leaflet_id)throw new Error("Map container is already initialized.");Ni(d,"scroll",this._onScroll,this),this._containerId=h(d)},_initLayout:function(){var o=this._container;this._fadeAnimated=this.options.fadeAnimation&&pn,qt(o,"leaflet-container"+(Mr?" leaflet-touch":"")+(No?" leaflet-retina":"")+(zn?" leaflet-oldie":"")+(Wa?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var d=Re(o,"position");d!=="absolute"&&d!=="relative"&&d!=="fixed"&&(o.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var o=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ir(this._mapPane,new X(0,0)),this.createPane("tilePane"),this.createPane("shadowPane"),this.createPane("overlayPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(qt(o.markerPane,"leaflet-zoom-hide"),qt(o.shadowPane,"leaflet-zoom-hide"))},_resetView:function(o,d){ir(this._mapPane,new X(0,0));var P=!this._loaded;this._loaded=!0,d=this._limitZoom(d),this.fire("viewprereset");var U=this._zoom!==d;this._moveStart(U,!1)._move(o,d)._moveEnd(U),this.fire("viewreset"),P&&this.fire("load")},_moveStart:function(o,d){return o&&this.fire("zoomstart"),d||this.fire("movestart"),this},_move:function(o,d,P){d===void 0&&(d=this._zoom);var U=this._zoom!==d;return this._zoom=d,this._lastCenter=o,this._pixelOrigin=this._getNewPixelOrigin(o),(U||P&&P.pinch)&&this.fire("zoom",P),this.fire("move",P)},_moveEnd:function(o){return o&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return re(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(o){ir(this._mapPane,this._getMapPanePos().subtract(o))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(o){this._targets={},this._targets[h(this._container)]=this;var d=o?wr:Ni;d(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&d(window,"resize",this._onResize,this),pn&&this.options.transform3DLimit&&(o?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){re(this._resizeRequest),this._resizeRequest=q(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var o=this._getMapPanePos();Math.max(Math.abs(o.x),Math.abs(o.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(o,d){for(var P,U=[],Y=d==="mouseout"||d==="mouseover",me=o.target||o.srcElement,Ke=!1;me;){if((P=this._targets[h(me)])&&(d==="click"||d==="preclick")&&!o._simulated&&this._draggableMoved(P)){Ke=!0;break}if(P&&P.listens(d,!0)&&(Y&&!ue(me,o)||(U.push(P),Y))||me===this._container)break;me=me.parentNode}return U.length||Ke||Y||!ue(me,o)||(U=[this]),U},_handleDOMEvent:function(o){if(this._loaded&&!le(o)){var d=o.type;d!=="mousedown"&&d!=="keypress"&&d!=="keyup"&&d!=="keydown"||nn(o.target||o.srcElement),this._fireDOMEvent(o,d)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(o,d,P){if(o.type==="click"){var U=Q({},o);U.type="preclick",this._fireDOMEvent(U,U.type,P)}if(!o._stopped&&(P=(P||[]).concat(this._findEventTargets(o,d))).length){var Y=P[0];d==="contextmenu"&&Y.listens(d,!0);var me={originalEvent:o};if(o.type!=="keypress"&&o.type!=="keydown"&&o.type!=="keyup"){var Ke=Y.getLatLng&&(!Y._radius||Y._radius<=10);me.containerPoint=Ke?this.latLngToContainerPoint(Y.getLatLng()):this.mouseEventToContainerPoint(o),me.layerPoint=this.containerPointToLayerPoint(me.containerPoint),me.latlng=Ke?Y.getLatLng():this.layerPointToLatLng(me.layerPoint)}for(var Tt=0;Tt<P.length;Tt++)if(P[Tt].fire(d,me,!0),me.originalEvent._stopped||P[Tt].options.bubblingMouseEvents===!1&&T(this._mouseEvents,d)!==-1)return}},_draggableMoved:function(o){return(o=o.dragging&&o.dragging.enabled()?o:this).dragging&&o.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var o=0,d=this._handlers.length;o<d;o++)this._handlers[o].disable()},whenReady:function(o,d){return this._loaded?o.call(d||this,{target:this}):this.on("load",o,d),this},_getMapPanePos:function(){return zr(this._mapPane)||new X(0,0)},_moved:function(){var o=this._getMapPanePos();return o&&!o.equals([0,0])},_getTopLeftPoint:function(o,d){return(o&&d!==void 0?this._getNewPixelOrigin(o,d):this.getPixelOrigin()).subtract(this._getMapPanePos())},_getNewPixelOrigin:function(o,d){var P=this.getSize()._divideBy(2);return this.project(o,d)._subtract(P)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(o,d,P){var U=this._getNewPixelOrigin(P,d);return this.project(o,d)._subtract(U)},_latLngBoundsToNewLayerBounds:function(o,d,P){var U=this._getNewPixelOrigin(P,d);return Be([this.project(o.getSouthWest(),d)._subtract(U),this.project(o.getNorthWest(),d)._subtract(U),this.project(o.getSouthEast(),d)._subtract(U),this.project(o.getNorthEast(),d)._subtract(U)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(o,d){return d=d===void 0||d,this.latLngToLayerPoint(o,d).subtract(this._getCenterLayerPoint())},_limitCenter:function(o,d,P){if(!P)return o;var U=this.project(o,d),Y=this.getSize().divideBy(2),me=new Me(U.subtract(Y),U.add(Y)),Ke=this._getBoundsOffset(me,P,d);return Ke.round().equals([0,0])?o:this.unproject(U.add(Ke),d)},_limitOffset:function(o,d){if(!d)return o;var P=this.getPixelBounds(),U=new Me(P.min.add(o),P.max.add(o));return o.add(this._getBoundsOffset(U,d))},_getBoundsOffset:function(o,d,P){var U=Be(this.project(d.getNorthEast(),P),this.project(d.getSouthWest(),P)),Y=U.min.subtract(o.min),me=U.max.subtract(o.max);return new X(this._rebound(Y.x,-me.x),this._rebound(Y.y,-me.y))},_rebound:function(o,d){return o+d>0?Math.round(o-d)/2:Math.max(0,Math.ceil(o))-Math.max(0,Math.floor(d))},_limitZoom:function(o){var d=this.getMinZoom(),P=this.getMaxZoom(),U=pn?this.options.zoomSnap:1;return U&&(o=Math.round(o/U)*U),Math.max(d,Math.min(P,o))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){fi(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(o,d){var P=this._getCenterOffset(o)._trunc();return!((d&&d.animate)!==!0&&!this.getSize().contains(P))&&(this.panBy(P,d),!0)},_createAnimProxy:function(){var o=this._proxy=He("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(o),this.on("zoomanim",function(d){var P=Io,U=this._proxy.style[P];hr(this._proxy,this.project(d.center,d.zoom),this.getZoomScale(d.zoom,1)),U===this._proxy.style[P]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",function(){var d=this.getCenter(),P=this.getZoom();hr(this._proxy,this.project(d,P),this.getZoomScale(P,1))},this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){mt(this._proxy),delete this._proxy},_catchTransitionEnd:function(o){this._animatingZoom&&o.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(o,d,P){if(this._animatingZoom)return!0;if(P=P||{},!this._zoomAnimated||P.animate===!1||this._nothingToAnimate()||Math.abs(d-this._zoom)>this.options.zoomAnimationThreshold)return!1;var U=this.getZoomScale(d),Y=this._getCenterOffset(o)._divideBy(1-1/U);return!(P.animate!==!0&&!this.getSize().contains(Y))&&(q(function(){this._moveStart(!0,!1)._animateZoom(o,d,!0)},this),!0)},_animateZoom:function(o,d,P,U){this._mapPane&&(P&&(this._animatingZoom=!0,this._animateToCenter=o,this._animateToZoom=d,qt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:o,zoom:d,noUpdate:U}),setTimeout(W(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&fi(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom),q(function(){this._moveEnd(!0)},this))}}),G=ne.extend({options:{position:"topright"},initialize:function(o){x(this,o)},getPosition:function(){return this.options.position},setPosition:function(o){var d=this._map;return d&&d.removeControl(this),this.options.position=o,d&&d.addControl(this),this},getContainer:function(){return this._container},addTo:function(o){this.remove(),this._map=o;var d=this._container=this.onAdd(o),P=this.getPosition(),U=o._controlCorners[P];return qt(d,"leaflet-control"),P.indexOf("bottom")!==-1?U.insertBefore(d,U.firstChild):U.appendChild(d),this},remove:function(){return this._map?(mt(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(o){this._map&&o&&o.screenX>0&&o.screenY>0&&this._map.getContainer().focus()}}),Z=function(o){return new G(o)};D.include({addControl:function(o){return o.addTo(this),this},removeControl:function(o){return o.remove(),this},_initControlPos:function(){function o(Y,me){var Ke=P+Y+" "+P+me;d[Y+me]=He("div",Ke,U)}var d=this._controlCorners={},P="leaflet-",U=this._controlContainer=He("div",P+"control-container",this._container);o("top","left"),o("top","right"),o("bottom","left"),o("bottom","right")},_clearControlPos:function(){for(var o in this._controlCorners)mt(this._controlCorners[o]);mt(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var te=G.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(o,d,P,U){return P<U?-1:U<P?1:0}},initialize:function(o,d,P){x(this,P),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var U in o)this._addLayer(o[U],U);for(U in d)this._addLayer(d[U],U,!0)},onAdd:function(o){this._initLayout(),this._update(),this._map=o,o.on("zoomend",this._checkDisabledLayers,this);for(var d=0;d<this._layers.length;d++)this._layers[d].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(o){return G.prototype.addTo.call(this,o),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(o,d){return this._addLayer(o,d),this._map?this._update():this},addOverlay:function(o,d){return this._addLayer(o,d,!0),this._map?this._update():this},removeLayer:function(o){o.off("add remove",this._onLayerChange,this);var d=this._getLayer(h(o));return d&&this._layers.splice(this._layers.indexOf(d),1),this._map?this._update():this},expand:function(){qt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var o=this._map.getSize().y-(this._container.offsetTop+50);return o<this._section.clientHeight?(qt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=o+"px"):fi(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return fi(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var o="leaflet-control-layers",d=this._container=He("div",o),P=this.options.collapsed;d.setAttribute("aria-haspopup",!0),Gn(d),Po(d);var U=this._section=He("section",o+"-list");P&&(this._map.on("click",this.collapse,this),ca||Ni(d,{mouseenter:this.expand,mouseleave:this.collapse},this));var Y=this._layersLink=He("a",o+"-toggle",d);Y.href="#",Y.title="Layers",Mr?(Ni(Y,"click",ln),Ni(Y,"click",this.expand,this)):Ni(Y,"focus",this.expand,this),P||this.expand(),this._baseLayersList=He("div",o+"-base",U),this._separator=He("div",o+"-separator",U),this._overlaysList=He("div",o+"-overlays",U),d.appendChild(U)},_getLayer:function(o){for(var d=0;d<this._layers.length;d++)if(this._layers[d]&&h(this._layers[d].layer)===o)return this._layers[d]},_addLayer:function(o,d,P){this._map&&o.on("add remove",this._onLayerChange,this),this._layers.push({layer:o,name:d,overlay:P}),this.options.sortLayers&&this._layers.sort(W(function(U,Y){return this.options.sortFunction(U.layer,Y.layer,U.name,Y.name)},this)),this.options.autoZIndex&&o.setZIndex&&(this._lastZIndex++,o.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ft(this._baseLayersList),Ft(this._overlaysList),this._layerControlInputs=[];var o,d,P,U,Y=0;for(P=0;P<this._layers.length;P++)U=this._layers[P],this._addItem(U),d=d||U.overlay,o=o||!U.overlay,Y+=U.overlay?0:1;return this.options.hideSingleBase&&(o=o&&Y>1,this._baseLayersList.style.display=o?"":"none"),this._separator.style.display=d&&o?"":"none",this},_onLayerChange:function(o){this._handlingClick||this._update();var d=this._getLayer(h(o.target)),P=d.overlay?o.type==="add"?"overlayadd":"overlayremove":o.type==="add"?"baselayerchange":null;P&&this._map.fire(P,d)},_createRadioElement:function(o,d){var P='<input type="radio" class="leaflet-control-layers-selector" name="'+o+'"'+(d?' checked="checked"':"")+"/>",U=document.createElement("div");return U.innerHTML=P,U.firstChild},_addItem:function(o){var d,P=document.createElement("label"),U=this._map.hasLayer(o.layer);o.overlay?((d=document.createElement("input")).type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=U):d=this._createRadioElement("leaflet-base-layers",U),this._layerControlInputs.push(d),d.layerId=h(o.layer),Ni(d,"click",this._onInputClick,this);var Y=document.createElement("span");Y.innerHTML=" "+o.name;var me=document.createElement("div");return P.appendChild(me),me.appendChild(d),me.appendChild(Y),(o.overlay?this._overlaysList:this._baseLayersList).appendChild(P),this._checkDisabledLayers(),P},_onInputClick:function(){var o,d,P=this._layerControlInputs,U=[],Y=[];this._handlingClick=!0;for(var me=P.length-1;me>=0;me--)o=P[me],d=this._getLayer(o.layerId).layer,o.checked?U.push(d):o.checked||Y.push(d);for(me=0;me<Y.length;me++)this._map.hasLayer(Y[me])&&this._map.removeLayer(Y[me]);for(me=0;me<U.length;me++)this._map.hasLayer(U[me])||this._map.addLayer(U[me]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var o,d,P=this._layerControlInputs,U=this._map.getZoom(),Y=P.length-1;Y>=0;Y--)o=P[Y],d=this._getLayer(o.layerId).layer,o.disabled=d.options.minZoom!==void 0&&U<d.options.minZoom||d.options.maxZoom!==void 0&&U>d.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expand:function(){return this.expand()},_collapse:function(){return this.collapse()}}),ae=G.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"&#x2212;",zoomOutTitle:"Zoom out"},onAdd:function(o){var d="leaflet-control-zoom",P=He("div",d+" leaflet-bar"),U=this.options;return this._zoomInButton=this._createButton(U.zoomInText,U.zoomInTitle,d+"-in",P,this._zoomIn),this._zoomOutButton=this._createButton(U.zoomOutText,U.zoomOutTitle,d+"-out",P,this._zoomOut),this._updateDisabled(),o.on("zoomend zoomlevelschange",this._updateDisabled,this),P},onRemove:function(o){o.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(o){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(o.shiftKey?3:1))},_zoomOut:function(o){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(o.shiftKey?3:1))},_createButton:function(o,d,P,U,Y){var me=He("a",P,U);return me.innerHTML=o,me.href="#",me.title=d,me.setAttribute("role","button"),me.setAttribute("aria-label",d),Gn(me),Ni(me,"click",ln),Ni(me,"click",Y,this),Ni(me,"click",this._refocusOnMap,this),me},_updateDisabled:function(){var o=this._map,d="leaflet-disabled";fi(this._zoomInButton,d),fi(this._zoomOutButton,d),(this._disabled||o._zoom===o.getMinZoom())&&qt(this._zoomOutButton,d),(this._disabled||o._zoom===o.getMaxZoom())&&qt(this._zoomInButton,d)}});D.mergeOptions({zoomControl:!0}),D.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ae,this.addControl(this.zoomControl))});var Pe=G.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(o){var d=He("div","leaflet-control-scale"),P=this.options;return this._addScales(P,"leaflet-control-scale-line",d),o.on(P.updateWhenIdle?"moveend":"move",this._update,this),o.whenReady(this._update,this),d},onRemove:function(o){o.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(o,d,P){o.metric&&(this._mScale=He("div",d,P)),o.imperial&&(this._iScale=He("div",d,P))},_update:function(){var o=this._map,d=o.getSize().y/2,P=o.distance(o.containerPointToLatLng([0,d]),o.containerPointToLatLng([this.options.maxWidth,d]));this._updateScales(P)},_updateScales:function(o){this.options.metric&&o&&this._updateMetric(o),this.options.imperial&&o&&this._updateImperial(o)},_updateMetric:function(o){var d=this._getRoundNum(o),P=d<1e3?d+" m":d/1e3+" km";this._updateScale(this._mScale,P,d/o)},_updateImperial:function(o){var d,P,U,Y=3.2808399*o;Y>5280?(d=Y/5280,P=this._getRoundNum(d),this._updateScale(this._iScale,P+" mi",P/d)):(U=this._getRoundNum(Y),this._updateScale(this._iScale,U+" ft",U/Y))},_updateScale:function(o,d,P){o.style.width=Math.round(this.options.maxWidth*P)+"px",o.innerHTML=d},_getRoundNum:function(o){var d=Math.pow(10,(Math.floor(o)+"").length-1),P=o/d;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:1,d*P}}),ve=G.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(o){x(this,o),this._attributions={}},onAdd:function(o){o.attributionControl=this,this._container=He("div","leaflet-control-attribution"),Gn(this._container);for(var d in o._layers)o._layers[d].getAttribution&&this.addAttribution(o._layers[d].getAttribution());return this._update(),this._container},setPrefix:function(o){return this.options.prefix=o,this._update(),this},addAttribution:function(o){return o?(this._attributions[o]||(this._attributions[o]=0),this._attributions[o]++,this._update(),this):this},removeAttribution:function(o){return o?(this._attributions[o]&&(this._attributions[o]--,this._update()),this):this},_update:function(){if(this._map){var o=[];for(var d in this._attributions)this._attributions[d]&&o.push(d);var P=[];this.options.prefix&&P.push(this.options.prefix),o.length&&P.push(o.join(", ")),this._container.innerHTML=P.join(" | ")}}});D.mergeOptions({attributionControl:!0}),D.addInitHook(function(){this.options.attributionControl&&new ve().addTo(this)}),G.Layers=te,G.Zoom=ae,G.Scale=Pe,G.Attribution=ve,Z.layers=function(o,d,P){return new te(o,d,P)},Z.zoom=function(o){return new ae(o)},Z.scale=function(o){return new Pe(o)},Z.attribution=function(o){return new ve(o)};var pe=ne.extend({initialize:function(o){this._map=o},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});pe.addTo=function(o,d){return o.addHandler(d,this),this};var Fe,ke={Events:gr},Ze=Mr?"touchstart mousedown":"mousedown",at={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},Ve={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"},st=jo.extend({options:{clickTolerance:3},initialize:function(o,d,P,U){x(this,U),this._element=o,this._dragStartTarget=d||o,this._preventOutline=P},enable:function(){this._enabled||(Ni(this._dragStartTarget,Ze,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(st._dragging===this&&this.finishDrag(),wr(this._dragStartTarget,Ze,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(o){if(!o._simulated&&this._enabled&&(this._moved=!1,!Kt(this._element,"leaflet-zoom-anim")&&!(st._dragging||o.shiftKey||o.which!==1&&o.button!==1&&!o.touches||(st._dragging=this,this._preventOutline&&nn(this._element),rn(),Wn(),this._moving)))){this.fire("down");var d=o.touches?o.touches[0]:o,P=Pn(this._element);this._startPoint=new X(d.clientX,d.clientY),this._parentScale=An(P),Ni(document,Ve[o.type],this._onMove,this),Ni(document,at[o.type],this._onUp,this)}},_onMove:function(o){if(!o._simulated&&this._enabled)if(o.touches&&o.touches.length>1)this._moved=!0;else{var d=o.touches&&o.touches.length===1?o.touches[0]:o,P=new X(d.clientX,d.clientY)._subtract(this._startPoint);(P.x||P.y)&&(Math.abs(P.x)+Math.abs(P.y)<this.options.clickTolerance||(P.x/=this._parentScale.x,P.y/=this._parentScale.y,Xr(o),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=zr(this._element).subtract(P),qt(document.body,"leaflet-dragging"),this._lastTarget=o.target||o.srcElement,window.SVGElementInstance&&this._lastTarget instanceof SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),qt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(P),this._moving=!0,re(this._animRequest),this._lastEvent=o,this._animRequest=q(this._updatePosition,this,!0)))}},_updatePosition:function(){var o={originalEvent:this._lastEvent};this.fire("predrag",o),ir(this._element,this._newPos),this.fire("drag",o)},_onUp:function(o){!o._simulated&&this._enabled&&this.finishDrag()},finishDrag:function(){fi(document.body,"leaflet-dragging"),this._lastTarget&&(fi(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var o in Ve)wr(document,Ve[o],this._onMove,this),wr(document,at[o],this._onUp,this);Br(),yn(),this._moved&&this._moving&&(re(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1,st._dragging=!1}}),Pt=(Object.freeze||Object)({simplify:Oe,pointToSegmentDistance:je,closestPointOnSegment:function(o,d,P){return Dt(o,d,P)},clipSegment:rt,_getEdgeIntersection:Mt,_getBitCode:Wt,_sqClosestPointOnSegment:Dt,isFlat:ai,_flat:dt}),$e=(Object.freeze||Object)({clipPolygon:Zt}),Ct={project:function(o){return new X(o.lng,o.lat)},unproject:function(o){return new ht(o.y,o.x)},bounds:new Me([-180,-90],[180,90])},At={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Me([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(o){var d=Math.PI/180,P=this.R,U=o.lat*d,Y=this.R_MINOR/P,me=Math.sqrt(1-Y*Y),Ke=me*Math.sin(U),Tt=Math.tan(Math.PI/4-U/2)/Math.pow((1-Ke)/(1+Ke),me/2);return U=-P*Math.log(Math.max(Tt,1e-10)),new X(o.lng*d*P,U)},unproject:function(o){for(var d,P=180/Math.PI,U=this.R,Y=this.R_MINOR/U,me=Math.sqrt(1-Y*Y),Ke=Math.exp(-o.y/U),Tt=Math.PI/2-2*Math.atan(Ke),wt=0,pt=.1;wt<15&&Math.abs(pt)>1e-7;wt++)d=me*Math.sin(Tt),d=Math.pow((1-d)/(1+d),me/2),Tt+=pt=Math.PI/2-2*Math.atan(Ke*d)-Tt;return new ht(Tt*P,o.x*P/U)}},qe=(Object.freeze||Object)({LonLat:Ct,Mercator:At,SphericalMercator:Ir}),nt=Q({},cn,{code:"EPSG:3395",projection:At,transformation:function(){var o=.5/(Math.PI*At.R);return gt(o,.5,-o,.5)}()}),Xe=Q({},cn,{code:"EPSG:4326",projection:Ct,transformation:gt(1/180,1,-1/180,.5)}),It=Q({},Ur,{projection:Ct,transformation:gt(1,0,-1,0),scale:function(o){return Math.pow(2,o)},zoom:function(o){return Math.log(o)/Math.LN2},distance:function(o,d){var P=d.lng-o.lng,U=d.lat-o.lat;return Math.sqrt(P*P+U*U)},infinite:!0});Ur.Earth=cn,Ur.EPSG3395=nt,Ur.EPSG3857=Zn,Ur.EPSG900913=Ps,Ur.EPSG4326=Xe,Ur.Simple=It;var kt=jo.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(o){return o.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(o){return o&&o.removeLayer(this),this},getPane:function(o){return this._map.getPane(o?this.options[o]||o:this.options.pane)},addInteractiveTarget:function(o){return this._map._targets[h(o)]=this,this},removeInteractiveTarget:function(o){return delete this._map._targets[h(o)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(o){var d=o.target;if(d.hasLayer(this)){if(this._map=d,this._zoomAnimated=d._zoomAnimated,this.getEvents){var P=this.getEvents();d.on(P,this),this.once("remove",function(){d.off(P,this)},this)}this.onAdd(d),this.getAttribution&&d.attributionControl&&d.attributionControl.addAttribution(this.getAttribution()),this.fire("add"),d.fire("layeradd",{layer:this})}}});D.include({addLayer:function(o){if(!o._layerAdd)throw new Error("The provided object is not a Layer.");var d=h(o);return this._layers[d]?this:(this._layers[d]=o,o._mapToAdd=this,o.beforeAdd&&o.beforeAdd(this),this.whenReady(o._layerAdd,o),this)},removeLayer:function(o){var d=h(o);return this._layers[d]?(this._loaded&&o.onRemove(this),o.getAttribution&&this.attributionControl&&this.attributionControl.removeAttribution(o.getAttribution()),delete this._layers[d],this._loaded&&(this.fire("layerremove",{layer:o}),o.fire("remove")),o._map=o._mapToAdd=null,this):this},hasLayer:function(o){return!!o&&h(o)in this._layers},eachLayer:function(o,d){for(var P in this._layers)o.call(d,this._layers[P]);return this},_addLayers:function(o){for(var d=0,P=(o=o?Dn(o)?o:[o]:[]).length;d<P;d++)this.addLayer(o[d])},_addZoomLimit:function(o){!isNaN(o.options.maxZoom)&&isNaN(o.options.minZoom)||(this._zoomBoundLayers[h(o)]=o,this._updateZoomLevels())},_removeZoomLimit:function(o){var d=h(o);this._zoomBoundLayers[d]&&(delete this._zoomBoundLayers[d],this._updateZoomLevels())},_updateZoomLevels:function(){var o=1/0,d=-1/0,P=this._getZoomSpan();for(var U in this._zoomBoundLayers){var Y=this._zoomBoundLayers[U].options;o=Y.minZoom===void 0?o:Math.min(o,Y.minZoom),d=Y.maxZoom===void 0?d:Math.max(d,Y.maxZoom)}this._layersMaxZoom=d===-1/0?void 0:d,this._layersMinZoom=o===1/0?void 0:o,P!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Nt=kt.extend({initialize:function(o,d){x(this,d),this._layers={};var P,U;if(o)for(P=0,U=o.length;P<U;P++)this.addLayer(o[P])},addLayer:function(o){var d=this.getLayerId(o);return this._layers[d]=o,this._map&&this._map.addLayer(o),this},removeLayer:function(o){var d=o in this._layers?o:this.getLayerId(o);return this._map&&this._layers[d]&&this._map.removeLayer(this._layers[d]),delete this._layers[d],this},hasLayer:function(o){return!!o&&(o in this._layers||this.getLayerId(o)in this._layers)},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(o){var d,P,U=Array.prototype.slice.call(arguments,1);for(d in this._layers)(P=this._layers[d])[o]&&P[o].apply(P,U);return this},onAdd:function(o){this.eachLayer(o.addLayer,o)},onRemove:function(o){this.eachLayer(o.removeLayer,o)},eachLayer:function(o,d){for(var P in this._layers)o.call(d,this._layers[P]);return this},getLayer:function(o){return this._layers[o]},getLayers:function(){var o=[];return this.eachLayer(o.push,o),o},setZIndex:function(o){return this.invoke("setZIndex",o)},getLayerId:function(o){return h(o)}}),Rt=Nt.extend({addLayer:function(o){return this.hasLayer(o)?this:(o.addEventParent(this),Nt.prototype.addLayer.call(this,o),this.fire("layeradd",{layer:o}))},removeLayer:function(o){return this.hasLayer(o)?(o in this._layers&&(o=this._layers[o]),o.removeEventParent(this),Nt.prototype.removeLayer.call(this,o),this.fire("layerremove",{layer:o})):this},setStyle:function(o){return this.invoke("setStyle",o)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var o=new ot;for(var d in this._layers){var P=this._layers[d];o.extend(P.getBounds?P.getBounds():P.getLatLng())}return o}}),Qt=ne.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0]},initialize:function(o){x(this,o)},createIcon:function(o){return this._createIcon("icon",o)},createShadow:function(o){return this._createIcon("shadow",o)},_createIcon:function(o,d){var P=this._getIconUrl(o);if(!P){if(o==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var U=this._createImg(P,d&&d.tagName==="IMG"?d:null);return this._setIconStyles(U,o),U},_setIconStyles:function(o,d){var P=this.options,U=P[d+"Size"];typeof U=="number"&&(U=[U,U]);var Y=ce(U),me=ce(d==="shadow"&&P.shadowAnchor||P.iconAnchor||Y&&Y.divideBy(2,!0));o.className="leaflet-marker-"+d+" "+(P.className||""),me&&(o.style.marginLeft=-me.x+"px",o.style.marginTop=-me.y+"px"),Y&&(o.style.width=Y.x+"px",o.style.height=Y.y+"px")},_createImg:function(o,d){return d=d||document.createElement("img"),d.src=o,d},_getIconUrl:function(o){return No&&this.options[o+"RetinaUrl"]||this.options[o+"Url"]}}),Jt=Qt.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(o){return Jt.imagePath||(Jt.imagePath=this._detectIconPath()),(this.options.imagePath||Jt.imagePath)+Qt.prototype._getIconUrl.call(this,o)},_detectIconPath:function(){var o=He("div","leaflet-default-icon-path",document.body),d=Re(o,"background-image")||Re(o,"backgroundImage");return document.body.removeChild(o),d=d===null||d.indexOf("url")!==0?"":d.replace(/^url\(["']?/,"").replace(/marker-icon\.png["']?\)$/,"")}}),pi=pe.extend({initialize:function(o){this._marker=o},addHooks:function(){var o=this._marker._icon;this._draggable||(this._draggable=new st(o,o,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),qt(o,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&fi(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(o){var d=this._marker,P=d._map,U=this._marker.options.autoPanSpeed,Y=this._marker.options.autoPanPadding,me=zr(d._icon),Ke=P.getPixelBounds(),Tt=P.getPixelOrigin(),wt=Be(Ke.min._subtract(Tt).add(Y),Ke.max._subtract(Tt).subtract(Y));if(!wt.contains(me)){var pt=ce((Math.max(wt.max.x,me.x)-wt.max.x)/(Ke.max.x-wt.max.x)-(Math.min(wt.min.x,me.x)-wt.min.x)/(Ke.min.x-wt.min.x),(Math.max(wt.max.y,me.y)-wt.max.y)/(Ke.max.y-wt.max.y)-(Math.min(wt.min.y,me.y)-wt.min.y)/(Ke.min.y-wt.min.y)).multiplyBy(U);P.panBy(pt,{animate:!1}),this._draggable._newPos._add(pt),this._draggable._startPos._add(pt),ir(d._icon,this._draggable._newPos),this._onDrag(o),this._panRequest=q(this._adjustPan.bind(this,o))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup().fire("movestart").fire("dragstart")},_onPreDrag:function(o){this._marker.options.autoPan&&(re(this._panRequest),this._panRequest=q(this._adjustPan.bind(this,o)))},_onDrag:function(o){var d=this._marker,P=d._shadow,U=zr(d._icon),Y=d._map.layerPointToLatLng(U);P&&ir(P,U),d._latlng=Y,o.latlng=Y,o.oldLatLng=this._oldLatLng,d.fire("move",o).fire("drag",o)},_onDragEnd:function(o){re(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",o)}}),vi=kt.extend({options:{icon:new Jt,interactive:!0,keyboard:!0,title:"",alt:"",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",bubblingMouseEvents:!1,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(o,d){x(this,d),this._latlng=Et(o)},onAdd:function(o){this._zoomAnimated=this._zoomAnimated&&o.options.markerZoomAnimation,this._zoomAnimated&&o.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(o){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&o.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(o){var d=this._latlng;return this._latlng=Et(o),this.update(),this.fire("move",{oldLatLng:d,latlng:this._latlng})},setZIndexOffset:function(o){return this.options.zIndexOffset=o,this.update()},setIcon:function(o){return this.options.icon=o,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var o=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(o)}return this},_initIcon:function(){var o=this.options,d="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),P=o.icon.createIcon(this._icon),U=!1;P!==this._icon&&(this._icon&&this._removeIcon(),U=!0,o.title&&(P.title=o.title),P.tagName==="IMG"&&(P.alt=o.alt||"")),qt(P,d),o.keyboard&&(P.tabIndex="0"),this._icon=P,o.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex});var Y=o.icon.createShadow(this._shadow),me=!1;Y!==this._shadow&&(this._removeShadow(),me=!0),Y&&(qt(Y,d),Y.alt=""),this._shadow=Y,o.opacity<1&&this._updateOpacity(),U&&this.getPane().appendChild(this._icon),this._initInteraction(),Y&&me&&this.getPane("shadowPane").appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),mt(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&mt(this._shadow),this._shadow=null},_setPos:function(o){ir(this._icon,o),this._shadow&&ir(this._shadow,o),this._zIndex=500+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(o){this._icon.style.zIndex=this._zIndex+o},_animateZoom:function(o){var d=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center).round();this._setPos(d)},_initInteraction:function(){if(this.options.interactive&&(qt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),pi)){var o=this.options.draggable;this.dragging&&(o=this.dragging.enabled(),this.dragging.disable()),this.dragging=new pi(this),o&&this.dragging.enable()}},setOpacity:function(o){return this.options.opacity=o,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var o=this.options.opacity;Yt(this._icon,o),this._shadow&&Yt(this._shadow,o)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}}),gi=kt.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(o){this._renderer=o.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(o){return x(this,o),this._renderer&&this._renderer._updateStyle(this),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(L.Browser.isTouching?10:0)}}),jt=gi.extend({options:{fill:!0,radius:10},initialize:function(o,d){x(this,d),this._latlng=Et(o),this._radius=this.options.radius},setLatLng:function(o){return this._latlng=Et(o),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(o){return this.options.radius=this._radius=o,this.redraw()},getRadius:function(){return this._radius},setStyle:function(o){var d=o&&o.radius||this._radius;return gi.prototype.setStyle.call(this,o),this.setRadius(d),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var o=this._radius,d=this._radiusY||o,P=this._clickTolerance(),U=[o+P,d+P];this._pxBounds=new Me(this._point.subtract(U),this._point.add(U))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(o){return o.distanceTo(this._point)<=this._radius+this._clickTolerance()}}),$t=jt.extend({initialize:function(o,d,P){if(typeof d=="number"&&(d=Q({},P,{radius:d})),x(this,d),this._latlng=Et(o),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(o){return this._mRadius=o,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var o=[this._radius,this._radiusY||this._radius];return new ot(this._map.layerPointToLatLng(this._point.subtract(o)),this._map.layerPointToLatLng(this._point.add(o)))},setStyle:gi.prototype.setStyle,_project:function(){var o=this._latlng.lng,d=this._latlng.lat,P=this._map,U=P.options.crs;if(U.distance===cn.distance){var Y=Math.PI/180,me=this._mRadius/cn.R/Y,Ke=P.project([d+me,o]),Tt=P.project([d-me,o]),wt=Ke.add(Tt).divideBy(2),pt=P.unproject(wt).lat,_i=Math.acos((Math.cos(me*Y)-Math.sin(d*Y)*Math.sin(pt*Y))/(Math.cos(d*Y)*Math.cos(pt*Y)))/Y;(isNaN(_i)||_i===0)&&(_i=me/Math.cos(Math.PI/180*d)),this._point=wt.subtract(P.getPixelOrigin()),this._radius=isNaN(_i)?0:wt.x-P.project([pt,o-_i]).x,this._radiusY=wt.y-Ke.y}else{var Hi=U.unproject(U.project(this._latlng).subtract([this._mRadius,0]));this._point=P.latLngToLayerPoint(this._latlng),this._radius=this._point.x-P.latLngToLayerPoint(Hi).x}this._updateBounds()}}),Oi=gi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(o,d){x(this,d),this._setLatLngs(o)},getLatLngs:function(){return this._latlngs},setLatLngs:function(o){return this._setLatLngs(o),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(o){for(var d,P,U=1/0,Y=null,me=Dt,Ke=0,Tt=this._parts.length;Ke<Tt;Ke++)for(var wt=this._parts[Ke],pt=1,_i=wt.length;pt<_i;pt++){var Hi=me(o,d=wt[pt-1],P=wt[pt],!0);Hi<U&&(U=Hi,Y=me(o,d,P))}return Y&&(Y.distance=Math.sqrt(U)),Y},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var o,d,P,U,Y,me,Ke,Tt=this._rings[0],wt=Tt.length;if(!wt)return null;for(o=0,d=0;o<wt-1;o++)d+=Tt[o].distanceTo(Tt[o+1])/2;if(d===0)return this._map.layerPointToLatLng(Tt[0]);for(o=0,U=0;o<wt-1;o++)if(Y=Tt[o],me=Tt[o+1],P=Y.distanceTo(me),(U+=P)>d)return Ke=(U-d)/P,this._map.layerPointToLatLng([me.x-Ke*(me.x-Y.x),me.y-Ke*(me.y-Y.y)])},getBounds:function(){return this._bounds},addLatLng:function(o,d){return d=d||this._defaultShape(),o=Et(o),d.push(o),this._bounds.extend(o),this.redraw()},_setLatLngs:function(o){this._bounds=new ot,this._latlngs=this._convertLatLngs(o)},_defaultShape:function(){return ai(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(o){for(var d=[],P=ai(o),U=0,Y=o.length;U<Y;U++)P?(d[U]=Et(o[U]),this._bounds.extend(d[U])):d[U]=this._convertLatLngs(o[U]);return d},_project:function(){var o=new Me;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,o);var d=this._clickTolerance(),P=new X(d,d);this._bounds.isValid()&&o.isValid()&&(o.min._subtract(P),o.max._add(P),this._pxBounds=o)},_projectLatlngs:function(o,d,P){var U,Y,me=o[0]instanceof ht,Ke=o.length;if(me){for(Y=[],U=0;U<Ke;U++)Y[U]=this._map.latLngToLayerPoint(o[U]),P.extend(Y[U]);d.push(Y)}else for(U=0;U<Ke;U++)this._projectLatlngs(o[U],d,P)},_clipPoints:function(){var o=this._renderer._bounds;if(this._parts=[],this._pxBounds&&this._pxBounds.intersects(o))if(this.options.noClip)this._parts=this._rings;else{var d,P,U,Y,me,Ke,Tt,wt=this._parts;for(d=0,U=0,Y=this._rings.length;d<Y;d++)for(P=0,me=(Tt=this._rings[d]).length;P<me-1;P++)(Ke=rt(Tt[P],Tt[P+1],o,P,!0))&&(wt[U]=wt[U]||[],wt[U].push(Ke[0]),Ke[1]===Tt[P+1]&&P!==me-2||(wt[U].push(Ke[1]),U++))}},_simplifyPoints:function(){for(var o=this._parts,d=this.options.smoothFactor,P=0,U=o.length;P<U;P++)o[P]=Oe(o[P],d)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(o,d){var P,U,Y,me,Ke,Tt,wt=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(P=0,me=this._parts.length;P<me;P++)for(U=0,Y=(Ke=(Tt=this._parts[P]).length)-1;U<Ke;Y=U++)if((d||U!==0)&&je(o,Tt[Y],Tt[U])<=wt)return!0;return!1}});Oi._flat=dt;var Ui=Oi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");var o,d,P,U,Y,me,Ke,Tt,wt,pt=this._rings[0],_i=pt.length;if(!_i)return null;for(me=Ke=Tt=0,o=0,d=_i-1;o<_i;d=o++)P=pt[o],U=pt[d],Y=P.y*U.x-U.y*P.x,Ke+=(P.x+U.x)*Y,Tt+=(P.y+U.y)*Y,me+=3*Y;return wt=me===0?pt[0]:[Ke/me,Tt/me],this._map.layerPointToLatLng(wt)},_convertLatLngs:function(o){var d=Oi.prototype._convertLatLngs.call(this,o),P=d.length;return P>=2&&d[0]instanceof ht&&d[0].equals(d[P-1])&&d.pop(),d},_setLatLngs:function(o){Oi.prototype._setLatLngs.call(this,o),ai(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return ai(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var o=this._renderer._bounds,d=this.options.weight,P=new X(d,d);if(o=new Me(o.min.subtract(P),o.max.add(P)),this._parts=[],this._pxBounds&&this._pxBounds.intersects(o))if(this.options.noClip)this._parts=this._rings;else for(var U,Y=0,me=this._rings.length;Y<me;Y++)(U=Zt(this._rings[Y],o,!0)).length&&this._parts.push(U)},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(o){var d,P,U,Y,me,Ke,Tt,wt,pt=!1;if(!this._pxBounds||!this._pxBounds.contains(o))return!1;for(Y=0,Tt=this._parts.length;Y<Tt;Y++)for(me=0,Ke=(wt=(d=this._parts[Y]).length)-1;me<wt;Ke=me++)P=d[me],U=d[Ke],P.y>o.y!=U.y>o.y&&o.x<(U.x-P.x)*(o.y-P.y)/(U.y-P.y)+P.x&&(pt=!pt);return pt||Oi.prototype._containsPoint.call(this,o,!0)}}),xi=Rt.extend({initialize:function(o,d){x(this,d),this._layers={},o&&this.addData(o)},addData:function(o){var d,P,U,Y=Dn(o)?o:o.features;if(Y){for(d=0,P=Y.length;d<P;d++)((U=Y[d]).geometries||U.geometry||U.features||U.coordinates)&&this.addData(U);return this}var me=this.options;if(me.filter&&!me.filter(o))return this;var Ke=ii(o,me);return Ke?(Ke.feature=dr(o),Ke.defaultOptions=Ke.options,this.resetStyle(Ke),me.onEachFeature&&me.onEachFeature(o,Ke),this.addLayer(Ke)):this},resetStyle:function(o){return o.options=Q({},o.defaultOptions),this._setLayerStyle(o,this.options.style),this},setStyle:function(o){return this.eachLayer(function(d){this._setLayerStyle(d,o)},this)},_setLayerStyle:function(o,d){typeof d=="function"&&(d=d(o.feature)),o.setStyle&&o.setStyle(d)}}),li={toGeoJSON:function(o){return $i(this,{type:"Point",coordinates:si(this.getLatLng(),o)})}};vi.include(li),$t.include(li),jt.include(li),Oi.include({toGeoJSON:function(o){var d=!ai(this._latlngs),P=Gi(this._latlngs,d?1:0,!1,o);return $i(this,{type:(d?"Multi":"")+"LineString",coordinates:P})}}),Ui.include({toGeoJSON:function(o){var d=!ai(this._latlngs),P=d&&!ai(this._latlngs[0]),U=Gi(this._latlngs,P?2:d?1:0,!0,o);return d||(U=[U]),$i(this,{type:(P?"Multi":"")+"Polygon",coordinates:U})}}),Nt.include({toMultiPoint:function(o){var d=[];return this.eachLayer(function(P){d.push(P.toGeoJSON(o).geometry.coordinates)}),$i(this,{type:"MultiPoint",coordinates:d})},toGeoJSON:function(o){var d=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(d==="MultiPoint")return this.toMultiPoint(o);var P=d==="GeometryCollection",U=[];return this.eachLayer(function(Y){if(Y.toGeoJSON){var me=Y.toGeoJSON(o);if(P)U.push(me.geometry);else{var Ke=dr(me);Ke.type==="FeatureCollection"?U.push.apply(U,Ke.features):U.push(Ke)}}}),P?$i(this,{geometries:U,type:"GeometryCollection"}):{type:"FeatureCollection",features:U}}});var Fi=Vi,Wi=kt.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(o,d,P){this._url=o,this._bounds=Ue(d),x(this,P)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(qt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){mt(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(o){return this.options.opacity=o,this._image&&this._updateOpacity(),this},setStyle:function(o){return o.opacity&&this.setOpacity(o.opacity),this},bringToFront:function(){return this._map&&Gt(this._image),this},bringToBack:function(){return this._map&&Bt(this._image),this},setUrl:function(o){return this._url=o,this._image&&(this._image.src=o,this._isLoading=!0,this.fire("loading")),this},setBounds:function(o){return this._bounds=Ue(o),this._map&&this._reset(),this},getEvents:function(){var o={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var o=this._url.tagName==="IMG",d=this._image=o?this._url:He("img");qt(d,"leaflet-image-layer"),this._zoomAnimated&&qt(d,"leaflet-zoom-animated"),this.options.className&&qt(d,this.options.className),d.onselectstart=A,d.onmousemove=A,d.onload=W(this.fire,this,"load"),d.onerror=W(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),o?this._url=d.src:(d.src=this._url,this._isLoading=!0,this.fire("loading"),d.alt=this.options.alt)},_animateZoom:function(o){var d=this._map.getZoomScale(o.zoom),P=this._map._latLngBoundsToNewLayerBounds(this._bounds,o.zoom,o.center).min;hr(this._image,P,d)},_reset:function(){var o=this._image,d=new Me(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),P=d.getSize();ir(o,d.min),o.style.width=P.x+"px",o.style.height=P.y+"px"},_updateOpacity:function(){Yt(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var o=this.options.errorOverlayUrl;o&&this._url!==o&&(this._url=o,this._image.src=o)}}),tr=Wi.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0},_initImage:function(){var o=this._url.tagName==="VIDEO",d=this._image=o?this._url:He("video");if(qt(d,"leaflet-image-layer"),this._zoomAnimated&&qt(d,"leaflet-zoom-animated"),d.onselectstart=A,d.onmousemove=A,d.onloadeddata=W(this.fire,this,"load"),o){for(var P=d.getElementsByTagName("source"),U=[],Y=0;Y<P.length;Y++)U.push(P[Y].src);this._url=P.length>0?U:[d.src]}else{Dn(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&d.style.hasOwnProperty("objectFit")&&(d.style.objectFit="fill"),d.autoplay=!!this.options.autoplay,d.loop=!!this.options.loop;for(var me=0;me<this._url.length;me++){var Ke=He("source");Ke.src=this._url[me],d.appendChild(Ke)}}}}),Zi=kt.extend({options:{offset:[0,7],className:"",pane:"popupPane"},initialize:function(o,d){x(this,o),this._source=d},onAdd:function(o){this._zoomAnimated=o._zoomAnimated,this._container||this._initLayout(),o._fadeAnimated&&Yt(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),o._fadeAnimated&&Yt(this._container,1),this.bringToFront()},onRemove:function(o){o._fadeAnimated?(Yt(this._container,0),this._removeTimeout=setTimeout(W(mt,void 0,this._container),200)):mt(this._container)},getLatLng:function(){return this._latlng},setLatLng:function(o){return this._latlng=Et(o),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(o){return this._content=o,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var o={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Gt(this._container),this},bringToBack:function(){return this._map&&Bt(this._container),this},_updateContent:function(){if(this._content){var o=this._contentNode,d=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof d=="string")o.innerHTML=d;else{for(;o.hasChildNodes();)o.removeChild(o.firstChild);o.appendChild(d)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var o=this._map.latLngToLayerPoint(this._latlng),d=ce(this.options.offset),P=this._getAnchor();this._zoomAnimated?ir(this._container,o.add(P)):d=d.add(o).add(P);var U=this._containerBottom=-d.y,Y=this._containerLeft=-Math.round(this._containerWidth/2)+d.x;this._container.style.bottom=U+"px",this._container.style.left=Y+"px"}},_getAnchor:function(){return[0,0]}}),Yi=Zi.extend({options:{maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(o){return o.openPopup(this),this},onAdd:function(o){Zi.prototype.onAdd.call(this,o),o.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof gi||this._source.on("preclick",Cr))},onRemove:function(o){Zi.prototype.onRemove.call(this,o),o.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof gi||this._source.off("preclick",Cr))},getEvents:function(){var o=Zi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(o.preclick=this._close),this.options.keepInView&&(o.moveend=this._adjustPan),o},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var o="leaflet-popup",d=this._container=He("div",o+" "+(this.options.className||"")+" leaflet-zoom-animated"),P=this._wrapper=He("div",o+"-content-wrapper",d);if(this._contentNode=He("div",o+"-content",P),Gn(P),Po(this._contentNode),Ni(P,"contextmenu",Cr),this._tipContainer=He("div",o+"-tip-container",d),this._tip=He("div",o+"-tip",this._tipContainer),this.options.closeButton){var U=this._closeButton=He("a",o+"-close-button",d);U.href="#close",U.innerHTML="&#215;",Ni(U,"click",this._onCloseButtonClick,this)}},_updateLayout:function(){var o=this._contentNode,d=o.style;d.width="",d.whiteSpace="nowrap";var P=o.offsetWidth;P=Math.min(P,this.options.maxWidth),P=Math.max(P,this.options.minWidth),d.width=P+1+"px",d.whiteSpace="",d.height="";var U=o.offsetHeight,Y=this.options.maxHeight;Y&&U>Y?(d.height=Y+"px",qt(o,"leaflet-popup-scrolled")):fi(o,"leaflet-popup-scrolled"),this._containerWidth=this._container.offsetWidth},_animateZoom:function(o){var d=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center),P=this._getAnchor();ir(this._container,d.add(P))},_adjustPan:function(){if(this.options.autoPan){this._map._panAnim&&this._map._panAnim.stop();var o=this._map,d=parseInt(Re(this._container,"marginBottom"),10)||0,P=this._container.offsetHeight+d,U=this._containerWidth,Y=new X(this._containerLeft,-P-this._containerBottom);Y._add(zr(this._container));var me=o.layerPointToContainerPoint(Y),Ke=ce(this.options.autoPanPadding),Tt=ce(this.options.autoPanPaddingTopLeft||Ke),wt=ce(this.options.autoPanPaddingBottomRight||Ke),pt=o.getSize(),_i=0,Hi=0;me.x+U+wt.x>pt.x&&(_i=me.x+U-pt.x+wt.x),me.x-_i-Tt.x<0&&(_i=me.x-Tt.x),me.y+P+wt.y>pt.y&&(Hi=me.y+P-pt.y+wt.y),me.y-Hi-Tt.y<0&&(Hi=me.y-Tt.y),(_i||Hi)&&o.fire("autopanstart").panBy([_i,Hi])}},_onCloseButtonClick:function(o){this._close(),ln(o)},_getAnchor:function(){return ce(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}});D.mergeOptions({closePopupOnClick:!0}),D.include({openPopup:function(o,d,P){return o instanceof Yi||(o=new Yi(P).setContent(o)),d&&o.setLatLng(d),this.hasLayer(o)?this:(this._popup&&this._popup.options.autoClose&&this.closePopup(),this._popup=o,this.addLayer(o))},closePopup:function(o){return o&&o!==this._popup||(o=this._popup,this._popup=null),o&&this.removeLayer(o),this}}),kt.include({bindPopup:function(o,d){return o instanceof Yi?(x(o,d),this._popup=o,o._source=this):(this._popup&&!d||(this._popup=new Yi(d,this)),this._popup.setContent(o)),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(o,d){if(o instanceof kt||(d=o,o=this),o instanceof Rt)for(var P in this._layers){o=this._layers[P];break}return d||(d=o.getCenter?o.getCenter():o.getLatLng()),this._popup&&this._map&&(this._popup._source=o,this._popup.update(),this._map.openPopup(this._popup,d)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(o){return this._popup&&(this._popup._map?this.closePopup():this.openPopup(o)),this},isPopupOpen:function(){return!!this._popup&&this._popup.isOpen()},setPopupContent:function(o){return this._popup&&this._popup.setContent(o),this},getPopup:function(){return this._popup},_openPopup:function(o){var d=o.layer||o.target;this._popup&&this._map&&(ln(o),d instanceof gi?this.openPopup(o.layer||o.target,o.latlng):this._map.hasLayer(this._popup)&&this._popup._source===d?this.closePopup():this.openPopup(d,o.latlng))},_movePopup:function(o){this._popup.setLatLng(o.latlng)},_onKeyPress:function(o){o.originalEvent.keyCode===13&&this._openPopup(o)}});var ar=Zi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,interactive:!1,opacity:.9},onAdd:function(o){Zi.prototype.onAdd.call(this,o),this.setOpacity(this.options.opacity),o.fire("tooltipopen",{tooltip:this}),this._source&&this._source.fire("tooltipopen",{tooltip:this},!0)},onRemove:function(o){Zi.prototype.onRemove.call(this,o),o.fire("tooltipclose",{tooltip:this}),this._source&&this._source.fire("tooltipclose",{tooltip:this},!0)},getEvents:function(){var o=Zi.prototype.getEvents.call(this);return Mr&&!this.options.permanent&&(o.preclick=this._close),o},_close:function(){this._map&&this._map.closeTooltip(this)},_initLayout:function(){var o="leaflet-tooltip "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=He("div",o)},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(o){var d=this._map,P=this._container,U=d.latLngToContainerPoint(d.getCenter()),Y=d.layerPointToContainerPoint(o),me=this.options.direction,Ke=P.offsetWidth,Tt=P.offsetHeight,wt=ce(this.options.offset),pt=this._getAnchor();me==="top"?o=o.add(ce(-Ke/2+wt.x,-Tt+wt.y+pt.y,!0)):me==="bottom"?o=o.subtract(ce(Ke/2-wt.x,-wt.y,!0)):me==="center"?o=o.subtract(ce(Ke/2+wt.x,Tt/2-pt.y+wt.y,!0)):me==="right"||me==="auto"&&Y.x<U.x?(me="right",o=o.add(ce(wt.x+pt.x,pt.y-Tt/2+wt.y,!0))):(me="left",o=o.subtract(ce(Ke+pt.x-wt.x,Tt/2-pt.y-wt.y,!0))),fi(P,"leaflet-tooltip-right"),fi(P,"leaflet-tooltip-left"),fi(P,"leaflet-tooltip-top"),fi(P,"leaflet-tooltip-bottom"),qt(P,"leaflet-tooltip-"+me),ir(P,o)},_updatePosition:function(){var o=this._map.latLngToLayerPoint(this._latlng);this._setPosition(o)},setOpacity:function(o){this.options.opacity=o,this._container&&Yt(this._container,o)},_animateZoom:function(o){var d=this._map._latLngToNewLayerPoint(this._latlng,o.zoom,o.center);this._setPosition(d)},_getAnchor:function(){return ce(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}});D.include({openTooltip:function(o,d,P){return o instanceof ar||(o=new ar(P).setContent(o)),d&&o.setLatLng(d),this.hasLayer(o)?this:this.addLayer(o)},closeTooltip:function(o){return o&&this.removeLayer(o),this}}),kt.include({bindTooltip:function(o,d){return o instanceof ar?(x(o,d),this._tooltip=o,o._source=this):(this._tooltip&&!d||(this._tooltip=new ar(d,this)),this._tooltip.setContent(o)),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(o){if(o||!this._tooltipHandlersAdded){var d=o?"off":"on",P={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?P.add=this._openTooltip:(P.mouseover=this._openTooltip,P.mouseout=this.closeTooltip,this._tooltip.options.sticky&&(P.mousemove=this._moveTooltip),Mr&&(P.click=this._openTooltip)),this[d](P),this._tooltipHandlersAdded=!o}},openTooltip:function(o,d){if(o instanceof kt||(d=o,o=this),o instanceof Rt)for(var P in this._layers){o=this._layers[P];break}return d||(d=o.getCenter?o.getCenter():o.getLatLng()),this._tooltip&&this._map&&(this._tooltip._source=o,this._tooltip.update(),this._map.openTooltip(this._tooltip,d),this._tooltip.options.interactive&&this._tooltip._container&&(qt(this._tooltip._container,"leaflet-clickable"),this.addInteractiveTarget(this._tooltip._container))),this},closeTooltip:function(){return this._tooltip&&(this._tooltip._close(),this._tooltip.options.interactive&&this._tooltip._container&&(fi(this._tooltip._container,"leaflet-clickable"),this.removeInteractiveTarget(this._tooltip._container))),this},toggleTooltip:function(o){return this._tooltip&&(this._tooltip._map?this.closeTooltip():this.openTooltip(o)),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(o){return this._tooltip&&this._tooltip.setContent(o),this},getTooltip:function(){return this._tooltip},_openTooltip:function(o){var d=o.layer||o.target;this._tooltip&&this._map&&this.openTooltip(d,this._tooltip.options.sticky?o.latlng:void 0)},_moveTooltip:function(o){var d,P,U=o.latlng;this._tooltip.options.sticky&&o.originalEvent&&(d=this._map.mouseEventToContainerPoint(o.originalEvent),P=this._map.containerPointToLayerPoint(d),U=this._map.layerPointToLatLng(P)),this._tooltip.setLatLng(U)}});var rr=Qt.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(o){var d=o&&o.tagName==="DIV"?o:document.createElement("div"),P=this.options;if(d.innerHTML=P.html!==!1?P.html:"",P.bgPos){var U=ce(P.bgPos);d.style.backgroundPosition=-U.x+"px "+-U.y+"px"}return this._setIconStyles(d,"icon"),d},createShadow:function(){return null}});Qt.Default=Jt;var nr=kt.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Kn,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(o){x(this,o)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView(),this._update()},beforeAdd:function(o){o._addZoomLimit(this)},onRemove:function(o){this._removeAllTiles(),mt(this._container),o._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Gt(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Bt(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(o){return this.options.opacity=o,this._updateOpacity(),this},setZIndex:function(o){return this.options.zIndex=o,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){return this._map&&(this._removeAllTiles(),this._update()),this},getEvents:function(){var o={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=K(this._onMoveEnd,this.options.updateInterval,this)),o.move=this._onMove),this._zoomAnimated&&(o.zoomanim=this._animateZoom),o},createTile:function(){return document.createElement("div")},getTileSize:function(){var o=this.options.tileSize;return o instanceof X?o:new X(o,o)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(o){for(var d,P=this.getPane().children,U=-o(-1/0,1/0),Y=0,me=P.length;Y<me;Y++)d=P[Y].style.zIndex,P[Y]!==this._container&&d&&(U=o(U,+d));isFinite(U)&&(this.options.zIndex=U+o(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!zn){Yt(this._container,this.options.opacity);var o=+new Date,d=!1,P=!1;for(var U in this._tiles){var Y=this._tiles[U];Y.current&&Y.loaded&&(Math.min(1,(o-Y.loaded)/200),Yt(Y.el,1),Y.active?P=!0:this._onOpaqueTile(Y),Y.active=!0)}P&&!this._noPrune&&this._pruneTiles(),d&&(re(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this))}},_onOpaqueTile:A,_initContainer:function(){this._container||(this._container=He("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var o=this._tileZoom,d=this.options.maxZoom;if(o!==void 0){for(var P in this._levels)this._levels[P].el.children.length||P===o?(this._levels[P].el.style.zIndex=d-Math.abs(o-P),this._onUpdateLevel(P)):(mt(this._levels[P].el),this._removeTilesAtZoom(P),this._onRemoveLevel(P),delete this._levels[P]);var U=this._levels[o],Y=this._map;return U||((U=this._levels[o]={}).el=He("div","leaflet-tile-container leaflet-zoom-animated",this._container),U.el.style.zIndex=d,U.origin=Y.project(Y.unproject(Y.getPixelOrigin()),o).round(),U.zoom=o,this._setZoomTransform(U,Y.getCenter(),Y.getZoom()),U.el.offsetWidth,this._onCreateLevel(U)),this._level=U,U}},_onUpdateLevel:A,_onRemoveLevel:A,_onCreateLevel:A,_pruneTiles:function(){if(this._map){var o,d,P=this._map.getZoom();if(P>this.options.maxZoom||P<this.options.minZoom)this._removeAllTiles();else{for(o in this._tiles)(d=this._tiles[o]).retain=d.current;for(o in this._tiles)if((d=this._tiles[o]).current&&!d.active){var U=d.coords;this._retainParent(U.x,U.y,U.z,U.z-5)||this._retainChildren(U.x,U.y,U.z,U.z+2)}for(o in this._tiles)this._tiles[o].retain||this._removeTile(o)}}},_removeTilesAtZoom:function(o){for(var d in this._tiles)this._tiles[d].coords.z===o&&this._removeTile(d)},_removeAllTiles:function(){for(var o in this._tiles)this._removeTile(o)},_invalidateAll:function(){for(var o in this._levels)mt(this._levels[o].el),this._onRemoveLevel(o),delete this._levels[o];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(o,d,P,U){var Y=Math.floor(o/2),me=Math.floor(d/2),Ke=P-1,Tt=new X(+Y,+me);Tt.z=+Ke;var wt=this._tileCoordsToKey(Tt),pt=this._tiles[wt];return pt&&pt.active?(pt.retain=!0,!0):(pt&&pt.loaded&&(pt.retain=!0),Ke>U&&this._retainParent(Y,me,Ke,U))},_retainChildren:function(o,d,P,U){for(var Y=2*o;Y<2*o+2;Y++)for(var me=2*d;me<2*d+2;me++){var Ke=new X(Y,me);Ke.z=P+1;var Tt=this._tileCoordsToKey(Ke),wt=this._tiles[Tt];wt&&wt.active?wt.retain=!0:(wt&&wt.loaded&&(wt.retain=!0),P+1<U&&this._retainChildren(Y,me,P+1,U))}},_resetView:function(o){var d=o&&(o.pinch||o.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),d,d)},_animateZoom:function(o){this._setView(o.center,o.zoom,!0,o.noUpdate)},_clampZoom:function(o){var d=this.options;return d.minNativeZoom!==void 0&&o<d.minNativeZoom?d.minNativeZoom:d.maxNativeZoom!==void 0&&d.maxNativeZoom<o?d.maxNativeZoom:o},_setView:function(o,d,P,U){var Y=this._clampZoom(Math.round(d));(this.options.maxZoom!==void 0&&Y>this.options.maxZoom||this.options.minZoom!==void 0&&Y<this.options.minZoom)&&(Y=void 0);var me=this.options.updateWhenZooming&&Y!==this._tileZoom;U&&!me||(this._tileZoom=Y,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),Y!==void 0&&this._update(o),P||this._pruneTiles(),this._noPrune=!!P),this._setZoomTransforms(o,d)},_setZoomTransforms:function(o,d){for(var P in this._levels)this._setZoomTransform(this._levels[P],o,d)},_setZoomTransform:function(o,d,P){var U=this._map.getZoomScale(P,o.zoom),Y=o.origin.multiplyBy(U).subtract(this._map._getNewPixelOrigin(d,P)).round();pn?hr(o.el,Y,U):ir(o.el,Y)},_resetGrid:function(){var o=this._map,d=o.options.crs,P=this._tileSize=this.getTileSize(),U=this._tileZoom,Y=this._map.getPixelWorldBounds(this._tileZoom);Y&&(this._globalTileRange=this._pxBoundsToTileRange(Y)),this._wrapX=d.wrapLng&&!this.options.noWrap&&[Math.floor(o.project([0,d.wrapLng[0]],U).x/P.x),Math.ceil(o.project([0,d.wrapLng[1]],U).x/P.y)],this._wrapY=d.wrapLat&&!this.options.noWrap&&[Math.floor(o.project([d.wrapLat[0],0],U).y/P.x),Math.ceil(o.project([d.wrapLat[1],0],U).y/P.y)]},_onMoveEnd:function(){this._map&&!this._map._animatingZoom&&this._update()},_getTiledPixelBounds:function(o){var d=this._map,P=d._animatingZoom?Math.max(d._animateToZoom,d.getZoom()):d.getZoom(),U=d.getZoomScale(P,this._tileZoom),Y=d.project(o,this._tileZoom).floor(),me=d.getSize().divideBy(2*U);return new Me(Y.subtract(me),Y.add(me))},_update:function(o){var d=this._map;if(d){var P=this._clampZoom(d.getZoom());if(o===void 0&&(o=d.getCenter()),this._tileZoom!==void 0){var U=this._getTiledPixelBounds(o),Y=this._pxBoundsToTileRange(U),me=Y.getCenter(),Ke=[],Tt=this.options.keepBuffer,wt=new Me(Y.getBottomLeft().subtract([Tt,-Tt]),Y.getTopRight().add([Tt,-Tt]));if(!(isFinite(Y.min.x)&&isFinite(Y.min.y)&&isFinite(Y.max.x)&&isFinite(Y.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var pt in this._tiles){var _i=this._tiles[pt].coords;_i.z===this._tileZoom&&wt.contains(new X(_i.x,_i.y))||(this._tiles[pt].current=!1)}if(Math.abs(P-this._tileZoom)>1)this._setView(o,P);else{for(var Hi=Y.min.y;Hi<=Y.max.y;Hi++)for(var Er=Y.min.x;Er<=Y.max.x;Er++){var Mn=new X(Er,Hi);if(Mn.z=this._tileZoom,this._isValidTile(Mn)){var vn=this._tiles[this._tileCoordsToKey(Mn)];vn?vn.current=!0:Ke.push(Mn)}}if(Ke.sort(function(ti,va){return ti.distanceTo(me)-va.distanceTo(me)}),Ke.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Ao=document.createDocumentFragment();for(Er=0;Er<Ke.length;Er++)this._addTile(Ke[Er],Ao);this._level.el.appendChild(Ao)}}}}},_isValidTile:function(o){var d=this._map.options.crs;if(!d.infinite){var P=this._globalTileRange;if(!d.wrapLng&&(o.x<P.min.x||o.x>P.max.x)||!d.wrapLat&&(o.y<P.min.y||o.y>P.max.y))return!1}if(!this.options.bounds)return!0;var U=this._tileCoordsToBounds(o);return Ue(this.options.bounds).overlaps(U)},_keyToBounds:function(o){return this._tileCoordsToBounds(this._keyToTileCoords(o))},_tileCoordsToNwSe:function(o){var d=this._map,P=this.getTileSize(),U=o.scaleBy(P),Y=U.add(P);return[d.unproject(U,o.z),d.unproject(Y,o.z)]},_tileCoordsToBounds:function(o){var d=this._tileCoordsToNwSe(o),P=new ot(d[0],d[1]);return this.options.noWrap||(P=this._map.wrapLatLngBounds(P)),P},_tileCoordsToKey:function(o){return o.x+":"+o.y+":"+o.z},_keyToTileCoords:function(o){var d=o.split(":"),P=new X(+d[0],+d[1]);return P.z=+d[2],P},_removeTile:function(o){var d=this._tiles[o];d&&(mt(d.el),delete this._tiles[o],this.fire("tileunload",{tile:d.el,coords:this._keyToTileCoords(o)}))},_initTile:function(o){qt(o,"leaflet-tile");var d=this.getTileSize();o.style.width=d.x+"px",o.style.height=d.y+"px",o.onselectstart=A,o.onmousemove=A,zn&&this.options.opacity<1&&Yt(o,this.options.opacity),ca&&!ao&&(o.style.WebkitBackfaceVisibility="hidden")},_addTile:function(o,d){var P=this._getTilePos(o),U=this._tileCoordsToKey(o),Y=this.createTile(this._wrapCoords(o),W(this._tileReady,this,o));this._initTile(Y),this.createTile.length<2&&q(W(this._tileReady,this,o,null,Y)),ir(Y,P),this._tiles[U]={el:Y,coords:o,current:!0},d.appendChild(Y),this.fire("tileloadstart",{tile:Y,coords:o})},_tileReady:function(o,d,P){d&&this.fire("tileerror",{error:d,tile:P,coords:o});var U=this._tileCoordsToKey(o);(P=this._tiles[U])&&(P.loaded=+new Date,this._map._fadeAnimated?(Yt(P.el,0),re(this._fadeFrame),this._fadeFrame=q(this._updateOpacity,this)):(P.active=!0,this._pruneTiles()),d||(qt(P.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:P.el,coords:o})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),zn||!this._map._fadeAnimated?q(this._pruneTiles,this):setTimeout(W(this._pruneTiles,this),250)))},_getTilePos:function(o){return o.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(o){var d=new X(this._wrapX?k(o.x,this._wrapX):o.x,this._wrapY?k(o.y,this._wrapY):o.y);return d.z=o.z,d},_pxBoundsToTileRange:function(o){var d=this.getTileSize();return new Me(o.min.unscaleBy(d).floor(),o.max.unscaleBy(d).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var o in this._tiles)if(!this._tiles[o].loaded)return!1;return!0}}),br=nr.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1},initialize:function(o,d){this._url=o,(d=x(this,d)).detectRetina&&No&&d.maxZoom>0&&(d.tileSize=Math.floor(d.tileSize/2),d.zoomReverse?(d.zoomOffset--,d.minZoom++):(d.zoomOffset++,d.maxZoom--),d.minZoom=Math.max(0,d.minZoom)),typeof d.subdomains=="string"&&(d.subdomains=d.subdomains.split("")),ca||this.on("tileunload",this._onTileRemove)},setUrl:function(o,d){return this._url===o&&d===void 0&&(d=!0),this._url=o,d||this.redraw(),this},createTile:function(o,d){var P=document.createElement("img");return Ni(P,"load",W(this._tileOnLoad,this,d,P)),Ni(P,"error",W(this._tileOnError,this,d,P)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(P.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),P.alt="",P.setAttribute("role","presentation"),P.src=this.getTileUrl(o),P},getTileUrl:function(o){var d={r:No?"@2x":"",s:this._getSubdomain(o),x:o.x,y:o.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var P=this._globalTileRange.max.y-o.y;this.options.tms&&(d.y=P),d["-y"]=P}return m(this._url,Q(d,this.options))},_tileOnLoad:function(o,d){zn?setTimeout(W(o,this,null,d),0):o(null,d)},_tileOnError:function(o,d,P){var U=this.options.errorTileUrl;U&&d.getAttribute("src")!==U&&(d.src=U),o(P,d)},_onTileRemove:function(o){o.tile.onload=null},_getZoomForUrl:function(){var o=this._tileZoom,d=this.options.maxZoom,P=this.options.zoomReverse,U=this.options.zoomOffset;return P&&(o=d-o),o+U},_getSubdomain:function(o){var d=Math.abs(o.x+o.y)%this.options.subdomains.length;return this.options.subdomains[d]},_abortLoading:function(){var o,d;for(o in this._tiles)this._tiles[o].coords.z!==this._tileZoom&&((d=this._tiles[o].el).onload=A,d.onerror=A,d.complete||(d.src=Rn,mt(d),delete this._tiles[o]))},_removeTile:function(o){var d=this._tiles[o];if(d)return as||d.el.setAttribute("src",Rn),nr.prototype._removeTile.call(this,o)},_tileReady:function(o,d,P){if(this._map&&(!P||P.getAttribute("src")!==Rn))return nr.prototype._tileReady.call(this,o,d,P)}}),Bn=br.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(o,d){this._url=o;var P=Q({},this.defaultWmsParams);for(var U in d)U in this.options||(P[U]=d[U]);var Y=(d=x(this,d)).detectRetina&&No?2:1,me=this.getTileSize();P.width=me.x*Y,P.height=me.y*Y,this.wmsParams=P},onAdd:function(o){this._crs=this.options.crs||o.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var d=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[d]=this._crs.code,br.prototype.onAdd.call(this,o)},getTileUrl:function(o){var d=this._tileCoordsToNwSe(o),P=this._crs,U=Be(P.project(d[0]),P.project(d[1])),Y=U.min,me=U.max,Ke=(this._wmsVersion>=1.3&&this._crs===Xe?[Y.y,Y.x,me.y,me.x]:[Y.x,Y.y,me.x,me.y]).join(","),Tt=br.prototype.getTileUrl.call(this,o);return Tt+v(this.wmsParams,Tt,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+Ke},setParams:function(o,d){return Q(this.wmsParams,o),d||this.redraw(),this}});br.WMS=Bn,Ki.wms=function(o,d){return new Bn(o,d)};var en=kt.extend({options:{padding:.1,tolerance:0},initialize:function(o){x(this,o),h(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&qt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var o={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(o.zoomanim=this._onAnimZoom),o},_onAnimZoom:function(o){this._updateTransform(o.center,o.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(o,d){var P=this._map.getZoomScale(d,this._zoom),U=zr(this._container),Y=this._map.getSize().multiplyBy(.5+this.options.padding),me=this._map.project(this._center,d),Ke=this._map.project(o,d).subtract(me),Tt=Y.multiplyBy(-P).add(U).add(Y).subtract(Ke);pn?hr(this._container,Tt,P):ir(this._container,Tt)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var o in this._layers)this._layers[o]._reset()},_onZoomEnd:function(){for(var o in this._layers)this._layers[o]._project()},_updatePaths:function(){for(var o in this._layers)this._layers[o]._update()},_update:function(){var o=this.options.padding,d=this._map.getSize(),P=this._map.containerPointToLayerPoint(d.multiplyBy(-o)).round();this._bounds=new Me(P,P.add(d.multiplyBy(1+2*o)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Oa=en.extend({getEvents:function(){var o=en.prototype.getEvents.call(this);return o.viewprereset=this._onViewPreReset,o},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){en.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var o=this._container=document.createElement("canvas");Ni(o,"mousemove",K(this._onMouseMove,32,this),this),Ni(o,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ni(o,"mouseout",this._handleMouseOut,this),this._ctx=o.getContext("2d")},_destroyContainer:function(){re(this._redrawRequest),delete this._ctx,mt(this._container),wr(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){this._redrawBounds=null;for(var o in this._layers)this._layers[o]._update();this._redraw()}},_update:function(){if(!this._map._animatingZoom||!this._bounds){en.prototype._update.call(this);var o=this._bounds,d=this._container,P=o.getSize(),U=No?2:1;ir(d,o.min),d.width=U*P.x,d.height=U*P.y,d.style.width=P.x+"px",d.style.height=P.y+"px",No&&this._ctx.scale(2,2),this._ctx.translate(-o.min.x,-o.min.y),this.fire("update")}},_reset:function(){en.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(o){this._updateDashArray(o),this._layers[h(o)]=o;var d=o._order={layer:o,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=d),this._drawLast=d,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(o){this._requestRedraw(o)},_removePath:function(o){var d=o._order,P=d.next,U=d.prev;P?P.prev=U:this._drawLast=U,U?U.next=P:this._drawFirst=P,delete o._order,delete this._layers[h(o)],this._requestRedraw(o)},_updatePath:function(o){this._extendRedrawBounds(o),o._project(),o._update(),this._requestRedraw(o)},_updateStyle:function(o){this._updateDashArray(o),this._requestRedraw(o)},_updateDashArray:function(o){if(typeof o.options.dashArray=="string"){var d,P,U=o.options.dashArray.split(/[, ]+/),Y=[];for(P=0;P<U.length;P++){if(d=Number(U[P]),isNaN(d))return;Y.push(d)}o.options._dashArray=Y}else o.options._dashArray=o.options.dashArray},_requestRedraw:function(o){this._map&&(this._extendRedrawBounds(o),this._redrawRequest=this._redrawRequest||q(this._redraw,this))},_extendRedrawBounds:function(o){if(o._pxBounds){var d=(o.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Me,this._redrawBounds.extend(o._pxBounds.min.subtract([d,d])),this._redrawBounds.extend(o._pxBounds.max.add([d,d]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var o=this._redrawBounds;if(o){var d=o.getSize();this._ctx.clearRect(o.min.x,o.min.y,d.x,d.y)}else this._ctx.clearRect(0,0,this._container.width,this._container.height)},_draw:function(){var o,d=this._redrawBounds;if(this._ctx.save(),d){var P=d.getSize();this._ctx.beginPath(),this._ctx.rect(d.min.x,d.min.y,P.x,P.y),this._ctx.clip()}this._drawing=!0;for(var U=this._drawFirst;U;U=U.next)o=U.layer,(!d||o._pxBounds&&o._pxBounds.intersects(d))&&o._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(o,d){if(this._drawing){var P,U,Y,me,Ke=o._parts,Tt=Ke.length,wt=this._ctx;if(Tt){for(wt.beginPath(),P=0;P<Tt;P++){for(U=0,Y=Ke[P].length;U<Y;U++)me=Ke[P][U],wt[U?"lineTo":"moveTo"](me.x,me.y);d&&wt.closePath()}this._fillStroke(wt,o)}}},_updateCircle:function(o){if(this._drawing&&!o._empty()){var d=o._point,P=this._ctx,U=Math.max(Math.round(o._radius),1),Y=(Math.max(Math.round(o._radiusY),1)||U)/U;Y!==1&&(P.save(),P.scale(1,Y)),P.beginPath(),P.arc(d.x,d.y/Y,U,0,2*Math.PI,!1),Y!==1&&P.restore(),this._fillStroke(P,o)}},_fillStroke:function(o,d){var P=d.options;P.fill&&(o.globalAlpha=P.fillOpacity,o.fillStyle=P.fillColor||P.color,o.fill(P.fillRule||"evenodd")),P.stroke&&P.weight!==0&&(o.setLineDash&&o.setLineDash(d.options&&d.options._dashArray||[]),o.globalAlpha=P.opacity,o.lineWidth=P.weight,o.strokeStyle=P.color,o.lineCap=P.lineCap,o.lineJoin=P.lineJoin,o.stroke())},_onClick:function(o){for(var d,P,U=this._map.mouseEventToLayerPoint(o),Y=this._drawFirst;Y;Y=Y.next)(d=Y.layer).options.interactive&&d._containsPoint(U)&&!this._map._draggableMoved(d)&&(P=d);P&&($(o),this._fireEvent([P],o))},_onMouseMove:function(o){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var d=this._map.mouseEventToLayerPoint(o);this._handleMouseHover(o,d)}},_handleMouseOut:function(o){var d=this._hoveredLayer;d&&(fi(this._container,"leaflet-interactive"),this._fireEvent([d],o,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(o,d){for(var P,U,Y=this._drawFirst;Y;Y=Y.next)(P=Y.layer).options.interactive&&P._containsPoint(d)&&(U=P);U!==this._hoveredLayer&&(this._handleMouseOut(o),U&&(qt(this._container,"leaflet-interactive"),this._fireEvent([U],o,"mouseover"),this._hoveredLayer=U)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],o)},_fireEvent:function(o,d,P){this._map._fireDOMEvent(d,P||d.type,o)},_bringToFront:function(o){var d=o._order;if(d){var P=d.next,U=d.prev;P&&(P.prev=U,U?U.next=P:P&&(this._drawFirst=P),d.prev=this._drawLast,this._drawLast.next=d,d.next=null,this._drawLast=d,this._requestRedraw(o))}},_bringToBack:function(o){var d=o._order;if(d){var P=d.next,U=d.prev;U&&(U.next=P,P?P.prev=U:U&&(this._drawLast=U),d.prev=null,d.next=this._drawFirst,this._drawFirst.prev=d,this._drawFirst=d,this._requestRedraw(o))}}}),oa=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(o){return document.createElement("<lvml:"+o+' class="lvml">')}}catch(o){return function(d){return document.createElement("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),Js={_initContainer:function(){this._container=He("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(en.prototype._update.call(this),this.fire("update"))},_initPath:function(o){var d=o._container=oa("shape");qt(d,"leaflet-vml-shape "+(this.options.className||"")),d.coordsize="1 1",o._path=oa("path"),d.appendChild(o._path),this._updateStyle(o),this._layers[h(o)]=o},_addPath:function(o){var d=o._container;this._container.appendChild(d),o.options.interactive&&o.addInteractiveTarget(d)},_removePath:function(o){var d=o._container;mt(d),o.removeInteractiveTarget(d),delete this._layers[h(o)]},_updateStyle:function(o){var d=o._stroke,P=o._fill,U=o.options,Y=o._container;Y.stroked=!!U.stroke,Y.filled=!!U.fill,U.stroke?(d||(d=o._stroke=oa("stroke")),Y.appendChild(d),d.weight=U.weight+"px",d.color=U.color,d.opacity=U.opacity,U.dashArray?d.dashStyle=Dn(U.dashArray)?U.dashArray.join(" "):U.dashArray.replace(/( *, *)/g," "):d.dashStyle="",d.endcap=U.lineCap.replace("butt","flat"),d.joinstyle=U.lineJoin):d&&(Y.removeChild(d),o._stroke=null),U.fill?(P||(P=o._fill=oa("fill")),Y.appendChild(P),P.color=U.fillColor||U.color,P.opacity=U.fillOpacity):P&&(Y.removeChild(P),o._fill=null)},_updateCircle:function(o){var d=o._point.round(),P=Math.round(o._radius),U=Math.round(o._radiusY||P);this._setPath(o,o._empty()?"M0 0":"AL "+d.x+","+d.y+" "+P+","+U+" 0,23592600")},_setPath:function(o,d){o._path.v=d},_bringToFront:function(o){Gt(o._container)},_bringToBack:function(o){Bt(o._container)}},Xo=ma?oa:Qe,kr=en.extend({getEvents:function(){var o=en.prototype.getEvents.call(this);return o.zoomstart=this._onZoomStart,o},_initContainer:function(){this._container=Xo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Xo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){mt(this._container),wr(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_onZoomStart:function(){this._update()},_update:function(){if(!this._map._animatingZoom||!this._bounds){en.prototype._update.call(this);var o=this._bounds,d=o.getSize(),P=this._container;this._svgSize&&this._svgSize.equals(d)||(this._svgSize=d,P.setAttribute("width",d.x),P.setAttribute("height",d.y)),ir(P,o.min),P.setAttribute("viewBox",[o.min.x,o.min.y,d.x,d.y].join(" ")),this.fire("update")}},_initPath:function(o){var d=o._path=Xo("path");o.options.className&&qt(d,o.options.className),o.options.interactive&&qt(d,"leaflet-interactive"),this._updateStyle(o),this._layers[h(o)]=o},_addPath:function(o){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(o._path),o.addInteractiveTarget(o._path)},_removePath:function(o){mt(o._path),o.removeInteractiveTarget(o._path),delete this._layers[h(o)]},_updatePath:function(o){o._project(),o._update()},_updateStyle:function(o){var d=o._path,P=o.options;d&&(P.stroke?(d.setAttribute("stroke",P.color),d.setAttribute("stroke-opacity",P.opacity),d.setAttribute("stroke-width",P.weight),d.setAttribute("stroke-linecap",P.lineCap),d.setAttribute("stroke-linejoin",P.lineJoin),P.dashArray?d.setAttribute("stroke-dasharray",P.dashArray):d.removeAttribute("stroke-dasharray"),P.dashOffset?d.setAttribute("stroke-dashoffset",P.dashOffset):d.removeAttribute("stroke-dashoffset")):d.setAttribute("stroke","none"),P.fill?(d.setAttribute("fill",P.fillColor||P.color),d.setAttribute("fill-opacity",P.fillOpacity),d.setAttribute("fill-rule",P.fillRule||"evenodd")):d.setAttribute("fill","none"))},_updatePoly:function(o,d){this._setPath(o,we(o._parts,d))},_updateCircle:function(o){var d=o._point,P=Math.max(Math.round(o._radius),1),U="a"+P+","+(Math.max(Math.round(o._radiusY),1)||P)+" 0 1,0 ",Y=o._empty()?"M0 0":"M"+(d.x-P)+","+d.y+U+2*P+",0 "+U+2*-P+",0 ";this._setPath(o,Y)},_setPath:function(o,d){o._path.setAttribute("d",d)},_bringToFront:function(o){Gt(o._path)},_bringToBack:function(o){Bt(o._path)}});ma&&kr.include(Js),D.include({getRenderer:function(o){var d=o.options.renderer||this._getPaneRenderer(o.options.pane)||this.options.renderer||this._renderer;return d||(d=this._renderer=this._createRenderer()),this.hasLayer(d)||this.addLayer(d),d},_getPaneRenderer:function(o){if(o==="overlayPane"||o===void 0)return!1;var d=this._paneRenderers[o];return d===void 0&&(d=this._createRenderer({pane:o}),this._paneRenderers[o]=d),d},_createRenderer:function(o){return this.options.preferCanvas&&un(o)||_r(o)}});var ss=Ui.extend({initialize:function(o,d){Ui.prototype.initialize.call(this,this._boundsToLatLngs(o),d)},setBounds:function(o){return this.setLatLngs(this._boundsToLatLngs(o))},_boundsToLatLngs:function(o){return o=Ue(o),[o.getSouthWest(),o.getNorthWest(),o.getNorthEast(),o.getSouthEast()]}});kr.create=Xo,kr.pointsToPath=we,xi.geometryToLayer=ii,xi.coordsToLatLng=ri,xi.coordsToLatLngs=ki,xi.latLngToCoords=si,xi.latLngsToCoords=Gi,xi.getFeature=$i,xi.asFeature=dr,D.mergeOptions({boxZoom:!0});var ya=pe.extend({initialize:function(o){this._map=o,this._container=o._container,this._pane=o._panes.overlayPane,this._resetStateTimeout=0,o.on("unload",this._destroy,this)},addHooks:function(){Ni(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){wr(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){mt(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(o){if(!o.shiftKey||o.which!==1&&o.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Wn(),rn(),this._startPoint=this._map.mouseEventToContainerPoint(o),Ni(document,{contextmenu:ln,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(o){this._moved||(this._moved=!0,this._box=He("div","leaflet-zoom-box",this._container),qt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(o);var d=new Me(this._point,this._startPoint),P=d.getSize();ir(this._box,d.min),this._box.style.width=P.x+"px",this._box.style.height=P.y+"px"},_finish:function(){this._moved&&(mt(this._box),fi(this._container,"leaflet-crosshair")),yn(),Br(),wr(document,{contextmenu:ln,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(o){if((o.which===1||o.button===1)&&(this._finish(),this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(W(this._resetState,this),0);var d=new ot(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(d).fire("boxzoomend",{boxZoomBounds:d})}},_onKeyDown:function(o){o.keyCode===27&&this._finish()}});D.addInitHook("addHandler","boxZoom",ya),D.mergeOptions({doubleClickZoom:!0});var aa=pe.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(o){var d=this._map,P=d.getZoom(),U=d.options.zoomDelta,Y=o.originalEvent.shiftKey?P-U:P+U;d.options.doubleClickZoom==="center"?d.setZoom(Y):d.setZoomAround(o.containerPoint,Y)}});D.addInitHook("addHandler","doubleClickZoom",aa),D.mergeOptions({dragging:!0,inertia:!ao,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var pr=pe.extend({addHooks:function(){if(!this._draggable){var o=this._map;this._draggable=new st(o._mapPane,o._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),o.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),o.on("zoomend",this._onZoomEnd,this),o.whenReady(this._onZoomEnd,this))}qt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){fi(this._map._container,"leaflet-grab"),fi(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var o=this._map;if(o._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var d=Ue(this._map.options.maxBounds);this._offsetLimit=Be(this._map.latLngToContainerPoint(d.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(d.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;o.fire("movestart").fire("dragstart"),o.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(o){if(this._map.options.inertia){var d=this._lastTime=+new Date,P=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(P),this._times.push(d),this._prunePositions(d)}this._map.fire("move",o).fire("drag",o)},_prunePositions:function(o){for(;this._positions.length>1&&o-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var o=this._map.getSize().divideBy(2),d=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=d.subtract(o).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(o,d){return o-(o-d)*this._viscosity},_onPreDragLimit:function(){if(this._viscosity&&this._offsetLimit){var o=this._draggable._newPos.subtract(this._draggable._startPos),d=this._offsetLimit;o.x<d.min.x&&(o.x=this._viscousLimit(o.x,d.min.x)),o.y<d.min.y&&(o.y=this._viscousLimit(o.y,d.min.y)),o.x>d.max.x&&(o.x=this._viscousLimit(o.x,d.max.x)),o.y>d.max.y&&(o.y=this._viscousLimit(o.y,d.max.y)),this._draggable._newPos=this._draggable._startPos.add(o)}},_onPreDragWrap:function(){var o=this._worldWidth,d=Math.round(o/2),P=this._initialWorldOffset,U=this._draggable._newPos.x,Y=(U-d+P)%o+d-P,me=(U+d+P)%o-d-P,Ke=Math.abs(Y+P)<Math.abs(me+P)?Y:me;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=Ke},_onDragEnd:function(o){var d=this._map,P=d.options,U=!P.inertia||this._times.length<2;if(d.fire("dragend",o),U)d.fire("moveend");else{this._prunePositions(+new Date);var Y=this._lastPos.subtract(this._positions[0]),me=(this._lastTime-this._times[0])/1e3,Ke=P.easeLinearity,Tt=Y.multiplyBy(Ke/me),wt=Tt.distanceTo([0,0]),pt=Math.min(P.inertiaMaxSpeed,wt),_i=Tt.multiplyBy(pt/wt),Hi=pt/(P.inertiaDeceleration*Ke),Er=_i.multiplyBy(-Hi/2).round();Er.x||Er.y?(Er=d._limitOffset(Er,d.options.maxBounds),q(function(){d.panBy(Er,{duration:Hi,easeLinearity:Ke,noMoveStart:!0,animate:!0})})):d.fire("moveend")}}});D.addInitHook("addHandler","dragging",pr),D.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ar=pe.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(o){this._map=o,this._setPanDelta(o.options.keyboardPanDelta),this._setZoomDelta(o.options.zoomDelta)},addHooks:function(){var o=this._map._container;o.tabIndex<=0&&(o.tabIndex="0"),Ni(o,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),wr(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var o=document.body,d=document.documentElement,P=o.scrollTop||d.scrollTop,U=o.scrollLeft||d.scrollLeft;this._map._container.focus(),window.scrollTo(U,P)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(o){var d,P,U=this._panKeys={},Y=this.keyCodes;for(d=0,P=Y.left.length;d<P;d++)U[Y.left[d]]=[-1*o,0];for(d=0,P=Y.right.length;d<P;d++)U[Y.right[d]]=[o,0];for(d=0,P=Y.down.length;d<P;d++)U[Y.down[d]]=[0,o];for(d=0,P=Y.up.length;d<P;d++)U[Y.up[d]]=[0,-1*o]},_setZoomDelta:function(o){var d,P,U=this._zoomKeys={},Y=this.keyCodes;for(d=0,P=Y.zoomIn.length;d<P;d++)U[Y.zoomIn[d]]=o;for(d=0,P=Y.zoomOut.length;d<P;d++)U[Y.zoomOut[d]]=-o},_addHooks:function(){Ni(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){wr(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(o){if(!(o.altKey||o.ctrlKey||o.metaKey)){var d,P=o.keyCode,U=this._map;if(P in this._panKeys)U._panAnim&&U._panAnim._inProgress||(d=this._panKeys[P],o.shiftKey&&(d=ce(d).multiplyBy(3)),U.panBy(d),U.options.maxBounds&&U.panInsideBounds(U.options.maxBounds));else if(P in this._zoomKeys)U.setZoom(U.getZoom()+(o.shiftKey?3:1)*this._zoomKeys[P]);else{if(P!==27||!U._popup||!U._popup.options.closeOnEscapeKey)return;U.closePopup()}ln(o)}}});D.addInitHook("addHandler","keyboard",Ar),D.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _o=pe.extend({addHooks:function(){Ni(this._map._container,"mousewheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){wr(this._map._container,"mousewheel",this._onWheelScroll,this)},_onWheelScroll:function(o){var d=Fr(o),P=this._map.options.wheelDebounceTime;this._delta+=d,this._lastMousePos=this._map.mouseEventToContainerPoint(o),this._startTime||(this._startTime=+new Date);var U=Math.max(P-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(W(this._performZoom,this),U),ln(o)},_performZoom:function(){var o=this._map,d=o.getZoom(),P=this._map.options.zoomSnap||0;o._stop();var U=this._delta/(4*this._map.options.wheelPxPerZoomLevel),Y=4*Math.log(2/(1+Math.exp(-Math.abs(U))))/Math.LN2,me=P?Math.ceil(Y/P)*P:Y,Ke=o._limitZoom(d+(this._delta>0?me:-me))-d;this._delta=0,this._startTime=null,Ke&&(o.options.scrollWheelZoom==="center"?o.setZoom(d+Ke):o.setZoomAround(this._lastMousePos,d+Ke))}});D.addInitHook("addHandler","scrollWheelZoom",_o),D.mergeOptions({tap:!0,tapTolerance:15});var Ha=pe.extend({addHooks:function(){Ni(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){wr(this._map._container,"touchstart",this._onDown,this)},_onDown:function(o){if(o.touches){if(Xr(o),this._fireClick=!0,o.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var d=o.touches[0],P=d.target;this._startPos=this._newPos=new X(d.clientX,d.clientY),P.tagName&&P.tagName.toLowerCase()==="a"&&qt(P,"leaflet-active"),this._holdTimeout=setTimeout(W(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",d))},this),1e3),this._simulateEvent("mousedown",d),Ni(document,{touchmove:this._onMove,touchend:this._onUp},this)}},_onUp:function(o){if(clearTimeout(this._holdTimeout),wr(document,{touchmove:this._onMove,touchend:this._onUp},this),this._fireClick&&o&&o.changedTouches){var d=o.changedTouches[0],P=d.target;P&&P.tagName&&P.tagName.toLowerCase()==="a"&&fi(P,"leaflet-active"),this._simulateEvent("mouseup",d),this._isTapValid()&&this._simulateEvent("click",d)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(o){var d=o.touches[0];this._newPos=new X(d.clientX,d.clientY),this._simulateEvent("mousemove",d)},_simulateEvent:function(o,d){var P=document.createEvent("MouseEvents");P._simulated=!0,d.target._simulatedClick=!0,P.initMouseEvent(o,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),d.target.dispatchEvent(P)}});Mr&&!qn&&D.addInitHook("addHandler","tap",Ha),D.mergeOptions({touchZoom:Mr&&!ao,bounceAtZoomLimits:!0});var Ia=pe.extend({addHooks:function(){qt(this._map._container,"leaflet-touch-zoom"),Ni(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){fi(this._map._container,"leaflet-touch-zoom"),wr(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(o){var d=this._map;if(o.touches&&o.touches.length===2&&!d._animatingZoom&&!this._zooming){var P=d.mouseEventToContainerPoint(o.touches[0]),U=d.mouseEventToContainerPoint(o.touches[1]);this._centerPoint=d.getSize()._divideBy(2),this._startLatLng=d.containerPointToLatLng(this._centerPoint),d.options.touchZoom!=="center"&&(this._pinchStartLatLng=d.containerPointToLatLng(P.add(U)._divideBy(2))),this._startDist=P.distanceTo(U),this._startZoom=d.getZoom(),this._moved=!1,this._zooming=!0,d._stop(),Ni(document,"touchmove",this._onTouchMove,this),Ni(document,"touchend",this._onTouchEnd,this),Xr(o)}},_onTouchMove:function(o){if(o.touches&&o.touches.length===2&&this._zooming){var d=this._map,P=d.mouseEventToContainerPoint(o.touches[0]),U=d.mouseEventToContainerPoint(o.touches[1]),Y=P.distanceTo(U)/this._startDist;if(this._zoom=d.getScaleZoom(Y,this._startZoom),!d.options.bounceAtZoomLimits&&(this._zoom<d.getMinZoom()&&Y<1||this._zoom>d.getMaxZoom()&&Y>1)&&(this._zoom=d._limitZoom(this._zoom)),d.options.touchZoom==="center"){if(this._center=this._startLatLng,Y===1)return}else{var me=P._add(U)._divideBy(2)._subtract(this._centerPoint);if(Y===1&&me.x===0&&me.y===0)return;this._center=d.unproject(d.project(this._pinchStartLatLng,this._zoom).subtract(me),this._zoom)}this._moved||(d._moveStart(!0,!1),this._moved=!0),re(this._animRequest);var Ke=W(d._move,d,this._center,this._zoom,{pinch:!0,round:!1});this._animRequest=q(Ke,this,!0),Xr(o)}},_onTouchEnd:function(){this._moved&&this._zooming?(this._zooming=!1,re(this._animRequest),wr(document,"touchmove",this._onTouchMove),wr(document,"touchend",this._onTouchEnd),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))):this._zooming=!1}});D.addInitHook("addHandler","touchZoom",Ia),D.BoxZoom=ya,D.DoubleClickZoom=aa,D.Drag=pr,D.Keyboard=Ar,D.ScrollWheelZoom=_o,D.Tap=Ha,D.TouchZoom=Ia,Object.freeze=hn,B.version="1.5.0+master.91ab2ec",B.Control=G,B.control=Z,B.Browser=Za,B.Evented=jo,B.Mixin=ke,B.Util=Ta,B.Class=ne,B.Handler=pe,B.extend=Q,B.bind=W,B.stamp=h,B.setOptions=x,B.DomEvent=_,B.DomUtil=O,B.PosAnimation=b,B.Draggable=st,B.LineUtil=Pt,B.PolyUtil=$e,B.Point=X,B.point=ce,B.Bounds=Me,B.bounds=Be,B.Transformation=bi,B.transformation=gt,B.Projection=qe,B.LatLng=ht,B.latLng=Et,B.LatLngBounds=ot,B.latLngBounds=Ue,B.CRS=Ur,B.GeoJSON=xi,B.geoJSON=Vi,B.geoJson=Fi,B.Layer=kt,B.LayerGroup=Nt,B.layerGroup=function(o,d){return new Nt(o,d)},B.FeatureGroup=Rt,B.featureGroup=function(o){return new Rt(o)},B.ImageOverlay=Wi,B.imageOverlay=function(o,d,P){return new Wi(o,d,P)},B.VideoOverlay=tr,B.videoOverlay=function(o,d,P){return new tr(o,d,P)},B.DivOverlay=Zi,B.Popup=Yi,B.popup=function(o,d){return new Yi(o,d)},B.Tooltip=ar,B.tooltip=function(o,d){return new ar(o,d)},B.Icon=Qt,B.icon=function(o){return new Qt(o)},B.DivIcon=rr,B.divIcon=function(o){return new rr(o)},B.Marker=vi,B.marker=function(o,d){return new vi(o,d)},B.TileLayer=br,B.tileLayer=Ki,B.GridLayer=nr,B.gridLayer=function(o){return new nr(o)},B.SVG=kr,B.svg=_r,B.Renderer=en,B.Canvas=Oa,B.canvas=un,B.Path=gi,B.CircleMarker=jt,B.circleMarker=function(o,d){return new jt(o,d)},B.Circle=$t,B.circle=function(o,d,P){return new $t(o,d,P)},B.Polyline=Oi,B.polyline=function(o,d){return new Oi(o,d)},B.Polygon=Ui,B.polygon=function(o,d){return new Ui(o,d)},B.Rectangle=ss,B.rectangle=function(o,d){return new ss(o,d)},B.Map=D,B.map=function(o,d){return new D(o,d)};var ls=window.L;B.noConflict=function(){return window.L=ls,this},window.L=B})},84922:function(ct){(function(Ye,B){ct.exports=B()})(this,function(){"use strict";var Ye,B,Q;function W(h,K){if(!Ye)Ye=K;else if(!B)B=K;else{var k="var sharedChunk = {}; ("+Ye+")(sharedChunk); ("+B+")(sharedChunk);",A={};Ye(A),Q=K(A),typeof window!="undefined"&&(Q.workerUrl=window.URL.createObjectURL(new Blob([k],{type:"text/javascript"})))}}return W(["exports"],function(h){"use strict";function K(e,t){return e(t={exports:{}},t.exports),t.exports}var k=A;function A(e,t,r,c){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=c,this.p2x=r,this.p2y=c}A.prototype.sampleCurveX=function(e){return((this.ax*e+this.bx)*e+this.cx)*e},A.prototype.sampleCurveY=function(e){return((this.ay*e+this.by)*e+this.cy)*e},A.prototype.sampleCurveDerivativeX=function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},A.prototype.solveCurveX=function(e,t){var r,c,f,g,w;for(t===void 0&&(t=1e-6),f=e,w=0;w<8;w++){if(g=this.sampleCurveX(f)-e,Math.abs(g)<t)return f;var E=this.sampleCurveDerivativeX(f);if(Math.abs(E)<1e-6)break;f-=g/E}if((f=e)<(r=0))return r;if(f>(c=1))return c;for(;r<c;){if(g=this.sampleCurveX(f),Math.abs(g-e)<t)return f;e>g?r=f:c=f,f=.5*(c-r)+r}return f},A.prototype.solve=function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))};var z=R;function R(e,t){this.x=e,this.y=t}R.prototype={clone:function(){return new R(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),c=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=c,this},_rotateAround:function(e,t){var r=Math.cos(e),c=Math.sin(e),f=t.y+c*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-c*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},R.convert=function(e){return e instanceof R?e:Array.isArray(e)?new R(e[0],e[1]):e};var C=typeof self!="undefined"?self:{},x=Math.pow(2,53)-1;function v(e,t,r,c){var f=new k(e,t,r,c);return function(g){return f.solve(g)}}var m=v(.25,.1,.25,1);function T(e,t,r){return Math.min(r,Math.max(t,e))}function I(e,t,r){var c=r-t,f=((e-t)%c+c)%c+t;return f===t?r:f}function F(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var c=0,f=t;c<f.length;c+=1){var g=f[c];for(var w in g)e[w]=g[w]}return e}var q=1;function re(){return q++}function ne(){return function e(t){return t?(t^16*Math.random()>>t/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function se(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function X(e,t){e.forEach(function(r){t[r]&&(t[r]=t[r].bind(t))})}function ce(e,t){return e.indexOf(t,e.length-t.length)!==-1}function Me(e,t,r){var c={};for(var f in e)c[f]=t.call(r||this,e[f],f,e);return c}function Be(e,t,r){var c={};for(var f in e)t.call(r||this,e[f],f,e)&&(c[f]=e[f]);return c}function ot(e){return Array.isArray(e)?e.map(ot):typeof e=="object"&&e?Me(e,ot):e}var Ue={};function ht(e){Ue[e]||(typeof console!="undefined"&&console.warn(e),Ue[e]=!0)}function Et(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function bi(e){for(var t=0,r=0,c=e.length,f=c-1,g=void 0,w=void 0;r<c;f=r++)t+=((w=e[f]).x-(g=e[r]).x)*(g.y+w.y);return t}function gt(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function Qe(e){var t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,function(c,f,g,w){var E=g||w;return t[f]=!E||E.toLowerCase(),""}),t["max-age"]){var r=parseInt(t["max-age"],10);isNaN(r)?delete t["max-age"]:t["max-age"]=r}return t}var we=null;function Ae(e){if(we==null){var t=e.navigator?e.navigator.userAgent:null;we=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return we}function it(e){try{var t=C[e];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch(r){return!1}}var Lt,ei,Si,ui,ni=C.performance&&C.performance.now?C.performance.now.bind(C.performance):Date.now.bind(Date),Bi=C.requestAnimationFrame||C.mozRequestAnimationFrame||C.webkitRequestAnimationFrame||C.msRequestAnimationFrame,Ci=C.cancelAnimationFrame||C.mozCancelAnimationFrame||C.webkitCancelAnimationFrame||C.msCancelAnimationFrame,xt={now:ni,frame:function(e){var t=Bi(e);return{cancel:function(){return Ci(t)}}},getImageData:function(e,t){t===void 0&&(t=0);var r=C.document.createElement("canvas"),c=r.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return r.width=e.width,r.height=e.height,c.drawImage(e,0,0,e.width,e.height),c.getImageData(-t,-t,e.width+2*t,e.height+2*t)},resolveURL:function(e){return Lt||(Lt=C.document.createElement("a")),Lt.href=e,Lt.href},hardwareConcurrency:C.navigator&&C.navigator.hardwareConcurrency||4,get devicePixelRatio(){return C.devicePixelRatio},get prefersReducedMotion(){return!!C.matchMedia&&(ei==null&&(ei=C.matchMedia("(prefers-reduced-motion: reduce)")),ei.matches)}},ze={API_URL:"https://api.mapbox.com",get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},FEEDBACK_URL:"https://apps.mapbox.com/feedback",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},oe={supported:!1,testSupport:function(e){!de&&ui&&(Re?He(e):Si=e)}},de=!1,Re=!1;function He(e){var t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,ui),e.isContextLost())return;oe.supported=!0}catch(r){}e.deleteTexture(t),de=!0}C.document&&((ui=C.document.createElement("img")).onload=function(){Si&&He(Si),Si=null,Re=!0},ui.onerror=function(){de=!0,Si=null},ui.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");var mt="01",Ft=function(e,t){this._transformRequestFn=e,this._customAccessToken=t,this._createSkuToken()};function Gt(e){return e.indexOf("mapbox:")===0}Ft.prototype._createSkuToken=function(){var e=function(){for(var t="",r=0;r<10;r++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",mt,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt},Ft.prototype._isSkuTokenExpired=function(){return Date.now()>this._skuTokenExpiresAt},Ft.prototype.transformRequest=function(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}},Ft.prototype.normalizeStyleURL=function(e,t){if(!Gt(e))return e;var r=fi(e);return r.path="/styles/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ft.prototype.normalizeGlyphsURL=function(e,t){if(!Gt(e))return e;var r=fi(e);return r.path="/fonts/v1"+r.path,this._makeAPIURL(r,this._customAccessToken||t)},Ft.prototype.normalizeSourceURL=function(e,t){if(!Gt(e))return e;var r=fi(e);return r.path="/v4/"+r.authority+".json",r.params.push("secure"),this._makeAPIURL(r,this._customAccessToken||t)},Ft.prototype.normalizeSpriteURL=function(e,t,r,c){var f=fi(e);return Gt(e)?(f.path="/styles/v1"+f.path+"/sprite"+t+r,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=""+t+r,Ii(f))},Ft.prototype.normalizeTileURL=function(e,t){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!Gt(e))return e;var r=fi(e);r.path=r.path.replace(/(\.(png|jpg)\d*)(?=$)/,(xt.devicePixelRatio>=2||t===512?"@2x":"")+(oe.supported?".webp":"$1")),r.path=r.path.replace(/^.+\/v4\//,"/"),r.path="/v4"+r.path;var c=this._customAccessToken||function(f){for(var g=0,w=f;g<w.length;g+=1){var E=w[g].match(/^access_token=(.*)$/);if(E)return E[1]}return null}(r.params)||ze.ACCESS_TOKEN;return ze.REQUIRE_ACCESS_TOKEN&&c&&this._skuToken&&r.params.push("sku="+this._skuToken),this._makeAPIURL(r,c)},Ft.prototype.canonicalizeTileURL=function(e,t){var r=fi(e);if(!r.path.match(/(^\/v4\/)/)||!r.path.match(/\.[\w]+$/))return e;var c="mapbox://tiles/";c+=r.path.replace("/v4/","");var f=r.params;return t&&(f=f.filter(function(g){return!g.match(/^access_token=/)})),f.length&&(c+="?"+f.join("&")),c},Ft.prototype.canonicalizeTileset=function(e,t){for(var r=!!t&&Gt(t),c=[],f=0,g=e.tiles||[];f<g.length;f+=1){var w=g[f];Kt(w)?c.push(this.canonicalizeTileURL(w,r)):c.push(w)}return c},Ft.prototype._makeAPIURL=function(e,t){var r="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=fi(ze.API_URL);if(e.protocol=c.protocol,e.authority=c.authority,c.path!=="/"&&(e.path=""+c.path+e.path),!ze.REQUIRE_ACCESS_TOKEN)return Ii(e);if(!(t=t||ze.ACCESS_TOKEN))throw new Error("An API access token is required to use Mapbox GL. "+r);if(t[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). "+r);return e.params=e.params.filter(function(f){return f.indexOf("access_token")===-1}),e.params.push("access_token="+t),Ii(e)};var Bt=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;function Kt(e){return Bt.test(e)}var qt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function fi(e){var t=e.match(qt);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function Ii(e){var t=e.params.length?"?"+e.params.join("&"):"";return e.protocol+"://"+e.authority+e.path+t}function zi(e){if(!e)return null;var t=e.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(C.atob(t[1]).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")))}catch(r){return null}}var Yt=function(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null};Yt.prototype.getStorageKey=function(e){var t,r=zi(ze.ACCESS_TOKEN);return t=r&&r.u?C.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,function(c,f){return String.fromCharCode(Number("0x"+f))})):ze.ACCESS_TOKEN||"",e?"mapbox.eventData."+e+":"+t:"mapbox.eventData:"+t},Yt.prototype.fetchEventData=function(){var e=it("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{var c=C.localStorage.getItem(t);c&&(this.eventData=JSON.parse(c));var f=C.localStorage.getItem(r);f&&(this.anonId=f)}catch(g){ht("Unable to read from LocalStorage")}},Yt.prototype.saveEventData=function(){var e=it("localStorage"),t=this.getStorageKey(),r=this.getStorageKey("uuid");if(e)try{C.localStorage.setItem(r,this.anonId),Object.keys(this.eventData).length>=1&&C.localStorage.setItem(t,JSON.stringify(this.eventData))}catch(c){ht("Unable to write to LocalStorage")}},Yt.prototype.processRequests=function(e){},Yt.prototype.postEvent=function(e,t,r,c){var f=this;if(ze.EVENTS_URL){var g=fi(ze.EVENTS_URL);g.params.push("access_token="+(c||ze.ACCESS_TOKEN||""));var w={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:"1.5.0",skuId:mt,userId:this.anonId},E=t?F(w,t):w,N={url:Ii(g),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=Fr(N,function(V){f.pendingRequest=null,r(V),f.saveEventData(),f.processRequests(c)})}},Yt.prototype.queueRequest=function(e,t){this.queue.push(e),this.processRequests(t)};var ur,yi,hr=function(e){function t(){e.call(this,"map.load"),this.success={},this.skuToken=""}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postMapLoadEvent=function(r,c,f,g){this.skuToken=f,(ze.EVENTS_URL&&g||ze.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(w){return Gt(w)||Kt(w)}))&&this.queueRequest({id:c,timestamp:Date.now()},g)},t.prototype.processRequests=function(r){var c=this;if(!this.pendingRequest&&this.queue.length!==0){var f=this.queue.shift(),g=f.id,w=f.timestamp;g&&this.success[g]||(this.anonId||this.fetchEventData(),se(this.anonId)||(this.anonId=ne()),this.postEvent(w,{skuToken:this.skuToken},function(E){E||g&&(c.success[g]=!0)},r))}},t}(Yt),ir=new(function(e){function t(r){e.call(this,"appUserTurnstile"),this._customAccessToken=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.postTurnstileEvent=function(r,c){ze.EVENTS_URL&&ze.ACCESS_TOKEN&&Array.isArray(r)&&r.some(function(f){return Gt(f)||Kt(f)})&&this.queueRequest(Date.now(),c)},t.prototype.processRequests=function(r){var c=this;if(!this.pendingRequest&&this.queue.length!==0){this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();var f=zi(ze.ACCESS_TOKEN),g=f?f.u:ze.ACCESS_TOKEN,w=g!==this.eventData.tokenU;se(this.anonId)||(this.anonId=ne(),w=!0);var E=this.queue.shift();if(this.eventData.lastSuccess){var N=new Date(this.eventData.lastSuccess),V=new Date(E),J=(E-this.eventData.lastSuccess)/864e5;w=w||J>=1||J<-1||N.getDate()!==V.getDate()}else w=!0;if(!w)return this.processRequests();this.postEvent(E,{"enabled.telemetry":!1},function(ee){ee||(c.eventData.lastSuccess=E,c.eventData.tokenU=g)},r)}},t}(Yt)),zr=ir.postTurnstileEvent.bind(ir),rn=new hr,Br=rn.postMapLoadEvent.bind(rn),nn=500,wn=50;function Pn(){C.caches&&!ur&&(ur=C.caches.open("mapbox-tiles"))}function An(e){var t=e.indexOf("?");return t<0?e:e.slice(0,t)}var Ni,wr=1/0;function mn(){return Ni==null&&(Ni=C.OffscreenCanvas&&new C.OffscreenCanvas(1,1).getContext("2d")&&typeof C.createImageBitmap=="function"),Ni}var ho={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(ho);var Cr=function(e){function t(r,c,f){c===401&&Kt(f)&&(r+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),e.call(this,r),this.status=c,this.url=f,this.name=this.constructor.name,this.message=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.toString=function(){return this.name+": "+this.message+" ("+this.status+"): "+this.url},t}(Error),Po=gt()?function(){return self.worker&&self.worker.referrer}:function(){return(C.location.protocol==="blob:"?C.parent:C).location.href},Gn,Xr,ln=function(e,t){if(!(/^file:/.test(r=e.url)||/^file:/.test(Po())&&!/^\w+:/.test(r))){if(C.fetch&&C.Request&&C.AbortController&&C.Request.prototype.hasOwnProperty("signal"))return function(c,f){var g,w=new C.AbortController,E=new C.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Po(),signal:w.signal}),N=!1,V=!1,J=(g=E.url).indexOf("sku=")>0&&Kt(g);c.type==="json"&&E.headers.set("Accept","application/json");var ee=function(fe,Te,Se){if(!V){if(fe&&fe.message!=="SecurityError"&&ht(fe),Te&&Se)return he(Te);var We=Date.now();C.fetch(E).then(function(De){if(De.ok){var et=J?De.clone():null;return he(De,et,We)}return f(new Cr(De.statusText,De.status,c.url))}).catch(function(De){De.code!==20&&f(new Error(De.message))})}},he=function(fe,Te,Se){(c.type==="arrayBuffer"?fe.arrayBuffer():c.type==="json"?fe.json():fe.text()).then(function(We){V||(Te&&Se&&function(De,et,ut){if(Pn(),ur){var vt={status:et.status,statusText:et.statusText,headers:new C.Headers};et.headers.forEach(function(Ot,Vt){return vt.headers.set(Vt,Ot)});var bt=Qe(et.headers.get("Cache-Control")||"");bt["no-store"]||(bt["max-age"]&&vt.headers.set("Expires",new Date(ut+1e3*bt["max-age"]).toUTCString()),new Date(vt.headers.get("Expires")).getTime()-ut<42e4||function(Ot,Vt){if(yi===void 0)try{new Response(new ReadableStream),yi=!0}catch(oi){yi=!1}yi?Vt(Ot.body):Ot.blob().then(Vt)}(et,function(Ot){var Vt=new C.Response(Ot,vt);Pn(),ur&&ur.then(function(oi){return oi.put(An(De.url),Vt)}).catch(function(oi){return ht(oi.message)})}))}}(E,Te,Se),N=!0,f(null,We,fe.headers.get("Cache-Control"),fe.headers.get("Expires")))}).catch(function(We){V||f(new Error(We.message))})};return J?function(fe,Te){if(Pn(),!ur)return Te(null);var Se=An(fe.url);ur.then(function(We){We.match(Se).then(function(De){var et=function(ut){if(!ut)return!1;var vt=new Date(ut.headers.get("Expires")||0),bt=Qe(ut.headers.get("Cache-Control")||"");return vt>Date.now()&&!bt["no-cache"]}(De);We.delete(Se),et&&We.put(Se,De.clone()),Te(null,De,et)}).catch(Te)}).catch(Te)}(E,ee):ee(null,null),{cancel:function(){V=!0,N||w.abort()}}}(e,t);if(gt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,t,void 0,!0)}var r;return function(c,f){var g=new C.XMLHttpRequest;for(var w in g.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(g.responseType="arraybuffer"),c.headers)g.setRequestHeader(w,c.headers[w]);return c.type==="json"&&(g.responseType="text",g.setRequestHeader("Accept","application/json")),g.withCredentials=c.credentials==="include",g.onerror=function(){f(new Error(g.statusText))},g.onload=function(){if((g.status>=200&&g.status<300||g.status===0)&&g.response!==null){var E=g.response;if(c.type==="json")try{E=JSON.parse(g.response)}catch(N){return f(N)}f(null,E,g.getResponseHeader("Cache-Control"),g.getResponseHeader("Expires"))}else f(new Cr(g.statusText,g.status,c.url))},g.send(c.body),{cancel:function(){return g.abort()}}}(e,t)},co=function(e,t){return ln(F(e,{type:"arrayBuffer"}),t)},Fr=function(e,t){return ln(F(e,{method:"POST"}),t)};Gn=[],Xr=0;var $=function(e,t){if(oe.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),Xr>=ze.MAX_PARALLEL_IMAGE_REQUESTS){var r={requestParameters:e,callback:t,cancelled:!1,cancel:function(){this.cancelled=!0}};return Gn.push(r),r}Xr++;var c=!1,f=function(){if(!c)for(c=!0,Xr--;Gn.length&&Xr<ze.MAX_PARALLEL_IMAGE_REQUESTS;){var w=Gn.shift();w.cancelled||(w.cancel=$(w.requestParameters,w.callback).cancel)}},g=co(e,function(w,E,N,V){f(),w?t(w):E&&(mn()?function(J,ee){var he=new C.Blob([new Uint8Array(J)],{type:"image/png"});C.createImageBitmap(he).then(function(fe){ee(null,fe)}).catch(function(fe){ee(new Error("Could not load image because of "+fe.message+". Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))})}(E,t):function(J,ee,he,fe){var Te=new C.Image,Se=C.URL;Te.onload=function(){ee(null,Te),Se.revokeObjectURL(Te.src)},Te.onerror=function(){return ee(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."))};var We=new C.Blob([new Uint8Array(J)],{type:"image/png"});Te.cacheControl=he,Te.expires=fe,Te.src=J.byteLength?Se.createObjectURL(We):"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII="}(E,t,N,V))});return{cancel:function(){g.cancel(),f()}}};function le(e,t,r){r[e]&&r[e].indexOf(t)!==-1||(r[e]=r[e]||[],r[e].push(t))}function ue(e,t,r){if(r&&r[e]){var c=r[e].indexOf(t);c!==-1&&r[e].splice(c,1)}}var be=function(e,t){t===void 0&&(t={}),F(this,t),this.type=e},Oe=function(e){function t(r,c){c===void 0&&(c={}),e.call(this,"error",F({error:r},c))}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(be),je=function(){};je.prototype.on=function(e,t){return this._listeners=this._listeners||{},le(e,t,this._listeners),this},je.prototype.off=function(e,t){return ue(e,t,this._listeners),ue(e,t,this._oneTimeListeners),this},je.prototype.once=function(e,t){return this._oneTimeListeners=this._oneTimeListeners||{},le(e,t,this._oneTimeListeners),this},je.prototype.fire=function(e,t){typeof e=="string"&&(e=new be(e,t||{}));var r=e.type;if(this.listens(r)){e.target=this;for(var c=0,f=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];c<f.length;c+=1)f[c].call(this,e);for(var g=0,w=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];g<w.length;g+=1){var E=w[g];ue(r,E,this._oneTimeListeners),E.call(this,e)}var N=this._eventedParent;N&&(F(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),N.fire(e))}else e instanceof Oe&&console.error(e.error);return this},je.prototype.listens=function(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)},je.prototype.setEventedParent=function(e,t){return this._eventedParent=e,this._eventedParentData=t,this};var xe={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}},Le=function(e,t,r,c){this.message=(e?e+": ":"")+r,c&&(this.identifier=c),t!=null&&t.__line__&&(this.line=t.__line__)};function tt(e){var t=e.value;return t?[new Le(e.key,t,"constants have been deprecated as of v8")]:[]}function rt(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];for(var c=0,f=t;c<f.length;c+=1){var g=f[c];for(var w in g)e[w]=g[w]}return e}function Mt(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Wt(e){if(Array.isArray(e))return e.map(Wt);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){var t={};for(var r in e)t[r]=Wt(e[r]);return t}return Mt(e)}var ft=function(e){function t(r,c){e.call(this,c),this.message=c,this.key=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(Error),Dt=function(e,t){t===void 0&&(t=[]),this.parent=e,this.bindings={};for(var r=0,c=t;r<c.length;r+=1){var f=c[r];this.bindings[f[0]]=f[1]}};Dt.prototype.concat=function(e){return new Dt(this,e)},Dt.prototype.get=function(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(e+" not found in scope.")},Dt.prototype.has=function(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)};var ai={kind:"null"},dt={kind:"number"},Zt={kind:"string"},ii={kind:"boolean"},ri={kind:"color"},ki={kind:"object"},si={kind:"value"},Gi={kind:"collator"},$i={kind:"formatted"},dr={kind:"resolvedImage"};function Vi(e,t){return{kind:"array",itemType:e,N:t}}function Ki(e){if(e.kind==="array"){var t=Ki(e.itemType);return typeof e.N=="number"?"array<"+t+", "+e.N+">":e.itemType.kind==="value"?"array":"array<"+t+">"}return e.kind}var un=[ai,dt,Zt,ii,ri,$i,ki,Vi(si),dr];function _r(e,t){if(t.kind==="error")return null;if(e.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!_r(e.itemType,t.itemType))&&(typeof e.N!="number"||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if(e.kind==="value"){for(var r=0,c=un;r<c.length;r+=1)if(!_r(c[r],t))return null}}return"Expected "+Ki(e)+" but found "+Ki(t)+" instead."}function hn(e,t){return t.some(function(r){return r.kind===e.kind})}function jr(e,t){return t.some(function(r){return r==="null"?e===null:r==="array"?Array.isArray(e):r==="object"?e&&!Array.isArray(e)&&typeof e=="object":r===typeof e})}var cr=K(function(e,t){var r={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(E){return(E=Math.round(E))<0?0:E>255?255:E}function f(E){return c(E[E.length-1]==="%"?parseFloat(E)/100*255:parseInt(E))}function g(E){return(N=E[E.length-1]==="%"?parseFloat(E)/100:parseFloat(E))<0?0:N>1?1:N;var N}function w(E,N,V){return V<0?V+=1:V>1&&(V-=1),6*V<1?E+(N-E)*V*6:2*V<1?N:3*V<2?E+(N-E)*(2/3-V)*6:E}try{t.parseCSSColor=function(E){var N,V=E.replace(/ /g,"").toLowerCase();if(V in r)return r[V].slice();if(V[0]==="#")return V.length===4?(N=parseInt(V.substr(1),16))>=0&&N<=4095?[(3840&N)>>4|(3840&N)>>8,240&N|(240&N)>>4,15&N|(15&N)<<4,1]:null:V.length===7&&(N=parseInt(V.substr(1),16))>=0&&N<=16777215?[(16711680&N)>>16,(65280&N)>>8,255&N,1]:null;var J=V.indexOf("("),ee=V.indexOf(")");if(J!==-1&&ee+1===V.length){var he=V.substr(0,J),fe=V.substr(J+1,ee-(J+1)).split(","),Te=1;switch(he){case"rgba":if(fe.length!==4)return null;Te=g(fe.pop());case"rgb":return fe.length!==3?null:[f(fe[0]),f(fe[1]),f(fe[2]),Te];case"hsla":if(fe.length!==4)return null;Te=g(fe.pop());case"hsl":if(fe.length!==3)return null;var Se=(parseFloat(fe[0])%360+360)%360/360,We=g(fe[1]),De=g(fe[2]),et=De<=.5?De*(We+1):De+We-De*We,ut=2*De-et;return[c(255*w(ut,et,Se+1/3)),c(255*w(ut,et,Se)),c(255*w(ut,et,Se-1/3)),Te];default:return null}}return null}}catch(E){}}).parseCSSColor,Ei=function(e,t,r,c){c===void 0&&(c=1),this.r=e,this.g=t,this.b=r,this.a=c};Ei.parse=function(e){if(e){if(e instanceof Ei)return e;if(typeof e=="string"){var t=cr(e);if(t)return new Ei(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3])}}},Ei.prototype.toString=function(){var e=this.toArray(),t=e[1],r=e[2],c=e[3];return"rgba("+Math.round(e[0])+","+Math.round(t)+","+Math.round(r)+","+c+")"},Ei.prototype.toArray=function(){var e=this.a;return e===0?[0,0,0,0]:[255*this.r/e,255*this.g/e,255*this.b/e,e]},Ei.black=new Ei(0,0,0,1),Ei.white=new Ei(1,1,1,1),Ei.transparent=new Ei(0,0,0,0),Ei.red=new Ei(1,0,0,1);var Dn=function(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})};Dn.prototype.compare=function(e,t){return this.collator.compare(e,t)},Dn.prototype.resolvedLocale=function(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale};var Rn=function(e,t,r,c,f){this.text=e,this.image=t,this.scale=r,this.fontStack=c,this.textColor=f},Hr=function(e){this.sections=e};Hr.fromString=function(e){return new Hr([new Rn(e,null,null,null,null)])},Hr.prototype.isEmpty=function(){return this.sections.length===0||!this.sections.some(function(e){return e.text.length!==0||e.image&&e.image.name.length!==0})},Hr.factory=function(e){return e instanceof Hr?e:Hr.fromString(e)},Hr.prototype.toString=function(){return this.sections.length===0?"":this.sections.map(function(e){return e.text}).join("")},Hr.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var c=r[t];if(c.image)e.push(["image",c.image.name]);else{e.push(c.text);var f={};c.fontStack&&(f["text-font"]=["literal",c.fontStack.split(",")]),c.scale&&(f["font-scale"]=c.scale),c.textColor&&(f["text-color"]=["rgba"].concat(c.textColor.toArray())),e.push(f)}}return e};var Ln=function(e){this.name=e.name,this.available=e.available};function ja(e,t,r,c){return typeof e=="number"&&e>=0&&e<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof r=="number"&&r>=0&&r<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:"Invalid rgba value ["+[e,t,r,c].join(", ")+"]: 'a' must be between 0 and 1.":"Invalid rgba value ["+(typeof c=="number"?[e,t,r,c]:[e,t,r]).join(", ")+"]: 'r', 'g', and 'b' must be between 0 and 255."}function Ta(e){if(e===null||typeof e=="string"||typeof e=="boolean"||typeof e=="number"||e instanceof Ei||e instanceof Dn||e instanceof Hr||e instanceof Ln)return!0;if(Array.isArray(e)){for(var t=0,r=e;t<r.length;t+=1)if(!Ta(r[t]))return!1;return!0}if(typeof e=="object"){for(var c in e)if(!Ta(e[c]))return!1;return!0}return!1}function gr(e){if(e===null)return ai;if(typeof e=="string")return Zt;if(typeof e=="boolean")return ii;if(typeof e=="number")return dt;if(e instanceof Ei)return ri;if(e instanceof Dn)return Gi;if(e instanceof Hr)return $i;if(e instanceof Ln)return dr;if(Array.isArray(e)){for(var t,r=e.length,c=0,f=e;c<f.length;c+=1){var g=gr(f[c]);if(t){if(t===g)continue;t=si;break}t=g}return Vi(t||si,r)}return ki}function jo(e){var t=typeof e;return e===null?"":t==="string"||t==="number"||t==="boolean"?String(e):e instanceof Ei||e instanceof Hr||e instanceof Ln?e.toString():JSON.stringify(e)}Ln.prototype.toString=function(){return this.name},Ln.fromString=function(e){return e?new Ln({name:e,available:!1}):null},Ln.prototype.serialize=function(){return["image",this.name]};var gn=function(e,t){this.type=e,this.value=t};gn.parse=function(e,t){if(e.length!==2)return t.error("'literal' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(!Ta(e[1]))return t.error("invalid value");var r=e[1],c=gr(r),f=t.expectedType;return c.kind!=="array"||c.N!==0||!f||f.kind!=="array"||typeof f.N=="number"&&f.N!==0||(c=f),new gn(c,r)},gn.prototype.evaluate=function(){return this.value},gn.prototype.eachChild=function(){},gn.prototype.outputDefined=function(){return!0},gn.prototype.serialize=function(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Ei?["rgba"].concat(this.value.toArray()):this.value instanceof Hr?this.value.serialize():this.value};var Ur=function(e){this.name="ExpressionEvaluationError",this.message=e};Ur.prototype.toJSON=function(){return this.message};var cn={string:Zt,number:dt,boolean:ii,object:ki},Ir=function(e,t){this.type=e,this.args=t};Ir.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r,c=1,f=e[0];if(f==="array"){var g,w;if(e.length>2){var E=e[1];if(typeof E!="string"||!(E in cn)||E==="object")return t.error('The item type argument of "array" must be one of string, number, boolean',1);g=cn[E],c++}else g=si;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);w=e[2],c++}r=Vi(g,w)}else r=cn[f];for(var N=[];c<e.length;c++){var V=t.parse(e[c],c,si);if(!V)return null;N.push(V)}return new Ir(r,N)},Ir.prototype.evaluate=function(e){for(var t=0;t<this.args.length;t++){var r=this.args[t].evaluate(e);if(!_r(this.type,gr(r)))return r;if(t===this.args.length-1)throw new Ur("Expected value to be of type "+Ki(this.type)+", but found "+Ki(gr(r))+" instead.")}return null},Ir.prototype.eachChild=function(e){this.args.forEach(e)},Ir.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Ir.prototype.serialize=function(){var e=this.type,t=[e.kind];if(e.kind==="array"){var r=e.itemType;if(r.kind==="string"||r.kind==="number"||r.kind==="boolean"){t.push(r.kind);var c=e.N;(typeof c=="number"||this.args.length>1)&&t.push(c)}}return t.concat(this.args.map(function(f){return f.serialize()}))};var Wn=function(e){this.type=$i,this.sections=e};Wn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[1];if(!Array.isArray(r)&&typeof r=="object")return t.error("First argument must be an image or text section.");for(var c=[],f=!1,g=1;g<=e.length-1;++g){var w=e[g];if(f&&typeof w=="object"&&!Array.isArray(w)){f=!1;var E=null;if(w["font-scale"]&&!(E=t.parse(w["font-scale"],1,dt)))return null;var N=null;if(w["text-font"]&&!(N=t.parse(w["text-font"],1,Vi(Zt))))return null;var V=null;if(w["text-color"]&&!(V=t.parse(w["text-color"],1,ri)))return null;var J=c[c.length-1];J.scale=E,J.font=N,J.textColor=V}else{var ee=t.parse(e[g],1,si);if(!ee)return null;var he=ee.type.kind;if(he!=="string"&&he!=="value"&&he!=="null"&&he!=="resolvedImage")return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,c.push({content:ee,scale:null,font:null,textColor:null})}}return new Wn(c)},Wn.prototype.evaluate=function(e){return new Hr(this.sections.map(function(t){var r=t.content.evaluate(e);return gr(r)===dr?new Rn("",r,null,null,null):new Rn(jo(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)}))},Wn.prototype.eachChild=function(e){for(var t=0,r=this.sections;t<r.length;t+=1){var c=r[t];e(c.content),c.scale&&e(c.scale),c.font&&e(c.font),c.textColor&&e(c.textColor)}},Wn.prototype.outputDefined=function(){return!1},Wn.prototype.serialize=function(){for(var e=["format"],t=0,r=this.sections;t<r.length;t+=1){var c=r[t];e.push(c.content.serialize());var f={};c.scale&&(f["font-scale"]=c.scale.serialize()),c.font&&(f["text-font"]=c.font.serialize()),c.textColor&&(f["text-color"]=c.textColor.serialize()),e.push(f)}return e};var yn=function(e){this.type=dr,this.input=e};yn.parse=function(e,t){if(e.length!==2)return t.error("Expected two arguments.");var r=t.parse(e[1],1,Zt);return r?new yn(r):t.error("No image name provided.")},yn.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=Ln.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r},yn.prototype.eachChild=function(e){e(this.input)},yn.prototype.outputDefined=function(){return!1},yn.prototype.serialize=function(){return["image",this.input.serialize()]};var Sa={"to-boolean":ii,"to-color":ri,"to-number":dt,"to-string":Zt},Zn=function(e,t){this.type=e,this.args=t};Zn.parse=function(e,t){if(e.length<2)return t.error("Expected at least one argument.");var r=e[0];if((r==="to-boolean"||r==="to-string")&&e.length!==2)return t.error("Expected one argument.");for(var c=Sa[r],f=[],g=1;g<e.length;g++){var w=t.parse(e[g],g,si);if(!w)return null;f.push(w)}return new Zn(c,f)},Zn.prototype.evaluate=function(e){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(e));if(this.type.kind==="color"){for(var t,r,c=0,f=this.args;c<f.length;c+=1){if(r=null,(t=f[c].evaluate(e))instanceof Ei)return t;if(typeof t=="string"){var g=e.parseColor(t);if(g)return g}else if(Array.isArray(t)&&!(r=t.length<3||t.length>4?"Invalid rbga value "+JSON.stringify(t)+": expected an array containing either three or four numeric values.":ja(t[0],t[1],t[2],t[3])))return new Ei(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Ur(r||"Could not parse color from value '"+(typeof t=="string"?t:String(JSON.stringify(t)))+"'")}if(this.type.kind==="number"){for(var w=null,E=0,N=this.args;E<N.length;E+=1){if((w=N[E].evaluate(e))===null)return 0;var V=Number(w);if(!isNaN(V))return V}throw new Ur("Could not convert "+JSON.stringify(w)+" to number.")}return this.type.kind==="formatted"?Hr.fromString(jo(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Ln.fromString(jo(this.args[0].evaluate(e))):jo(this.args[0].evaluate(e))},Zn.prototype.eachChild=function(e){this.args.forEach(e)},Zn.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},Zn.prototype.serialize=function(){if(this.type.kind==="formatted")return new Wn([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new yn(this.args[0]).serialize();var e=["to-"+this.type.kind];return this.eachChild(function(t){e.push(t.serialize())}),e};var Ps=["Unknown","Point","LineString","Polygon"],Yr=function(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null};Yr.prototype.id=function(){return this.feature&&"id"in this.feature?this.feature.id:null},Yr.prototype.geometryType=function(){return this.feature?typeof this.feature.type=="number"?Ps[this.feature.type]:this.feature.type:null},Yr.prototype.geometry=function(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null},Yr.prototype.canonicalID=function(){return this.canonical},Yr.prototype.properties=function(){return this.feature&&this.feature.properties||{}},Yr.prototype.parseColor=function(e){var t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Ei.parse(e)),t};var Qr=function(e,t,r,c){this.name=e,this.type=t,this._evaluate=r,this.args=c};Qr.prototype.evaluate=function(e){return this._evaluate(e,this.args)},Qr.prototype.eachChild=function(e){this.args.forEach(e)},Qr.prototype.outputDefined=function(){return!1},Qr.prototype.serialize=function(){return[this.name].concat(this.args.map(function(e){return e.serialize()}))},Qr.parse=function(e,t){var r,c=e[0],f=Qr.definitions[c];if(!f)return t.error('Unknown expression "'+c+'". If you wanted a literal array, use ["literal", [...]].',0);for(var g=Array.isArray(f)?f[0]:f.type,w=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=w.filter(function(Ri){var ci=Ri[0];return!Array.isArray(ci)||ci.length===e.length-1}),N=null,V=0,J=E;V<J.length;V+=1){var ee=J[V],he=ee[0],fe=ee[1];N=new Hn(t.registry,t.path,null,t.scope);for(var Te=[],Se=!1,We=1;We<e.length;We++){var De=e[We],et=Array.isArray(he)?he[We-1]:he.type,ut=N.parse(De,1+Te.length,et);if(!ut){Se=!0;break}Te.push(ut)}if(!Se)if(Array.isArray(he)&&he.length!==Te.length)N.error("Expected "+he.length+" arguments, but found "+Te.length+" instead.");else{for(var vt=0;vt<Te.length;vt++){var bt=Array.isArray(he)?he[vt]:he.type,Ot=Te[vt];N.concat(vt+1).checkSubtype(bt,Ot.type)}if(N.errors.length===0)return new Qr(c,g,fe,Te)}}if(E.length===1)(r=t.errors).push.apply(r,N.errors);else{for(var Vt=(E.length?E:w).map(function(Ri){var ci;return ci=Ri[0],Array.isArray(ci)?"("+ci.map(Ki).join(", ")+")":"("+Ki(ci.type)+"...)"}).join(" | "),oi=[],Mi=1;Mi<e.length;Mi++){var di=t.parse(e[Mi],1+oi.length);if(!di)return null;oi.push(Ki(di.type))}t.error("Expected arguments of type "+Vt+", but found ("+oi.join(", ")+") instead.")}return null},Qr.register=function(e,t){for(var r in Qr.definitions=t,t)e[r]=Qr};var zn=function(e,t,r){this.type=Gi,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t};function on(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function Co(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function ca(e,t){var r=(180+e[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(r*f*8192),Math.round(c*f*8192)]}function ao(e,t,r){return t[1]>e[1]!=r[1]>e[1]&&e[0]<(r[0]-t[0])*(e[1]-t[1])/(r[1]-t[1])+t[0]}function Ua(e,t){for(var r,c,f,g,w,E,N,V=!1,J=0,ee=t.length;J<ee;J++)for(var he=t[J],fe=0,Te=he.length;fe<Te-1;fe++){if((g=(r=e)[0]-(c=he[fe])[0])*(N=r[1]-(f=he[fe+1])[1])-(E=r[0]-f[0])*(w=r[1]-c[1])==0&&g*E<=0&&w*N<=0)return!1;ao(e,he[fe],he[fe+1])&&(V=!V)}return V}function as(e,t){for(var r=0;r<t.length;r++)if(Ua(e,t[r]))return!0;return!1}function Na(e,t,r,c){var f=c[0]-r[0],g=c[1]-r[1],w=(e[0]-r[0])*g-f*(e[1]-r[1]),E=(t[0]-r[0])*g-f*(t[1]-r[1]);return w>0&&E<0||w<0&&E>0}function pa(e,t,r){for(var c=0,f=r;c<f.length;c+=1)for(var g=f[c],w=0;w<g.length-1;++w)if((ee=[(J=g[w+1])[0]-(V=g[w])[0],J[1]-V[1]])[0]*(he=[(N=t)[0]-(E=e)[0],N[1]-E[1]])[1]-ee[1]*he[0]!=0&&Na(E,N,V,J)&&Na(V,J,E,N))return!0;var E,N,V,J,ee,he;return!1}function Ga(e,t){for(var r=0;r<e.length;++r)if(!Ua(e[r],t))return!1;for(var c=0;c<e.length-1;++c)if(pa(e[c],e[c+1],t))return!1;return!0}function Wa(e,t){for(var r=0;r<t.length;r++)if(Ga(e,t[r]))return!0;return!1}function ia(e,t,r){for(var c=[],f=0;f<e.length;f++){for(var g=[],w=0;w<e[f].length;w++){var E=ca(e[f][w],r);on(t,E),g.push(E)}c.push(g)}return c}function Uo(e,t,r){for(var c=[],f=0;f<e.length;f++){var g=ia(e[f],t,r);c.push(g)}return c}function ra(e,t,r,c){if(e[0]<r[0]||e[0]>r[2]){var f=.5*c,g=e[0]-r[0]>f?-c:r[0]-e[0]>f?c:0;g===0&&(g=e[0]-r[2]>f?-c:r[2]-e[0]>f?c:0),e[0]+=g}on(t,e)}function da(e,t,r,c){for(var f=8192*Math.pow(2,c.z),g=[8192*c.x,8192*c.y],w=[],E=0,N=e;E<N.length;E+=1)for(var V=0,J=N[E];V<J.length;V+=1){var ee=J[V],he=[ee.x+g[0],ee.y+g[1]];ra(he,t,r,f),w.push(he)}return w}function fa(e,t,r,c){for(var f,g=8192*Math.pow(2,c.z),w=[8192*c.x,8192*c.y],E=[],N=0,V=e;N<V.length;N+=1){for(var J=[],ee=0,he=V[N];ee<he.length;ee+=1){var fe=he[ee],Te=[fe.x+w[0],fe.y+w[1]];on(t,Te),J.push(Te)}E.push(J)}if(t[2]-t[0]<=g/2){(f=t)[0]=f[1]=1/0,f[2]=f[3]=-1/0;for(var Se=0,We=E;Se<We.length;Se+=1)for(var De=0,et=We[Se];De<et.length;De+=1)ra(et[De],t,r,g)}return E}zn.parse=function(e,t){if(e.length!==2)return t.error("Expected one argument.");var r=e[1];if(typeof r!="object"||Array.isArray(r))return t.error("Collator options argument must be an object.");var c=t.parse(r["case-sensitive"]!==void 0&&r["case-sensitive"],1,ii);if(!c)return null;var f=t.parse(r["diacritic-sensitive"]!==void 0&&r["diacritic-sensitive"],1,ii);if(!f)return null;var g=null;return r.locale&&!(g=t.parse(r.locale,1,Zt))?null:new zn(c,f,g)},zn.prototype.evaluate=function(e){return new Dn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)},zn.prototype.eachChild=function(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)},zn.prototype.outputDefined=function(){return!1},zn.prototype.serialize=function(){var e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]};var Vn=function(e,t){this.type=ii,this.geojson=e,this.geometries=t};function pn(e){if(e instanceof Qr&&(e.name==="get"&&e.args.length===1||e.name==="feature-state"||e.name==="has"&&e.args.length===1||e.name==="properties"||e.name==="geometry-type"||e.name==="id"||/^filter-/.test(e.name))||e instanceof Vn)return!1;var t=!0;return e.eachChild(function(r){t&&!pn(r)&&(t=!1)}),t}function Kn(e){if(e instanceof Qr&&e.name==="feature-state")return!1;var t=!0;return e.eachChild(function(r){t&&!Kn(r)&&(t=!1)}),t}function Ko(e,t){if(e instanceof Qr&&t.indexOf(e.name)>=0)return!1;var r=!0;return e.eachChild(function(c){r&&!Ko(c,t)&&(r=!1)}),r}Vn.parse=function(e,t){if(e.length!==2)return t.error("'within' expression requires exactly one argument, but found "+(e.length-1)+" instead.");if(Ta(e[1])){var r=e[1];if(r.type==="FeatureCollection")for(var c=0;c<r.features.length;++c){var f=r.features[c].geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Vn(r,r.features[c].geometry)}else if(r.type==="Feature"){var g=r.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Vn(r,r.geometry)}else if(r.type==="Polygon"||r.type==="MultiPolygon")return new Vn(r,r)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")},Vn.prototype.evaluate=function(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(t,r){var c=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var w=ia(r.coordinates,f,g),E=da(t.geometry(),c,f,g);if(!Co(c,f))return!1;for(var N=0,V=E;N<V.length;N+=1)if(!Ua(V[N],w))return!1}if(r.type==="MultiPolygon"){var J=Uo(r.coordinates,f,g),ee=da(t.geometry(),c,f,g);if(!Co(c,f))return!1;for(var he=0,fe=ee;he<fe.length;he+=1)if(!as(fe[he],J))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(t,r){var c=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],g=t.canonicalID();if(r.type==="Polygon"){var w=ia(r.coordinates,f,g),E=fa(t.geometry(),c,f,g);if(!Co(c,f))return!1;for(var N=0,V=E;N<V.length;N+=1)if(!Ga(V[N],w))return!1}if(r.type==="MultiPolygon"){var J=Uo(r.coordinates,f,g),ee=fa(t.geometry(),c,f,g);if(!Co(c,f))return!1;for(var he=0,fe=ee;he<fe.length;he+=1)if(!Wa(fe[he],J))return!1}return!0}(e,this.geometries)}return!1},Vn.prototype.eachChild=function(){},Vn.prototype.outputDefined=function(){return!0},Vn.prototype.serialize=function(){return["within",this.geojson]};var Eo=function(e,t){this.type=t.type,this.name=e,this.boundExpression=t};Eo.parse=function(e,t){if(e.length!==2||typeof e[1]!="string")return t.error("'var' expression requires exactly one string literal argument.");var r=e[1];return t.scope.has(r)?new Eo(r,t.scope.get(r)):t.error('Unknown variable "'+r+'". Make sure "'+r+'" has been bound in an enclosing "let" expression before using it.',1)},Eo.prototype.evaluate=function(e){return this.boundExpression.evaluate(e)},Eo.prototype.eachChild=function(){},Eo.prototype.outputDefined=function(){return!1},Eo.prototype.serialize=function(){return["var",this.name]};var Hn=function(e,t,r,c,f){t===void 0&&(t=[]),c===void 0&&(c=new Dt),f===void 0&&(f=[]),this.registry=e,this.path=t,this.key=t.map(function(g){return"["+g+"]"}).join(""),this.scope=c,this.errors=f,this.expectedType=r};function qn(e,t){for(var r,c=e.length-1,f=0,g=c,w=0;f<=g;)if((r=e[w=Math.floor((f+g)/2)])<=t){if(w===c||t<e[w+1])return w;f=w+1}else{if(!(r>t))throw new Ur("Input is not a number.");g=w-1}return 0}Hn.prototype.parse=function(e,t,r,c,f){return f===void 0&&(f={}),t?this.concat(t,r,c)._parse(e,f):this._parse(e,f)},Hn.prototype._parse=function(e,t){function r(V,J,ee){return ee==="assert"?new Ir(J,[V]):ee==="coerce"?new Zn(J,[V]):V}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');var c=e[0];if(typeof c!="string")return this.error("Expression name must be a string, but found "+typeof c+' instead. If you wanted a literal array, use ["literal", [...]].',0),null;var f=this.registry[c];if(f){var g=f.parse(e,this);if(!g)return null;if(this.expectedType){var w=this.expectedType,E=g.type;if(w.kind!=="string"&&w.kind!=="number"&&w.kind!=="boolean"&&w.kind!=="object"&&w.kind!=="array"||E.kind!=="value")if(w.kind!=="color"&&w.kind!=="formatted"&&w.kind!=="resolvedImage"||E.kind!=="value"&&E.kind!=="string"){if(this.checkSubtype(w,E))return null}else g=r(g,w,t.typeAnnotation||"coerce");else g=r(g,w,t.typeAnnotation||"assert")}if(!(g instanceof gn)&&g.type.kind!=="resolvedImage"&&function V(J){if(J instanceof Eo)return V(J.boundExpression);if(J instanceof Qr&&J.name==="error"||J instanceof zn||J instanceof Vn)return!1;var ee=J instanceof Zn||J instanceof Ir,he=!0;return J.eachChild(function(fe){he=ee?he&&V(fe):he&&fe instanceof gn}),!!he&&pn(J)&&Ko(J,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}(g)){var N=new Yr;try{g=new gn(g.type,g.evaluate(N))}catch(V){return this.error(V.message),null}}return g}return this.error('Unknown expression "'+c+'". If you wanted a literal array, use ["literal", [...]].',0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':"Expected an array, but found "+typeof e+" instead.")},Hn.prototype.concat=function(e,t,r){var c=typeof e=="number"?this.path.concat(e):this.path,f=r?this.scope.concat(r):this.scope;return new Hn(this.registry,c,t||null,f,this.errors)},Hn.prototype.error=function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];var c=""+this.key+t.map(function(f){return"["+f+"]"}).join("");this.errors.push(new ft(c,e))},Hn.prototype.checkSubtype=function(e,t){var r=_r(e,t);return r&&this.error(r),r};var Mr=function(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(var c=0,f=r;c<f.length;c+=1){var g=f[c],w=g[1];this.labels.push(g[0]),this.outputs.push(w)}};function qr(e,t,r){return e*(1-r)+t*r}Mr.parse=function(e,t){if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");var r=t.parse(e[1],1,dt);if(!r)return null;var c=[],f=null;t.expectedType&&t.expectedType.kind!=="value"&&(f=t.expectedType);for(var g=1;g<e.length;g+=2){var w=g===1?-1/0:e[g],E=e[g+1],N=g,V=g+1;if(typeof w!="number")return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',N);if(c.length&&c[c.length-1][0]>=w)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',N);var J=t.parse(E,V,f);if(!J)return null;f=f||J.type,c.push([w,J])}return new Mr(f,r,c)},Mr.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var c=this.input.evaluate(e);if(c<=t[0])return r[0].evaluate(e);var f=t.length;return c>=t[f-1]?r[f-1].evaluate(e):r[qn(t,c)].evaluate(e)},Mr.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},Mr.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},Mr.prototype.serialize=function(){for(var e=["step",this.input.serialize()],t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e};var Ho=Object.freeze({__proto__:null,number:qr,color:function(e,t,r){return new Ei(qr(e.r,t.r,r),qr(e.g,t.g,r),qr(e.b,t.b,r),qr(e.a,t.a,r))},array:function(e,t,r){return e.map(function(c,f){return qr(c,t[f],r)})}}),No=6/29*3*(6/29),_a=Math.PI/180,Ca=180/Math.PI;function ma(e){return e>.008856451679035631?Math.pow(e,1/3):e/No+4/29}function Za(e){return e>6/29?e*e*e:No*(e-4/29)}function so(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function na(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Va(e){var t=na(e.r),r=na(e.g),c=na(e.b),f=ma((.4124564*t+.3575761*r+.1804375*c)/.95047),g=ma((.2126729*t+.7151522*r+.072175*c)/1);return{l:116*g-16,a:500*(f-g),b:200*(g-ma((.0193339*t+.119192*r+.9503041*c)/1.08883)),alpha:e.a}}function Ea(e){var t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,c=isNaN(e.b)?t:t-e.b/200;return t=1*Za(t),r=.95047*Za(r),c=1.08883*Za(c),new Ei(so(3.2404542*r-1.5371385*t-.4985314*c),so(-.969266*r+1.8760108*t+.041556*c),so(.0556434*r-.2040259*t+1.0572252*c),e.alpha)}function Ds(e,t,r){var c=t-e;return e+r*(c>180||c<-180?c-360*Math.round(c/360):c)}var Oo={forward:Va,reverse:Ea,interpolate:function(e,t,r){return{l:qr(e.l,t.l,r),a:qr(e.a,t.a,r),b:qr(e.b,t.b,r),alpha:qr(e.alpha,t.alpha,r)}}},ga={forward:function(e){var t=Va(e),r=t.l,c=t.a,f=t.b,g=Math.atan2(f,c)*Ca;return{h:g<0?g+360:g,c:Math.sqrt(c*c+f*f),l:r,alpha:e.a}},reverse:function(e){var t=e.h*_a,r=e.c;return Ea({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:Ds(e.h,t.h,r),c:qr(e.c,t.c,r),l:qr(e.l,t.l,r),alpha:qr(e.alpha,t.alpha,r)}}},Ka=Object.freeze({__proto__:null,lab:Oo,hcl:ga}),$r=function(e,t,r,c,f){this.type=e,this.operator=t,this.interpolation=r,this.input=c,this.labels=[],this.outputs=[];for(var g=0,w=f;g<w.length;g+=1){var E=w[g],N=E[1];this.labels.push(E[0]),this.outputs.push(N)}};function qo(e,t,r,c){var f=c-r,g=e-r;return f===0?0:t===1?g/f:(Math.pow(t,g)-1)/(Math.pow(t,f)-1)}$r.interpolationFactor=function(e,t,r,c){var f=0;if(e.name==="exponential")f=qo(t,e.base,r,c);else if(e.name==="linear")f=qo(t,1,r,c);else if(e.name==="cubic-bezier"){var g=e.controlPoints;f=new k(g[0],g[1],g[2],g[3]).solve(qo(t,1,r,c))}return f},$r.parse=function(e,t){var r=e[0],c=e[1],f=e[2],g=e.slice(3);if(!Array.isArray(c)||c.length===0)return t.error("Expected an interpolation type expression.",1);if(c[0]==="linear")c={name:"linear"};else if(c[0]==="exponential"){var w=c[1];if(typeof w!="number")return t.error("Exponential interpolation requires a numeric base.",1,1);c={name:"exponential",base:w}}else{if(c[0]!=="cubic-bezier")return t.error("Unknown interpolation type "+String(c[0]),1,0);var E=c.slice(1);if(E.length!==4||E.some(function(We){return typeof We!="number"||We<0||We>1}))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);c={name:"cubic-bezier",controlPoints:E}}if(e.length-1<4)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(!(f=t.parse(f,2,dt)))return null;var N=[],V=null;r==="interpolate-hcl"||r==="interpolate-lab"?V=ri:t.expectedType&&t.expectedType.kind!=="value"&&(V=t.expectedType);for(var J=0;J<g.length;J+=2){var ee=g[J],he=g[J+1],fe=J+3,Te=J+4;if(typeof ee!="number")return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',fe);if(N.length&&N[N.length-1][0]>=ee)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',fe);var Se=t.parse(he,Te,V);if(!Se)return null;V=V||Se.type,N.push([ee,Se])}return V.kind==="number"||V.kind==="color"||V.kind==="array"&&V.itemType.kind==="number"&&typeof V.N=="number"?new $r(V,r,c,f,N):t.error("Type "+Ki(V)+" is not interpolatable.")},$r.prototype.evaluate=function(e){var t=this.labels,r=this.outputs;if(t.length===1)return r[0].evaluate(e);var c=this.input.evaluate(e);if(c<=t[0])return r[0].evaluate(e);var f=t.length;if(c>=t[f-1])return r[f-1].evaluate(e);var g=qn(t,c),w=$r.interpolationFactor(this.interpolation,c,t[g],t[g+1]),E=r[g].evaluate(e),N=r[g+1].evaluate(e);return this.operator==="interpolate"?Ho[this.type.kind.toLowerCase()](E,N,w):this.operator==="interpolate-hcl"?ga.reverse(ga.interpolate(ga.forward(E),ga.forward(N),w)):Oo.reverse(Oo.interpolate(Oo.forward(E),Oo.forward(N),w))},$r.prototype.eachChild=function(e){e(this.input);for(var t=0,r=this.outputs;t<r.length;t+=1)e(r[t])},$r.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})},$r.prototype.serialize=function(){var e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);for(var t=[this.operator,e,this.input.serialize()],r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t};var io=function(e,t){this.type=e,this.args=t};io.parse=function(e,t){if(e.length<2)return t.error("Expectected at least one argument.");var r=null,c=t.expectedType;c&&c.kind!=="value"&&(r=c);for(var f=[],g=0,w=e.slice(1);g<w.length;g+=1){var E=t.parse(w[g],1+f.length,r,void 0,{typeAnnotation:"omit"});if(!E)return null;r=r||E.type,f.push(E)}var N=c&&f.some(function(V){return _r(c,V.type)});return new io(N?si:r,f)},io.prototype.evaluate=function(e){for(var t,r=null,c=0,f=0,g=this.args;f<g.length&&(c++,(r=g[f].evaluate(e))&&r instanceof Ln&&!r.available&&(t||(t=r.name),r=null,c===this.args.length&&(r=t)),r===null);f+=1);return r},io.prototype.eachChild=function(e){this.args.forEach(e)},io.prototype.outputDefined=function(){return this.args.every(function(e){return e.outputDefined()})},io.prototype.serialize=function(){var e=["coalesce"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Io=function(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t};Io.prototype.evaluate=function(e){return this.result.evaluate(e)},Io.prototype.eachChild=function(e){for(var t=0,r=this.bindings;t<r.length;t+=1)e(r[t][1]);e(this.result)},Io.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found "+(e.length-1)+" instead.");for(var r=[],c=1;c<e.length-1;c+=2){var f=e[c];if(typeof f!="string")return t.error("Expected string, but found "+typeof f+" instead.",c);if(/[^a-zA-Z0-9_]/.test(f))return t.error("Variable names must contain only alphanumeric characters or '_'.",c);var g=t.parse(e[c+1],c+1);if(!g)return null;r.push([f,g])}var w=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return w?new Io(r,w):null},Io.prototype.outputDefined=function(){return this.result.outputDefined()},Io.prototype.serialize=function(){for(var e=["let"],t=0,r=this.bindings;t<r.length;t+=1){var c=r[t];e.push(c[0],c[1].serialize())}return e.push(this.result.serialize()),e};var po=function(e,t,r){this.type=e,this.index=t,this.input=r};po.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,dt),c=t.parse(e[2],2,Vi(t.expectedType||si));return r&&c?new po(c.type.itemType,r,c):null},po.prototype.evaluate=function(e){var t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Ur("Array index out of bounds: "+t+" < 0.");if(t>=r.length)throw new Ur("Array index out of bounds: "+t+" > "+(r.length-1)+".");if(t!==Math.floor(t))throw new Ur("Array index must be an integer, but found "+t+" instead.");return r[t]},po.prototype.eachChild=function(e){e(this.index),e(this.input)},po.prototype.outputDefined=function(){return!1},po.prototype.serialize=function(){return["at",this.index.serialize(),this.input.serialize()]};var Jo=function(e,t){this.type=ii,this.needle=e,this.haystack=t};Jo.parse=function(e,t){if(e.length!==3)return t.error("Expected 2 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,si),c=t.parse(e[2],2,si);return r&&c?hn(r.type,[ii,Zt,dt,ai,si])?new Jo(r,c):t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ki(r.type)+" instead"):null},Jo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!r)return!1;if(!jr(t,["boolean","string","number","null"]))throw new Ur("Expected first argument to be of type boolean, string, number or null, but found "+Ki(gr(t))+" instead.");if(!jr(r,["string","array"]))throw new Ur("Expected second argument to be of type array or string, but found "+Ki(gr(r))+" instead.");return r.indexOf(t)>=0},Jo.prototype.eachChild=function(e){e(this.needle),e(this.haystack)},Jo.prototype.outputDefined=function(){return!0},Jo.prototype.serialize=function(){return["in",this.needle.serialize(),this.haystack.serialize()]};var fo=function(e,t,r){this.type=dt,this.needle=e,this.haystack=t,this.fromIndex=r};fo.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,si),c=t.parse(e[2],2,si);if(!r||!c)return null;if(!hn(r.type,[ii,Zt,dt,ai,si]))return t.error("Expected first argument to be of type boolean, string, number or null, but found "+Ki(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,dt);return f?new fo(r,c,f):null}return new fo(r,c)},fo.prototype.evaluate=function(e){var t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!jr(t,["boolean","string","number","null"]))throw new Ur("Expected first argument to be of type boolean, string, number or null, but found "+Ki(gr(t))+" instead.");if(!jr(r,["string","array"]))throw new Ur("Expected second argument to be of type array or string, but found "+Ki(gr(r))+" instead.");if(this.fromIndex){var c=this.fromIndex.evaluate(e);return r.indexOf(t,c)}return r.indexOf(t)},fo.prototype.eachChild=function(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)},fo.prototype.outputDefined=function(){return!1},fo.prototype.serialize=function(){if(this.fromIndex!=null&&this.fromIndex!==void 0){var e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]};var Lo=function(e,t,r,c,f,g){this.inputType=e,this.type=t,this.input=r,this.cases=c,this.outputs=f,this.otherwise=g};Lo.parse=function(e,t){if(e.length<5)return t.error("Expected at least 4 arguments, but found only "+(e.length-1)+".");if(e.length%2!=1)return t.error("Expected an even number of arguments.");var r,c;t.expectedType&&t.expectedType.kind!=="value"&&(c=t.expectedType);for(var f={},g=[],w=2;w<e.length-1;w+=2){var E=e[w],N=e[w+1];Array.isArray(E)||(E=[E]);var V=t.concat(w);if(E.length===0)return V.error("Expected at least one branch label.");for(var J=0,ee=E;J<ee.length;J+=1){var he=ee[J];if(typeof he!="number"&&typeof he!="string")return V.error("Branch labels must be numbers or strings.");if(typeof he=="number"&&Math.abs(he)>Number.MAX_SAFE_INTEGER)return V.error("Branch labels must be integers no larger than "+Number.MAX_SAFE_INTEGER+".");if(typeof he=="number"&&Math.floor(he)!==he)return V.error("Numeric branch labels must be integer values.");if(r){if(V.checkSubtype(r,gr(he)))return null}else r=gr(he);if(f[String(he)]!==void 0)return V.error("Branch labels must be unique.");f[String(he)]=g.length}var fe=t.parse(N,w,c);if(!fe)return null;c=c||fe.type,g.push(fe)}var Te=t.parse(e[1],1,si);if(!Te)return null;var Se=t.parse(e[e.length-1],e.length-1,c);return Se?Te.type.kind!=="value"&&t.concat(1).checkSubtype(r,Te.type)?null:new Lo(r,c,Te,f,g,Se):null},Lo.prototype.evaluate=function(e){var t=this.input.evaluate(e);return(gr(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)},Lo.prototype.eachChild=function(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)},Lo.prototype.outputDefined=function(){return this.outputs.every(function(e){return e.outputDefined()})&&this.otherwise.outputDefined()},Lo.prototype.serialize=function(){for(var e=this,t=["match",this.input.serialize()],r=[],c={},f=0,g=Object.keys(this.cases).sort();f<g.length;f+=1){var w=g[f];(ee=c[this.cases[w]])===void 0?(c[this.cases[w]]=r.length,r.push([this.cases[w],[w]])):r[ee][1].push(w)}for(var E=function(fe){return e.inputType.kind==="number"?Number(fe):fe},N=0,V=r;N<V.length;N+=1){var J=V[N],ee=J[0],he=J[1];t.push(he.length===1?E(he[0]):he.map(E)),t.push(this.outputs[outputIndex$1].serialize())}return t.push(this.otherwise.serialize()),t};var Go=function(e,t,r){this.type=e,this.branches=t,this.otherwise=r};Go.parse=function(e,t){if(e.length<4)return t.error("Expected at least 3 arguments, but found only "+(e.length-1)+".");if(e.length%2!=0)return t.error("Expected an odd number of arguments.");var r;t.expectedType&&t.expectedType.kind!=="value"&&(r=t.expectedType);for(var c=[],f=1;f<e.length-1;f+=2){var g=t.parse(e[f],f,ii);if(!g)return null;var w=t.parse(e[f+1],f+1,r);if(!w)return null;c.push([g,w]),r=r||w.type}var E=t.parse(e[e.length-1],e.length-1,r);return E?new Go(r,c,E):null},Go.prototype.evaluate=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var c=r[t],f=c[1];if(c[0].evaluate(e))return f.evaluate(e)}return this.otherwise.evaluate(e)},Go.prototype.eachChild=function(e){for(var t=0,r=this.branches;t<r.length;t+=1){var c=r[t],f=c[1];e(c[0]),e(f)}e(this.otherwise)},Go.prototype.outputDefined=function(){return this.branches.every(function(e){return e[1].outputDefined()})&&this.otherwise.outputDefined()},Go.prototype.serialize=function(){var e=["case"];return this.eachChild(function(t){e.push(t.serialize())}),e};var ko=function(e,t,r,c){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=c};function O(e,t){return e==="=="||e==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function l(e,t,r,c){return c.compare(t,r)===0}function i(e,t,r){var c=e!=="=="&&e!=="!=";return function(){function f(g,w,E){this.type=ii,this.lhs=g,this.rhs=w,this.collator=E,this.hasUntypedArgument=g.type.kind==="value"||w.type.kind==="value"}return f.parse=function(g,w){if(g.length!==3&&g.length!==4)return w.error("Expected two or three arguments.");var E=g[0],N=w.parse(g[1],1,si);if(!N)return null;if(!O(E,N.type))return w.concat(1).error('"'+E+`" comparisons are not supported for type '`+Ki(N.type)+"'.");var V=w.parse(g[2],2,si);if(!V)return null;if(!O(E,V.type))return w.concat(2).error('"'+E+`" comparisons are not supported for type '`+Ki(V.type)+"'.");if(N.type.kind!==V.type.kind&&N.type.kind!=="value"&&V.type.kind!=="value")return w.error("Cannot compare types '"+Ki(N.type)+"' and '"+Ki(V.type)+"'.");c&&(N.type.kind==="value"&&V.type.kind!=="value"?N=new Ir(V.type,[N]):N.type.kind!=="value"&&V.type.kind==="value"&&(V=new Ir(N.type,[V])));var J=null;if(g.length===4){if(N.type.kind!=="string"&&V.type.kind!=="string"&&N.type.kind!=="value"&&V.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(!(J=w.parse(g[3],3,Gi)))return null}return new f(N,V,J)},f.prototype.evaluate=function(g){var w=this.lhs.evaluate(g),E=this.rhs.evaluate(g);if(c&&this.hasUntypedArgument){var N=gr(w),V=gr(E);if(N.kind!==V.kind||N.kind!=="string"&&N.kind!=="number")throw new Ur('Expected arguments for "'+e+'" to be (string, string) or (number, number), but found ('+N.kind+", "+V.kind+") instead.")}if(this.collator&&!c&&this.hasUntypedArgument){var J=gr(w),ee=gr(E);if(J.kind!=="string"||ee.kind!=="string")return t(g,w,E)}return this.collator?r(g,w,E,this.collator.evaluate(g)):t(g,w,E)},f.prototype.eachChild=function(g){g(this.lhs),g(this.rhs),this.collator&&g(this.collator)},f.prototype.outputDefined=function(){return!0},f.prototype.serialize=function(){var g=[e];return this.eachChild(function(w){g.push(w.serialize())}),g},f}()}ko.parse=function(e,t){if(e.length<=2||e.length>=5)return t.error("Expected 3 or 4 arguments, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1,si),c=t.parse(e[2],2,dt);if(!r||!c)return null;if(!hn(r.type,[Vi(si),Zt,si]))return t.error("Expected first argument to be of type array or string, but found "+Ki(r.type)+" instead");if(e.length===4){var f=t.parse(e[3],3,dt);return f?new ko(r.type,r,c,f):null}return new ko(r.type,r,c)},ko.prototype.evaluate=function(e){var t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!jr(t,["string","array"]))throw new Ur("Expected first argument to be of type array or string, but found "+Ki(gr(t))+" instead.");if(this.endIndex){var c=this.endIndex.evaluate(e);return t.slice(r,c)}return t.slice(r)},ko.prototype.eachChild=function(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)},ko.prototype.outputDefined=function(){return!1},ko.prototype.serialize=function(){if(this.endIndex!=null&&this.endIndex!==void 0){var e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]};var s=i("==",function(e,t,r){return t===r},l),_=i("!=",function(e,t,r){return t!==r},function(e,t,r,c){return!l(0,t,r,c)}),b=i("<",function(e,t,r){return t<r},function(e,t,r,c){return c.compare(t,r)<0}),D=i(">",function(e,t,r){return t>r},function(e,t,r,c){return c.compare(t,r)>0}),G=i("<=",function(e,t,r){return t<=r},function(e,t,r,c){return c.compare(t,r)<=0}),Z=i(">=",function(e,t,r){return t>=r},function(e,t,r,c){return c.compare(t,r)>=0}),te=function(e,t,r,c,f){this.type=Zt,this.number=e,this.locale=t,this.currency=r,this.minFractionDigits=c,this.maxFractionDigits=f};te.parse=function(e,t){if(e.length!==3)return t.error("Expected two arguments.");var r=t.parse(e[1],1,dt);if(!r)return null;var c=e[2];if(typeof c!="object"||Array.isArray(c))return t.error("NumberFormat options argument must be an object.");var f=null;if(c.locale&&!(f=t.parse(c.locale,1,Zt)))return null;var g=null;if(c.currency&&!(g=t.parse(c.currency,1,Zt)))return null;var w=null;if(c["min-fraction-digits"]&&!(w=t.parse(c["min-fraction-digits"],1,dt)))return null;var E=null;return c["max-fraction-digits"]&&!(E=t.parse(c["max-fraction-digits"],1,dt))?null:new te(r,f,g,w,E)},te.prototype.evaluate=function(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))},te.prototype.eachChild=function(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)},te.prototype.outputDefined=function(){return!1},te.prototype.serialize=function(){var e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]};var ae=function(e){this.type=dt,this.input=e};ae.parse=function(e,t){if(e.length!==2)return t.error("Expected 1 argument, but found "+(e.length-1)+" instead.");var r=t.parse(e[1],1);return r?r.type.kind!=="array"&&r.type.kind!=="string"&&r.type.kind!=="value"?t.error("Expected argument of type string or array, but found "+Ki(r.type)+" instead."):new ae(r):null},ae.prototype.evaluate=function(e){var t=this.input.evaluate(e);if(typeof t=="string"||Array.isArray(t))return t.length;throw new Ur("Expected value to be of type string or array, but found "+Ki(gr(t))+" instead.")},ae.prototype.eachChild=function(e){e(this.input)},ae.prototype.outputDefined=function(){return!1},ae.prototype.serialize=function(){var e=["length"];return this.eachChild(function(t){e.push(t.serialize())}),e};var Pe={"==":s,"!=":_,">":D,"<":b,">=":Z,"<=":G,array:Ir,at:po,boolean:Ir,case:Go,coalesce:io,collator:zn,format:Wn,image:yn,in:Jo,"index-of":fo,interpolate:$r,"interpolate-hcl":$r,"interpolate-lab":$r,length:ae,let:Io,literal:gn,match:Lo,number:Ir,"number-format":te,object:Ir,slice:ko,step:Mr,string:Ir,"to-boolean":Zn,"to-color":Zn,"to-number":Zn,"to-string":Zn,var:Eo,within:Vn};function ve(e,t){var r=t[0],c=t[1],f=t[2],g=t[3];r=r.evaluate(e),c=c.evaluate(e),f=f.evaluate(e);var w=g?g.evaluate(e):1,E=ja(r,c,f,w);if(E)throw new Ur(E);return new Ei(r/255*w,c/255*w,f/255*w,w)}function pe(e,t){return e in t}function Fe(e,t){var r=t[e];return r===void 0?null:r}function ke(e){return{type:e}}function Ze(e){return{result:"success",value:e}}function at(e){return{result:"error",value:e}}function Ve(e){return e["property-type"]==="data-driven"||e["property-type"]==="cross-faded-data-driven"}function st(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Pt(e){return!!e.expression&&e.expression.interpolated}function $e(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":e===null?"null":typeof e}function Ct(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function At(e){return e}function qe(e,t,r){return e!==void 0?e:t!==void 0?t:r!==void 0?r:void 0}function nt(e,t,r,c,f){return qe(typeof r===f?c[r]:void 0,e.default,t.default)}function Xe(e,t,r){if($e(r)!=="number")return qe(e.default,t.default);var c=e.stops.length;if(c===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[c-1][0])return e.stops[c-1][1];var f=qn(e.stops.map(function(g){return g[0]}),r);return e.stops[f][1]}function It(e,t,r){var c=e.base!==void 0?e.base:1;if($e(r)!=="number")return qe(e.default,t.default);var f=e.stops.length;if(f===1||r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[f-1][0])return e.stops[f-1][1];var g=qn(e.stops.map(function(ee){return ee[0]}),r),w=function(ee,he,fe,Te){var Se=Te-fe,We=ee-fe;return Se===0?0:he===1?We/Se:(Math.pow(he,We)-1)/(Math.pow(he,Se)-1)}(r,c,e.stops[g][0],e.stops[g+1][0]),E=e.stops[g][1],N=e.stops[g+1][1],V=Ho[t.type]||At;if(e.colorSpace&&e.colorSpace!=="rgb"){var J=Ka[e.colorSpace];V=function(ee,he){return J.reverse(J.interpolate(J.forward(ee),J.forward(he),w))}}return typeof E.evaluate=="function"?{evaluate:function(){for(var ee=[],he=arguments.length;he--;)ee[he]=arguments[he];var fe=E.evaluate.apply(void 0,ee),Te=N.evaluate.apply(void 0,ee);if(fe!==void 0&&Te!==void 0)return V(fe,Te,w)}}:V(E,N,w)}function kt(e,t,r){return t.type==="color"?r=Ei.parse(r):t.type==="formatted"?r=Hr.fromString(r.toString()):t.type==="resolvedImage"?r=Ln.fromString(r.toString()):$e(r)===t.type||t.type==="enum"&&t.values[r]||(r=void 0),qe(r,e.default,t.default)}Qr.register(Pe,{error:[{kind:"error"},[Zt],function(e,t){throw new Ur(t[0].evaluate(e))}],typeof:[Zt,[si],function(e,t){return Ki(gr(t[0].evaluate(e)))}],"to-rgba":[Vi(dt,4),[ri],function(e,t){return t[0].evaluate(e).toArray()}],rgb:[ri,[dt,dt,dt],ve],rgba:[ri,[dt,dt,dt,dt],ve],has:{type:ii,overloads:[[[Zt],function(e,t){return pe(t[0].evaluate(e),e.properties())}],[[Zt,ki],function(e,t){var r=t[1];return pe(t[0].evaluate(e),r.evaluate(e))}]]},get:{type:si,overloads:[[[Zt],function(e,t){return Fe(t[0].evaluate(e),e.properties())}],[[Zt,ki],function(e,t){var r=t[1];return Fe(t[0].evaluate(e),r.evaluate(e))}]]},"feature-state":[si,[Zt],function(e,t){return Fe(t[0].evaluate(e),e.featureState||{})}],properties:[ki,[],function(e){return e.properties()}],"geometry-type":[Zt,[],function(e){return e.geometryType()}],id:[si,[],function(e){return e.id()}],zoom:[dt,[],function(e){return e.globals.zoom}],"heatmap-density":[dt,[],function(e){return e.globals.heatmapDensity||0}],"line-progress":[dt,[],function(e){return e.globals.lineProgress||0}],accumulated:[si,[],function(e){return e.globals.accumulated===void 0?null:e.globals.accumulated}],"+":[dt,ke(dt),function(e,t){for(var r=0,c=0,f=t;c<f.length;c+=1)r+=f[c].evaluate(e);return r}],"*":[dt,ke(dt),function(e,t){for(var r=1,c=0,f=t;c<f.length;c+=1)r*=f[c].evaluate(e);return r}],"-":{type:dt,overloads:[[[dt,dt],function(e,t){var r=t[1];return t[0].evaluate(e)-r.evaluate(e)}],[[dt],function(e,t){return-t[0].evaluate(e)}]]},"/":[dt,[dt,dt],function(e,t){var r=t[1];return t[0].evaluate(e)/r.evaluate(e)}],"%":[dt,[dt,dt],function(e,t){var r=t[1];return t[0].evaluate(e)%r.evaluate(e)}],ln2:[dt,[],function(){return Math.LN2}],pi:[dt,[],function(){return Math.PI}],e:[dt,[],function(){return Math.E}],"^":[dt,[dt,dt],function(e,t){var r=t[1];return Math.pow(t[0].evaluate(e),r.evaluate(e))}],sqrt:[dt,[dt],function(e,t){return Math.sqrt(t[0].evaluate(e))}],log10:[dt,[dt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN10}],ln:[dt,[dt],function(e,t){return Math.log(t[0].evaluate(e))}],log2:[dt,[dt],function(e,t){return Math.log(t[0].evaluate(e))/Math.LN2}],sin:[dt,[dt],function(e,t){return Math.sin(t[0].evaluate(e))}],cos:[dt,[dt],function(e,t){return Math.cos(t[0].evaluate(e))}],tan:[dt,[dt],function(e,t){return Math.tan(t[0].evaluate(e))}],asin:[dt,[dt],function(e,t){return Math.asin(t[0].evaluate(e))}],acos:[dt,[dt],function(e,t){return Math.acos(t[0].evaluate(e))}],atan:[dt,[dt],function(e,t){return Math.atan(t[0].evaluate(e))}],min:[dt,ke(dt),function(e,t){return Math.min.apply(Math,t.map(function(r){return r.evaluate(e)}))}],max:[dt,ke(dt),function(e,t){return Math.max.apply(Math,t.map(function(r){return r.evaluate(e)}))}],abs:[dt,[dt],function(e,t){return Math.abs(t[0].evaluate(e))}],round:[dt,[dt],function(e,t){var r=t[0].evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[dt,[dt],function(e,t){return Math.floor(t[0].evaluate(e))}],ceil:[dt,[dt],function(e,t){return Math.ceil(t[0].evaluate(e))}],"filter-==":[ii,[Zt,si],function(e,t){var r=t[0],c=t[1];return e.properties()[r.value]===c.value}],"filter-id-==":[ii,[si],function(e,t){var r=t[0];return e.id()===r.value}],"filter-type-==":[ii,[Zt],function(e,t){var r=t[0];return e.geometryType()===r.value}],"filter-<":[ii,[Zt,si],function(e,t){var r=t[0],c=t[1],f=e.properties()[r.value],g=c.value;return typeof f==typeof g&&f<g}],"filter-id-<":[ii,[si],function(e,t){var r=t[0],c=e.id(),f=r.value;return typeof c==typeof f&&c<f}],"filter->":[ii,[Zt,si],function(e,t){var r=t[0],c=t[1],f=e.properties()[r.value],g=c.value;return typeof f==typeof g&&f>g}],"filter-id->":[ii,[si],function(e,t){var r=t[0],c=e.id(),f=r.value;return typeof c==typeof f&&c>f}],"filter-<=":[ii,[Zt,si],function(e,t){var r=t[0],c=t[1],f=e.properties()[r.value],g=c.value;return typeof f==typeof g&&f<=g}],"filter-id-<=":[ii,[si],function(e,t){var r=t[0],c=e.id(),f=r.value;return typeof c==typeof f&&c<=f}],"filter->=":[ii,[Zt,si],function(e,t){var r=t[0],c=t[1],f=e.properties()[r.value],g=c.value;return typeof f==typeof g&&f>=g}],"filter-id->=":[ii,[si],function(e,t){var r=t[0],c=e.id(),f=r.value;return typeof c==typeof f&&c>=f}],"filter-has":[ii,[si],function(e,t){return t[0].value in e.properties()}],"filter-has-id":[ii,[],function(e){return e.id()!==null&&e.id()!==void 0}],"filter-type-in":[ii,[Vi(Zt)],function(e,t){return t[0].value.indexOf(e.geometryType())>=0}],"filter-id-in":[ii,[Vi(si)],function(e,t){return t[0].value.indexOf(e.id())>=0}],"filter-in-small":[ii,[Zt,Vi(si)],function(e,t){var r=t[0];return t[1].value.indexOf(e.properties()[r.value])>=0}],"filter-in-large":[ii,[Zt,Vi(si)],function(e,t){var r=t[0],c=t[1];return function(f,g,w,E){for(;w<=E;){var N=w+E>>1;if(g[N]===f)return!0;g[N]>f?E=N-1:w=N+1}return!1}(e.properties()[r.value],c.value,0,c.value.length-1)}],all:{type:ii,overloads:[[[ii,ii],function(e,t){var r=t[1];return t[0].evaluate(e)&&r.evaluate(e)}],[ke(ii),function(e,t){for(var r=0,c=t;r<c.length;r+=1)if(!c[r].evaluate(e))return!1;return!0}]]},any:{type:ii,overloads:[[[ii,ii],function(e,t){var r=t[1];return t[0].evaluate(e)||r.evaluate(e)}],[ke(ii),function(e,t){for(var r=0,c=t;r<c.length;r+=1)if(c[r].evaluate(e))return!0;return!1}]]},"!":[ii,[ii],function(e,t){return!t[0].evaluate(e)}],"is-supported-script":[ii,[Zt],function(e,t){var r=e.globals&&e.globals.isSupportedScript;return!r||r(t[0].evaluate(e))}],upcase:[Zt,[Zt],function(e,t){return t[0].evaluate(e).toUpperCase()}],downcase:[Zt,[Zt],function(e,t){return t[0].evaluate(e).toLowerCase()}],concat:[Zt,ke(si),function(e,t){return t.map(function(r){return jo(r.evaluate(e))}).join("")}],"resolved-locale":[Zt,[Gi],function(e,t){return t[0].evaluate(e).resolvedLocale()}]});var Nt=function(e,t){this.expression=e,this._warningHistory={},this._evaluator=new Yr,this._defaultValue=t?function(r){return r.type==="color"&&Ct(r.default)?new Ei(0,0,0,0):r.type==="color"?Ei.parse(r.default)||null:r.default===void 0?null:r.default}(t):null,this._enumValues=t&&t.type==="enum"?t.values:null};function Rt(e){return Array.isArray(e)&&e.length>0&&typeof e[0]=="string"&&e[0]in Pe}function Qt(e,t){var r=new Hn(Pe,[],t?function(f){var g={color:ri,string:Zt,number:dt,enum:Zt,boolean:ii,formatted:$i,resolvedImage:dr};return f.type==="array"?Vi(g[f.value]||si,f.length):g[f.type]}(t):void 0),c=r.parse(e,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Ze(new Nt(c,t)):at(r.errors)}Nt.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,f,g){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=c,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g,this.expression.evaluate(this._evaluator)},Nt.prototype.evaluate=function(e,t,r,c,f,g){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=c,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=g||null;try{var w=this.expression.evaluate(this._evaluator);if(w==null||typeof w=="number"&&w!=w)return this._defaultValue;if(this._enumValues&&!(w in this._enumValues))throw new Ur("Expected value to be one of "+Object.keys(this._enumValues).map(function(E){return JSON.stringify(E)}).join(", ")+", but found "+JSON.stringify(w)+" instead.");return w}catch(E){return this._warningHistory[E.message]||(this._warningHistory[E.message]=!0,typeof console!="undefined"&&console.warn(E.message)),this._defaultValue}};var Jt=function(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent=e!=="constant"&&!Kn(t.expression)};Jt.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,c,f,g)},Jt.prototype.evaluate=function(e,t,r,c,f,g){return this._styleExpression.evaluate(e,t,r,c,f,g)};var pi=function(e,t,r,c){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent=e!=="camera"&&!Kn(t.expression),this.interpolationType=c};function vi(e,t){if((e=Qt(e,t)).result==="error")return e;var r=e.value.expression,c=pn(r);if(!c&&!Ve(t))return at([new ft("","data expressions not supported")]);var f=Ko(r,["zoom"]);if(!f&&!st(t))return at([new ft("","zoom expressions not supported")]);var g=function w(E){var N=null;if(E instanceof Io)N=w(E.result);else if(E instanceof io)for(var V=0,J=E.args;V<J.length&&!(N=w(J[V]));V+=1);else(E instanceof Mr||E instanceof $r)&&E.input instanceof Qr&&E.input.name==="zoom"&&(N=E);return N instanceof ft||E.eachChild(function(ee){var he=w(ee);he instanceof ft?N=he:!N&&he?N=new ft("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):N&&he&&N!==he&&(N=new ft("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),N}(r);return g||f?g instanceof ft?at([g]):g instanceof $r&&!Pt(t)?at([new ft("",'"interpolate" expressions cannot be used with this property')]):Ze(g?new pi(c?"camera":"composite",e.value,g.labels,g instanceof $r?g.interpolation:void 0):new Jt(c?"constant":"source",e.value)):at([new ft("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}pi.prototype.evaluateWithoutErrorHandling=function(e,t,r,c,f,g){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,c,f,g)},pi.prototype.evaluate=function(e,t,r,c,f,g){return this._styleExpression.evaluate(e,t,r,c,f,g)},pi.prototype.interpolationFactor=function(e,t,r){return this.interpolationType?$r.interpolationFactor(this.interpolationType,e,t,r):0};var gi=function(e,t){this._parameters=e,this._specification=t,rt(this,function r(c,f){var g,w,E,N=f.type==="color",V=c.stops&&typeof c.stops[0][0]=="object",J=V||!(V||c.property!==void 0),ee=c.type||(Pt(f)?"exponential":"interval");if(N&&((c=rt({},c)).stops&&(c.stops=c.stops.map(function(di){return[di[0],Ei.parse(di[1])]})),c.default=Ei.parse(c.default?c.default:f.default)),c.colorSpace&&c.colorSpace!=="rgb"&&!Ka[c.colorSpace])throw new Error("Unknown color space: "+c.colorSpace);if(ee==="exponential")g=It;else if(ee==="interval")g=Xe;else if(ee==="categorical"){g=nt,w=Object.create(null);for(var he=0,fe=c.stops;he<fe.length;he+=1){var Te=fe[he];w[Te[0]]=Te[1]}E=typeof c.stops[0][0]}else{if(ee!=="identity")throw new Error('Unknown function type "'+ee+'"');g=kt}if(V){for(var Se={},We=[],De=0;De<c.stops.length;De++){var et=c.stops[De],ut=et[0].zoom;Se[ut]===void 0&&(Se[ut]={zoom:ut,type:c.type,property:c.property,default:c.default,stops:[]},We.push(ut)),Se[ut].stops.push([et[0].value,et[1]])}for(var vt=[],bt=0,Ot=We;bt<Ot.length;bt+=1){var Vt=Ot[bt];vt.push([Se[Vt].zoom,r(Se[Vt],f)])}var oi={name:"linear"};return{kind:"composite",interpolationType:oi,interpolationFactor:$r.interpolationFactor.bind(void 0,oi),zoomStops:vt.map(function(di){return di[0]}),evaluate:function(di,Ri){var ci=di.zoom;return It({stops:vt,base:c.base},f,ci).evaluate(ci,Ri)}}}if(J){var Mi=ee==="exponential"?{name:"exponential",base:c.base!==void 0?c.base:1}:null;return{kind:"camera",interpolationType:Mi,interpolationFactor:$r.interpolationFactor.bind(void 0,Mi),zoomStops:c.stops.map(function(di){return di[0]}),evaluate:function(di){return g(c,f,di.zoom,w,E)}}}return{kind:"source",evaluate:function(di,Ri){var ci=Ri&&Ri.properties?Ri.properties[c.property]:void 0;return ci===void 0?qe(c.default,f.default):g(c,f,ci,w,E)}}}(this._parameters,this._specification))};function jt(e){var t=e.key,r=e.value,c=e.valueSpec||{},f=e.objectElementValidators||{},g=e.style,w=e.styleSpec,E=[],N=$e(r);if(N!=="object")return[new Le(t,r,"object expected, "+N+" found")];for(var V in r){var J=V.split(".")[0],ee=c[J]||c["*"],he=void 0;if(f[J])he=f[J];else if(c[J])he=pr;else if(f["*"])he=f["*"];else{if(!c["*"]){E.push(new Le(t,r[V],'unknown property "'+V+'"'));continue}he=pr}E=E.concat(he({key:(t&&t+".")+V,value:r[V],valueSpec:ee,style:g,styleSpec:w,object:r,objectKey:V},r))}for(var fe in c)f[fe]||c[fe].required&&c[fe].default===void 0&&r[fe]===void 0&&E.push(new Le(t,r,'missing required property "'+fe+'"'));return E}function $t(e){var t=e.value,r=e.valueSpec,c=e.style,f=e.styleSpec,g=e.key,w=e.arrayElementValidator||pr;if($e(t)!=="array")return[new Le(g,t,"array expected, "+$e(t)+" found")];if(r.length&&t.length!==r.length)return[new Le(g,t,"array length "+r.length+" expected, length "+t.length+" found")];if(r["min-length"]&&t.length<r["min-length"])return[new Le(g,t,"array length at least "+r["min-length"]+" expected, length "+t.length+" found")];var E={type:r.value,values:r.values};f.$version<7&&(E.function=r.function),$e(r.value)==="object"&&(E=r.value);for(var N=[],V=0;V<t.length;V++)N=N.concat(w({array:t,arrayIndex:V,value:t[V],valueSpec:E,style:c,styleSpec:f,key:g+"["+V+"]"}));return N}function Oi(e){var t=e.key,r=e.value,c=e.valueSpec,f=$e(r);return f==="number"&&r!=r&&(f="NaN"),f!=="number"?[new Le(t,r,"number expected, "+f+" found")]:"minimum"in c&&r<c.minimum?[new Le(t,r,r+" is less than the minimum value "+c.minimum)]:"maximum"in c&&r>c.maximum?[new Le(t,r,r+" is greater than the maximum value "+c.maximum)]:[]}function Ui(e){var t,r,c,f=e.valueSpec,g=Mt(e.value.type),w={},E=g!=="categorical"&&e.value.property===void 0,N=!E,V=$e(e.value.stops)==="array"&&$e(e.value.stops[0])==="array"&&$e(e.value.stops[0][0])==="object",J=jt({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(fe){if(g==="identity")return[new Le(fe.key,fe.value,'identity function may not have a "stops" property')];var Te=[],Se=fe.value;return Te=Te.concat($t({key:fe.key,value:Se,valueSpec:fe.valueSpec,style:fe.style,styleSpec:fe.styleSpec,arrayElementValidator:ee})),$e(Se)==="array"&&Se.length===0&&Te.push(new Le(fe.key,Se,"array must have at least one stop")),Te},default:function(fe){return pr({key:fe.key,value:fe.value,valueSpec:f,style:fe.style,styleSpec:fe.styleSpec})}}});return g==="identity"&&E&&J.push(new Le(e.key,e.value,'missing required property "property"')),g==="identity"||e.value.stops||J.push(new Le(e.key,e.value,'missing required property "stops"')),g==="exponential"&&e.valueSpec.expression&&!Pt(e.valueSpec)&&J.push(new Le(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(N&&!Ve(e.valueSpec)?J.push(new Le(e.key,e.value,"property functions not supported")):E&&!st(e.valueSpec)&&J.push(new Le(e.key,e.value,"zoom functions not supported"))),g!=="categorical"&&!V||e.value.property!==void 0||J.push(new Le(e.key,e.value,'"property" property is required')),J;function ee(fe){var Te=[],Se=fe.value,We=fe.key;if($e(Se)!=="array")return[new Le(We,Se,"array expected, "+$e(Se)+" found")];if(Se.length!==2)return[new Le(We,Se,"array length 2 expected, length "+Se.length+" found")];if(V){if($e(Se[0])!=="object")return[new Le(We,Se,"object expected, "+$e(Se[0])+" found")];if(Se[0].zoom===void 0)return[new Le(We,Se,"object stop key must have zoom")];if(Se[0].value===void 0)return[new Le(We,Se,"object stop key must have value")];if(c&&c>Mt(Se[0].zoom))return[new Le(We,Se[0].zoom,"stop zoom values must appear in ascending order")];Mt(Se[0].zoom)!==c&&(c=Mt(Se[0].zoom),r=void 0,w={}),Te=Te.concat(jt({key:We+"[0]",value:Se[0],valueSpec:{zoom:{}},style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{zoom:Oi,value:he}}))}else Te=Te.concat(he({key:We+"[0]",value:Se[0],valueSpec:{},style:fe.style,styleSpec:fe.styleSpec},Se));return Rt(Wt(Se[1]))?Te.concat([new Le(We+"[1]",Se[1],"expressions are not allowed in function stops.")]):Te.concat(pr({key:We+"[1]",value:Se[1],valueSpec:f,style:fe.style,styleSpec:fe.styleSpec}))}function he(fe,Te){var Se=$e(fe.value),We=Mt(fe.value),De=fe.value!==null?fe.value:Te;if(t){if(Se!==t)return[new Le(fe.key,De,Se+" stop domain type must match previous stop domain type "+t)]}else t=Se;if(Se!=="number"&&Se!=="string"&&Se!=="boolean")return[new Le(fe.key,De,"stop domain value must be a number, string, or boolean")];if(Se!=="number"&&g!=="categorical"){var et="number expected, "+Se+" found";return Ve(f)&&g===void 0&&(et+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Le(fe.key,De,et)]}return g!=="categorical"||Se!=="number"||isFinite(We)&&Math.floor(We)===We?g!=="categorical"&&Se==="number"&&r!==void 0&&We<r?[new Le(fe.key,De,"stop domain values must appear in ascending order")]:(r=We,g==="categorical"&&We in w?[new Le(fe.key,De,"stop domain values must be unique")]:(w[We]=!0,[])):[new Le(fe.key,De,"integer expected, found "+We)]}}function xi(e){var t=(e.expressionContext==="property"?vi:Qt)(Wt(e.value),e.valueSpec);if(t.result==="error")return t.value.map(function(c){return new Le(""+e.key+c.key,e.value,c.message)});var r=t.value.expression||t.value._styleExpression.expression;if(e.expressionContext==="property"&&e.propertyKey==="text-font"&&!r.outputDefined())return[new Le(e.key,e.value,'Invalid data expression for "'+e.propertyKey+'". Output values must be contained as literals within the expression.')];if(e.expressionContext==="property"&&e.propertyType==="layout"&&!Kn(r))return[new Le(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if(e.expressionContext==="filter"&&!Kn(r))return[new Le(e.key,e.value,'"feature-state" data expressions are not supported with filters.')];if(e.expressionContext&&e.expressionContext.indexOf("cluster")===0){if(!Ko(r,["zoom","feature-state"]))return[new Le(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(e.expressionContext==="cluster-initial"&&!pn(r))return[new Le(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function li(e){var t=e.key,r=e.value,c=e.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(Mt(r))===-1&&f.push(new Le(t,r,"expected one of ["+c.values.join(", ")+"], "+JSON.stringify(r)+" found")):Object.keys(c.values).indexOf(Mt(r))===-1&&f.push(new Le(t,r,"expected one of ["+Object.keys(c.values).join(", ")+"], "+JSON.stringify(r)+" found")),f}function Fi(e){if(e===!0||e===!1)return!0;if(!Array.isArray(e)||e.length===0)return!1;switch(e[0]){case"has":return e.length>=2&&e[1]!=="$id"&&e[1]!=="$type";case"in":return e.length>=3&&(typeof e[1]!="string"||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return e.length!==3||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(var t=0,r=e.slice(1);t<r.length;t+=1){var c=r[t];if(!Fi(c)&&typeof c!="boolean")return!1}return!0;default:return!0}}gi.deserialize=function(e){return new gi(e._parameters,e._specification)},gi.serialize=function(e){return{_parameters:e._parameters,_specification:e._specification}};var Wi={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function tr(e){if(e==null)return{filter:function(){return!0},needGeometry:!1};Fi(e)||(e=Yi(e));var t=Qt(e,Wi);if(t.result==="error")throw new Error(t.value.map(function(r){return r.key+": "+r.message}).join(", "));return{filter:function(r,c,f){return t.value.evaluate(r,c,{},f)},needGeometry:function r(c){if(!Array.isArray(c))return!1;if(c[0]==="within")return!0;for(var f=1;f<c.length;f++)if(r(c[f]))return!0;return!1}(e)}}function Zi(e,t){return e<t?-1:e>t?1:0}function Yi(e){if(!e)return!0;var t,r=e[0];return e.length<=1?r!=="any":r==="=="?ar(e[1],e[2],"=="):r==="!="?br(ar(e[1],e[2],"==")):r==="<"||r===">"||r==="<="||r===">="?ar(e[1],e[2],r):r==="any"?(t=e.slice(1),["any"].concat(t.map(Yi))):r==="all"?["all"].concat(e.slice(1).map(Yi)):r==="none"?["all"].concat(e.slice(1).map(Yi).map(br)):r==="in"?rr(e[1],e.slice(2)):r==="!in"?br(rr(e[1],e.slice(2))):r==="has"?nr(e[1]):r==="!has"?br(nr(e[1])):r!=="within"||e}function ar(e,t,r){switch(e){case"$type":return["filter-type-"+r,t];case"$id":return["filter-id-"+r,t];default:return["filter-"+r,e,t]}}function rr(e,t){if(t.length===0)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(function(r){return typeof r!=typeof t[0]})?["filter-in-large",e,["literal",t.sort(Zi)]]:["filter-in-small",e,["literal",t]]}}function nr(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function br(e){return["!",e]}function Bn(e){return Fi(Wt(e.value))?xi(rt({},e,{expressionContext:"filter",valueSpec:{value:"boolean"}})):function t(r){var c=r.value,f=r.key;if($e(c)!=="array")return[new Le(f,c,"array expected, "+$e(c)+" found")];var g,w=r.styleSpec,E=[];if(c.length<1)return[new Le(f,c,"filter array must have at least 1 element")];switch(E=E.concat(li({key:f+"[0]",value:c[0],valueSpec:w.filter_operator,style:r.style,styleSpec:r.styleSpec})),Mt(c[0])){case"<":case"<=":case">":case">=":c.length>=2&&Mt(c[1])==="$type"&&E.push(new Le(f,c,'"$type" cannot be use with operator "'+c[0]+'"'));case"==":case"!=":c.length!==3&&E.push(new Le(f,c,'filter array for operator "'+c[0]+'" must have 3 elements'));case"in":case"!in":c.length>=2&&(g=$e(c[1]))!=="string"&&E.push(new Le(f+"[1]",c[1],"string expected, "+g+" found"));for(var N=2;N<c.length;N++)g=$e(c[N]),Mt(c[1])==="$type"?E=E.concat(li({key:f+"["+N+"]",value:c[N],valueSpec:w.geometry_type,style:r.style,styleSpec:r.styleSpec})):g!=="string"&&g!=="number"&&g!=="boolean"&&E.push(new Le(f+"["+N+"]",c[N],"string, number, or boolean expected, "+g+" found"));break;case"any":case"all":case"none":for(var V=1;V<c.length;V++)E=E.concat(t({key:f+"["+V+"]",value:c[V],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":g=$e(c[1]),c.length!==2?E.push(new Le(f,c,'filter array for "'+c[0]+'" operator must have 2 elements')):g!=="string"&&E.push(new Le(f+"[1]",c[1],"string expected, "+g+" found"));break;case"within":g=$e(c[1]),c.length!==2?E.push(new Le(f,c,'filter array for "'+c[0]+'" operator must have 2 elements')):g!=="object"&&E.push(new Le(f+"[1]",c[1],"object expected, "+g+" found"))}return E}(e)}function en(e,t){var r=e.key,c=e.style,f=e.styleSpec,g=e.value,w=e.objectKey,E=f[t+"_"+e.layerType];if(!E)return[];var N=w.match(/^(.*)-transition$/);if(t==="paint"&&N&&E[N[1]]&&E[N[1]].transition)return pr({key:r,value:g,valueSpec:f.transition,style:c,styleSpec:f});var V,J=e.valueSpec||E[w];if(!J)return[new Le(r,g,'unknown property "'+w+'"')];if($e(g)==="string"&&Ve(J)&&!J.tokens&&(V=/^{([^}]+)}$/.exec(g)))return[new Le(r,g,'"'+w+'" does not support interpolation syntax\nUse an identity property function instead: `{ "type": "identity", "property": '+JSON.stringify(V[1])+" }`.")];var ee=[];return e.layerType==="symbol"&&(w==="text-field"&&c&&!c.glyphs&&ee.push(new Le(r,g,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&Ct(Wt(g))&&Mt(g.type)==="identity"&&ee.push(new Le(r,g,'"text-font" does not support identity functions'))),ee.concat(pr({key:e.key,value:g,valueSpec:J,style:c,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:w}))}function Oa(e){return en(e,"paint")}function oa(e){return en(e,"layout")}function Js(e){var t=[],r=e.value,c=e.key,f=e.style,g=e.styleSpec;r.type||r.ref||t.push(new Le(c,r,'either "type" or "ref" is required'));var w,E=Mt(r.type),N=Mt(r.ref);if(r.id)for(var V=Mt(r.id),J=0;J<e.arrayIndex;J++){var ee=f.layers[J];Mt(ee.id)===V&&t.push(new Le(c,r.id,'duplicate layer id "'+r.id+'", previously used at line '+ee.id.__line__))}if("ref"in r)["type","source","source-layer","filter","layout"].forEach(function(Te){Te in r&&t.push(new Le(c,r[Te],'"'+Te+'" is prohibited for ref layers'))}),f.layers.forEach(function(Te){Mt(Te.id)===N&&(w=Te)}),w?w.ref?t.push(new Le(c,r.ref,"ref cannot reference another ref layer")):E=Mt(w.type):t.push(new Le(c,r.ref,'ref layer "'+N+'" not found'));else if(E!=="background")if(r.source){var he=f.sources&&f.sources[r.source],fe=he&&Mt(he.type);he?fe==="vector"&&E==="raster"?t.push(new Le(c,r.source,'layer "'+r.id+'" requires a raster source')):fe==="raster"&&E!=="raster"?t.push(new Le(c,r.source,'layer "'+r.id+'" requires a vector source')):fe!=="vector"||r["source-layer"]?fe==="raster-dem"&&E!=="hillshade"?t.push(new Le(c,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):E!=="line"||!r.paint||!r.paint["line-gradient"]||fe==="geojson"&&he.lineMetrics||t.push(new Le(c,r,'layer "'+r.id+'" specifies a line-gradient, which requires a GeoJSON source with `lineMetrics` enabled.')):t.push(new Le(c,r,'layer "'+r.id+'" must specify a "source-layer"')):t.push(new Le(c,r.source,'source "'+r.source+'" not found'))}else t.push(new Le(c,r,'missing required property "source"'));return t=t.concat(jt({key:c,value:r,valueSpec:g.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":function(){return[]},type:function(){return pr({key:c+".type",value:r.type,valueSpec:g.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"})},filter:Bn,layout:function(Te){return jt({layer:r,key:Te.key,value:Te.value,style:Te.style,styleSpec:Te.styleSpec,objectElementValidators:{"*":function(Se){return oa(rt({layerType:E},Se))}}})},paint:function(Te){return jt({layer:r,key:Te.key,value:Te.value,style:Te.style,styleSpec:Te.styleSpec,objectElementValidators:{"*":function(Se){return Oa(rt({layerType:E},Se))}}})}}}))}function Xo(e){var t=e.value,r=e.key,c=$e(t);return c!=="string"?[new Le(r,t,"string expected, "+c+" found")]:[]}var kr={promoteId:function(e){var t=e.key,r=e.value;if($e(r)==="string")return Xo({key:t,value:r});var c=[];for(var f in r)c.push.apply(c,Xo({key:t+"."+f,value:r[f]}));return c}};function ss(e){var t=e.value,r=e.key,c=e.styleSpec,f=e.style;if(!t.type)return[new Le(r,t,'"type" is required')];var g,w=Mt(t.type);switch(w){case"vector":case"raster":case"raster-dem":return jt({key:r,value:t,valueSpec:c["source_"+w.replace("-","_")],style:e.style,styleSpec:c,objectElementValidators:kr});case"geojson":if(g=jt({key:r,value:t,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:kr}),t.cluster)for(var E in t.clusterProperties){var N=t.clusterProperties[E],V=N[0],J=typeof V=="string"?[V,["accumulated"],["get",E]]:V;g.push.apply(g,xi({key:r+"."+E+".map",value:N[1],expressionContext:"cluster-map"})),g.push.apply(g,xi({key:r+"."+E+".reduce",value:J,expressionContext:"cluster-reduce"}))}return g;case"video":return jt({key:r,value:t,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return jt({key:r,value:t,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new Le(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return li({key:r+".type",value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:c})}}function ya(e){var t=e.value,r=e.styleSpec,c=r.light,f=e.style,g=[],w=$e(t);if(t===void 0)return g;if(w!=="object")return g.concat([new Le("light",t,"object expected, "+w+" found")]);for(var E in t){var N=E.match(/^(.*)-transition$/);g=g.concat(N&&c[N[1]]&&c[N[1]].transition?pr({key:E,value:t[E],valueSpec:r.transition,style:f,styleSpec:r}):c[E]?pr({key:E,value:t[E],valueSpec:c[E],style:f,styleSpec:r}):[new Le(E,t[E],'unknown property "'+E+'"')])}return g}var aa={"*":function(){return[]},array:$t,boolean:function(e){var t=e.value,r=e.key,c=$e(t);return c!=="boolean"?[new Le(r,t,"boolean expected, "+c+" found")]:[]},number:Oi,color:function(e){var t=e.key,r=e.value,c=$e(r);return c!=="string"?[new Le(t,r,"color expected, "+c+" found")]:cr(r)===null?[new Le(t,r,'color expected, "'+r+'" found')]:[]},constants:tt,enum:li,filter:Bn,function:Ui,layer:Js,object:jt,source:ss,light:ya,string:Xo,formatted:function(e){return Xo(e).length===0?[]:xi(e)},resolvedImage:function(e){return Xo(e).length===0?[]:xi(e)}};function pr(e){var t=e.value,r=e.valueSpec,c=e.styleSpec;return r.expression&&Ct(Mt(t))?Ui(e):r.expression&&Rt(Wt(t))?xi(e):r.type&&aa[r.type]?aa[r.type](e):jt(rt({},e,{valueSpec:r.type?c[r.type]:r}))}function Ar(e){var t=e.value,r=e.key,c=Xo(e);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new Le(r,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new Le(r,t,'"glyphs" url must include a "{range}" token'))),c}function _o(e,t){t===void 0&&(t=xe);var r=[];return r=r.concat(pr({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Ar,"*":function(){return[]}}})),e.constants&&(r=r.concat(tt({key:"constants",value:e.constants,style:e,styleSpec:t}))),Ha(r)}function Ha(e){return[].concat(e).sort(function(t,r){return t.line-r.line})}function Ia(e){return function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return Ha(e.apply(this,t))}}_o.source=Ia(ss),_o.light=Ia(ya),_o.layer=Ia(Js),_o.filter=Ia(Bn),_o.paintProperty=Ia(Oa),_o.layoutProperty=Ia(oa);var ls=_o,o=ls.light,d=ls.paintProperty,P=ls.layoutProperty;function U(e,t){var r=!1;if(t&&t.length)for(var c=0,f=t;c<f.length;c+=1)e.fire(new Oe(new Error(f[c].message))),r=!0;return r}var Y=me;function me(e,t,r){var c=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var f=new Int32Array(this.arrayBuffer);e=f[0],this.d=(t=f[1])+2*(r=f[2]);for(var g=0;g<this.d*this.d;g++){var w=f[3+g],E=f[3+g+1];c.push(w===E?null:f.subarray(w,E))}var N=f[3+c.length+1];this.keys=f.subarray(f[3+c.length],N),this.bboxes=f.subarray(N),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var V=0;V<this.d*this.d;V++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var J=r/t*e;this.min=-J,this.max=e+J}me.prototype.insert=function(e,t,r,c,f){this._forEachCell(t,r,c,f,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(c),this.bboxes.push(f)},me.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},me.prototype._insertCell=function(e,t,r,c,f,g){this.cells[f].push(g)},me.prototype.query=function(e,t,r,c,f){var g=this.min,w=this.max;if(e<=g&&t<=g&&w<=r&&w<=c&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(e,t,r,c,this._queryCell,E,{},f),E},me.prototype._queryCell=function(e,t,r,c,f,g,w,E){var N=this.cells[f];if(N!==null)for(var V=this.keys,J=this.bboxes,ee=0;ee<N.length;ee++){var he=N[ee];if(w[he]===void 0){var fe=4*he;(E?E(J[fe+0],J[fe+1],J[fe+2],J[fe+3]):e<=J[fe+2]&&t<=J[fe+3]&&r>=J[fe+0]&&c>=J[fe+1])?(w[he]=!0,g.push(V[he])):w[he]=!1}}},me.prototype._forEachCell=function(e,t,r,c,f,g,w,E){for(var N=this._convertToCellCoord(e),V=this._convertToCellCoord(t),J=this._convertToCellCoord(r),ee=this._convertToCellCoord(c),he=N;he<=J;he++)for(var fe=V;fe<=ee;fe++){var Te=this.d*fe+he;if((!E||E(this._convertFromCellCoord(he),this._convertFromCellCoord(fe),this._convertFromCellCoord(he+1),this._convertFromCellCoord(fe+1)))&&f.call(this,e,t,r,c,Te,g,w,E))return}},me.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},me.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},me.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,c=0;c<this.cells.length;c++)r+=this.cells[c].length;var f=new Int32Array(t+r+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var g=t,w=0;w<e.length;w++){var E=e[w];f[3+w]=g,f.set(E,g),g+=E.length}return f[3+e.length]=g,f.set(this.keys,g),f[3+e.length+1]=g+=this.keys.length,f.set(this.bboxes,g),g+=this.bboxes.length,f.buffer};var Ke=C.ImageData,Tt=C.ImageBitmap,wt={};function pt(e,t,r){r===void 0&&(r={}),Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),wt[e]={klass:t,omit:r.omit||[],shallow:r.shallow||[]}}for(var _i in pt("Object",Object),Y.serialize=function(e,t){var r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Y.deserialize=function(e){return new Y(e.buffer)},pt("Grid",Y),pt("Color",Ei),pt("Error",Error),pt("ResolvedImage",Ln),pt("StylePropertyFunction",gi),pt("StyleExpression",Nt,{omit:["_evaluator"]}),pt("ZoomDependentExpression",pi),pt("ZoomConstantExpression",Jt),pt("CompoundExpression",Qr,{omit:["_evaluate"]}),Pe)Pe[_i]._classRegistryKey||pt("Expression_"+_i,Pe[_i]);function Hi(e){return e&&typeof ArrayBuffer!="undefined"&&(e instanceof ArrayBuffer||e.constructor&&e.constructor.name==="ArrayBuffer")}function Er(e){return Tt&&e instanceof Tt}function Mn(e,t){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Hi(e)||Er(e))return t&&t.push(e),e;if(ArrayBuffer.isView(e)){var r=e;return t&&t.push(r.buffer),r}if(e instanceof Ke)return t&&t.push(e.data.buffer),e;if(Array.isArray(e)){for(var c=[],f=0,g=e;f<g.length;f+=1)c.push(Mn(g[f],t));return c}if(typeof e=="object"){var w=e.constructor,E=w._classRegistryKey;if(!E)throw new Error("can't serialize object of unregistered class");var N=w.serialize?w.serialize(e,t):{};if(!w.serialize){for(var V in e)if(e.hasOwnProperty(V)&&!(wt[E].omit.indexOf(V)>=0)){var J=e[V];N[V]=wt[E].shallow.indexOf(V)>=0?J:Mn(J,t)}e instanceof Error&&(N.message=e.message)}if(N.$name)throw new Error("$name property is reserved for worker serialization logic.");return E!=="Object"&&(N.$name=E),N}throw new Error("can't serialize object of type "+typeof e)}function vn(e){if(e==null||typeof e=="boolean"||typeof e=="number"||typeof e=="string"||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Hi(e)||Er(e)||ArrayBuffer.isView(e)||e instanceof Ke)return e;if(Array.isArray(e))return e.map(vn);if(typeof e=="object"){var t=e.$name||"Object",r=wt[t].klass;if(!r)throw new Error("can't deserialize unregistered class "+t);if(r.deserialize)return r.deserialize(e);for(var c=Object.create(r.prototype),f=0,g=Object.keys(e);f<g.length;f+=1){var w=g[f];if(w!=="$name"){var E=e[w];c[w]=wt[t].shallow.indexOf(w)>=0?E:vn(E)}}return c}throw new Error("can't deserialize object of type "+typeof e)}var Ao=function(){this.first=!0};Ao.prototype.update=function(e,t){var r=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=r,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=r,!0):(this.lastFloorZoom>r?(this.lastIntegerZoom=r+1,this.lastIntegerZoomTime=t):this.lastFloorZoom<r&&(this.lastIntegerZoom=r,this.lastIntegerZoomTime=t),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=r,!0))};var ti={"Latin-1 Supplement":function(e){return e>=128&&e<=255},Arabic:function(e){return e>=1536&&e<=1791},"Arabic Supplement":function(e){return e>=1872&&e<=1919},"Arabic Extended-A":function(e){return e>=2208&&e<=2303},"Hangul Jamo":function(e){return e>=4352&&e<=4607},"Unified Canadian Aboriginal Syllabics":function(e){return e>=5120&&e<=5759},Khmer:function(e){return e>=6016&&e<=6143},"Unified Canadian Aboriginal Syllabics Extended":function(e){return e>=6320&&e<=6399},"General Punctuation":function(e){return e>=8192&&e<=8303},"Letterlike Symbols":function(e){return e>=8448&&e<=8527},"Number Forms":function(e){return e>=8528&&e<=8591},"Miscellaneous Technical":function(e){return e>=8960&&e<=9215},"Control Pictures":function(e){return e>=9216&&e<=9279},"Optical Character Recognition":function(e){return e>=9280&&e<=9311},"Enclosed Alphanumerics":function(e){return e>=9312&&e<=9471},"Geometric Shapes":function(e){return e>=9632&&e<=9727},"Miscellaneous Symbols":function(e){return e>=9728&&e<=9983},"Miscellaneous Symbols and Arrows":function(e){return e>=11008&&e<=11263},"CJK Radicals Supplement":function(e){return e>=11904&&e<=12031},"Kangxi Radicals":function(e){return e>=12032&&e<=12255},"Ideographic Description Characters":function(e){return e>=12272&&e<=12287},"CJK Symbols and Punctuation":function(e){return e>=12288&&e<=12351},Hiragana:function(e){return e>=12352&&e<=12447},Katakana:function(e){return e>=12448&&e<=12543},Bopomofo:function(e){return e>=12544&&e<=12591},"Hangul Compatibility Jamo":function(e){return e>=12592&&e<=12687},Kanbun:function(e){return e>=12688&&e<=12703},"Bopomofo Extended":function(e){return e>=12704&&e<=12735},"CJK Strokes":function(e){return e>=12736&&e<=12783},"Katakana Phonetic Extensions":function(e){return e>=12784&&e<=12799},"Enclosed CJK Letters and Months":function(e){return e>=12800&&e<=13055},"CJK Compatibility":function(e){return e>=13056&&e<=13311},"CJK Unified Ideographs Extension A":function(e){return e>=13312&&e<=19903},"Yijing Hexagram Symbols":function(e){return e>=19904&&e<=19967},"CJK Unified Ideographs":function(e){return e>=19968&&e<=40959},"Yi Syllables":function(e){return e>=40960&&e<=42127},"Yi Radicals":function(e){return e>=42128&&e<=42191},"Hangul Jamo Extended-A":function(e){return e>=43360&&e<=43391},"Hangul Syllables":function(e){return e>=44032&&e<=55215},"Hangul Jamo Extended-B":function(e){return e>=55216&&e<=55295},"Private Use Area":function(e){return e>=57344&&e<=63743},"CJK Compatibility Ideographs":function(e){return e>=63744&&e<=64255},"Arabic Presentation Forms-A":function(e){return e>=64336&&e<=65023},"Vertical Forms":function(e){return e>=65040&&e<=65055},"CJK Compatibility Forms":function(e){return e>=65072&&e<=65103},"Small Form Variants":function(e){return e>=65104&&e<=65135},"Arabic Presentation Forms-B":function(e){return e>=65136&&e<=65279},"Halfwidth and Fullwidth Forms":function(e){return e>=65280&&e<=65519}};function va(e){for(var t=0,r=e;t<r.length;t+=1)if(ba(r[t].charCodeAt(0)))return!0;return!1}function ba(e){return!(e!==746&&e!==747&&(e<4352||!(ti["Bopomofo Extended"](e)||ti.Bopomofo(e)||ti["CJK Compatibility Forms"](e)&&!(e>=65097&&e<=65103)||ti["CJK Compatibility Ideographs"](e)||ti["CJK Compatibility"](e)||ti["CJK Radicals Supplement"](e)||ti["CJK Strokes"](e)||!(!ti["CJK Symbols and Punctuation"](e)||e>=12296&&e<=12305||e>=12308&&e<=12319||e===12336)||ti["CJK Unified Ideographs Extension A"](e)||ti["CJK Unified Ideographs"](e)||ti["Enclosed CJK Letters and Months"](e)||ti["Hangul Compatibility Jamo"](e)||ti["Hangul Jamo Extended-A"](e)||ti["Hangul Jamo Extended-B"](e)||ti["Hangul Jamo"](e)||ti["Hangul Syllables"](e)||ti.Hiragana(e)||ti["Ideographic Description Characters"](e)||ti.Kanbun(e)||ti["Kangxi Radicals"](e)||ti["Katakana Phonetic Extensions"](e)||ti.Katakana(e)&&e!==12540||!(!ti["Halfwidth and Fullwidth Forms"](e)||e===65288||e===65289||e===65293||e>=65306&&e<=65310||e===65339||e===65341||e===65343||e>=65371&&e<=65503||e===65507||e>=65512&&e<=65519)||!(!ti["Small Form Variants"](e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||ti["Unified Canadian Aboriginal Syllabics"](e)||ti["Unified Canadian Aboriginal Syllabics Extended"](e)||ti["Vertical Forms"](e)||ti["Yijing Hexagram Symbols"](e)||ti["Yi Syllables"](e)||ti["Yi Radicals"](e))))}function qa(e){return!(ba(e)||function(t){return!!(ti["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||ti["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||ti["Letterlike Symbols"](t)||ti["Number Forms"](t)||ti["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||ti["Control Pictures"](t)&&t!==9251||ti["Optical Character Recognition"](t)||ti["Enclosed Alphanumerics"](t)||ti["Geometric Shapes"](t)||ti["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||ti["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||ti["CJK Symbols and Punctuation"](t)||ti.Katakana(t)||ti["Private Use Area"](t)||ti["CJK Compatibility Forms"](t)||ti["Small Form Variants"](t)||ti["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(e))}function Jn(e){return e>=1424&&e<=2303||ti["Arabic Presentation Forms-A"](e)||ti["Arabic Presentation Forms-B"](e)}function mo(e,t){return!(!t&&Jn(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||ti.Khmer(e))}function us(e){for(var t=0,r=e;t<r.length;t+=1)if(Jn(r[t].charCodeAt(0)))return!0;return!1}var Ls=null,Sr="unavailable",go=null,Rs=function(e){e&&typeof e=="string"&&e.indexOf("NetworkError")>-1&&(Sr="error"),Ls&&Ls(e)};function zs(){Al.fire(new be("pluginStateChange",{pluginStatus:Sr,pluginURL:go}))}var Al=new je,Dl=function(){return Sr},Ja=function(){if(Sr!=="deferred"||!go)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Sr="loading",zs(),go&&co({url:go},function(e){e?Rs(e):(Sr="loaded",zs())})},Wo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:function(){return Sr==="loaded"||Wo.applyArabicShaping!=null},isLoading:function(){return Sr==="loading"},setState:function(e){Sr=e.pluginStatus,go=e.pluginURL},isParsed:function(){return Wo.applyArabicShaping!=null&&Wo.processBidirectionalText!=null&&Wo.processStyledBidirectionalText!=null},getPluginURL:function(){return go}},yr=function(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.zoomHistory=t.zoomHistory,this.transition=t.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Ao,this.transition={})};yr.prototype.isSupportedScript=function(e){return function(t,r){for(var c=0,f=t;c<f.length;c+=1)if(!mo(f[c].charCodeAt(0),r))return!1;return!0}(e,Wo.isLoaded())},yr.prototype.crossFadingFactor=function(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)},yr.prototype.getCrossfadeParameters=function(){var e=this.zoom,t=e-Math.floor(e),r=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:t+(1-t)*r}:{fromScale:.5,toScale:1,t:1-(1-r)*t}};var xa=function(e,t){this.property=e,this.value=t,this.expression=function(r,c){if(Ct(r))return new gi(r,c);if(Rt(r)){var f=vi(r,c);if(f.result==="error")throw new Error(f.value.map(function(w){return w.key+": "+w.message}).join(", "));return f.value}var g=r;return typeof r=="string"&&c.type==="color"&&(g=Ei.parse(r)),{kind:"constant",evaluate:function(){return g}}}(t===void 0?e.specification.default:t,e.specification)};xa.prototype.isDataDriven=function(){return this.expression.kind==="source"||this.expression.kind==="composite"},xa.prototype.possiblyEvaluate=function(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)};var sa=function(e){this.property=e,this.value=new xa(e,void 0)};sa.prototype.transitioned=function(e,t){return new hs(this.property,this.value,t,F({},e.transition,this.transition),e.now)},sa.prototype.untransitioned=function(){return new hs(this.property,this.value,null,{},0)};var ro=function(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)};ro.prototype.getValue=function(e){return ot(this._values[e].value.value)},ro.prototype.setValue=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new sa(this._values[e].property)),this._values[e].value=new xa(this._values[e].property,t===null?void 0:ot(t))},ro.prototype.getTransition=function(e){return ot(this._values[e].transition)},ro.prototype.setTransition=function(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new sa(this._values[e].property)),this._values[e].transition=ot(t)||void 0},ro.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t],f=this.getValue(c);f!==void 0&&(e[c]=f);var g=this.getTransition(c);g!==void 0&&(e[c+"-transition"]=g)}return e},ro.prototype.transitioned=function(e,t){for(var r=new Xa(this._properties),c=0,f=Object.keys(this._values);c<f.length;c+=1){var g=f[c];r._values[g]=this._values[g].transitioned(e,t._values[g])}return r},ro.prototype.untransitioned=function(){for(var e=new Xa(this._properties),t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t];e._values[c]=this._values[c].untransitioned()}return e};var hs=function(e,t,r,c,f){this.property=e,this.value=t,this.begin=f+c.delay||0,this.end=this.begin+c.duration||0,e.specification.transition&&(c.delay||c.duration)&&(this.prior=r)};hs.prototype.possiblyEvaluate=function(e,t,r){var c=e.now||0,f=this.value.possiblyEvaluate(e,t,r),g=this.prior;if(g){if(c>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(c<this.begin)return g.possiblyEvaluate(e,t,r);var w=(c-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(e,t,r),f,function(E){if(E<=0)return 0;if(E>=1)return 1;var N=E*E,V=N*E;return 4*(E<.5?V:3*(E-N)+V-.75)}(w))}return f};var Xa=function(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)};Xa.prototype.possiblyEvaluate=function(e,t,r){for(var c=new Bs(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var w=g[f];c._values[w]=this._values[w].possiblyEvaluate(e,t,r)}return c},Xa.prototype.hasTransition=function(){for(var e=0,t=Object.keys(this._values);e<t.length;e+=1)if(this._values[t[e]].prior)return!0;return!1};var la=function(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)};la.prototype.getValue=function(e){return ot(this._values[e].value)},la.prototype.setValue=function(e,t){this._values[e]=new xa(this._values[e].property,t===null?void 0:ot(t))},la.prototype.serialize=function(){for(var e={},t=0,r=Object.keys(this._values);t<r.length;t+=1){var c=r[t],f=this.getValue(c);f!==void 0&&(e[c]=f)}return e},la.prototype.possiblyEvaluate=function(e,t,r){for(var c=new Bs(this._properties),f=0,g=Object.keys(this._values);f<g.length;f+=1){var w=g[f];c._values[w]=this._values[w].possiblyEvaluate(e,t,r)}return c};var yo=function(e,t,r){this.property=e,this.value=t,this.parameters=r};yo.prototype.isConstant=function(){return this.value.kind==="constant"},yo.prototype.constantOr=function(e){return this.value.kind==="constant"?this.value.value:e},yo.prototype.evaluate=function(e,t,r,c){return this.property.evaluate(this.value,this.parameters,e,t,r,c)};var Bs=function(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)};Bs.prototype.get=function(e){return this._values[e]};var Ai=function(e){this.specification=e};Ai.prototype.possiblyEvaluate=function(e,t){return e.expression.evaluate(t)},Ai.prototype.interpolate=function(e,t,r){var c=Ho[this.specification.type];return c?c(e,t,r):e};var wi=function(e,t){this.specification=e,this.overrides=t};wi.prototype.possiblyEvaluate=function(e,t,r,c){return new yo(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(t,null,{},r,c)}:e.expression,t)},wi.prototype.interpolate=function(e,t,r){if(e.value.kind!=="constant"||t.value.kind!=="constant")return e;if(e.value.value===void 0||t.value.value===void 0)return new yo(this,{kind:"constant",value:void 0},e.parameters);var c=Ho[this.specification.type];return c?new yo(this,{kind:"constant",value:c(e.value.value,t.value.value,r)},e.parameters):e},wi.prototype.evaluate=function(e,t,r,c,f,g){return e.kind==="constant"?e.value:e.evaluate(t,r,c,f,g)};var Xs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,c,f,g){if(r.value===void 0)return new yo(this,{kind:"constant",value:void 0},c);if(r.expression.kind==="constant"){var w=r.expression.evaluate(c,null,{},f,g),E=r.property.specification.type==="resolvedImage"&&typeof w!="string"?w.name:w,N=this._calculate(E,E,E,c);return new yo(this,{kind:"constant",value:N},c)}if(r.expression.kind==="camera"){var V=this._calculate(r.expression.evaluate({zoom:c.zoom-1}),r.expression.evaluate({zoom:c.zoom}),r.expression.evaluate({zoom:c.zoom+1}),c);return new yo(this,{kind:"constant",value:V},c)}return new yo(this,r.expression,c)},t.prototype.evaluate=function(r,c,f,g,w,E){if(r.kind==="source"){var N=r.evaluate(c,f,g,w,E);return this._calculate(N,N,N,c)}return r.kind==="composite"?this._calculate(r.evaluate({zoom:Math.floor(c.zoom)-1},f,g),r.evaluate({zoom:Math.floor(c.zoom)},f,g),r.evaluate({zoom:Math.floor(c.zoom)+1},f,g),c):r.value},t.prototype._calculate=function(r,c,f,g){return g.zoom>g.zoomHistory.lastIntegerZoom?{from:r,to:c}:{from:f,to:c}},t.prototype.interpolate=function(r){return r},t}(wi),Do=function(e){this.specification=e};Do.prototype.possiblyEvaluate=function(e,t,r,c){if(e.value!==void 0){if(e.expression.kind==="constant"){var f=e.expression.evaluate(t,null,{},r,c);return this._calculate(f,f,f,t)}return this._calculate(e.expression.evaluate(new yr(Math.floor(t.zoom-1),t)),e.expression.evaluate(new yr(Math.floor(t.zoom),t)),e.expression.evaluate(new yr(Math.floor(t.zoom+1),t)),t)}},Do.prototype._calculate=function(e,t,r,c){return c.zoom>c.zoomHistory.lastIntegerZoom?{from:e,to:t}:{from:r,to:t}},Do.prototype.interpolate=function(e){return e};var ua=function(e){this.specification=e};ua.prototype.possiblyEvaluate=function(e,t,r,c){return!!e.expression.evaluate(t,null,{},r,c)},ua.prototype.interpolate=function(){return!1};var no=function(e){for(var t in this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[],e){var r=e[t];r.specification.overridable&&this.overridableProperties.push(t);var c=this.defaultPropertyValues[t]=new xa(r,void 0),f=this.defaultTransitionablePropertyValues[t]=new sa(r);this.defaultTransitioningPropertyValues[t]=f.untransitioned(),this.defaultPossiblyEvaluatedValues[t]=c.possiblyEvaluate({})}};pt("DataDrivenProperty",wi),pt("DataConstantProperty",Ai),pt("CrossFadedDataDrivenProperty",Xs),pt("CrossFadedProperty",Do),pt("ColorRampProperty",ua);var wa=function(e){function t(r,c){if(e.call(this),this.id=r.id,this.type=r.type,this._featureFilter={filter:function(){return!0},needGeometry:!1},r.type!=="custom"&&(this.metadata=(r=r).metadata,this.minzoom=r.minzoom,this.maxzoom=r.maxzoom,r.type!=="background"&&(this.source=r.source,this.sourceLayer=r["source-layer"],this.filter=r.filter),c.layout&&(this._unevaluatedLayout=new la(c.layout)),c.paint)){for(var f in this._transitionablePaint=new ro(c.paint),r.paint)this.setPaintProperty(f,r.paint[f],{validate:!1});for(var g in r.layout)this.setLayoutProperty(g,r.layout[g],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Bs(c.paint)}}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getCrossfadeParameters=function(){return this._crossfadeParameters},t.prototype.getLayoutProperty=function(r){return r==="visibility"?this.visibility:this._unevaluatedLayout.getValue(r)},t.prototype.setLayoutProperty=function(r,c,f){f===void 0&&(f={}),c!=null&&this._validate(P,"layers."+this.id+".layout."+r,r,c,f)||(r!=="visibility"?this._unevaluatedLayout.setValue(r,c):this.visibility=c)},t.prototype.getPaintProperty=function(r){return ce(r,"-transition")?this._transitionablePaint.getTransition(r.slice(0,-"-transition".length)):this._transitionablePaint.getValue(r)},t.prototype.setPaintProperty=function(r,c,f){if(f===void 0&&(f={}),c!=null&&this._validate(d,"layers."+this.id+".paint."+r,r,c,f))return!1;if(ce(r,"-transition"))return this._transitionablePaint.setTransition(r.slice(0,-"-transition".length),c||void 0),!1;var g=this._transitionablePaint._values[r],w=g.property.specification["property-type"]==="cross-faded-data-driven",E=g.value.isDataDriven(),N=g.value;this._transitionablePaint.setValue(r,c),this._handleSpecialPaintPropertyUpdate(r);var V=this._transitionablePaint._values[r].value;return V.isDataDriven()||E||w||this._handleOverridablePaintPropertyUpdate(r,N,V)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){},t.prototype._handleOverridablePaintPropertyUpdate=function(r,c,f){return!1},t.prototype.isHidden=function(r){return!!(this.minzoom&&r<this.minzoom)||!!(this.maxzoom&&r>=this.maxzoom)||this.visibility==="none"},t.prototype.updateTransitions=function(r){this._transitioningPaint=this._transitionablePaint.transitioned(r,this._transitioningPaint)},t.prototype.hasTransition=function(){return this._transitioningPaint.hasTransition()},t.prototype.recalculate=function(r,c){r.getCrossfadeParameters&&(this._crossfadeParameters=r.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(r,void 0,c)),this.paint=this._transitioningPaint.possiblyEvaluate(r,void 0,c)},t.prototype.serialize=function(){var r={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(r.layout=r.layout||{},r.layout.visibility=this.visibility),Be(r,function(c,f){return!(c===void 0||f==="layout"&&!Object.keys(c).length||f==="paint"&&!Object.keys(c).length)})},t.prototype._validate=function(r,c,f,g,w){return w===void 0&&(w={}),(!w||w.validate!==!1)&&U(this,r.call(ls,{key:c,layerType:this.type,objectKey:f,value:g,styleSpec:xe,style:{glyphs:!0,sprite:!0}}))},t.prototype.is3D=function(){return!1},t.prototype.isTileClipped=function(){return!1},t.prototype.hasOffscreenPass=function(){return!1},t.prototype.resize=function(){},t.prototype.isStateDependent=function(){for(var r in this.paint._values){var c=this.paint.get(r);if(c instanceof yo&&Ve(c.property.specification)&&(c.value.kind==="source"||c.value.kind==="composite")&&c.value.isStateDependent)return!0}return!1},t}(je),Rl={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array},Ys=function(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8},Or=function(){this.isTransferred=!1,this.capacity=-1,this.resize(0)};function Xn(e,t){t===void 0&&(t=1);var r=0,c=0;return{members:e.map(function(f){var g=Rl[f.type].BYTES_PER_ELEMENT,w=r=fu(r,Math.max(t,g)),E=f.components||1;return c=Math.max(c,g),r+=g*E,{name:f.name,type:f.type,components:E,offset:w}}),size:fu(r,Math.max(c,t)),alignment:t}}function fu(e,t){return Math.ceil(e/t)*t}Or.serialize=function(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}},Or.deserialize=function(e){var t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t},Or.prototype._trim=function(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())},Or.prototype.clear=function(){this.length=0},Or.prototype.resize=function(e){this.reserve(e),this.length=e},Or.prototype.reserve=function(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);var t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}},Or.prototype._refreshViews=function(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")};var cs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var f=this.length;return this.resize(f+1),this.emplace(f,r,c)},t.prototype.emplace=function(r,c,f){var g=2*r;return this.int16[g+0]=c,this.int16[g+1]=f,r},t}(Or);cs.prototype.bytesPerElement=4,pt("StructArrayLayout2i4",cs);var zl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g){var w=this.length;return this.resize(w+1),this.emplace(w,r,c,f,g)},t.prototype.emplace=function(r,c,f,g,w){var E=4*r;return this.int16[E+0]=c,this.int16[E+1]=f,this.int16[E+2]=g,this.int16[E+3]=w,r},t}(Or);zl.prototype.bytesPerElement=8,pt("StructArrayLayout4i8",zl);var ka=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E){var N=this.length;return this.resize(N+1),this.emplace(N,r,c,f,g,w,E)},t.prototype.emplace=function(r,c,f,g,w,E,N){var V=6*r;return this.int16[V+0]=c,this.int16[V+1]=f,this.int16[V+2]=g,this.int16[V+3]=w,this.int16[V+4]=E,this.int16[V+5]=N,r},t}(Or);ka.prototype.bytesPerElement=12,pt("StructArrayLayout2i4i12",ka);var Ro=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E){var N=this.length;return this.resize(N+1),this.emplace(N,r,c,f,g,w,E)},t.prototype.emplace=function(r,c,f,g,w,E,N){var V=4*r,J=8*r;return this.int16[V+0]=c,this.int16[V+1]=f,this.uint8[J+4]=g,this.uint8[J+5]=w,this.uint8[J+6]=E,this.uint8[J+7]=N,r},t}(Or);Ro.prototype.bytesPerElement=8,pt("StructArrayLayout2i4ub8",Ro);var Ms=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var f=this.length;return this.resize(f+1),this.emplace(f,r,c)},t.prototype.emplace=function(r,c,f){var g=2*r;return this.float32[g+0]=c,this.float32[g+1]=f,r},t}(Or);Ms.prototype.bytesPerElement=8,pt("StructArrayLayout2f8",Ms);var Pa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E,N,V,J,ee){var he=this.length;return this.resize(he+1),this.emplace(he,r,c,f,g,w,E,N,V,J,ee)},t.prototype.emplace=function(r,c,f,g,w,E,N,V,J,ee,he){var fe=10*r;return this.uint16[fe+0]=c,this.uint16[fe+1]=f,this.uint16[fe+2]=g,this.uint16[fe+3]=w,this.uint16[fe+4]=E,this.uint16[fe+5]=N,this.uint16[fe+6]=V,this.uint16[fe+7]=J,this.uint16[fe+8]=ee,this.uint16[fe+9]=he,r},t}(Or);Pa.prototype.bytesPerElement=20,pt("StructArrayLayout10ui20",Pa);var Qs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E,N,V,J,ee,he,fe){var Te=this.length;return this.resize(Te+1),this.emplace(Te,r,c,f,g,w,E,N,V,J,ee,he,fe)},t.prototype.emplace=function(r,c,f,g,w,E,N,V,J,ee,he,fe,Te){var Se=12*r;return this.int16[Se+0]=c,this.int16[Se+1]=f,this.int16[Se+2]=g,this.int16[Se+3]=w,this.uint16[Se+4]=E,this.uint16[Se+5]=N,this.uint16[Se+6]=V,this.uint16[Se+7]=J,this.int16[Se+8]=ee,this.int16[Se+9]=he,this.int16[Se+10]=fe,this.int16[Se+11]=Te,r},t}(Or);Qs.prototype.bytesPerElement=24,pt("StructArrayLayout4i4ui4i24",Qs);var Ts=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,f)},t.prototype.emplace=function(r,c,f,g){var w=3*r;return this.float32[w+0]=c,this.float32[w+1]=f,this.float32[w+2]=g,r},t}(Or);Ts.prototype.bytesPerElement=12,pt("StructArrayLayout3f12",Ts);var Fs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.uint32[1*r+0]=c,r},t}(Or);Fs.prototype.bytesPerElement=4,pt("StructArrayLayout1ul4",Fs);var Bl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E,N,V,J){var ee=this.length;return this.resize(ee+1),this.emplace(ee,r,c,f,g,w,E,N,V,J)},t.prototype.emplace=function(r,c,f,g,w,E,N,V,J,ee){var he=10*r,fe=5*r;return this.int16[he+0]=c,this.int16[he+1]=f,this.int16[he+2]=g,this.int16[he+3]=w,this.int16[he+4]=E,this.int16[he+5]=N,this.uint32[fe+3]=V,this.uint16[he+8]=J,this.uint16[he+9]=ee,r},t}(Or);Bl.prototype.bytesPerElement=20,pt("StructArrayLayout6i1ul2ui20",Bl);var Ss=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E){var N=this.length;return this.resize(N+1),this.emplace(N,r,c,f,g,w,E)},t.prototype.emplace=function(r,c,f,g,w,E,N){var V=6*r;return this.int16[V+0]=c,this.int16[V+1]=f,this.int16[V+2]=g,this.int16[V+3]=w,this.int16[V+4]=E,this.int16[V+5]=N,r},t}(Or);Ss.prototype.bytesPerElement=12,pt("StructArrayLayout2i2i2i12",Ss);var ps=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w){var E=this.length;return this.resize(E+1),this.emplace(E,r,c,f,g,w)},t.prototype.emplace=function(r,c,f,g,w,E){var N=4*r,V=8*r;return this.float32[N+0]=c,this.float32[N+1]=f,this.float32[N+2]=g,this.int16[V+6]=w,this.int16[V+7]=E,r},t}(Or);ps.prototype.bytesPerElement=16,pt("StructArrayLayout2f1f2i16",ps);var Fl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g){var w=this.length;return this.resize(w+1),this.emplace(w,r,c,f,g)},t.prototype.emplace=function(r,c,f,g,w){var E=12*r,N=3*r;return this.uint8[E+0]=c,this.uint8[E+1]=f,this.float32[N+1]=g,this.float32[N+2]=w,r},t}(Or);Fl.prototype.bytesPerElement=12,pt("StructArrayLayout2ub2f12",Fl);var Ya=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,f)},t.prototype.emplace=function(r,c,f,g){var w=3*r;return this.uint16[w+0]=c,this.uint16[w+1]=f,this.uint16[w+2]=g,r},t}(Or);Ya.prototype.bytesPerElement=6,pt("StructArrayLayout3ui6",Ya);var Qa=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et){var ut=this.length;return this.resize(ut+1),this.emplace(ut,r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et)},t.prototype.emplace=function(r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et,ut){var vt=24*r,bt=12*r,Ot=48*r;return this.int16[vt+0]=c,this.int16[vt+1]=f,this.uint16[vt+2]=g,this.uint16[vt+3]=w,this.uint32[bt+2]=E,this.uint32[bt+3]=N,this.uint32[bt+4]=V,this.uint16[vt+10]=J,this.uint16[vt+11]=ee,this.uint16[vt+12]=he,this.float32[bt+7]=fe,this.float32[bt+8]=Te,this.uint8[Ot+36]=Se,this.uint8[Ot+37]=We,this.uint8[Ot+38]=De,this.uint32[bt+10]=et,this.int16[vt+22]=ut,r},t}(Or);Qa.prototype.bytesPerElement=48,pt("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",Qa);var $s=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et,ut,vt,bt,Ot,Vt,oi,Mi,di,Ri,ci,or){var ji=this.length;return this.resize(ji+1),this.emplace(ji,r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et,ut,vt,bt,Ot,Vt,oi,Mi,di,Ri,ci,or)},t.prototype.emplace=function(r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se,We,De,et,ut,vt,bt,Ot,Vt,oi,Mi,di,Ri,ci,or,ji){var Pi=34*r,fr=17*r;return this.int16[Pi+0]=c,this.int16[Pi+1]=f,this.int16[Pi+2]=g,this.int16[Pi+3]=w,this.int16[Pi+4]=E,this.int16[Pi+5]=N,this.int16[Pi+6]=V,this.int16[Pi+7]=J,this.uint16[Pi+8]=ee,this.uint16[Pi+9]=he,this.uint16[Pi+10]=fe,this.uint16[Pi+11]=Te,this.uint16[Pi+12]=Se,this.uint16[Pi+13]=We,this.uint16[Pi+14]=De,this.uint16[Pi+15]=et,this.uint16[Pi+16]=ut,this.uint16[Pi+17]=vt,this.uint16[Pi+18]=bt,this.uint16[Pi+19]=Ot,this.uint16[Pi+20]=Vt,this.uint16[Pi+21]=oi,this.uint16[Pi+22]=Mi,this.uint32[fr+12]=di,this.float32[fr+13]=Ri,this.float32[fr+14]=ci,this.float32[fr+15]=or,this.float32[fr+16]=ji,r},t}(Or);$s.prototype.bytesPerElement=68,pt("StructArrayLayout8i15ui1ul4f68",$s);var $a=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.float32[1*r+0]=c,r},t}(Or);$a.prototype.bytesPerElement=4,pt("StructArrayLayout1f4",$a);var Yo=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,f)},t.prototype.emplace=function(r,c,f,g){var w=3*r;return this.int16[w+0]=c,this.int16[w+1]=f,this.int16[w+2]=g,r},t}(Or);Yo.prototype.bytesPerElement=6,pt("StructArrayLayout3i6",Yo);var jl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f){var g=this.length;return this.resize(g+1),this.emplace(g,r,c,f)},t.prototype.emplace=function(r,c,f,g){var w=4*r;return this.uint32[2*r+0]=c,this.uint16[w+2]=f,this.uint16[w+3]=g,r},t}(Or);jl.prototype.bytesPerElement=8,pt("StructArrayLayout1ul2ui8",jl);var js=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c){var f=this.length;return this.resize(f+1),this.emplace(f,r,c)},t.prototype.emplace=function(r,c,f){var g=2*r;return this.uint16[g+0]=c,this.uint16[g+1]=f,r},t}(Or);js.prototype.bytesPerElement=4,pt("StructArrayLayout2ui4",js);var el=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r){var c=this.length;return this.resize(c+1),this.emplace(c,r)},t.prototype.emplace=function(r,c){return this.uint16[1*r+0]=c,r},t}(Or);el.prototype.bytesPerElement=2,pt("StructArrayLayout1ui2",el);var Cs=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._refreshViews=function(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)},t.prototype.emplaceBack=function(r,c,f,g){var w=this.length;return this.resize(w+1),this.emplace(w,r,c,f,g)},t.prototype.emplace=function(r,c,f,g,w){var E=4*r;return this.float32[E+0]=c,this.float32[E+1]=f,this.float32[E+2]=g,this.float32[E+3]=w,r},t}(Or);Cs.prototype.bytesPerElement=16,pt("StructArrayLayout4f16",Cs);var Us=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorPointX:{configurable:!0},anchorPointY:{configurable:!0},x1:{configurable:!0},y1:{configurable:!0},x2:{configurable:!0},y2:{configurable:!0},featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0},anchorPoint:{configurable:!0}};return r.anchorPointX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorPointY.get=function(){return this._structArray.int16[this._pos2+1]},r.x1.get=function(){return this._structArray.int16[this._pos2+2]},r.y1.get=function(){return this._structArray.int16[this._pos2+3]},r.x2.get=function(){return this._structArray.int16[this._pos2+4]},r.y2.get=function(){return this._structArray.int16[this._pos2+5]},r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+8]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.anchorPoint.get=function(){return new z(this.anchorPointX,this.anchorPointY)},Object.defineProperties(t.prototype,r),t}(Ys);Us.prototype.size=20;var tl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new Us(this,r)},t}(Bl);pt("CollisionBoxArray",tl);var il=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},glyphStartIndex:{configurable:!0},numGlyphs:{configurable:!0},vertexStartIndex:{configurable:!0},lineStartIndex:{configurable:!0},lineLength:{configurable:!0},segment:{configurable:!0},lowerSize:{configurable:!0},upperSize:{configurable:!0},lineOffsetX:{configurable:!0},lineOffsetY:{configurable:!0},writingMode:{configurable:!0},placedOrientation:{configurable:!0},hidden:{configurable:!0},crossTileID:{configurable:!0},associatedIconIndex:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.glyphStartIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.numGlyphs.get=function(){return this._structArray.uint16[this._pos2+3]},r.vertexStartIndex.get=function(){return this._structArray.uint32[this._pos4+2]},r.lineStartIndex.get=function(){return this._structArray.uint32[this._pos4+3]},r.lineLength.get=function(){return this._structArray.uint32[this._pos4+4]},r.segment.get=function(){return this._structArray.uint16[this._pos2+10]},r.lowerSize.get=function(){return this._structArray.uint16[this._pos2+11]},r.upperSize.get=function(){return this._structArray.uint16[this._pos2+12]},r.lineOffsetX.get=function(){return this._structArray.float32[this._pos4+7]},r.lineOffsetY.get=function(){return this._structArray.float32[this._pos4+8]},r.writingMode.get=function(){return this._structArray.uint8[this._pos1+36]},r.placedOrientation.get=function(){return this._structArray.uint8[this._pos1+37]},r.placedOrientation.set=function(c){this._structArray.uint8[this._pos1+37]=c},r.hidden.get=function(){return this._structArray.uint8[this._pos1+38]},r.hidden.set=function(c){this._structArray.uint8[this._pos1+38]=c},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+10]},r.crossTileID.set=function(c){this._structArray.uint32[this._pos4+10]=c},r.associatedIconIndex.get=function(){return this._structArray.int16[this._pos2+22]},Object.defineProperties(t.prototype,r),t}(Ys);il.prototype.size=48;var ds=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new il(this,r)},t}(Qa);pt("PlacedSymbolArray",ds);var Ul=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={anchorX:{configurable:!0},anchorY:{configurable:!0},rightJustifiedTextSymbolIndex:{configurable:!0},centerJustifiedTextSymbolIndex:{configurable:!0},leftJustifiedTextSymbolIndex:{configurable:!0},verticalPlacedTextSymbolIndex:{configurable:!0},placedIconSymbolIndex:{configurable:!0},verticalPlacedIconSymbolIndex:{configurable:!0},key:{configurable:!0},textBoxStartIndex:{configurable:!0},textBoxEndIndex:{configurable:!0},verticalTextBoxStartIndex:{configurable:!0},verticalTextBoxEndIndex:{configurable:!0},iconBoxStartIndex:{configurable:!0},iconBoxEndIndex:{configurable:!0},verticalIconBoxStartIndex:{configurable:!0},verticalIconBoxEndIndex:{configurable:!0},featureIndex:{configurable:!0},numHorizontalGlyphVertices:{configurable:!0},numVerticalGlyphVertices:{configurable:!0},numIconVertices:{configurable:!0},numVerticalIconVertices:{configurable:!0},useRuntimeCollisionCircles:{configurable:!0},crossTileID:{configurable:!0},textBoxScale:{configurable:!0},textOffset0:{configurable:!0},textOffset1:{configurable:!0},collisionCircleDiameter:{configurable:!0}};return r.anchorX.get=function(){return this._structArray.int16[this._pos2+0]},r.anchorY.get=function(){return this._structArray.int16[this._pos2+1]},r.rightJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+2]},r.centerJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+3]},r.leftJustifiedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+4]},r.verticalPlacedTextSymbolIndex.get=function(){return this._structArray.int16[this._pos2+5]},r.placedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+6]},r.verticalPlacedIconSymbolIndex.get=function(){return this._structArray.int16[this._pos2+7]},r.key.get=function(){return this._structArray.uint16[this._pos2+8]},r.textBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+9]},r.textBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+10]},r.verticalTextBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+11]},r.verticalTextBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+12]},r.iconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+13]},r.iconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+14]},r.verticalIconBoxStartIndex.get=function(){return this._structArray.uint16[this._pos2+15]},r.verticalIconBoxEndIndex.get=function(){return this._structArray.uint16[this._pos2+16]},r.featureIndex.get=function(){return this._structArray.uint16[this._pos2+17]},r.numHorizontalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+18]},r.numVerticalGlyphVertices.get=function(){return this._structArray.uint16[this._pos2+19]},r.numIconVertices.get=function(){return this._structArray.uint16[this._pos2+20]},r.numVerticalIconVertices.get=function(){return this._structArray.uint16[this._pos2+21]},r.useRuntimeCollisionCircles.get=function(){return this._structArray.uint16[this._pos2+22]},r.crossTileID.get=function(){return this._structArray.uint32[this._pos4+12]},r.crossTileID.set=function(c){this._structArray.uint32[this._pos4+12]=c},r.textBoxScale.get=function(){return this._structArray.float32[this._pos4+13]},r.textOffset0.get=function(){return this._structArray.float32[this._pos4+14]},r.textOffset1.get=function(){return this._structArray.float32[this._pos4+15]},r.collisionCircleDiameter.get=function(){return this._structArray.float32[this._pos4+16]},Object.defineProperties(t.prototype,r),t}(Ys);Ul.prototype.size=68;var Nl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new Ul(this,r)},t}($s);pt("SymbolInstanceArray",Nl);var _u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getoffsetX=function(r){return this.float32[1*r+0]},t}($a);pt("GlyphOffsetArray",_u);var rl=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.getx=function(r){return this.int16[3*r+0]},t.prototype.gety=function(r){return this.int16[3*r+1]},t.prototype.gettileUnitDistanceFromAnchor=function(r){return this.int16[3*r+2]},t}(Yo);pt("SymbolLineVertexArray",rl);var n=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t;var r={featureIndex:{configurable:!0},sourceLayerIndex:{configurable:!0},bucketIndex:{configurable:!0}};return r.featureIndex.get=function(){return this._structArray.uint32[this._pos4+0]},r.sourceLayerIndex.get=function(){return this._structArray.uint16[this._pos2+2]},r.bucketIndex.get=function(){return this._structArray.uint16[this._pos2+3]},Object.defineProperties(t.prototype,r),t}(Ys);n.prototype.size=8;var u=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.get=function(r){return new n(this,r)},t}(jl);pt("FeatureIndexArray",u);var a=Xn([{name:"a_pos",components:2,type:"Int16"}],4).members,p=function(e){e===void 0&&(e=[]),this.segments=e};function y(e,t){return 256*(e=T(Math.floor(e),0,255))+T(Math.floor(t),0,255)}p.prototype.prepareSegment=function(e,t,r,c){var f=this.segments[this.segments.length-1];return e>p.MAX_VERTEX_ARRAY_LENGTH&&ht("Max vertices per segment is "+p.MAX_VERTEX_ARRAY_LENGTH+": bucket requested "+e),(!f||f.vertexLength+e>p.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==c)&&(f={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},c!==void 0&&(f.sortKey=c),this.segments.push(f)),f},p.prototype.get=function(){return this.segments},p.prototype.destroy=function(){for(var e=0,t=this.segments;e<t.length;e+=1){var r=t[e];for(var c in r.vaos)r.vaos[c].destroy()}},p.simpleSegment=function(e,t,r,c){return new p([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:c,vaos:{},sortKey:0}])},p.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,pt("SegmentVector",p);var M=Xn([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]),S=K(function(e){e.exports=function(t,r){var c,f,g,w,E,N,V,J;for(f=t.length-(c=3&t.length),g=r,E=3432918353,N=461845907,J=0;J<f;)V=255&t.charCodeAt(J)|(255&t.charCodeAt(++J))<<8|(255&t.charCodeAt(++J))<<16|(255&t.charCodeAt(++J))<<24,++J,g=27492+(65535&(w=5*(65535&(g=(g^=V=(65535&(V=(V=(65535&V)*E+(((V>>>16)*E&65535)<<16)&4294967295)<<15|V>>>17))*N+(((V>>>16)*N&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(w>>>16)&65535)<<16);switch(V=0,c){case 3:V^=(255&t.charCodeAt(J+2))<<16;case 2:V^=(255&t.charCodeAt(J+1))<<8;case 1:g^=V=(65535&(V=(V=(65535&(V^=255&t.charCodeAt(J)))*E+(((V>>>16)*E&65535)<<16)&4294967295)<<15|V>>>17))*N+(((V>>>16)*N&65535)<<16)&4294967295}return g^=t.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}}),j=K(function(e){e.exports=function(t,r){for(var c,f=t.length,g=r^f,w=0;f>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(w)|(255&t.charCodeAt(++w))<<8|(255&t.charCodeAt(++w))<<16|(255&t.charCodeAt(++w))<<24))+((1540483477*(c>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++w;switch(f){case 3:g^=(255&t.charCodeAt(w+2))<<16;case 2:g^=(255&t.charCodeAt(w+1))<<8;case 1:g=1540483477*(65535&(g^=255&t.charCodeAt(w)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}}),H=S,ie=j;H.murmur3=S,H.murmur2=ie;var _e=function(){this.ids=[],this.positions=[],this.indexed=!1};_e.prototype.add=function(e,t,r,c){this.ids.push(ge(e)),this.positions.push(t,r,c)},_e.prototype.getPositions=function(e){for(var t=ge(e),r=0,c=this.ids.length-1;r<c;){var f=r+c>>1;this.ids[f]>=t?c=f:r=f+1}for(var g=[];this.ids[r]===t;)g.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return g},_e.serialize=function(e,t){var r=new Float64Array(e.ids),c=new Uint32Array(e.positions);return function f(g,w,E,N){for(;E<N;){for(var V=g[E+N>>1],J=E-1,ee=N+1;;){do J++;while(g[J]<V);do ee--;while(g[ee]>V);if(J>=ee)break;Ie(g,J,ee),Ie(w,3*J,3*ee),Ie(w,3*J+1,3*ee+1),Ie(w,3*J+2,3*ee+2)}ee-E<N-ee?(f(g,w,E,ee),E=ee+1):(f(g,w,ee+1,N),N=ee)}}(r,c,0,r.length-1),t&&t.push(r.buffer,c.buffer),{ids:r,positions:c}},_e.deserialize=function(e){var t=new _e;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t};var ye=Math.pow(2,53)-1;function ge(e){var t=+e;return!isNaN(t)&&t<=ye?t:H(String(e))}function Ie(e,t,r){var c=e[t];e[t]=e[r],e[r]=c}pt("FeaturePositionMap",_e);var Ee=function(e,t){this.gl=e.gl,this.location=t},Ge=function(e){function t(r,c){e.call(this,r,c),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))},t}(Ee),Ce=function(e){function t(r,c){e.call(this,r,c),this.current=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))},t}(Ee),Ne=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1]))},t}(Ee),Je=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2]))},t}(Ee),lt=function(e){function t(r,c){e.call(this,r,c),this.current=[0,0,0,0]}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3]))},t}(Ee),yt=function(e){function t(r,c){e.call(this,r,c),this.current=Ei.transparent}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a))},t}(Ee),_t=new Float32Array(16),St=function(e){function t(r,c){e.call(this,r,c),this.current=_t}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.set=function(r){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(var c=1;c<16;c++)if(r[c]!==this.current[c]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}},t}(Ee);function zt(e){return[y(255*e.r,255*e.g),y(255*e.b,255*e.a)]}var Ht=function(e,t,r){this.value=e,this.uniformNames=t.map(function(c){return"u_"+c}),this.type=r};Ht.prototype.setUniform=function(e,t,r){e.set(r.constantOr(this.value))},Ht.prototype.getBinding=function(e,t,r){return this.type==="color"?new yt(e,t):new Ce(e,t)};var Ut=function(e,t){this.uniformNames=t.map(function(r){return"u_"+r}),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1};Ut.prototype.setConstantPatternPositions=function(e,t){this.pixelRatioFrom=t.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=t.tlbr,this.patternTo=e.tlbr},Ut.prototype.setUniform=function(e,t,r,c){var f=c==="u_pattern_to"?this.patternTo:c==="u_pattern_from"?this.patternFrom:c==="u_pixel_ratio_to"?this.pixelRatioTo:c==="u_pixel_ratio_from"?this.pixelRatioFrom:null;f&&e.set(f)},Ut.prototype.getBinding=function(e,t,r){return r.substr(0,9)==="u_pattern"?new lt(e,t):new Ce(e,t)};var Xt=function(e,t,r,c){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map(function(f){return{name:"a_"+f,type:"Float32",components:r==="color"?2:1,offset:0}}),this.paintVertexArray=new c};Xt.prototype.populatePaintArray=function(e,t,r,c,f){var g=this.paintVertexArray.length,w=this.expression.evaluate(new yr(0),t,{},c,[],f);this.paintVertexArray.resize(e),this._setPaintValue(g,e,w)},Xt.prototype.updatePaintArray=function(e,t,r,c){var f=this.expression.evaluate({zoom:0},r,c);this._setPaintValue(e,t,f)},Xt.prototype._setPaintValue=function(e,t,r){if(this.type==="color")for(var c=zt(r),f=e;f<t;f++)this.paintVertexArray.emplace(f,c[0],c[1]);else{for(var g=e;g<t;g++)this.paintVertexArray.emplace(g,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}},Xt.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},Xt.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()};var hi=function(e,t,r,c,f,g){this.expression=e,this.uniformNames=t.map(function(w){return"u_"+w+"_t"}),this.type=r,this.useIntegerZoom=c,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=t.map(function(w){return{name:"a_"+w,type:"Float32",components:r==="color"?4:2,offset:0}}),this.paintVertexArray=new g};hi.prototype.populatePaintArray=function(e,t,r,c,f){var g=this.expression.evaluate(new yr(this.zoom),t,{},c,[],f),w=this.expression.evaluate(new yr(this.zoom+1),t,{},c,[],f),E=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(E,e,g,w)},hi.prototype.updatePaintArray=function(e,t,r,c){var f=this.expression.evaluate({zoom:this.zoom},r,c),g=this.expression.evaluate({zoom:this.zoom+1},r,c);this._setPaintValue(e,t,f,g)},hi.prototype._setPaintValue=function(e,t,r,c){if(this.type==="color")for(var f=zt(r),g=zt(c),w=e;w<t;w++)this.paintVertexArray.emplace(w,f[0],f[1],g[0],g[1]);else{for(var E=e;E<t;E++)this.paintVertexArray.emplace(E,r,c);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(c))}},hi.prototype.upload=function(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))},hi.prototype.destroy=function(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()},hi.prototype.setUniform=function(e,t){var r=this.useIntegerZoom?Math.floor(t.zoom):t.zoom,c=T(this.expression.interpolationFactor(r,this.zoom,this.zoom+1),0,1);e.set(c)},hi.prototype.getBinding=function(e,t,r){return new Ce(e,t)};var Di=function(e,t,r,c,f,g){this.expression=e,this.type=t,this.useIntegerZoom=r,this.zoom=c,this.layerId=g,this.zoomInPaintVertexArray=new f,this.zoomOutPaintVertexArray=new f};Di.prototype.populatePaintArray=function(e,t,r){var c=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(c,e,t.patterns&&t.patterns[this.layerId],r)},Di.prototype.updatePaintArray=function(e,t,r,c,f){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],f)},Di.prototype._setPaintValues=function(e,t,r,c){if(c&&r){var f=c[r.min],g=c[r.mid],w=c[r.max];if(f&&g&&w)for(var E=e;E<t;E++)this.zoomInPaintVertexArray.emplace(E,g.tl[0],g.tl[1],g.br[0],g.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],g.pixelRatio,f.pixelRatio),this.zoomOutPaintVertexArray.emplace(E,g.tl[0],g.tl[1],g.br[0],g.br[1],w.tl[0],w.tl[1],w.br[0],w.br[1],g.pixelRatio,w.pixelRatio)}},Di.prototype.upload=function(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,M.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,M.members,this.expression.isStateDependent))},Di.prototype.destroy=function(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()};var Li=function(e,t,r){this.binders={},this._buffers=[];var c=[];for(var f in e.paint._values)if(r(f)){var g=e.paint.get(f);if(g instanceof yo&&Ve(g.property.specification)){var w=mi(f,e.type),E=g.value,N=g.property.specification.type,V=g.property.useIntegerZoom,J=g.property.specification["property-type"],ee=J==="cross-faded"||J==="cross-faded-data-driven";if(E.kind==="constant")this.binders[f]=ee?new Ut(E.value,w):new Ht(E.value,w,N),c.push("/u_"+f);else if(E.kind==="source"||ee){var he=sr(f,N,"source");this.binders[f]=ee?new Di(E,N,V,t,he,e.id):new Xt(E,w,N,he),c.push("/a_"+f)}else{var fe=sr(f,N,"composite");this.binders[f]=new hi(E,w,N,V,t,fe),c.push("/z_"+f)}}}this.cacheKey=c.sort().join("")};Li.prototype.getMaxValue=function(e){var t=this.binders[e];return t instanceof Xt||t instanceof hi?t.maxValue:0},Li.prototype.populatePaintArrays=function(e,t,r,c,f){for(var g in this.binders){var w=this.binders[g];(w instanceof Xt||w instanceof hi||w instanceof Di)&&w.populatePaintArray(e,t,r,c,f)}},Li.prototype.setConstantPatternPositions=function(e,t){for(var r in this.binders){var c=this.binders[r];c instanceof Ut&&c.setConstantPatternPositions(e,t)}},Li.prototype.updatePaintArrays=function(e,t,r,c,f){var g=!1;for(var w in e)for(var E=0,N=t.getPositions(w);E<N.length;E+=1){var V=N[E],J=r.feature(V.index);for(var ee in this.binders){var he=this.binders[ee];if((he instanceof Xt||he instanceof hi||he instanceof Di)&&he.expression.isStateDependent===!0){var fe=c.paint.get(ee);he.expression=fe.value,he.updatePaintArray(V.start,V.end,J,e[w],f),g=!0}}}return g},Li.prototype.defines=function(){var e=[];for(var t in this.binders){var r=this.binders[t];(r instanceof Ht||r instanceof Ut)&&e.push.apply(e,r.uniformNames.map(function(c){return"#define HAS_UNIFORM_"+c}))}return e},Li.prototype.getBinderAttributes=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Xt||r instanceof hi)for(var c=0;c<r.paintVertexAttributes.length;c++)e.push(r.paintVertexAttributes[c].name);else if(r instanceof Di)for(var f=0;f<M.members.length;f++)e.push(M.members[f].name)}return e},Li.prototype.getBinderUniforms=function(){var e=[];for(var t in this.binders){var r=this.binders[t];if(r instanceof Ht||r instanceof Ut||r instanceof hi)for(var c=0,f=r.uniformNames;c<f.length;c+=1)e.push(f[c])}return e},Li.prototype.getPaintVertexBuffers=function(){return this._buffers},Li.prototype.getUniforms=function(e,t){var r=[];for(var c in this.binders){var f=this.binders[c];if(f instanceof Ht||f instanceof Ut||f instanceof hi)for(var g=0,w=f.uniformNames;g<w.length;g+=1){var E=w[g];if(t[E]){var N=f.getBinding(e,t[E],E);r.push({name:E,property:c,binding:N})}}}return r},Li.prototype.setUniforms=function(e,t,r,c){for(var f=0,g=t;f<g.length;f+=1){var w=g[f],E=w.name,N=w.property;this.binders[N].setUniform(w.binding,c,r.get(N),E)}},Li.prototype.updatePaintBuffers=function(e){for(var t in this._buffers=[],this.binders){var r=this.binders[t];if(e&&r instanceof Di){var c=e.fromScale===2?r.zoomInPaintVertexBuffer:r.zoomOutPaintVertexBuffer;c&&this._buffers.push(c)}else(r instanceof Xt||r instanceof hi)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}},Li.prototype.upload=function(e){for(var t in this.binders){var r=this.binders[t];(r instanceof Xt||r instanceof hi||r instanceof Di)&&r.upload(e)}this.updatePaintBuffers()},Li.prototype.destroy=function(){for(var e in this.binders){var t=this.binders[e];(t instanceof Xt||t instanceof hi||t instanceof Di)&&t.destroy()}};var Ji=function(e,t,r){r===void 0&&(r=function(){return!0}),this.programConfigurations={};for(var c=0,f=e;c<f.length;c+=1){var g=f[c];this.programConfigurations[g.id]=new Li(g,t,r)}this.needsUpload=!1,this._featureMap=new _e,this._bufferOffset=0};function mi(e,t){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[e]||[e.replace(t+"-","").replace(/-/g,"_")]}function sr(e,t,r){var c={color:{source:Ms,composite:Cs},number:{source:$a,composite:Ms}},f=function(g){return{"line-pattern":{source:Pa,composite:Pa},"fill-pattern":{source:Pa,composite:Pa},"fill-extrusion-pattern":{source:Pa,composite:Pa}}[g]}(e);return f&&f[r]||c[t][r]}Ji.prototype.populatePaintArrays=function(e,t,r,c,f,g){for(var w in this.programConfigurations)this.programConfigurations[w].populatePaintArrays(e,t,c,f,g);t.id!==void 0&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0},Ji.prototype.updatePaintArrays=function(e,t,r,c){for(var f=0,g=r;f<g.length;f+=1){var w=g[f];this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(e,this._featureMap,t,w,c)||this.needsUpload}},Ji.prototype.get=function(e){return this.programConfigurations[e]},Ji.prototype.upload=function(e){if(this.needsUpload){for(var t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}},Ji.prototype.destroy=function(){for(var e in this.programConfigurations)this.programConfigurations[e].destroy()},pt("ConstantBinder",Ht),pt("CrossFadedConstantBinder",Ut),pt("SourceExpressionBinder",Xt),pt("CrossFadedCompositeBinder",Di),pt("CompositeExpressionBinder",hi),pt("ProgramConfiguration",Li,{omit:["_buffers"]}),pt("ProgramConfigurationSet",Ji);var mr=Math.pow(2,14)-1,lr=-mr-1;function Xi(e){for(var t=8192/e.extent,r=e.loadGeometry(),c=0;c<r.length;c++)for(var f=r[c],g=0;g<f.length;g++){var w=f[g],E=Math.round(w.x*t),N=Math.round(w.y*t);w.x=T(E,lr,mr),w.y=T(N,lr,mr),(E<w.x||E>w.x+1||N<w.y||N>w.y+1)&&ht("Geometry exceeds allowed extent, reduce your vector tile buffer size")}return r}function Pr(e,t,r,c,f){e.emplaceBack(2*t+(c+1)/2,2*r+(f+1)/2)}var qi=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new cs,this.indexArray=new Ya,this.segments=new p,this.programConfigurations=new Ji(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function er(e,t){for(var r=0;r<e.length;r++)if(Bo(t,e[r]))return!0;for(var c=0;c<t.length;c++)if(Bo(e,t[c]))return!0;return!!Tn(e,t)}function Yn(e,t,r){return!!Bo(e,t)||!!$n(t,e,r)}function an(e,t){if(e.length===1)return es(t,e[0]);for(var r=0;r<t.length;r++)for(var c=t[r],f=0;f<c.length;f++)if(Bo(e,c[f]))return!0;for(var g=0;g<e.length;g++)if(es(t,e[g]))return!0;for(var w=0;w<t.length;w++)if(Tn(e,t[w]))return!0;return!1}function zo(e,t,r){if(e.length>1){if(Tn(e,t))return!0;for(var c=0;c<t.length;c++)if($n(t[c],e,r))return!0}for(var f=0;f<e.length;f++)if($n(e[f],t,r))return!0;return!1}function Tn(e,t){if(e.length===0||t.length===0)return!1;for(var r=0;r<e.length-1;r++)for(var c=e[r],f=e[r+1],g=0;g<t.length-1;g++)if(Qn(c,f,t[g],t[g+1]))return!0;return!1}function Qn(e,t,r,c){return Et(e,r,c)!==Et(t,r,c)&&Et(e,t,r)!==Et(e,t,c)}function $n(e,t,r){var c=r*r;if(t.length===1)return e.distSqr(t[0])<c;for(var f=1;f<t.length;f++)if(ha(e,t[f-1],t[f])<c)return!0;return!1}function ha(e,t,r){var c=t.distSqr(r);if(c===0)return e.distSqr(t);var f=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/c;return e.distSqr(f<0?t:f>1?r:r.sub(t)._mult(f)._add(t))}function es(e,t){for(var r,c,f,g=!1,w=0;w<e.length;w++)for(var E=0,N=(r=e[w]).length-1;E<r.length;N=E++)(c=r[E]).y>t.y!=(f=r[N]).y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(g=!g);return g}function Bo(e,t){for(var r=!1,c=0,f=e.length-1;c<e.length;f=c++){var g=e[c],w=e[f];g.y>t.y!=w.y>t.y&&t.x<(w.x-g.x)*(t.y-g.y)/(w.y-g.y)+g.x&&(r=!r)}return r}function Mo(e,t,r){var c=r[0],f=r[2];if(e.x<c.x&&t.x<c.x||e.x>f.x&&t.x>f.x||e.y<c.y&&t.y<c.y||e.y>f.y&&t.y>f.y)return!1;var g=Et(e,t,r[0]);return g!==Et(e,t,r[1])||g!==Et(e,t,r[2])||g!==Et(e,t,r[3])}function Fo(e,t,r){var c=t.paint.get(e).value;return c.kind==="constant"?c.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Zo(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function fs(e,t,r,c,f){if(!t[0]&&!t[1])return e;var g=z.convert(t)._mult(f);r==="viewport"&&g._rotate(-c);for(var w=[],E=0;E<e.length;E++)w.push(e[E].sub(g));return w}qi.prototype.populate=function(e,t,r){var c=this.layers[0],f=[],g=null;c.type==="circle"&&(g=c.layout.get("circle-sort-key"));for(var w=0,E=e;w<E.length;w+=1){var N=E[w],V=N.feature,J=N.id,ee=N.index,he=N.sourceLayerIndex,fe=this.layers[0]._featureFilter.needGeometry,Te={type:V.type,id:J,properties:V.properties,geometry:fe?Xi(V):[]};if(this.layers[0]._featureFilter.filter(new yr(this.zoom),Te,r)){fe||(Te.geometry=Xi(V));var Se=g?g.evaluate(Te,{},r):void 0;f.push({id:J,properties:V.properties,type:V.type,sourceLayerIndex:he,index:ee,geometry:Te.geometry,patterns:{},sortKey:Se})}}g&&f.sort(function(Vt,oi){return Vt.sortKey-oi.sortKey});for(var We=0,De=f;We<De.length;We+=1){var et=De[We],ut=et.geometry,vt=et.index,bt=et.sourceLayerIndex,Ot=e[vt].feature;this.addFeature(et,ut,vt,r),t.featureIndex.insert(Ot,ut,vt,bt,this.index)}},qi.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},qi.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},qi.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},qi.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,a),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},qi.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},qi.prototype.addFeature=function(e,t,r,c){for(var f=0,g=t;f<g.length;f+=1)for(var w=0,E=g[f];w<E.length;w+=1){var N=E[w],V=N.x,J=N.y;if(!(V<0||V>=8192||J<0||J>=8192)){var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),he=ee.vertexLength;Pr(this.layoutVertexArray,V,J,-1,-1),Pr(this.layoutVertexArray,V,J,1,-1),Pr(this.layoutVertexArray,V,J,1,1),Pr(this.layoutVertexArray,V,J,-1,1),this.indexArray.emplaceBack(he,he+1,he+2),this.indexArray.emplaceBack(he,he+3,he+2),ee.vertexLength+=4,ee.primitiveLength+=2}}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},c)},pt("CircleBucket",qi,{omit:["layers"]});var _s=new no({"circle-sort-key":new wi(xe.layout_circle["circle-sort-key"])}),Ns={paint:new no({"circle-radius":new wi(xe.paint_circle["circle-radius"]),"circle-color":new wi(xe.paint_circle["circle-color"]),"circle-blur":new wi(xe.paint_circle["circle-blur"]),"circle-opacity":new wi(xe.paint_circle["circle-opacity"]),"circle-translate":new Ai(xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ai(xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ai(xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ai(xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new wi(xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new wi(xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new wi(xe.paint_circle["circle-stroke-opacity"])}),layout:_s},oo=typeof Float32Array!="undefined"?Float32Array:Array;function ms(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Gs(e,t,r){var c=t[0],f=t[1],g=t[2],w=t[3],E=t[4],N=t[5],V=t[6],J=t[7],ee=t[8],he=t[9],fe=t[10],Te=t[11],Se=t[12],We=t[13],De=t[14],et=t[15],ut=r[0],vt=r[1],bt=r[2],Ot=r[3];return e[0]=ut*c+vt*E+bt*ee+Ot*Se,e[1]=ut*f+vt*N+bt*he+Ot*We,e[2]=ut*g+vt*V+bt*fe+Ot*De,e[3]=ut*w+vt*J+bt*Te+Ot*et,e[4]=(ut=r[4])*c+(vt=r[5])*E+(bt=r[6])*ee+(Ot=r[7])*Se,e[5]=ut*f+vt*N+bt*he+Ot*We,e[6]=ut*g+vt*V+bt*fe+Ot*De,e[7]=ut*w+vt*J+bt*Te+Ot*et,e[8]=(ut=r[8])*c+(vt=r[9])*E+(bt=r[10])*ee+(Ot=r[11])*Se,e[9]=ut*f+vt*N+bt*he+Ot*We,e[10]=ut*g+vt*V+bt*fe+Ot*De,e[11]=ut*w+vt*J+bt*Te+Ot*et,e[12]=(ut=r[12])*c+(vt=r[13])*E+(bt=r[14])*ee+(Ot=r[15])*Se,e[13]=ut*f+vt*N+bt*he+Ot*We,e[14]=ut*g+vt*V+bt*fe+Ot*De,e[15]=ut*w+vt*J+bt*Te+Ot*et,e}Math.hypot||(Math.hypot=function(){for(var e=arguments,t=0,r=arguments.length;r--;)t+=e[r]*e[r];return Math.sqrt(t)});var Aa,lo=Gs;function Da(e,t,r){var c=t[0],f=t[1],g=t[2],w=t[3];return e[0]=r[0]*c+r[4]*f+r[8]*g+r[12]*w,e[1]=r[1]*c+r[5]*f+r[9]*g+r[13]*w,e[2]=r[2]*c+r[6]*f+r[10]*g+r[14]*w,e[3]=r[3]*c+r[7]*f+r[11]*g+r[15]*w,e}Aa=new oo(3),oo!=Float32Array&&(Aa[0]=0,Aa[1]=0,Aa[2]=0),function(){var e=new oo(4);oo!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var nl=(function(){var e=new oo(2);oo!=Float32Array&&(e[0]=0,e[1]=0)}(),function(e){function t(r){e.call(this,r,Ns)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new qi(r)},t.prototype.queryRadius=function(r){var c=r;return Fo("circle-radius",this,c)+Fo("circle-stroke-width",this,c)+Zo(this.paint.get("circle-translate"))},t.prototype.queryIntersectsFeature=function(r,c,f,g,w,E,N,V){for(var J=fs(r,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),E.angle,N),ee=this.paint.get("circle-radius").evaluate(c,f)+this.paint.get("circle-stroke-width").evaluate(c,f),he=this.paint.get("circle-pitch-alignment")==="map",fe=he?J:function(Vt,oi){return Vt.map(function(Mi){return Ra(Mi,oi)})}(J,V),Te=he?ee*N:ee,Se=0,We=g;Se<We.length;Se+=1)for(var De=0,et=We[Se];De<et.length;De+=1){var ut=et[De],vt=he?ut:Ra(ut,V),bt=Te,Ot=Da([],[ut.x,ut.y,0,1],V);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?bt*=Ot[3]/E.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(bt*=E.cameraToCenterDistance/Ot[3]),Yn(fe,vt,bt))return!0}return!1},t}(wa));function Ra(e,t){var r=Da([],[e.x,e.y,0,1],t);return new z(r[0]/r[3],r[1]/r[3])}var Es=function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(qi);function tn(e,t,r,c){var f=t.width,g=t.height;if(c){if(c instanceof Uint8ClampedArray)c=new Uint8Array(c.buffer);else if(c.length!==f*g*r)throw new RangeError("mismatched image size")}else c=new Uint8Array(f*g*r);return e.width=f,e.height=g,e.data=c,e}function Qo(e,t,r){var c=t.width,f=t.height;if(c!==e.width||f!==e.height){var g=tn({},{width:c,height:f},r);vo(e,g,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,c),height:Math.min(e.height,f)},r),e.width=c,e.height=f,e.data=g.data}}function vo(e,t,r,c,f,g){if(f.width===0||f.height===0)return t;if(f.width>e.width||f.height>e.height||r.x>e.width-f.width||r.y>e.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");for(var w=e.data,E=t.data,N=0;N<f.height;N++)for(var V=((r.y+N)*e.width+r.x)*g,J=((c.y+N)*t.width+c.x)*g,ee=0;ee<f.width*g;ee++)E[J+ee]=w[V+ee];return t}pt("HeatmapBucket",Es,{omit:["layers"]});var La=function(e,t){tn(this,e,1,t)};La.prototype.resize=function(e){Qo(this,e,1)},La.prototype.clone=function(){return new La({width:this.width,height:this.height},new Uint8Array(this.data))},La.copy=function(e,t,r,c,f){vo(e,t,r,c,f,1)};var bo=function(e,t){tn(this,e,4,t)};bo.prototype.resize=function(e){Qo(this,e,4)},bo.prototype.replace=function(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e},bo.prototype.clone=function(){return new bo({width:this.width,height:this.height},new Uint8Array(this.data))},bo.copy=function(e,t,r,c,f){vo(e,t,r,c,f,4)},pt("AlphaImage",La),pt("RGBAImage",bo);var Ju={paint:new no({"heatmap-radius":new wi(xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new wi(xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ai(xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ua(xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ai(xe.paint_heatmap["heatmap-opacity"])})};function mu(e){var t={},r=e.resolution||256,c=e.clips?e.clips.length:1,f=e.image||new bo({width:r,height:c}),g=function(Te,Se,We){t[e.evaluationKey]=We;var De=e.expression.evaluate(t);f.data[Te+Se+0]=Math.floor(255*De.r/De.a),f.data[Te+Se+1]=Math.floor(255*De.g/De.a),f.data[Te+Se+2]=Math.floor(255*De.b/De.a),f.data[Te+Se+3]=Math.floor(255*De.a)};if(e.clips)for(var w=0,E=0;w<c;++w,E+=4*r)for(var N=0,V=0;N<r;N++,V+=4){var J=N/(r-1),ee=e.clips[w];g(E,V,ee.start*(1-J)+ee.end*J)}else for(var he=0,fe=0;he<r;he++,fe+=4)g(0,fe,he/(r-1));return f}var ol=function(e){function t(r){e.call(this,r,Ju),this._updateColorRamp()}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Es(r)},t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="heatmap-color"&&this._updateColorRamp()},t.prototype._updateColorRamp=function(){this.colorRamp=mu({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null},t.prototype.resize=function(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype.hasOffscreenPass=function(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"},t}(wa),Xu={paint:new no({"hillshade-illumination-direction":new Ai(xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ai(xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ai(xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ai(xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ai(xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ai(xe.paint_hillshade["hillshade-accent-color"])})},al=function(e){function t(r){e.call(this,r,Xu)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.hasOffscreenPass=function(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"},t}(wa),Gl=Xn([{name:"a_pos",components:2,type:"Int16"}],4).members,Yu=gu,Vc=gu;function gu(e,t,r){r=r||2;var c,f,g,w,E,N,V,J=t&&t.length,ee=J?t[0]*r:e.length,he=Th(e,0,ee,r,!0),fe=[];if(!he||he.next===he.prev)return fe;if(J&&(he=function(Se,We,De,et){var ut,vt,bt,Ot=[];for(ut=0,vt=We.length;ut<vt;ut++)(bt=Th(Se,We[ut]*et,ut<vt-1?We[ut+1]*et:Se.length,et,!1))===bt.next&&(bt.steiner=!0),Ot.push($c(bt));for(Ot.sort(Xc),ut=0;ut<Ot.length;ut++)Yc(Ot[ut],De),De=Os(De,De.next);return De}(e,t,he,r)),e.length>80*r){c=g=e[0],f=w=e[1];for(var Te=r;Te<ee;Te+=r)(E=e[Te])<c&&(c=E),(N=e[Te+1])<f&&(f=N),E>g&&(g=E),N>w&&(w=N);V=(V=Math.max(g-c,w-f))!==0?1/V:0}return Wl(he,fe,r,c,f,V),fe}function Th(e,t,r,c,f){var g,w;if(f===eh(e,t,r,c)>0)for(g=t;g<r;g+=c)w=Eh(g,e[g],e[g+1],w);else for(g=r-c;g>=t;g-=c)w=Eh(g,e[g],e[g+1],w);return w&&yu(w,w.next)&&(Vl(w),w=w.next),w}function Os(e,t){if(!e)return e;t||(t=e);var r,c=e;do if(r=!1,c.steiner||!yu(c,c.next)&&Sn(c.prev,c,c.next)!==0)c=c.next;else{if(Vl(c),(c=t=c.prev)===c.next)break;r=!0}while(r||c!==t);return t}function Wl(e,t,r,c,f,g,w){if(e){!w&&g&&function(J,ee,he,fe){var Te=J;do Te.z===null&&(Te.z=Qu(Te.x,Te.y,ee,he,fe)),Te.prevZ=Te.prev,Te.nextZ=Te.next,Te=Te.next;while(Te!==J);Te.prevZ.nextZ=null,Te.prevZ=null,function(Se){var We,De,et,ut,vt,bt,Ot,Vt,oi=1;do{for(De=Se,Se=null,vt=null,bt=0;De;){for(bt++,et=De,Ot=0,We=0;We<oi&&(Ot++,et=et.nextZ);We++);for(Vt=oi;Ot>0||Vt>0&&et;)Ot!==0&&(Vt===0||!et||De.z<=et.z)?(ut=De,De=De.nextZ,Ot--):(ut=et,et=et.nextZ,Vt--),vt?vt.nextZ=ut:Se=ut,ut.prevZ=vt,vt=ut;De=et}vt.nextZ=null,oi*=2}while(bt>1)}(Te)}(e,c,f,g);for(var E,N,V=e;e.prev!==e.next;)if(E=e.prev,N=e.next,g?Hc(e,c,f,g):Kc(e))t.push(E.i/r),t.push(e.i/r),t.push(N.i/r),Vl(e),e=N.next,V=N.next;else if((e=N)===V){w?w===1?Wl(e=qc(Os(e),t,r),t,r,c,f,g,2):w===2&&Jc(e,t,r,c,f,g):Wl(Os(e),t,r,c,f,g,1);break}}}function Kc(e){var t=e.prev,r=e,c=e.next;if(Sn(t,r,c)>=0)return!1;for(var f=e.next.next;f!==e.prev;){if(sl(t.x,t.y,r.x,r.y,c.x,c.y,f.x,f.y)&&Sn(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function Hc(e,t,r,c){var f=e.prev,g=e,w=e.next;if(Sn(f,g,w)>=0)return!1;for(var E=f.x>g.x?f.x>w.x?f.x:w.x:g.x>w.x?g.x:w.x,N=f.y>g.y?f.y>w.y?f.y:w.y:g.y>w.y?g.y:w.y,V=Qu(f.x<g.x?f.x<w.x?f.x:w.x:g.x<w.x?g.x:w.x,f.y<g.y?f.y<w.y?f.y:w.y:g.y<w.y?g.y:w.y,t,r,c),J=Qu(E,N,t,r,c),ee=e.prevZ,he=e.nextZ;ee&&ee.z>=V&&he&&he.z<=J;){if(ee!==e.prev&&ee!==e.next&&sl(f.x,f.y,g.x,g.y,w.x,w.y,ee.x,ee.y)&&Sn(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,he!==e.prev&&he!==e.next&&sl(f.x,f.y,g.x,g.y,w.x,w.y,he.x,he.y)&&Sn(he.prev,he,he.next)>=0))return!1;he=he.nextZ}for(;ee&&ee.z>=V;){if(ee!==e.prev&&ee!==e.next&&sl(f.x,f.y,g.x,g.y,w.x,w.y,ee.x,ee.y)&&Sn(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;he&&he.z<=J;){if(he!==e.prev&&he!==e.next&&sl(f.x,f.y,g.x,g.y,w.x,w.y,he.x,he.y)&&Sn(he.prev,he,he.next)>=0)return!1;he=he.nextZ}return!0}function qc(e,t,r){var c=e;do{var f=c.prev,g=c.next.next;!yu(f,g)&&Sh(f,c,c.next,g)&&Zl(f,g)&&Zl(g,f)&&(t.push(f.i/r),t.push(c.i/r),t.push(g.i/r),Vl(c),Vl(c.next),c=e=g),c=c.next}while(c!==e);return Os(c)}function Jc(e,t,r,c,f,g){var w=e;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&ep(w,E)){var N=Ch(w,E);return w=Os(w,w.next),N=Os(N,N.next),Wl(w,t,r,c,f,g),void Wl(N,t,r,c,f,g)}E=E.next}w=w.next}while(w!==e)}function Xc(e,t){return e.x-t.x}function Yc(e,t){if(t=function(c,f){var g,w=f,E=c.x,N=c.y,V=-1/0;do{if(N<=w.y&&N>=w.next.y&&w.next.y!==w.y){var J=w.x+(N-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(J<=E&&J>V){if(V=J,J===E){if(N===w.y)return w;if(N===w.next.y)return w.next}g=w.x<w.next.x?w:w.next}}w=w.next}while(w!==f);if(!g)return null;if(E===V)return g;var ee,he=g,fe=g.x,Te=g.y,Se=1/0;w=g;do E>=w.x&&w.x>=fe&&E!==w.x&&sl(N<Te?E:V,N,fe,Te,N<Te?V:E,N,w.x,w.y)&&(ee=Math.abs(N-w.y)/(E-w.x),Zl(w,c)&&(ee<Se||ee===Se&&(w.x>g.x||w.x===g.x&&Qc(g,w)))&&(g=w,Se=ee)),w=w.next;while(w!==he);return g}(e,t)){var r=Ch(t,e);Os(t,t.next),Os(r,r.next)}}function Qc(e,t){return Sn(e.prev,e,t.prev)<0&&Sn(t.next,e,e.next)<0}function Qu(e,t,r,c,f){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*f)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-c)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function $c(e){var t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function sl(e,t,r,c,f,g,w,E){return(f-w)*(t-E)-(e-w)*(g-E)>=0&&(e-w)*(c-E)-(r-w)*(t-E)>=0&&(r-w)*(g-E)-(f-w)*(c-E)>=0}function ep(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(r,c){var f=r;do{if(f.i!==r.i&&f.next.i!==r.i&&f.i!==c.i&&f.next.i!==c.i&&Sh(f,f.next,r,c))return!0;f=f.next}while(f!==r);return!1}(e,t)&&(Zl(e,t)&&Zl(t,e)&&function(r,c){var f=r,g=!1,w=(r.x+c.x)/2,E=(r.y+c.y)/2;do f.y>E!=f.next.y>E&&f.next.y!==f.y&&w<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(g=!g),f=f.next;while(f!==r);return g}(e,t)&&(Sn(e.prev,e,t.prev)||Sn(e,t.prev,t))||yu(e,t)&&Sn(e.prev,e,e.next)>0&&Sn(t.prev,t,t.next)>0)}function Sn(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function yu(e,t){return e.x===t.x&&e.y===t.y}function Sh(e,t,r,c){var f=bu(Sn(e,t,r)),g=bu(Sn(e,t,c)),w=bu(Sn(r,c,e)),E=bu(Sn(r,c,t));return f!==g&&w!==E||!(f!==0||!vu(e,r,t))||!(g!==0||!vu(e,c,t))||!(w!==0||!vu(r,e,c))||!(E!==0||!vu(r,t,c))}function vu(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function bu(e){return e>0?1:e<0?-1:0}function Zl(e,t){return Sn(e.prev,e,e.next)<0?Sn(e,t,e.next)>=0&&Sn(e,e.prev,t)>=0:Sn(e,t,e.prev)<0||Sn(e,e.next,t)<0}function Ch(e,t){var r=new $u(e.i,e.x,e.y),c=new $u(t.i,t.x,t.y),f=e.next,g=t.prev;return e.next=t,t.prev=e,r.next=f,f.prev=r,c.next=r,r.prev=c,g.next=c,c.prev=g,c}function Eh(e,t,r,c){var f=new $u(e,t,r);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Vl(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function $u(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function eh(e,t,r,c){for(var f=0,g=t,w=r-c;g<r;g+=c)f+=(e[w]-e[g])*(e[g+1]+e[w+1]),w=g;return f}function tp(e,t,r,c,f){(function g(w,E,N,V,J){for(;V>N;){if(V-N>600){var ee=V-N+1,he=E-N+1,fe=Math.log(ee),Te=.5*Math.exp(2*fe/3),Se=.5*Math.sqrt(fe*Te*(ee-Te)/ee)*(he-ee/2<0?-1:1);g(w,E,Math.max(N,Math.floor(E-he*Te/ee+Se)),Math.min(V,Math.floor(E+(ee-he)*Te/ee+Se)),J)}var We=w[E],De=N,et=V;for(Kl(w,N,E),J(w[V],We)>0&&Kl(w,N,V);De<et;){for(Kl(w,De,et),De++,et--;J(w[De],We)<0;)De++;for(;J(w[et],We)>0;)et--}J(w[N],We)===0?Kl(w,N,et):Kl(w,++et,V),et<=E&&(N=et+1),E<=et&&(V=et-1)}})(e,t,r||0,c||e.length-1,f||ip)}function Kl(e,t,r){var c=e[t];e[t]=e[r],e[r]=c}function ip(e,t){return e<t?-1:e>t?1:0}function th(e,t){var r=e.length;if(r<=1)return[e];for(var c,f,g=[],w=0;w<r;w++){var E=bi(e[w]);E!==0&&(e[w].area=Math.abs(E),f===void 0&&(f=E<0),f===E<0?(c&&g.push(c),c=[e[w]]):c.push(e[w]))}if(c&&g.push(c),t>1)for(var N=0;N<g.length;N++)g[N].length<=t||(tp(g[N],t,1,g[N].length-1,rp),g[N]=g[N].slice(0,t));return g}function rp(e,t){return t.area-e.area}function ih(e,t,r){for(var c=r.patternDependencies,f=!1,g=0,w=t;g<w.length;g+=1){var E=w[g].paint.get(e+"-pattern");E.isConstant()||(f=!0);var N=E.constantOr(null);N&&(f=!0,c[N.to]=!0,c[N.from]=!0)}return f}function rh(e,t,r,c,f){for(var g=f.patternDependencies,w=0,E=t;w<E.length;w+=1){var N=E[w],V=N.paint.get(e+"-pattern").value;if(V.kind!=="constant"){var J=V.evaluate({zoom:c-1},r,{},f.availableImages),ee=V.evaluate({zoom:c},r,{},f.availableImages),he=V.evaluate({zoom:c+1},r,{},f.availableImages);ee=ee&&ee.name?ee.name:ee,he=he&&he.name?he.name:he,g[J=J&&J.name?J.name:J]=!0,g[ee]=!0,g[he]=!0,r.patterns[N.id]={min:J,mid:ee,max:he}}}return r}gu.deviation=function(e,t,r,c){var f=t&&t.length,g=Math.abs(eh(e,0,f?t[0]*r:e.length,r));if(f)for(var w=0,E=t.length;w<E;w++)g-=Math.abs(eh(e,t[w]*r,w<E-1?t[w+1]*r:e.length,r));var N=0;for(w=0;w<c.length;w+=3){var V=c[w]*r,J=c[w+1]*r,ee=c[w+2]*r;N+=Math.abs((e[V]-e[ee])*(e[J+1]-e[V+1])-(e[V]-e[J])*(e[ee+1]-e[V+1]))}return g===0&&N===0?0:Math.abs((N-g)/g)},gu.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},c=0,f=0;f<e.length;f++){for(var g=0;g<e[f].length;g++)for(var w=0;w<t;w++)r.vertices.push(e[f][g][w]);f>0&&r.holes.push(c+=e[f-1].length)}return r},Yu.default=Vc;var za=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new cs,this.indexArray=new Ya,this.indexArray2=new js,this.programConfigurations=new Ji(e.layers,e.zoom),this.segments=new p,this.segments2=new p,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};za.prototype.populate=function(e,t,r){this.hasPattern=ih("fill",this.layers,t);for(var c=this.layers[0].layout.get("fill-sort-key"),f=[],g=0,w=e;g<w.length;g+=1){var E=w[g],N=E.feature,V=E.id,J=E.index,ee=E.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,fe={type:N.type,id:V,properties:N.properties,geometry:he?Xi(N):[]};if(this.layers[0]._featureFilter.filter(new yr(this.zoom),fe,r)){he||(fe.geometry=Xi(N));var Te=c?c.evaluate(fe,{},r,t.availableImages):void 0;f.push({id:V,properties:N.properties,type:N.type,sourceLayerIndex:ee,index:J,geometry:fe.geometry,patterns:{},sortKey:Te})}}c&&f.sort(function(Ot,Vt){return Ot.sortKey-Vt.sortKey});for(var Se=0,We=f;Se<We.length;Se+=1){var De=We[Se],et=De.geometry,ut=De.index,vt=De.sourceLayerIndex;if(this.hasPattern){var bt=rh("fill",this.layers,De,this.zoom,t);this.patternFeatures.push(bt)}else this.addFeature(De,et,ut,r,{});t.featureIndex.insert(e[ut].feature,et,ut,vt,this.index)}},za.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},za.prototype.addFeatures=function(e,t,r){for(var c=0,f=this.patternFeatures;c<f.length;c+=1){var g=f[c];this.addFeature(g,g.geometry,g.index,t,r)}},za.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},za.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},za.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gl),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0},za.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())},za.prototype.addFeature=function(e,t,r,c,f){for(var g=0,w=th(t,500);g<w.length;g+=1){for(var E=w[g],N=0,V=0,J=E;V<J.length;V+=1)N+=J[V].length;for(var ee=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray),he=ee.vertexLength,fe=[],Te=[],Se=0,We=E;Se<We.length;Se+=1){var De=We[Se];if(De.length!==0){De!==E[0]&&Te.push(fe.length/2);var et=this.segments2.prepareSegment(De.length,this.layoutVertexArray,this.indexArray2),ut=et.vertexLength;this.layoutVertexArray.emplaceBack(De[0].x,De[0].y),this.indexArray2.emplaceBack(ut+De.length-1,ut),fe.push(De[0].x),fe.push(De[0].y);for(var vt=1;vt<De.length;vt++)this.layoutVertexArray.emplaceBack(De[vt].x,De[vt].y),this.indexArray2.emplaceBack(ut+vt-1,ut+vt),fe.push(De[vt].x),fe.push(De[vt].y);et.vertexLength+=De.length,et.primitiveLength+=De.length}}for(var bt=Yu(fe,Te),Ot=0;Ot<bt.length;Ot+=3)this.indexArray.emplaceBack(he+bt[Ot],he+bt[Ot+1],he+bt[Ot+2]);ee.vertexLength+=N,ee.primitiveLength+=bt.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,c)},pt("FillBucket",za,{omit:["layers","patternFeatures"]});var np=new no({"fill-sort-key":new wi(xe.layout_fill["fill-sort-key"])}),op={paint:new no({"fill-antialias":new Ai(xe.paint_fill["fill-antialias"]),"fill-opacity":new wi(xe.paint_fill["fill-opacity"]),"fill-color":new wi(xe.paint_fill["fill-color"]),"fill-outline-color":new wi(xe.paint_fill["fill-outline-color"]),"fill-translate":new Ai(xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ai(xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Xs(xe.paint_fill["fill-pattern"])}),layout:np},ap=function(e){function t(r){e.call(this,r,op)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,c){e.prototype.recalculate.call(this,r,c);var f=this.paint._values["fill-outline-color"];f.value.kind==="constant"&&f.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])},t.prototype.createBucket=function(r){return new za(r)},t.prototype.queryRadius=function(){return Zo(this.paint.get("fill-translate"))},t.prototype.queryIntersectsFeature=function(r,c,f,g,w,E,N){return an(fs(r,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),E.angle,N),g)},t.prototype.isTileClipped=function(){return!0},t}(wa),sp=Xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4).members,Oh=ll;function ll(e,t,r,c,f){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=c,this._values=f,e.readFields(lp,this,t)}function lp(e,t,r){e==1?t.id=r.readVarint():e==2?function(c,f){for(var g=c.readVarint()+c.pos;c.pos<g;){var w=f._keys[c.readVarint()],E=f._values[c.readVarint()];f.properties[w]=E}}(r,t):e==3?t.type=r.readVarint():e==4&&(t._geometry=r.pos)}function up(e){for(var t,r,c=0,f=0,g=e.length,w=g-1;f<g;w=f++)c+=((r=e[w]).x-(t=e[f]).x)*(t.y+r.y);return c}ll.types=["Unknown","Point","LineString","Polygon"],ll.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,c=1,f=0,g=0,w=0,E=[];e.pos<r;){if(f<=0){var N=e.readVarint();c=7&N,f=N>>3}if(f--,c===1||c===2)g+=e.readSVarint(),w+=e.readSVarint(),c===1&&(t&&E.push(t),t=[]),t.push(new z(g,w));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&E.push(t),E},ll.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,c=0,f=0,g=0,w=1/0,E=-1/0,N=1/0,V=-1/0;e.pos<t;){if(c<=0){var J=e.readVarint();r=7&J,c=J>>3}if(c--,r===1||r===2)(f+=e.readSVarint())<w&&(w=f),f>E&&(E=f),(g+=e.readSVarint())<N&&(N=g),g>V&&(V=g);else if(r!==7)throw new Error("unknown command "+r)}return[w,N,E,V]},ll.prototype.toGeoJSON=function(e,t,r){var c,f,g=this.extent*Math.pow(2,r),w=this.extent*e,E=this.extent*t,N=this.loadGeometry(),V=ll.types[this.type];function J(fe){for(var Te=0;Te<fe.length;Te++){var Se=fe[Te];fe[Te]=[360*(Se.x+w)/g-180,360/Math.PI*Math.atan(Math.exp((180-360*(Se.y+E)/g)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(c=0;c<N.length;c++)ee[c]=N[c][0];J(N=ee);break;case 2:for(c=0;c<N.length;c++)J(N[c]);break;case 3:for(N=function(fe){var Te=fe.length;if(Te<=1)return[fe];for(var Se,We,De=[],et=0;et<Te;et++){var ut=up(fe[et]);ut!==0&&(We===void 0&&(We=ut<0),We===ut<0?(Se&&De.push(Se),Se=[fe[et]]):Se.push(fe[et]))}return Se&&De.push(Se),De}(N),c=0;c<N.length;c++)for(f=0;f<N[c].length;f++)J(N[c][f])}N.length===1?N=N[0]:V="Multi"+V;var he={type:"Feature",geometry:{type:V,coordinates:N},properties:this.properties};return"id"in this&&(he.id=this.id),he};var Ih=kh;function kh(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(hp,this,t),this.length=this._features.length}function hp(e,t,r){e===15?t.version=r.readVarint():e===1?t.name=r.readString():e===5?t.extent=r.readVarint():e===2?t._features.push(r.pos):e===3?t._keys.push(r.readString()):e===4&&t._values.push(function(c){for(var f=null,g=c.readVarint()+c.pos;c.pos<g;){var w=c.readVarint()>>3;f=w===1?c.readString():w===2?c.readFloat():w===3?c.readDouble():w===4?c.readVarint64():w===5?c.readVarint():w===6?c.readSVarint():w===7?c.readBoolean():null}return f}(r))}function cp(e,t,r){if(e===3){var c=new Ih(r,r.readVarint()+r.pos);c.length&&(t[c.name]=c)}}kh.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Oh(this._pbf,t,this.extent,this._keys,this._values)};var ul={VectorTile:function(e,t){this.layers=e.readFields(cp,{},t)},VectorTileFeature:Oh,VectorTileLayer:Ih},pp=ul.VectorTileFeature.types,nh=Math.pow(2,13);function Hl(e,t,r,c,f,g,w,E){e.emplaceBack(t,r,2*Math.floor(c*nh)+w,f*nh*2,g*nh*2,Math.round(E))}var Ba=function(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(t){return t.id}),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new ka,this.indexArray=new Ya,this.programConfigurations=new Ji(e.layers,e.zoom),this.segments=new p,this.stateDependentLayerIds=this.layers.filter(function(t){return t.isStateDependent()}).map(function(t){return t.id})};function dp(e,t){return e.x===t.x&&(e.x<0||e.x>8192)||e.y===t.y&&(e.y<0||e.y>8192)}Ba.prototype.populate=function(e,t,r){this.features=[],this.hasPattern=ih("fill-extrusion",this.layers,t);for(var c=0,f=e;c<f.length;c+=1){var g=f[c],w=g.feature,E=g.id,N=g.index,V=g.sourceLayerIndex,J=this.layers[0]._featureFilter.needGeometry,ee={type:w.type,id:E,properties:w.properties,geometry:J?Xi(w):[]};if(this.layers[0]._featureFilter.filter(new yr(this.zoom),ee,r)){var he={id:E,sourceLayerIndex:V,index:N,geometry:J?ee.geometry:Xi(w),properties:w.properties,type:w.type,patterns:{}};this.hasPattern?this.features.push(rh("fill-extrusion",this.layers,he,this.zoom,t)):this.addFeature(he,he.geometry,N,r,{}),t.featureIndex.insert(w,he.geometry,N,V,this.index,!0)}}},Ba.prototype.addFeatures=function(e,t,r){for(var c=0,f=this.features;c<f.length;c+=1){var g=f[c];this.addFeature(g,g.geometry,g.index,t,r)}},Ba.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},Ba.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},Ba.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},Ba.prototype.upload=function(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,sp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},Ba.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},Ba.prototype.addFeature=function(e,t,r,c,f){for(var g=0,w=th(t,500);g<w.length;g+=1){for(var E=w[g],N=0,V=0,J=E;V<J.length;V+=1)N+=J[V].length;for(var ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray),he=0,fe=E;he<fe.length;he+=1){var Te=fe[he];if(Te.length!==0&&!((fr=Te).every(function(Qi){return Qi.x<0})||fr.every(function(Qi){return Qi.x>8192})||fr.every(function(Qi){return Qi.y<0})||fr.every(function(Qi){return Qi.y>8192})))for(var Se=0,We=0;We<Te.length;We++){var De=Te[We];if(We>=1){var et=Te[We-1];if(!dp(De,et)){ee.vertexLength+4>p.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));var ut=De.sub(et)._perp()._unit(),vt=et.dist(De);Se+vt>32768&&(Se=0),Hl(this.layoutVertexArray,De.x,De.y,ut.x,ut.y,0,0,Se),Hl(this.layoutVertexArray,De.x,De.y,ut.x,ut.y,0,1,Se),Hl(this.layoutVertexArray,et.x,et.y,ut.x,ut.y,0,0,Se+=vt),Hl(this.layoutVertexArray,et.x,et.y,ut.x,ut.y,0,1,Se);var bt=ee.vertexLength;this.indexArray.emplaceBack(bt,bt+2,bt+1),this.indexArray.emplaceBack(bt+1,bt+2,bt+3),ee.vertexLength+=4,ee.primitiveLength+=2}}}}if(ee.vertexLength+N>p.MAX_VERTEX_ARRAY_LENGTH&&(ee=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray)),pp[e.type]==="Polygon"){for(var Ot=[],Vt=[],oi=ee.vertexLength,Mi=0,di=E;Mi<di.length;Mi+=1){var Ri=di[Mi];if(Ri.length!==0){Ri!==E[0]&&Vt.push(Ot.length/2);for(var ci=0;ci<Ri.length;ci++){var or=Ri[ci];Hl(this.layoutVertexArray,or.x,or.y,0,0,1,1,0),Ot.push(or.x),Ot.push(or.y)}}}for(var ji=Yu(Ot,Vt),Pi=0;Pi<ji.length;Pi+=3)this.indexArray.emplaceBack(oi+ji[Pi],oi+ji[Pi+2],oi+ji[Pi+1]);ee.primitiveLength+=ji.length/3,ee.vertexLength+=N}}var fr;this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,c)},pt("FillExtrusionBucket",Ba,{omit:["layers","features"]});var fp={paint:new no({"fill-extrusion-opacity":new Ai(xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new wi(xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ai(xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ai(xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Xs(xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new wi(xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new wi(xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ai(xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})},_p=function(e){function t(r){e.call(this,r,fp)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.createBucket=function(r){return new Ba(r)},t.prototype.queryRadius=function(){return Zo(this.paint.get("fill-extrusion-translate"))},t.prototype.is3D=function(){return!0},t.prototype.queryIntersectsFeature=function(r,c,f,g,w,E,N,V){var J=fs(r,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),E.angle,N),ee=this.paint.get("fill-extrusion-height").evaluate(c,f),he=this.paint.get("fill-extrusion-base").evaluate(c,f),fe=function(Se,We,De,et){for(var ut=[],vt=0,bt=Se;vt<bt.length;vt+=1){var Ot=bt[vt],Vt=[Ot.x,Ot.y,0,1];Da(Vt,Vt,We),ut.push(new z(Vt[0]/Vt[3],Vt[1]/Vt[3]))}return ut}(J,V),Te=function(Se,We,De,et){for(var ut=[],vt=[],bt=et[8]*We,Ot=et[9]*We,Vt=et[10]*We,oi=et[11]*We,Mi=et[8]*De,di=et[9]*De,Ri=et[10]*De,ci=et[11]*De,or=0,ji=Se;or<ji.length;or+=1){for(var Pi=[],fr=[],Qi=0,Lr=ji[or];Qi<Lr.length;Qi+=1){var Ti=Lr[Qi],Tr=Ti.x,Gr=Ti.y,Fn=et[0]*Tr+et[4]*Gr+et[12],jn=et[1]*Tr+et[5]*Gr+et[13],Wr=et[2]*Tr+et[6]*Gr+et[14],bn=et[3]*Tr+et[7]*Gr+et[15],Zr=Wr+Vt,On=bn+oi,wo=Fn+Mi,to=jn+di,So=Wr+Ri,In=bn+ci,kn=new z((Fn+bt)/On,(jn+Ot)/On);kn.z=Zr/On,Pi.push(kn);var vr=new z(wo/In,to/In);vr.z=So/In,fr.push(vr)}ut.push(Pi),vt.push(fr)}return[ut,vt]}(g,he,ee,V);return function(Se,We,De){var et=1/0;an(De,We)&&(et=Ah(De,We[0]));for(var ut=0;ut<We.length;ut++)for(var vt=We[ut],bt=Se[ut],Ot=0;Ot<vt.length-1;Ot++){var Vt=vt[Ot],oi=[Vt,vt[Ot+1],bt[Ot+1],bt[Ot],Vt];er(De,oi)&&(et=Math.min(et,Ah(De,oi)))}return et!==1/0&&et}(Te[0],Te[1],fe)},t}(wa);function ql(e,t){return e.x*t.x+e.y*t.y}function Ah(e,t){if(e.length===1){for(var r,c=0,f=t[c++];!r||f.equals(r);)if(!(r=t[c++]))return 1/0;for(;c<t.length;c++){var g=t[c],w=e[0],E=r.sub(f),N=g.sub(f),V=w.sub(f),J=ql(E,E),ee=ql(E,N),he=ql(N,N),fe=ql(V,E),Te=ql(V,N),Se=J*he-ee*ee,We=(he*fe-ee*Te)/Se,De=(J*Te-ee*fe)/Se,et=f.z*(1-We-De)+r.z*We+g.z*De;if(isFinite(et))return et}return 1/0}for(var ut=1/0,vt=0,bt=t;vt<bt.length;vt+=1)ut=Math.min(ut,bt[vt].z);return ut}var mp=Xn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4).members,gp=Xn([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]).members,yp=ul.VectorTileFeature.types,vp=Math.cos(Math.PI/180*37.5),Dh=Math.pow(2,14)/.5,To=function(e){var t=this;this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(r){return r.id}),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(function(r){t.gradients[r.id]={}}),this.layoutVertexArray=new Ro,this.layoutVertexArray2=new Ms,this.indexArray=new Ya,this.programConfigurations=new Ji(e.layers,e.zoom),this.segments=new p,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(function(r){return r.isStateDependent()}).map(function(r){return r.id})};To.prototype.populate=function(e,t,r){this.hasPattern=ih("line",this.layers,t);for(var c=this.layers[0].layout.get("line-sort-key"),f=[],g=0,w=e;g<w.length;g+=1){var E=w[g],N=E.feature,V=E.id,J=E.index,ee=E.sourceLayerIndex,he=this.layers[0]._featureFilter.needGeometry,fe={type:N.type,id:V,properties:N.properties,geometry:he?Xi(N):[]};if(this.layers[0]._featureFilter.filter(new yr(this.zoom),fe,r)){he||(fe.geometry=Xi(N));var Te=c?c.evaluate(fe,{},r):void 0;f.push({id:V,properties:N.properties,type:N.type,sourceLayerIndex:ee,index:J,geometry:fe.geometry,patterns:{},sortKey:Te})}}c&&f.sort(function(Ot,Vt){return Ot.sortKey-Vt.sortKey});for(var Se=0,We=f;Se<We.length;Se+=1){var De=We[Se],et=De.geometry,ut=De.index,vt=De.sourceLayerIndex;if(this.hasPattern){var bt=rh("line",this.layers,De,this.zoom,t);this.patternFeatures.push(bt)}else this.addFeature(De,et,ut,r,{});t.featureIndex.insert(e[ut].feature,et,ut,vt,this.index)}},To.prototype.update=function(e,t,r){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r)},To.prototype.addFeatures=function(e,t,r){for(var c=0,f=this.patternFeatures;c<f.length;c+=1){var g=f[c];this.addFeature(g,g.geometry,g.index,t,r)}},To.prototype.isEmpty=function(){return this.layoutVertexArray.length===0},To.prototype.uploadPending=function(){return!this.uploaded||this.programConfigurations.needsUpload},To.prototype.upload=function(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,gp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,mp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0},To.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())},To.prototype.lineFeatureClips=function(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}},To.prototype.addFeature=function(e,t,r,c,f){var g=this.layers[0].layout,w=g.get("line-join").evaluate(e,{}),E=g.get("line-cap"),N=g.get("line-miter-limit"),V=g.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(var J=0,ee=t;J<ee.length;J+=1)this.addLine(ee[J],e,w,E,N,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,f,c)},To.prototype.addLine=function(e,t,r,c,f,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(var w=0;w<e.length-1;w++)this.totalDistance+=e[w].dist(e[w+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}for(var E=yp[t.type]==="Polygon",N=e.length;N>=2&&e[N-1].equals(e[N-2]);)N--;for(var V=0;V<N-1&&e[V].equals(e[V+1]);)V++;if(!(N<(E?3:2))){r==="bevel"&&(f=1.05);var J,ee=this.overscaling<=16?122880/(512*this.overscaling):0,he=this.segments.prepareSegment(10*N,this.layoutVertexArray,this.indexArray),fe=void 0,Te=void 0,Se=void 0,We=void 0;this.e1=this.e2=-1,E&&(We=e[V].sub(J=e[N-2])._unit()._perp());for(var De=V;De<N;De++)if(!(Te=De===N-1?E?e[V+1]:void 0:e[De+1])||!e[De].equals(Te)){We&&(Se=We),J&&(fe=J),J=e[De],We=Te?Te.sub(J)._unit()._perp():Se;var et=(Se=Se||We).add(We);et.x===0&&et.y===0||et._unit();var ut=Se.x*We.x+Se.y*We.y,vt=et.x*We.x+et.y*We.y,bt=vt!==0?1/vt:1/0,Ot=2*Math.sqrt(2-2*vt),Vt=vt<vp&&fe&&Te,oi=Se.x*We.y-Se.y*We.x>0;if(Vt&&De>V){var Mi=J.dist(fe);if(Mi>2*ee){var di=J.sub(J.sub(fe)._mult(ee/Mi)._round());this.updateDistance(fe,di),this.addCurrentVertex(di,Se,0,0,he),fe=di}}var Ri=fe&&Te,ci=Ri?r:E?"butt":c;if(Ri&&ci==="round"&&(bt<g?ci="miter":bt<=2&&(ci="fakeround")),ci==="miter"&&bt>f&&(ci="bevel"),ci==="bevel"&&(bt>2&&(ci="flipbevel"),bt<f&&(ci="miter")),fe&&this.updateDistance(fe,J),ci==="miter")et._mult(bt),this.addCurrentVertex(J,et,0,0,he);else if(ci==="flipbevel"){if(bt>100)et=We.mult(-1);else{var or=bt*Se.add(We).mag()/Se.sub(We).mag();et._perp()._mult(or*(oi?-1:1))}this.addCurrentVertex(J,et,0,0,he),this.addCurrentVertex(J,et.mult(-1),0,0,he)}else if(ci==="bevel"||ci==="fakeround"){var ji=-Math.sqrt(bt*bt-1),Pi=oi?ji:0,fr=oi?0:ji;if(fe&&this.addCurrentVertex(J,Se,Pi,fr,he),ci==="fakeround")for(var Qi=Math.round(180*Ot/Math.PI/20),Lr=1;Lr<Qi;Lr++){var Ti=Lr/Qi;if(Ti!==.5){var Tr=Ti-.5;Ti+=Ti*Tr*(Ti-1)*((1.0904+ut*(ut*(3.55645-1.43519*ut)-3.2452))*Tr*Tr+(.848013+ut*(.215638*ut-1.06021)))}var Gr=We.sub(Se)._mult(Ti)._add(Se)._unit()._mult(oi?-1:1);this.addHalfVertex(J,Gr.x,Gr.y,!1,oi,0,he)}Te&&this.addCurrentVertex(J,We,-Pi,-fr,he)}else if(ci==="butt")this.addCurrentVertex(J,et,0,0,he);else if(ci==="square"){var Fn=fe?1:-1;this.addCurrentVertex(J,et,Fn,Fn,he)}else ci==="round"&&(fe&&(this.addCurrentVertex(J,Se,0,0,he),this.addCurrentVertex(J,Se,1,1,he,!0)),Te&&(this.addCurrentVertex(J,We,-1,-1,he,!0),this.addCurrentVertex(J,We,0,0,he)));if(Vt&&De<N-1){var jn=J.dist(Te);if(jn>2*ee){var Wr=J.add(Te.sub(J)._mult(ee/jn)._round());this.updateDistance(J,Wr),this.addCurrentVertex(Wr,We,0,0,he),J=Wr}}}}},To.prototype.addCurrentVertex=function(e,t,r,c,f,g){g===void 0&&(g=!1);var w=t.y*c-t.x,E=-t.y-t.x*c;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,g,!1,r,f),this.addHalfVertex(e,w,E,g,!0,-c,f),this.distance>Dh/2&&this.totalDistance===0&&(this.distance=0,this.addCurrentVertex(e,t,r,c,f,g))},To.prototype.addHalfVertex=function(e,t,r,c,f,g,w){var E=.5*(this.lineClips?this.scaledDistance*(Dh-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e.x<<1)+(c?1:0),(e.y<<1)+(f?1:0),Math.round(63*t)+128,Math.round(63*r)+128,1+(g===0?0:g<0?-1:1)|(63&E)<<2,E>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);var N=w.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,N),w.primitiveLength++),f?this.e2=N:this.e1=N},To.prototype.updateScaledDistance=function(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance},To.prototype.updateDistance=function(e,t){this.distance+=e.dist(t),this.updateScaledDistance()},pt("LineBucket",To,{omit:["layers","patternFeatures"]});var bp=new no({"line-cap":new Ai(xe.layout_line["line-cap"]),"line-join":new wi(xe.layout_line["line-join"]),"line-miter-limit":new Ai(xe.layout_line["line-miter-limit"]),"line-round-limit":new Ai(xe.layout_line["line-round-limit"]),"line-sort-key":new wi(xe.layout_line["line-sort-key"])}),Rh={paint:new no({"line-opacity":new wi(xe.paint_line["line-opacity"]),"line-color":new wi(xe.paint_line["line-color"]),"line-translate":new Ai(xe.paint_line["line-translate"]),"line-translate-anchor":new Ai(xe.paint_line["line-translate-anchor"]),"line-width":new wi(xe.paint_line["line-width"]),"line-gap-width":new wi(xe.paint_line["line-gap-width"]),"line-offset":new wi(xe.paint_line["line-offset"]),"line-blur":new wi(xe.paint_line["line-blur"]),"line-dasharray":new Do(xe.paint_line["line-dasharray"]),"line-pattern":new Xs(xe.paint_line["line-pattern"]),"line-gradient":new ua(xe.paint_line["line-gradient"])}),layout:bp},zh=new(function(e){function t(){e.apply(this,arguments)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.possiblyEvaluate=function(r,c){return c=new yr(Math.floor(c.zoom),{now:c.now,fadeDuration:c.fadeDuration,zoomHistory:c.zoomHistory,transition:c.transition}),e.prototype.possiblyEvaluate.call(this,r,c)},t.prototype.evaluate=function(r,c,f,g){return c=F({},c,{zoom:Math.floor(c.zoom)}),e.prototype.evaluate.call(this,r,c,f,g)},t}(wi))(Rh.paint.properties["line-width"].specification);zh.useIntegerZoom=!0;var xp=function(e){function t(r){e.call(this,r,Rh),this.gradientVersion=0}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype._handleSpecialPaintPropertyUpdate=function(r){r==="line-gradient"&&(this.stepInterpolant=this._transitionablePaint._values["line-gradient"].value.expression._styleExpression.expression instanceof Mr,this.gradientVersion=(this.gradientVersion+1)%x)},t.prototype.gradientExpression=function(){return this._transitionablePaint._values["line-gradient"].value.expression},t.prototype.recalculate=function(r,c){e.prototype.recalculate.call(this,r,c),this.paint._values["line-floorwidth"]=zh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)},t.prototype.createBucket=function(r){return new To(r)},t.prototype.queryRadius=function(r){var c=r,f=Bh(Fo("line-width",this,c),Fo("line-gap-width",this,c)),g=Fo("line-offset",this,c);return f/2+Math.abs(g)+Zo(this.paint.get("line-translate"))},t.prototype.queryIntersectsFeature=function(r,c,f,g,w,E,N){var V=fs(r,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),E.angle,N),J=N/2*Bh(this.paint.get("line-width").evaluate(c,f),this.paint.get("line-gap-width").evaluate(c,f)),ee=this.paint.get("line-offset").evaluate(c,f);return ee&&(g=function(he,fe){for(var Te=[],Se=new z(0,0),We=0;We<he.length;We++){for(var De=he[We],et=[],ut=0;ut<De.length;ut++){var vt=De[ut],bt=De[ut+1],Ot=ut===0?Se:vt.sub(De[ut-1])._unit()._perp(),Vt=ut===De.length-1?Se:bt.sub(vt)._unit()._perp(),oi=Ot._add(Vt)._unit();oi._mult(1/(oi.x*Vt.x+oi.y*Vt.y)),et.push(oi._mult(fe)._add(vt))}Te.push(et)}return Te}(g,ee*N)),function(he,fe,Te){for(var Se=0;Se<fe.length;Se++){var We=fe[Se];if(he.length>=3){for(var De=0;De<We.length;De++)if(Bo(he,We[De]))return!0}if(zo(he,We,Te))return!0}return!1}(V,g,J)},t.prototype.isTileClipped=function(){return!0},t}(wa);function Bh(e,t){return t>0?t+2*e:e}var wp=Xn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Pp=Xn([{name:"a_projected_pos",components:3,type:"Float32"}],4),Lp=(Xn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4),Xn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}])),Fh=(Xn([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]),Xn([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4)),Mp=Xn([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Tp(e,t,r){return e.sections.forEach(function(c){c.text=function(f,g,w){var E=g.layout.get("text-transform").evaluate(w,{});return E==="uppercase"?f=f.toLocaleUpperCase():E==="lowercase"&&(f=f.toLocaleLowerCase()),Wo.applyArabicShaping&&(f=Wo.applyArabicShaping(f)),f}(c.text,t,r)}),e}Xn([{name:"triangle",components:3,type:"Uint16"}]),Xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Xn([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xn([{type:"Float32",name:"offsetX"}]),Xn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Jl={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"},jh=function(e,t,r,c,f){var g,w,E=8*f-c-1,N=(1<<E)-1,V=N>>1,J=-7,ee=r?f-1:0,he=r?-1:1,fe=e[t+ee];for(ee+=he,g=fe&(1<<-J)-1,fe>>=-J,J+=E;J>0;g=256*g+e[t+ee],ee+=he,J-=8);for(w=g&(1<<-J)-1,g>>=-J,J+=c;J>0;w=256*w+e[t+ee],ee+=he,J-=8);if(g===0)g=1-V;else{if(g===N)return w?NaN:1/0*(fe?-1:1);w+=Math.pow(2,c),g-=V}return(fe?-1:1)*w*Math.pow(2,g-c)},Uh=function(e,t,r,c,f,g){var w,E,N,V=8*g-f-1,J=(1<<V)-1,ee=J>>1,he=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,fe=c?0:g-1,Te=c?1:-1,Se=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(E=isNaN(t)?1:0,w=J):(w=Math.floor(Math.log(t)/Math.LN2),t*(N=Math.pow(2,-w))<1&&(w--,N*=2),(t+=w+ee>=1?he/N:he*Math.pow(2,1-ee))*N>=2&&(w++,N/=2),w+ee>=J?(E=0,w=J):w+ee>=1?(E=(t*N-1)*Math.pow(2,f),w+=ee):(E=t*Math.pow(2,ee-1)*Math.pow(2,f),w=0));f>=8;e[r+fe]=255&E,fe+=Te,E/=256,f-=8);for(w=w<<f|E,V+=f;V>0;e[r+fe]=255&w,fe+=Te,w/=256,V-=8);e[r+fe-Te]|=128*Se},xu=Nr;function Nr(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}Nr.Varint=0,Nr.Fixed64=1,Nr.Bytes=2,Nr.Fixed32=5;var Nh=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function gs(e){return e.type===Nr.Bytes?e.readVarint()+e.pos:e.pos+1}function hl(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function Gh(e,t,r){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(c);for(var f=r.pos-1;f>=e;f--)r.buf[f+c]=r.buf[f]}function Sp(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function Cp(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function Ep(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function Op(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function Ip(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function kp(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Ap(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Dp(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Rp(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function wu(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function cl(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function Wh(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function zp(e,t,r){e===1&&r.readMessage(Bp,t)}function Bp(e,t,r){if(e===3){var c=r.readMessage(Fp,{}),f=c.width,g=c.height,w=c.left,E=c.top,N=c.advance;t.push({id:c.id,bitmap:new La({width:f+6,height:g+6},c.bitmap),metrics:{width:f,height:g,left:w,top:E,advance:N}})}}function Fp(e,t,r){e===1?t.id=r.readVarint():e===2?t.bitmap=r.readBytes():e===3?t.width=r.readVarint():e===4?t.height=r.readVarint():e===5?t.left=r.readSVarint():e===6?t.top=r.readSVarint():e===7&&(t.advance=r.readVarint())}function Zh(e){for(var t=0,r=0,c=0,f=e;c<f.length;c+=1){var g=f[c];t+=g.w*g.h,r=Math.max(r,g.w)}e.sort(function(Se,We){return We.h-Se.h});for(var w=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}],E=0,N=0,V=0,J=e;V<J.length;V+=1)for(var ee=J[V],he=w.length-1;he>=0;he--){var fe=w[he];if(!(ee.w>fe.w||ee.h>fe.h)){if(ee.x=fe.x,ee.y=fe.y,N=Math.max(N,ee.y+ee.h),E=Math.max(E,ee.x+ee.w),ee.w===fe.w&&ee.h===fe.h){var Te=w.pop();he<w.length&&(w[he]=Te)}else ee.h===fe.h?(fe.x+=ee.w,fe.w-=ee.w):ee.w===fe.w?(fe.y+=ee.h,fe.h-=ee.h):(w.push({x:fe.x+ee.w,y:fe.y,w:fe.w-ee.w,h:ee.h}),fe.y+=ee.h,fe.h-=ee.h);break}}return{w:E,h:N,fill:t/(E*N)||0}}Nr.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var c=this.readVarint(),f=c>>3,g=this.pos;this.type=7&c,e(f,t,this),this.pos===g&&this.skip(c)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=wu(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=Wh(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=wu(this.buf,this.pos)+4294967296*wu(this.buf,this.pos+4);return this.pos+=8,e},readSFixed64:function(){var e=wu(this.buf,this.pos)+4294967296*Wh(this.buf,this.pos+4);return this.pos+=8,e},readFloat:function(){var e=jh(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=jh(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,c=this.buf;return t=127&(r=c[this.pos++]),r<128?t:(t|=(127&(r=c[this.pos++]))<<7,r<128?t:(t|=(127&(r=c[this.pos++]))<<14,r<128?t:(t|=(127&(r=c[this.pos++]))<<21,r<128?t:function(f,g,w){var E,N,V=w.buf;if(E=(112&(N=V[w.pos++]))>>4,N<128||(E|=(127&(N=V[w.pos++]))<<3,N<128)||(E|=(127&(N=V[w.pos++]))<<10,N<128)||(E|=(127&(N=V[w.pos++]))<<17,N<128)||(E|=(127&(N=V[w.pos++]))<<24,N<128)||(E|=(1&(N=V[w.pos++]))<<31,N<128))return hl(f,E,g);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=c[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&Nh?function(r,c,f){return Nh.decode(r.subarray(c,f))}(this.buf,t,e):function(r,c,f){for(var g="",w=c;w<f;){var E,N,V,J=r[w],ee=null,he=J>239?4:J>223?3:J>191?2:1;if(w+he>f)break;he===1?J<128&&(ee=J):he===2?(192&(E=r[w+1]))==128&&(ee=(31&J)<<6|63&E)<=127&&(ee=null):he===3?(N=r[w+2],(192&(E=r[w+1]))==128&&(192&N)==128&&((ee=(15&J)<<12|(63&E)<<6|63&N)<=2047||ee>=55296&&ee<=57343)&&(ee=null)):he===4&&(N=r[w+2],V=r[w+3],(192&(E=r[w+1]))==128&&(192&N)==128&&(192&V)==128&&((ee=(15&J)<<18|(63&E)<<12|(63&N)<<6|63&V)<=65535||ee>=1114112)&&(ee=null)),ee===null?(ee=65533,he=1):ee>65535&&(ee-=65536,g+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|1023&ee),g+=String.fromCharCode(ee),w+=he}return g}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==Nr.Bytes)return e.push(this.readVarint(t));var r=gs(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==Nr.Bytes)return e.push(this.readSVarint());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==Nr.Bytes)return e.push(this.readBoolean());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==Nr.Bytes)return e.push(this.readFloat());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==Nr.Bytes)return e.push(this.readDouble());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==Nr.Bytes)return e.push(this.readFixed32());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==Nr.Bytes)return e.push(this.readSFixed32());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==Nr.Bytes)return e.push(this.readFixed64());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==Nr.Bytes)return e.push(this.readSFixed64());var t=gs(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===Nr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Nr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Nr.Fixed32)this.pos+=4;else{if(t!==Nr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),cl(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),cl(this.buf,-1&e,this.pos),cl(this.buf,Math.floor(e*(1/4294967296)),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(t,r){var c,f;if(t>=0?(c=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(g,w,E){E.buf[E.pos++]=127&g|128,g>>>=7,E.buf[E.pos++]=127&g|128,g>>>=7,E.buf[E.pos++]=127&g|128,g>>>=7,E.buf[E.pos++]=127&g|128,E.buf[E.pos]=127&(g>>>=7)}(c,0,r),function(g,w){var E=(7&g)<<4;w.buf[w.pos++]|=E|((g>>>=3)?128:0),g&&(w.buf[w.pos++]=127&g|((g>>>=7)?128:0),g&&(w.buf[w.pos++]=127&g|((g>>>=7)?128:0),g&&(w.buf[w.pos++]=127&g|((g>>>=7)?128:0),g&&(w.buf[w.pos++]=127&g|((g>>>=7)?128:0),g&&(w.buf[w.pos++]=127&g)))))}(f,r)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(c,f,g){for(var w,E,N=0;N<f.length;N++){if((w=f.charCodeAt(N))>55295&&w<57344){if(!E){w>56319||N+1===f.length?(c[g++]=239,c[g++]=191,c[g++]=189):E=w;continue}if(w<56320){c[g++]=239,c[g++]=191,c[g++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(c[g++]=239,c[g++]=191,c[g++]=189,E=null);w<128?c[g++]=w:(w<2048?c[g++]=w>>6|192:(w<65536?c[g++]=w>>12|224:(c[g++]=w>>18|240,c[g++]=w>>12&63|128),c[g++]=w>>6&63|128),c[g++]=63&w|128)}return g}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&Gh(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),Uh(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),Uh(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var c=this.pos-r;c>=128&&Gh(r,c,this),this.pos=r-1,this.writeVarint(c),this.pos+=c},writeMessage:function(e,t,r){this.writeTag(e,Nr.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,Sp,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,Cp,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,Ip,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,Ep,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,Op,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,kp,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Ap,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Dp,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Rp,t)},writeBytesField:function(e,t){this.writeTag(e,Nr.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,Nr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,Nr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,Nr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,Nr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,Nr.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,Nr.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,Nr.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,Nr.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,Nr.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};var Pu=function(e,t){var r=t.pixelRatio,c=t.version,f=t.stretchX,g=t.stretchY,w=t.content;this.paddedRect=e,this.pixelRatio=r,this.stretchX=f,this.stretchY=g,this.content=w,this.version=c},Xl={tl:{configurable:!0},br:{configurable:!0},tlbr:{configurable:!0},displaySize:{configurable:!0}};Xl.tl.get=function(){return[this.paddedRect.x+1,this.paddedRect.y+1]},Xl.br.get=function(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]},Xl.tlbr.get=function(){return this.tl.concat(this.br)},Xl.displaySize.get=function(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]},Object.defineProperties(Pu.prototype,Xl);var Yl=function(e,t){var r={},c={};this.haveRenderCallbacks=[];var f=[];this.addImages(e,r,f),this.addImages(t,c,f);var g=Zh(f),w=new bo({width:g.w||1,height:g.h||1});for(var E in e){var N=e[E],V=r[E].paddedRect;bo.copy(N.data,w,{x:0,y:0},{x:V.x+1,y:V.y+1},N.data)}for(var J in t){var ee=t[J],he=c[J].paddedRect,fe=he.x+1,Te=he.y+1,Se=ee.data.width,We=ee.data.height;bo.copy(ee.data,w,{x:0,y:0},{x:fe,y:Te},ee.data),bo.copy(ee.data,w,{x:0,y:We-1},{x:fe,y:Te-1},{width:Se,height:1}),bo.copy(ee.data,w,{x:0,y:0},{x:fe,y:Te+We},{width:Se,height:1}),bo.copy(ee.data,w,{x:Se-1,y:0},{x:fe-1,y:Te},{width:1,height:We}),bo.copy(ee.data,w,{x:0,y:0},{x:fe+Se,y:Te},{width:1,height:We})}this.image=w,this.iconPositions=r,this.patternPositions=c};Yl.prototype.addImages=function(e,t,r){for(var c in e){var f=e[c],g={x:0,y:0,w:f.data.width+2,h:f.data.height+2};r.push(g),t[c]=new Pu(g,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(c)}},Yl.prototype.patchUpdatedImages=function(e,t){for(var r in e.dispatchRenderCallbacks(this.haveRenderCallbacks),e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)},Yl.prototype.patchUpdatedImage=function(e,t,r){if(e&&t&&e.version!==t.version){e.version=t.version;var c=e.tl;r.update(t.data,void 0,{x:c[0],y:c[1]})}},pt("ImagePosition",Pu),pt("ImageAtlas",Yl);var $o={horizontal:1,vertical:2,horizontalOnly:3},pl=function(){this.scale=1,this.fontStack="",this.imageName=null};pl.forText=function(e,t){var r=new pl;return r.scale=e||1,r.fontStack=t,r},pl.forImage=function(e){var t=new pl;return t.imageName=e,t};var xo=function(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null};function Lu(e,t,r,c,f,g,w,E,N,V,J,ee,he,fe,Te,Se){var We,De=xo.fromFeature(e,f);ee===$o.vertical&&De.verticalizePunctuation();var et=Wo.processBidirectionalText,ut=Wo.processStyledBidirectionalText;if(et&&De.sections.length===1){We=[];for(var vt=0,bt=et(De.toString(),oh(De,V,g,t,c,fe,Te));vt<bt.length;vt+=1){var Ot=bt[vt],Vt=new xo;Vt.text=Ot,Vt.sections=De.sections;for(var oi=0;oi<Ot.length;oi++)Vt.sectionIndex.push(0);We.push(Vt)}}else if(ut){We=[];for(var Mi=0,di=ut(De.text,De.sectionIndex,oh(De,V,g,t,c,fe,Te));Mi<di.length;Mi+=1){var Ri=di[Mi],ci=new xo;ci.text=Ri[0],ci.sectionIndex=Ri[1],ci.sections=De.sections,We.push(ci)}}else We=function(Pi,fr){for(var Qi=[],Lr=Pi.text,Ti=0,Tr=0,Gr=fr;Tr<Gr.length;Tr+=1){var Fn=Gr[Tr];Qi.push(Pi.substring(Ti,Fn)),Ti=Fn}return Ti<Lr.length&&Qi.push(Pi.substring(Ti,Lr.length)),Qi}(De,oh(De,V,g,t,c,fe,Te));var or=[],ji={positionedLines:or,text:De.toString(),top:J[1],bottom:J[1],left:J[0],right:J[0],writingMode:ee,iconsInText:!1,verticalizable:!1};return function(Pi,fr,Qi,Lr,Ti,Tr,Gr,Fn,jn,Wr,bn,Zr){for(var On=0,wo=-17,to=0,So=0,In=Fn==="right"?1:Fn==="left"?0:.5,kn=0,vr=0,Rr=Ti;vr<Rr.length;vr+=1){var Vr=Rr[vr];Vr.trim();var xr=Vr.getMaxScale(),xn=24*(xr-1),uo={positionedGlyphs:[],lineOffset:0};Pi.positionedLines[kn]=uo;var Un=uo.positionedGlyphs,sn=0;if(Vr.length()){for(var Nn=0;Nn<Vr.length();Nn++){var Kr=Vr.getSection(Nn),dn=Vr.getSectionIndex(Nn),ea=Vr.getCharCode(Nn),ts=0,fn=null,is=null,Ma=null,bl=24,Ks=!(jn===$o.horizontal||!bn&&!ba(ea)||bn&&(Mu[ea]||(xs=ea,ti.Arabic(xs)||ti["Arabic Supplement"](xs)||ti["Arabic Extended-A"](xs)||ti["Arabic Presentation Forms-A"](xs)||ti["Arabic Presentation Forms-B"](xs))));if(Kr.imageName){var xl=Lr[Kr.imageName];if(!xl)continue;Ma=Kr.imageName,Pi.iconsInText=Pi.iconsInText||!0,is=xl.paddedRect;var bs=xl.displaySize;Kr.scale=24*Kr.scale/Zr,ts=xn+(24-bs[1]*Kr.scale),bl=(fn={width:bs[0],height:bs[1],left:1,top:-3,advance:Ks?bs[1]:bs[0]}).advance;var wl=Ks?bs[0]*Kr.scale-24*xr:bs[1]*Kr.scale-24*xr;wl>0&&wl>sn&&(sn=wl)}else{var Du=Qi[Kr.fontStack],Pl=Du&&Du[ea];if(Pl&&Pl.rect)is=Pl.rect,fn=Pl.metrics;else{var eu=fr[Kr.fontStack],Ru=eu&&eu[ea];if(!Ru)continue;fn=Ru.metrics}ts=24*(xr-Kr.scale)}Ks?(Pi.verticalizable=!0,Un.push({glyph:ea,imageName:Ma,x:On,y:wo+ts,vertical:Ks,scale:Kr.scale,fontStack:Kr.fontStack,sectionIndex:dn,metrics:fn,rect:is}),On+=bl*Kr.scale+Wr):(Un.push({glyph:ea,imageName:Ma,x:On,y:wo+ts,vertical:Ks,scale:Kr.scale,fontStack:Kr.fontStack,sectionIndex:dn,metrics:fn,rect:is}),On+=fn.advance*Kr.scale+Wr)}Un.length!==0&&(to=Math.max(On-Wr,to),Up(Un,0,Un.length-1,In,sn)),On=0;var zu=Tr*xr+sn;uo.lineOffset=Math.max(sn,xn),wo+=zu,So=Math.max(zu,So),++kn}else wo+=Tr,++kn}var xs,tu=wo- -17,Ll=ah(Gr),ks=Ll.horizontalAlign,Ml=Ll.verticalAlign;(function(Bu,Fu,iu,ru,ju,nu,ou,au,Uu){var Tl,Nu=(Fu-iu)*ju;Tl=nu!==ou?-au*ru- -17:(-ru*Uu+.5)*ou;for(var Sl=0,su=Bu;Sl<su.length;Sl+=1)for(var Hs=0,lu=su[Sl].positionedGlyphs;Hs<lu.length;Hs+=1){var Cl=lu[Hs];Cl.x+=Nu,Cl.y+=Tl}})(Pi.positionedLines,In,ks,Ml,to,So,Tr,tu,Ti.length),Pi.top+=-Ml*tu,Pi.bottom=Pi.top+tu,Pi.left+=-ks*to,Pi.right=Pi.left+to}(ji,t,r,c,We,w,E,N,ee,V,he,Se),!function(Pi){for(var fr=0,Qi=Pi;fr<Qi.length;fr+=1)if(Qi[fr].positionedGlyphs.length!==0)return!1;return!0}(or)&&ji}xo.fromFeature=function(e,t){for(var r=new xo,c=0;c<e.sections.length;c++){var f=e.sections[c];f.image?r.addImageSection(f):r.addTextSection(f,t)}return r},xo.prototype.length=function(){return this.text.length},xo.prototype.getSection=function(e){return this.sections[this.sectionIndex[e]]},xo.prototype.getSectionIndex=function(e){return this.sectionIndex[e]},xo.prototype.getCharCode=function(e){return this.text.charCodeAt(e)},xo.prototype.verticalizePunctuation=function(){this.text=function(e){for(var t="",r=0;r<e.length;r++){var c=e.charCodeAt(r+1)||null,f=e.charCodeAt(r-1)||null;t+=c&&qa(c)&&!Jl[e[r+1]]||f&&qa(f)&&!Jl[e[r-1]]||!Jl[e[r]]?e[r]:Jl[e[r]]}return t}(this.text)},xo.prototype.trim=function(){for(var e=0,t=0;t<this.text.length&&Mu[this.text.charCodeAt(t)];t++)e++;for(var r=this.text.length,c=this.text.length-1;c>=0&&c>=e&&Mu[this.text.charCodeAt(c)];c--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)},xo.prototype.substring=function(e,t){var r=new xo;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r},xo.prototype.toString=function(){return this.text},xo.prototype.getMaxScale=function(){var e=this;return this.sectionIndex.reduce(function(t,r){return Math.max(t,e.sections[r].scale)},0)},xo.prototype.addTextSection=function(e,t){this.text+=e.text,this.sections.push(pl.forText(e.scale,e.fontStack||t));for(var r=this.sections.length-1,c=0;c<e.text.length;++c)this.sectionIndex.push(r)},xo.prototype.addImageSection=function(e){var t=e.image?e.image.name:"";if(t.length!==0){var r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(pl.forImage(t)),this.sectionIndex.push(this.sections.length-1)):ht("Reached maximum number of images 6401")}else ht("Can't add FormattedSection with an empty image.")},xo.prototype.getNextImageSectionCharCode=function(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)};var Mu={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Vo={};function Vh(e,t,r,c,f,g){if(t.imageName){var w=c[t.imageName];return w?w.displaySize[0]*t.scale*24/g+f:0}var E=r[t.fontStack],N=E&&E[e];return N?N.metrics.advance*t.scale+f:0}function Kh(e,t,r,c){var f=Math.pow(e-t,2);return c?e<t?f/2:2*f:f+Math.abs(r)*r}function jp(e,t,r){var c=0;return e===10&&(c-=1e4),r&&(c+=150),e!==40&&e!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function Hh(e,t,r,c,f,g){for(var w=null,E=Kh(t,r,f,g),N=0,V=c;N<V.length;N+=1){var J=V[N],ee=Kh(t-J.x,r,f,g)+J.badness;ee<=E&&(w=J,E=ee)}return{index:e,x:t,priorBreak:w,badness:E}}function oh(e,t,r,c,f,g,w){if(g!=="point")return[];if(!e)return[];for(var E,N=[],V=function(We,De,et,ut,vt,bt){for(var Ot=0,Vt=0;Vt<We.length();Vt++){var oi=We.getSection(Vt);Ot+=Vh(We.getCharCode(Vt),oi,ut,vt,De,bt)}return Ot/Math.max(1,Math.ceil(Ot/et))}(e,t,r,c,f,w),J=e.text.indexOf("\u200B")>=0,ee=0,he=0;he<e.length();he++){var fe=e.getSection(he),Te=e.getCharCode(he);if(Mu[Te]||(ee+=Vh(Te,fe,c,f,t,w)),he<e.length()-1){var Se=!((E=Te)<11904||!(ti["Bopomofo Extended"](E)||ti.Bopomofo(E)||ti["CJK Compatibility Forms"](E)||ti["CJK Compatibility Ideographs"](E)||ti["CJK Compatibility"](E)||ti["CJK Radicals Supplement"](E)||ti["CJK Strokes"](E)||ti["CJK Symbols and Punctuation"](E)||ti["CJK Unified Ideographs Extension A"](E)||ti["CJK Unified Ideographs"](E)||ti["Enclosed CJK Letters and Months"](E)||ti["Halfwidth and Fullwidth Forms"](E)||ti.Hiragana(E)||ti["Ideographic Description Characters"](E)||ti["Kangxi Radicals"](E)||ti["Katakana Phonetic Extensions"](E)||ti.Katakana(E)||ti["Vertical Forms"](E)||ti["Yi Radicals"](E)||ti["Yi Syllables"](E)));(Vo[Te]||Se||fe.imageName)&&N.push(Hh(he+1,ee,V,N,jp(Te,e.getCharCode(he+1),Se&&J),!1))}}return function We(De){return De?We(De.priorBreak).concat(De.index):[]}(Hh(e.length(),ee,V,N,0,!0))}function ah(e){var t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function Up(e,t,r,c,f){if(c||f)for(var g=e[r],w=(e[r].x+g.metrics.advance*g.scale)*c,E=t;E<=r;E++)e[E].x-=w,e[E].y+=f}function qh(e,t,r,c,f,g){var w,E=e.image;if(E.content){var N=E.content,V=E.pixelRatio||1;w=[N[0]/V,N[1]/V,E.displaySize[0]-N[2]/V,E.displaySize[1]-N[3]/V]}var J,ee,he,fe,Te=t.left*g,Se=t.right*g;r==="width"||r==="both"?(fe=f[0]+Te-c[3],ee=f[0]+Se+c[1]):ee=(fe=f[0]+(Te+Se-E.displaySize[0])/2)+E.displaySize[0];var We=t.top*g,De=t.bottom*g;return r==="height"||r==="both"?(J=f[1]+We-c[0],he=f[1]+De+c[2]):he=(J=f[1]+(We+De-E.displaySize[1])/2)+E.displaySize[1],{image:E,top:J,right:ee,bottom:he,left:fe,collisionPadding:w}}Vo[10]=!0,Vo[32]=!0,Vo[38]=!0,Vo[40]=!0,Vo[41]=!0,Vo[43]=!0,Vo[45]=!0,Vo[47]=!0,Vo[173]=!0,Vo[183]=!0,Vo[8203]=!0,Vo[8208]=!0,Vo[8211]=!0,Vo[8231]=!0;var dl=function(e){function t(r,c,f,g){e.call(this,r,c),this.angle=f,g!==void 0&&(this.segment=g)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.clone=function(){return new t(this.x,this.y,this.angle,this.segment)},t}(z);function sh(e,t){var r=t.expression;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new yr(e+1))};if(r.kind==="source")return{kind:"source"};for(var c=r.zoomStops,f=r.interpolationType,g=0;g<c.length&&c[g]<=e;)g++;for(var w=g=Math.max(0,g-1);w<c.length&&c[w]<e+1;)w++;w=Math.min(c.length-1,w);var E=c[g],N=c[w];return r.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:N,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:N,minSize:r.evaluate(new yr(E)),maxSize:r.evaluate(new yr(N)),interpolationType:f}}function Jh(e,t,r){var c=t.uSize,f=r.lowerSize;return e.kind==="source"?f/128:e.kind==="composite"?qr(f/128,r.upperSize/128,t.uSizeT):c}function Xh(e,t){var r=0,c=0;if(e.kind==="constant")c=e.layoutSize;else if(e.kind!=="source"){var f=e.interpolationType,g=f?T($r.interpolationFactor(f,t,e.minZoom,e.maxZoom),0,1):0;e.kind==="camera"?c=qr(e.minSize,e.maxSize,g):r=g}return{uSizeT:r,uSize:c}}pt("Anchor",dl);var Np=Object.freeze({__proto__:null,getSizeData:sh,evaluateSizeForFeature:Jh,evaluateSizeForZoom:Xh,SIZE_PACK_FACTOR:128});function Yh(e,t,r,c,f){if(t.segment===void 0)return!0;for(var g=t,w=t.segment+1,E=0;E>-r/2;){if(--w<0)return!1;E-=e[w].dist(g),g=e[w]}E+=e[w].dist(e[w+1]),w++;for(var N=[],V=0;E<r/2;){var J=e[w],ee=e[w+1];if(!ee)return!1;var he=e[w-1].angleTo(J)-J.angleTo(ee);for(he=Math.abs((he+3*Math.PI)%(2*Math.PI)-Math.PI),N.push({distance:E,angleDelta:he}),V+=he;E-N[0].distance>c;)V-=N.shift().angleDelta;if(V>f)return!1;w++,E+=J.dist(ee)}return!0}function Qh(e){for(var t=0,r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function $h(e,t,r){return e?.6*t*r:0}function ec(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function Gp(e,t,r,c,f,g){for(var w=$h(r,f,g),E=ec(r,c)*g,N=0,V=Qh(e)/2,J=0;J<e.length-1;J++){var ee=e[J],he=e[J+1],fe=ee.dist(he);if(N+fe>V){var Te=(V-N)/fe,Se=qr(ee.x,he.x,Te),We=qr(ee.y,he.y,Te),De=new dl(Se,We,he.angleTo(ee),J);return De._round(),!w||Yh(e,De,E,w,t)?De:void 0}N+=fe}}function Wp(e,t,r,c,f,g,w,E,N){var V=$h(c,g,w),J=ec(c,f),ee=J*w,he=e[0].x===0||e[0].x===N||e[0].y===0||e[0].y===N;return t-ee<t/4&&(t=ee+t/4),function fe(Te,Se,We,De,et,ut,vt,bt,Ot){for(var Vt=ut/2,oi=Qh(Te),Mi=0,di=Se-We,Ri=[],ci=0;ci<Te.length-1;ci++){for(var or=Te[ci],ji=Te[ci+1],Pi=or.dist(ji),fr=ji.angleTo(or);di+We<Mi+Pi;){var Qi=((di+=We)-Mi)/Pi,Lr=qr(or.x,ji.x,Qi),Ti=qr(or.y,ji.y,Qi);if(Lr>=0&&Lr<Ot&&Ti>=0&&Ti<Ot&&di-Vt>=0&&di+Vt<=oi){var Tr=new dl(Lr,Ti,fr,ci);Tr._round(),De&&!Yh(Te,Tr,ut,De,et)||Ri.push(Tr)}}Mi+=Pi}return bt||Ri.length||vt||(Ri=fe(Te,Mi/2,We,De,et,ut,vt,!0,Ot)),Ri}(e,he?t/2*E%t:(J/2+2*g)*w*E%t,t,V,r,ee,he,!1,N)}function tc(e,t,r,c,f){for(var g=[],w=0;w<e.length;w++)for(var E=e[w],N=void 0,V=0;V<E.length-1;V++){var J=E[V],ee=E[V+1];J.x<t&&ee.x<t||(J.x<t?J=new z(t,J.y+(t-J.x)/(ee.x-J.x)*(ee.y-J.y))._round():ee.x<t&&(ee=new z(t,J.y+(t-J.x)/(ee.x-J.x)*(ee.y-J.y))._round()),J.y<r&&ee.y<r||(J.y<r?J=new z(J.x+(r-J.y)/(ee.y-J.y)*(ee.x-J.x),r)._round():ee.y<r&&(ee=new z(J.x+(r-J.y)/(ee.y-J.y)*(ee.x-J.x),r)._round()),J.x>=c&&ee.x>=c||(J.x>=c?J=new z(c,J.y+(c-J.x)/(ee.x-J.x)*(ee.y-J.y))._round():ee.x>=c&&(ee=new z(c,J.y+(c-J.x)/(ee.x-J.x)*(ee.y-J.y))._round()),J.y>=f&&ee.y>=f||(J.y>=f?J=new z(J.x+(f-J.y)/(ee.y-J.y)*(ee.x-J.x),f)._round():ee.y>=f&&(ee=new z(J.x+(f-J.y)/(ee.y-J.y)*(ee.x-J.x),f)._round()),N&&J.equals(N[N.length-1])||g.push(N=[J]),N.push(ee)))))}return g}function ic(e,t,r,c){var f=[],g=e.image,w=g.pixelRatio,E=g.paddedRect.w-2,N=g.paddedRect.h-2,V=e.right-e.left,J=e.bottom-e.top,ee=g.stretchX||[[0,E]],he=g.stretchY||[[0,N]],fe=function(Lr,Ti){return Lr+Ti[1]-Ti[0]},Te=ee.reduce(fe,0),Se=he.reduce(fe,0),We=E-Te,De=N-Se,et=0,ut=Te,vt=0,bt=Se,Ot=0,Vt=We,oi=0,Mi=De;if(g.content&&c){var di=g.content;et=Tu(ee,0,di[0]),vt=Tu(he,0,di[1]),ut=Tu(ee,di[0],di[2]),bt=Tu(he,di[1],di[3]),Ot=di[0]-et,oi=di[1]-vt,Vt=di[2]-di[0]-ut,Mi=di[3]-di[1]-bt}var Ri=function(Lr,Ti,Tr,Gr){var Fn=Su(Lr.stretch-et,ut,V,e.left),jn=Cu(Lr.fixed-Ot,Vt,Lr.stretch,Te),Wr=Su(Ti.stretch-vt,bt,J,e.top),bn=Cu(Ti.fixed-oi,Mi,Ti.stretch,Se),Zr=Su(Tr.stretch-et,ut,V,e.left),On=Cu(Tr.fixed-Ot,Vt,Tr.stretch,Te),wo=Su(Gr.stretch-vt,bt,J,e.top),to=Cu(Gr.fixed-oi,Mi,Gr.stretch,Se),So=new z(Fn,Wr),In=new z(Zr,Wr),kn=new z(Zr,wo),vr=new z(Fn,wo),Rr=new z(jn/w,bn/w),Vr=new z(On/w,to/w),xr=t*Math.PI/180;if(xr){var xn=Math.sin(xr),uo=Math.cos(xr),Un=[uo,-xn,xn,uo];So._matMult(Un),In._matMult(Un),vr._matMult(Un),kn._matMult(Un)}var sn=Lr.stretch+Lr.fixed,Nn=Ti.stretch+Ti.fixed;return{tl:So,tr:In,bl:vr,br:kn,tex:{x:g.paddedRect.x+1+sn,y:g.paddedRect.y+1+Nn,w:Tr.stretch+Tr.fixed-sn,h:Gr.stretch+Gr.fixed-Nn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Rr,pixelOffsetBR:Vr,minFontScaleX:Vt/w/V,minFontScaleY:Mi/w/J,isSDF:r}};if(c&&(g.stretchX||g.stretchY))for(var ci=rc(ee,We,Te),or=rc(he,De,Se),ji=0;ji<ci.length-1;ji++)for(var Pi=ci[ji],fr=ci[ji+1],Qi=0;Qi<or.length-1;Qi++)f.push(Ri(Pi,or[Qi],fr,or[Qi+1]));else f.push(Ri({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:N+1}));return f}function Tu(e,t,r){for(var c=0,f=0,g=e;f<g.length;f+=1){var w=g[f];c+=Math.max(t,Math.min(r,w[1]))-Math.max(t,Math.min(r,w[0]))}return c}function rc(e,t,r){for(var c=[{fixed:-1,stretch:0}],f=0,g=e;f<g.length;f+=1){var w=g[f],E=w[0],N=w[1],V=c[c.length-1];c.push({fixed:E-V.stretch,stretch:V.stretch}),c.push({fixed:E-V.stretch,stretch:V.stretch+(N-E)})}return c.push({fixed:t+1,stretch:r}),c}function Su(e,t,r,c){return e/t*r+c}function Cu(e,t,r,c){return e-t*r/c}var Eu=function(e,t,r,c,f,g,w,E,N,V){if(this.boxStartIndex=e.length,N){var J=g.top,ee=g.bottom,he=g.collisionPadding;he&&(J-=he[1],ee+=he[3]);var fe=ee-J;fe>0&&(fe=Math.max(10,fe),this.circleDiameter=fe)}else{var Te=g.top*w-E,Se=g.bottom*w+E,We=g.left*w-E,De=g.right*w+E,et=g.collisionPadding;if(et&&(We-=et[0]*w,Te-=et[1]*w,De+=et[2]*w,Se+=et[3]*w),V){var ut=new z(We,Te),vt=new z(De,Te),bt=new z(We,Se),Ot=new z(De,Se),Vt=V*Math.PI/180;ut._rotate(Vt),vt._rotate(Vt),bt._rotate(Vt),Ot._rotate(Vt),We=Math.min(ut.x,vt.x,bt.x,Ot.x),De=Math.max(ut.x,vt.x,bt.x,Ot.x),Te=Math.min(ut.y,vt.y,bt.y,Ot.y),Se=Math.max(ut.y,vt.y,bt.y,Ot.y)}e.emplaceBack(t.x,t.y,We,Te,De,Se,r,c,f)}this.boxEndIndex=e.length},fl=function(e,t){if(e===void 0&&(e=[]),t===void 0&&(t=Zp),this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(var r=(this.length>>1)-1;r>=0;r--)this._down(r)};function Zp(e,t){return e<t?-1:e>t?1:0}function Vp(e,t,r){t===void 0&&(t=1),r===void 0&&(r=!1);for(var c=1/0,f=1/0,g=-1/0,w=-1/0,E=e[0],N=0;N<E.length;N++){var V=E[N];(!N||V.x<c)&&(c=V.x),(!N||V.y<f)&&(f=V.y),(!N||V.x>g)&&(g=V.x),(!N||V.y>w)&&(w=V.y)}var J=Math.min(g-c,w-f),ee=J/2,he=new fl([],Kp);if(J===0)return new z(c,f);for(var fe=c;fe<g;fe+=J)for(var Te=f;Te<w;Te+=J)he.push(new _l(fe+ee,Te+ee,ee,e));for(var Se=function(et){for(var ut=0,vt=0,bt=0,Ot=et[0],Vt=0,oi=Ot.length,Mi=oi-1;Vt<oi;Mi=Vt++){var di=Ot[Vt],Ri=Ot[Mi],ci=di.x*Ri.y-Ri.x*di.y;vt+=(di.x+Ri.x)*ci,bt+=(di.y+Ri.y)*ci,ut+=3*ci}return new _l(vt/ut,bt/ut,0,et)}(e),We=he.length;he.length;){var De=he.pop();(De.d>Se.d||!Se.d)&&(Se=De,r&&console.log("found best %d after %d probes",Math.round(1e4*De.d)/1e4,We)),De.max-Se.d<=t||(he.push(new _l(De.p.x-(ee=De.h/2),De.p.y-ee,ee,e)),he.push(new _l(De.p.x+ee,De.p.y-ee,ee,e)),he.push(new _l(De.p.x-ee,De.p.y+ee,ee,e)),he.push(new _l(De.p.x+ee,De.p.y+ee,ee,e)),We+=4)}return r&&(console.log("num probes: "+We),console.log("best distance: "+Se.d)),Se.p}function Kp(e,t){return t.max-e.max}function _l(e,t,r,c){this.p=new z(e,t),this.h=r,this.d=function(f,g){for(var w=!1,E=1/0,N=0;N<g.length;N++)for(var V=g[N],J=0,ee=V.length,he=ee-1;J<ee;he=J++){var fe=V[J],Te=V[he];fe.y>f.y!=Te.y>f.y&&f.x<(Te.x-fe.x)*(f.y-fe.y)/(Te.y-fe.y)+fe.x&&(w=!w),E=Math.min(E,ha(f,fe,Te))}return(w?1:-1)*Math.sqrt(E)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}fl.prototype.push=function(e){this.data.push(e),this.length++,this._up(this.length-1)},fl.prototype.pop=function(){if(this.length!==0){var e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}},fl.prototype.peek=function(){return this.data[0]},fl.prototype._up=function(e){for(var t=this.data,r=this.compare,c=t[e];e>0;){var f=e-1>>1,g=t[f];if(r(c,g)>=0)break;t[e]=g,e=f}t[e]=c},fl.prototype._down=function(e){for(var t=this.data,r=this.compare,c=this.length>>1,f=t[e];e<c;){var g=1+(e<<1),w=t[g],E=g+1;if(E<this.length&&r(t[E],w)<0&&(g=E,w=t[E]),r(w,f)>=0)break;t[e]=w,e=g}t[e]=f};var lh=Number.POSITIVE_INFINITY;function nc(e,t){return t[1]!==lh?function(r,c,f){var g=0,w=0;switch(c=Math.abs(c),f=Math.abs(f),r){case"top-right":case"top-left":case"top":w=f-7;break;case"bottom-right":case"bottom-left":case"bottom":w=7-f}switch(r){case"top-right":case"bottom-right":case"right":g=-c;break;case"top-left":case"bottom-left":case"left":g=c}return[g,w]}(e,t[0],t[1]):function(r,c){var f=0,g=0;c<0&&(c=0);var w=c/Math.sqrt(2);switch(r){case"top-right":case"top-left":g=w-7;break;case"bottom-right":case"bottom-left":g=7-w;break;case"bottom":g=7-c;break;case"top":g=c-7}switch(r){case"top-right":case"bottom-right":f=-w;break;case"top-left":case"bottom-left":f=w;break;case"left":f=c;break;case"right":f=-c}return[f,g]}(e,t[0])}function uh(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function oc(e,t,r,c,f,g,w,E,N,V,J,ee,he,fe,Te){var Se=function(vt,bt,Ot,Vt,oi,Mi,di,Ri){for(var ci=Vt.layout.get("text-rotate").evaluate(Mi,{})*Math.PI/180,or=[],ji=0,Pi=bt.positionedLines;ji<Pi.length;ji+=1)for(var fr=Pi[ji],Qi=0,Lr=fr.positionedGlyphs;Qi<Lr.length;Qi+=1){var Ti=Lr[Qi];if(Ti.rect){var Tr=Ti.rect||{},Gr=4,Fn=!0,jn=1,Wr=0,bn=(oi||Ri)&&Ti.vertical,Zr=Ti.metrics.advance*Ti.scale/2;if(Ri&&bt.verticalizable&&(Wr=fr.lineOffset/2-(Ti.imageName?-(24-Ti.metrics.width*Ti.scale)/2:24*(Ti.scale-1))),Ti.imageName){var On=di[Ti.imageName];Fn=On.sdf,Gr=1/(jn=On.pixelRatio)}var wo=oi?[Ti.x+Zr,Ti.y]:[0,0],to=oi?[0,0]:[Ti.x+Zr+Ot[0],Ti.y+Ot[1]-Wr],So=[0,0];bn&&(So=to,to=[0,0]);var In=(Ti.metrics.left-Gr)*Ti.scale-Zr+to[0],kn=(-Ti.metrics.top-Gr)*Ti.scale+to[1],vr=In+Tr.w*Ti.scale/jn,Rr=kn+Tr.h*Ti.scale/jn,Vr=new z(In,kn),xr=new z(vr,kn),xn=new z(In,Rr),uo=new z(vr,Rr);if(bn){var Un=new z(-Zr,Zr- -17),sn=-Math.PI/2,Nn=12-Zr,Kr=new z(22-Nn,-(Ti.imageName?Nn:0)),dn=new(Function.prototype.bind.apply(z,[null].concat(So)));Vr._rotateAround(sn,Un)._add(Kr)._add(dn),xr._rotateAround(sn,Un)._add(Kr)._add(dn),xn._rotateAround(sn,Un)._add(Kr)._add(dn),uo._rotateAround(sn,Un)._add(Kr)._add(dn)}if(ci){var ea=Math.sin(ci),ts=Math.cos(ci),fn=[ts,-ea,ea,ts];Vr._matMult(fn),xr._matMult(fn),xn._matMult(fn),uo._matMult(fn)}var is=new z(0,0),Ma=new z(0,0);or.push({tl:Vr,tr:xr,bl:xn,br:uo,tex:Tr,writingMode:bt.writingMode,glyphOffset:wo,sectionIndex:Ti.sectionIndex,isSDF:Fn,pixelOffsetTL:is,pixelOffsetBR:Ma,minFontScaleX:0,minFontScaleY:0})}}return or}(0,r,E,f,g,w,c,e.allowVerticalPlacement),We=e.textSizeData,De=null;We.kind==="source"?(De=[128*f.layout.get("text-size").evaluate(w,{})])[0]>32640&&ht(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'):We.kind==="composite"&&((De=[128*fe.compositeTextSizes[0].evaluate(w,{},Te),128*fe.compositeTextSizes[1].evaluate(w,{},Te)])[0]>32640||De[1]>32640)&&ht(e.layerIds[0]+': Value for "text-size" is >= 255. Reduce your "text-size".'),e.addSymbols(e.text,Se,De,E,g,w,V,t,N.lineStartIndex,N.lineLength,he,Te);for(var et=0,ut=J;et<ut.length;et+=1)ee[ut[et]]=e.text.placedSymbolArray.length-1;return 4*Se.length}function ac(e){for(var t in e)return e[t];return null}function Hp(e,t,r,c){var f=e.compareText;if(t in f){for(var g=f[t],w=g.length-1;w>=0;w--)if(c.dist(g[w])<r)return!0}else f[t]=[];return f[t].push(c),!1}var qp=ul.VectorTileFeature.types,Jp=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ou(e,t,r,c,f,g,w,E,N,V,J,ee,he){var fe=E?Math.min(32640,Math.round(E[0])):0,Te=E?Math.min(32640,Math.round(E[1])):0;e.emplaceBack(t,r,Math.round(32*c),Math.round(32*f),g,w,(fe<<1)+(N?1:0),Te,16*V,16*J,256*ee,256*he)}function hh(e,t,r){e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r),e.emplaceBack(t.x,t.y,r)}function Xp(e){for(var t=0,r=e.sections;t<r.length;t+=1)if(us(r[t].text))return!0;return!1}var ml=function(e){this.layoutVertexArray=new Qs,this.indexArray=new Ya,this.programConfigurations=e,this.segments=new p,this.dynamicLayoutVertexArray=new Ts,this.opacityVertexArray=new Fs,this.placedSymbolArray=new ds};ml.prototype.isEmpty=function(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0},ml.prototype.upload=function(e,t,r,c){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,wp.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Pp.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Jp,!0),this.opacityVertexBuffer.itemSize=1),(r||c)&&this.programConfigurations.upload(e))},ml.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())},pt("SymbolBuffers",ml);var Ql=function(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new p,this.collisionVertexArray=new Fl};Ql.prototype.upload=function(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Lp.members,!0)},Ql.prototype.destroy=function(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())},pt("CollisionBuffers",Ql);var Dr=function(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(function(g){return g.id}),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ms([]),this.placementViewportMatrix=ms([]);var t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=sh(this.zoom,t["text-size"]),this.iconSizeData=sh(this.zoom,t["icon-size"]);var r=this.layers[0].layout,c=r.get("symbol-sort-key"),f=r.get("symbol-z-order");this.sortFeaturesByKey=f!=="viewport-y"&&c.constantOr(1)!==void 0,this.sortFeaturesByY=(f==="viewport-y"||f==="auto"&&!this.sortFeaturesByKey)&&(r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement")),r.get("symbol-placement")==="point"&&(this.writingModes=r.get("text-writing-mode").map(function(g){return $o[g]})),this.stateDependentLayerIds=this.layers.filter(function(g){return g.isStateDependent()}).map(function(g){return g.id}),this.sourceID=e.sourceID};Dr.prototype.createArrays=function(){this.text=new ml(new Ji(this.layers,this.zoom,function(e){return/^text/.test(e)})),this.icon=new ml(new Ji(this.layers,this.zoom,function(e){return/^icon/.test(e)})),this.glyphOffsetArray=new _u,this.lineVertexArray=new rl,this.symbolInstances=new Nl},Dr.prototype.calculateGlyphDependencies=function(e,t,r,c,f){for(var g=0;g<e.length;g++)if(t[e.charCodeAt(g)]=!0,(r||c)&&f){var w=Jl[e.charAt(g)];w&&(t[w.charCodeAt(0)]=!0)}},Dr.prototype.populate=function(e,t,r){var c=this.layers[0],f=c.layout,g=f.get("text-font"),w=f.get("text-field"),E=f.get("icon-image"),N=(w.value.kind!=="constant"||w.value.value instanceof Hr&&!w.value.value.isEmpty()||w.value.value.toString().length>0)&&(g.value.kind!=="constant"||g.value.value.length>0),V=E.value.kind!=="constant"||!!E.value.value||Object.keys(E.parameters).length>0,J=f.get("symbol-sort-key");if(this.features=[],N||V){for(var ee=t.iconDependencies,he=t.glyphDependencies,fe=t.availableImages,Te=new yr(this.zoom),Se=0,We=e;Se<We.length;Se+=1){var De=We[Se],et=De.feature,ut=De.id,vt=De.index,bt=De.sourceLayerIndex,Ot=c._featureFilter.needGeometry,Vt={type:et.type,id:ut,properties:et.properties,geometry:Ot?Xi(et):[]};if(c._featureFilter.filter(Te,Vt,r)){Ot||(Vt.geometry=Xi(et));var oi=void 0;if(N){var Mi=c.getValueAndResolveTokens("text-field",Vt,r,fe),di=Hr.factory(Mi);Xp(di)&&(this.hasRTLText=!0),(!this.hasRTLText||Dl()==="unavailable"||this.hasRTLText&&Wo.isParsed())&&(oi=Tp(di,c,Vt))}var Ri=void 0;if(V){var ci=c.getValueAndResolveTokens("icon-image",Vt,r,fe);Ri=ci instanceof Ln?ci:Ln.fromString(ci)}if(oi||Ri){var or=this.sortFeaturesByKey?J.evaluate(Vt,{},r):void 0,ji={id:ut,text:oi,icon:Ri,index:vt,sourceLayerIndex:bt,geometry:Xi(et),properties:et.properties,type:qp[et.type],sortKey:or};if(this.features.push(ji),Ri&&(ee[Ri.name]=!0),oi){var Pi=g.evaluate(Vt,{},r).join(","),fr=f.get("text-rotation-alignment")==="map"&&f.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf($o.vertical)>=0;for(var Qi=0,Lr=oi.sections;Qi<Lr.length;Qi+=1){var Ti=Lr[Qi];if(Ti.image)ee[Ti.image.name]=!0;else{var Tr=va(oi.toString()),Gr=Ti.fontStack||Pi,Fn=he[Gr]=he[Gr]||{};this.calculateGlyphDependencies(Ti.text,Fn,fr,this.allowVerticalPlacement,Tr)}}}}}}f.get("symbol-placement")==="line"&&(this.features=function(jn){var Wr={},bn={},Zr=[],On=0;function wo(sn){Zr.push(jn[sn]),On++}function to(sn,Nn,Kr){var dn=bn[sn];return delete bn[sn],bn[Nn]=dn,Zr[dn].geometry[0].pop(),Zr[dn].geometry[0]=Zr[dn].geometry[0].concat(Kr[0]),dn}function So(sn,Nn,Kr){var dn=Wr[Nn];return delete Wr[Nn],Wr[sn]=dn,Zr[dn].geometry[0].shift(),Zr[dn].geometry[0]=Kr[0].concat(Zr[dn].geometry[0]),dn}function In(sn,Nn,Kr){var dn=Kr?Nn[0][Nn[0].length-1]:Nn[0][0];return sn+":"+dn.x+":"+dn.y}for(var kn=0;kn<jn.length;kn++){var vr=jn[kn],Rr=vr.geometry,Vr=vr.text?vr.text.toString():null;if(Vr){var xr=In(Vr,Rr),xn=In(Vr,Rr,!0);if(xr in bn&&xn in Wr&&bn[xr]!==Wr[xn]){var uo=So(xr,xn,Rr),Un=to(xr,xn,Zr[uo].geometry);delete Wr[xr],delete bn[xn],bn[In(Vr,Zr[Un].geometry,!0)]=Un,Zr[uo].geometry=null}else xr in bn?to(xr,xn,Rr):xn in Wr?So(xr,xn,Rr):(wo(kn),Wr[xr]=On-1,bn[xn]=On-1)}else wo(kn)}return Zr.filter(function(sn){return sn.geometry})}(this.features)),this.sortFeaturesByKey&&this.features.sort(function(jn,Wr){return jn.sortKey-Wr.sortKey})}},Dr.prototype.update=function(e,t,r){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r))},Dr.prototype.isEmpty=function(){return this.symbolInstances.length===0&&!this.hasRTLText},Dr.prototype.uploadPending=function(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload},Dr.prototype.upload=function(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0},Dr.prototype.destroyDebugData=function(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()},Dr.prototype.destroy=function(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()},Dr.prototype.addToLineVertexArray=function(e,t){var r=this.lineVertexArray.length;if(e.segment!==void 0){for(var c=e.dist(t[e.segment+1]),f=e.dist(t[e.segment]),g={},w=e.segment+1;w<t.length;w++)g[w]={x:t[w].x,y:t[w].y,tileUnitDistanceFromAnchor:c},w<t.length-1&&(c+=t[w+1].dist(t[w]));for(var E=e.segment||0;E>=0;E--)g[E]={x:t[E].x,y:t[E].y,tileUnitDistanceFromAnchor:f},E>0&&(f+=t[E-1].dist(t[E]));for(var N=0;N<t.length;N++){var V=g[N];this.lineVertexArray.emplaceBack(V.x,V.y,V.tileUnitDistanceFromAnchor)}}return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}},Dr.prototype.addSymbols=function(e,t,r,c,f,g,w,E,N,V,J,ee){for(var he=e.indexArray,fe=e.layoutVertexArray,Te=e.segments.prepareSegment(4*t.length,fe,he,g.sortKey),Se=this.glyphOffsetArray.length,We=Te.vertexLength,De=this.allowVerticalPlacement&&w===$o.vertical?Math.PI/2:0,et=g.text&&g.text.sections,ut=0;ut<t.length;ut++){var vt=t[ut],bt=vt.tl,Ot=vt.tr,Vt=vt.bl,oi=vt.br,Mi=vt.tex,di=vt.pixelOffsetTL,Ri=vt.pixelOffsetBR,ci=vt.minFontScaleX,or=vt.minFontScaleY,ji=vt.glyphOffset,Pi=vt.isSDF,fr=vt.sectionIndex,Qi=Te.vertexLength,Lr=ji[1];Ou(fe,E.x,E.y,bt.x,Lr+bt.y,Mi.x,Mi.y,r,Pi,di.x,di.y,ci,or),Ou(fe,E.x,E.y,Ot.x,Lr+Ot.y,Mi.x+Mi.w,Mi.y,r,Pi,Ri.x,di.y,ci,or),Ou(fe,E.x,E.y,Vt.x,Lr+Vt.y,Mi.x,Mi.y+Mi.h,r,Pi,di.x,Ri.y,ci,or),Ou(fe,E.x,E.y,oi.x,Lr+oi.y,Mi.x+Mi.w,Mi.y+Mi.h,r,Pi,Ri.x,Ri.y,ci,or),hh(e.dynamicLayoutVertexArray,E,De),he.emplaceBack(Qi,Qi+1,Qi+2),he.emplaceBack(Qi+1,Qi+2,Qi+3),Te.vertexLength+=4,Te.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(ji[0]),ut!==t.length-1&&fr===t[ut+1].sectionIndex||e.programConfigurations.populatePaintArrays(fe.length,g,g.index,{},ee,et&&et[fr])}e.placedSymbolArray.emplaceBack(E.x,E.y,Se,this.glyphOffsetArray.length-Se,We,N,V,E.segment,r?r[0]:0,r?r[1]:0,c[0],c[1],w,0,!1,0,J)},Dr.prototype._addCollisionDebugVertex=function(e,t,r,c,f,g){return t.emplaceBack(0,0),e.emplaceBack(r.x,r.y,c,f,Math.round(g.x),Math.round(g.y))},Dr.prototype.addCollisionDebugVertices=function(e,t,r,c,f,g,w){var E=f.segments.prepareSegment(4,f.layoutVertexArray,f.indexArray),N=E.vertexLength,V=f.layoutVertexArray,J=f.collisionVertexArray,ee=w.anchorX,he=w.anchorY;this._addCollisionDebugVertex(V,J,g,ee,he,new z(e,t)),this._addCollisionDebugVertex(V,J,g,ee,he,new z(r,t)),this._addCollisionDebugVertex(V,J,g,ee,he,new z(r,c)),this._addCollisionDebugVertex(V,J,g,ee,he,new z(e,c)),E.vertexLength+=4;var fe=f.indexArray;fe.emplaceBack(N,N+1),fe.emplaceBack(N+1,N+2),fe.emplaceBack(N+2,N+3),fe.emplaceBack(N+3,N),E.primitiveLength+=4},Dr.prototype.addDebugCollisionBoxes=function(e,t,r,c){for(var f=e;f<t;f++){var g=this.collisionBoxArray.get(f);this.addCollisionDebugVertices(g.x1,g.y1,g.x2,g.y2,c?this.textCollisionBox:this.iconCollisionBox,g.anchorPoint,r)}},Dr.prototype.generateCollisionDebugBuffers=function(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Ql(Ss,Fh.members,js),this.iconCollisionBox=new Ql(Ss,Fh.members,js);for(var e=0;e<this.symbolInstances.length;e++){var t=this.symbolInstances.get(e);this.addDebugCollisionBoxes(t.textBoxStartIndex,t.textBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.verticalTextBoxStartIndex,t.verticalTextBoxEndIndex,t,!0),this.addDebugCollisionBoxes(t.iconBoxStartIndex,t.iconBoxEndIndex,t,!1),this.addDebugCollisionBoxes(t.verticalIconBoxStartIndex,t.verticalIconBoxEndIndex,t,!1)}},Dr.prototype._deserializeCollisionBoxesForSymbol=function(e,t,r,c,f,g,w,E,N){for(var V={},J=t;J<r;J++){var ee=e.get(J);V.textBox={x1:ee.x1,y1:ee.y1,x2:ee.x2,y2:ee.y2,anchorPointX:ee.anchorPointX,anchorPointY:ee.anchorPointY},V.textFeatureIndex=ee.featureIndex;break}for(var he=c;he<f;he++){var fe=e.get(he);V.verticalTextBox={x1:fe.x1,y1:fe.y1,x2:fe.x2,y2:fe.y2,anchorPointX:fe.anchorPointX,anchorPointY:fe.anchorPointY},V.verticalTextFeatureIndex=fe.featureIndex;break}for(var Te=g;Te<w;Te++){var Se=e.get(Te);V.iconBox={x1:Se.x1,y1:Se.y1,x2:Se.x2,y2:Se.y2,anchorPointX:Se.anchorPointX,anchorPointY:Se.anchorPointY},V.iconFeatureIndex=Se.featureIndex;break}for(var We=E;We<N;We++){var De=e.get(We);V.verticalIconBox={x1:De.x1,y1:De.y1,x2:De.x2,y2:De.y2,anchorPointX:De.anchorPointX,anchorPointY:De.anchorPointY},V.verticalIconFeatureIndex=De.featureIndex;break}return V},Dr.prototype.deserializeCollisionBoxes=function(e){this.collisionArrays=[];for(var t=0;t<this.symbolInstances.length;t++){var r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}},Dr.prototype.hasTextData=function(){return this.text.segments.get().length>0},Dr.prototype.hasIconData=function(){return this.icon.segments.get().length>0},Dr.prototype.hasDebugData=function(){return this.textCollisionBox&&this.iconCollisionBox},Dr.prototype.hasTextCollisionBoxData=function(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0},Dr.prototype.hasIconCollisionBoxData=function(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0},Dr.prototype.addIndicesForPlacedSymbol=function(e,t){for(var r=e.placedSymbolArray.get(t),c=r.vertexStartIndex+4*r.numGlyphs,f=r.vertexStartIndex;f<c;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)},Dr.prototype.getSortedSymbolIndexes=function(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;for(var t=Math.sin(e),r=Math.cos(e),c=[],f=[],g=[],w=0;w<this.symbolInstances.length;++w){g.push(w);var E=this.symbolInstances.get(w);c.push(0|Math.round(t*E.anchorX+r*E.anchorY)),f.push(E.featureIndex)}return g.sort(function(N,V){return c[N]-c[V]||f[V]-f[N]}),g},Dr.prototype.addToSortKeyRanges=function(e,t){var r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})},Dr.prototype.sortFeatures=function(e){var t=this;if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(var r=0,c=this.symbolInstanceIndexes;r<c.length;r+=1){var f=this.symbolInstances.get(c[r]);this.featureSortOrder.push(f.featureIndex),[f.rightJustifiedTextSymbolIndex,f.centerJustifiedTextSymbolIndex,f.leftJustifiedTextSymbolIndex].forEach(function(g,w,E){g>=0&&E.indexOf(g)===w&&t.addIndicesForPlacedSymbol(t.text,g)}),f.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,f.verticalPlacedTextSymbolIndex),f.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.placedIconSymbolIndex),f.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,f.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}},pt("SymbolBucket",Dr,{omit:["layers","collisionBoxArray","features","compareText"]}),Dr.MAX_GLYPHS=65535,Dr.addDynamicAttributes=hh;var Yp=new no({"symbol-placement":new Ai(xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ai(xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ai(xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new wi(xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ai(xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ai(xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ai(xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ai(xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ai(xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new wi(xe.layout_symbol["icon-size"]),"icon-text-fit":new Ai(xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ai(xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new wi(xe.layout_symbol["icon-image"]),"icon-rotate":new wi(xe.layout_symbol["icon-rotate"]),"icon-padding":new Ai(xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ai(xe.layout_symbol["icon-keep-upright"]),"icon-offset":new wi(xe.layout_symbol["icon-offset"]),"icon-anchor":new wi(xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ai(xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ai(xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ai(xe.layout_symbol["text-rotation-alignment"]),"text-field":new wi(xe.layout_symbol["text-field"]),"text-font":new wi(xe.layout_symbol["text-font"]),"text-size":new wi(xe.layout_symbol["text-size"]),"text-max-width":new wi(xe.layout_symbol["text-max-width"]),"text-line-height":new Ai(xe.layout_symbol["text-line-height"]),"text-letter-spacing":new wi(xe.layout_symbol["text-letter-spacing"]),"text-justify":new wi(xe.layout_symbol["text-justify"]),"text-radial-offset":new wi(xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ai(xe.layout_symbol["text-variable-anchor"]),"text-anchor":new wi(xe.layout_symbol["text-anchor"]),"text-max-angle":new Ai(xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ai(xe.layout_symbol["text-writing-mode"]),"text-rotate":new wi(xe.layout_symbol["text-rotate"]),"text-padding":new Ai(xe.layout_symbol["text-padding"]),"text-keep-upright":new Ai(xe.layout_symbol["text-keep-upright"]),"text-transform":new wi(xe.layout_symbol["text-transform"]),"text-offset":new wi(xe.layout_symbol["text-offset"]),"text-allow-overlap":new Ai(xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ai(xe.layout_symbol["text-ignore-placement"]),"text-optional":new Ai(xe.layout_symbol["text-optional"])}),ch={paint:new no({"icon-opacity":new wi(xe.paint_symbol["icon-opacity"]),"icon-color":new wi(xe.paint_symbol["icon-color"]),"icon-halo-color":new wi(xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new wi(xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new wi(xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ai(xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ai(xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new wi(xe.paint_symbol["text-opacity"]),"text-color":new wi(xe.paint_symbol["text-color"],{runtimeType:ri,getOverride:function(e){return e.textColor},hasOverride:function(e){return!!e.textColor}}),"text-halo-color":new wi(xe.paint_symbol["text-halo-color"]),"text-halo-width":new wi(xe.paint_symbol["text-halo-width"]),"text-halo-blur":new wi(xe.paint_symbol["text-halo-blur"]),"text-translate":new Ai(xe.paint_symbol["text-translate"]),"text-translate-anchor":new Ai(xe.paint_symbol["text-translate-anchor"])}),layout:Yp},gl=function(e){this.type=e.property.overrides?e.property.overrides.runtimeType:ai,this.defaultValue=e};gl.prototype.evaluate=function(e){if(e.formattedSection){var t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default},gl.prototype.eachChild=function(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)},gl.prototype.outputDefined=function(){return!1},gl.prototype.serialize=function(){return null},pt("FormatSectionOverride",gl,{omit:["defaultValue"]});var Qp=function(e){function t(r){e.call(this,r,ch)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.recalculate=function(r,c){if(e.prototype.recalculate.call(this,r,c),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){var f=this.layout.get("text-writing-mode");if(f){for(var g=[],w=0,E=f;w<E.length;w+=1){var N=E[w];g.indexOf(N)<0&&g.push(N)}this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()},t.prototype.getValueAndResolveTokens=function(r,c,f,g){var w=this.layout.get(r).evaluate(c,{},f,g),E=this._unevaluatedLayout._values[r];return E.isDataDriven()||Rt(E.value)||!w?w:function(N,V){return V.replace(/{([^{}]+)}/g,function(J,ee){return ee in N?String(N[ee]):""})}(c.properties,w)},t.prototype.createBucket=function(r){return new Dr(r)},t.prototype.queryRadius=function(){return 0},t.prototype.queryIntersectsFeature=function(){return!1},t.prototype._setPaintOverrides=function(){for(var r=0,c=ch.paint.overridableProperties;r<c.length;r+=1){var f=c[r];if(t.hasPaintOverride(this.layout,f)){var g,w=this.paint.get(f),E=new gl(w),N=new Nt(E,w.property.specification);g=w.value.kind==="constant"||w.value.kind==="source"?new Jt("source",N):new pi("composite",N,w.value.zoomStops,w.value._interpolationType),this.paint._values[f]=new yo(w.property,g,w.parameters)}}},t.prototype._handleOverridablePaintPropertyUpdate=function(r,c,f){return!(!this.layout||c.isDataDriven()||f.isDataDriven())&&t.hasPaintOverride(this.layout,r)},t.hasPaintOverride=function(r,c){var f=r.get("text-field"),g=ch.paint.properties[c],w=!1,E=function(J){for(var ee=0,he=J;ee<he.length;ee+=1)if(g.overrides&&g.overrides.hasOverride(he[ee]))return void(w=!0)};if(f.value.kind==="constant"&&f.value.value instanceof Hr)E(f.value.value.sections);else if(f.value.kind==="source"){var N=function(J){w||(J instanceof gn&&gr(J.value)===$i?E(J.value.sections):J instanceof Wn?E(J.sections):J.eachChild(N))},V=f.value;V._styleExpression&&N(V._styleExpression.expression)}return w},t}(wa),$p={paint:new no({"background-color":new Ai(xe.paint_background["background-color"]),"background-pattern":new Do(xe.paint_background["background-pattern"]),"background-opacity":new Ai(xe.paint_background["background-opacity"])})},ed=function(e){function t(r){e.call(this,r,$p)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(wa),td={paint:new no({"raster-opacity":new Ai(xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Ai(xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ai(xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ai(xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ai(xe.paint_raster["raster-saturation"]),"raster-contrast":new Ai(xe.paint_raster["raster-contrast"]),"raster-resampling":new Ai(xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ai(xe.paint_raster["raster-fade-duration"])})},id=function(e){function t(r){e.call(this,r,td)}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t}(wa),rd=function(e){function t(r){e.call(this,r,{}),this.implementation=r}return e&&(t.__proto__=e),(t.prototype=Object.create(e&&e.prototype)).constructor=t,t.prototype.is3D=function(){return this.implementation.renderingMode==="3d"},t.prototype.hasOffscreenPass=function(){return this.implementation.prerender!==void 0},t.prototype.recalculate=function(){},t.prototype.updateTransitions=function(){},t.prototype.hasTransition=function(){},t.prototype.serialize=function(){},t.prototype.onAdd=function(r){this.implementation.onAdd&&this.implementation.onAdd(r,r.painter.context.gl)},t.prototype.onRemove=function(r){this.implementation.onRemove&&this.implementation.onRemove(r,r.painter.context.gl)},t}(wa),nd={circle:nl,heatmap:ol,hillshade:al,fill:ap,"fill-extrusion":_p,line:xp,symbol:Qp,background:ed,raster:id},sc=C.HTMLImageElement,lc=C.HTMLCanvasElement,uc=C.HTMLVideoElement,hc=C.ImageData,Iu=C.ImageBitmap,Ws=function(e,t,r,c){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,c)};Ws.prototype.update=function(e,t,r){var c=e.width,f=e.height,g=!(this.size&&this.size[0]===c&&this.size[1]===f||r),w=this.context,E=w.gl;if(this.useMipmap=Boolean(t&&t.useMipmap),E.bindTexture(E.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!t||t.premultiply!==!1)),g)this.size=[c,f],e instanceof sc||e instanceof lc||e instanceof uc||e instanceof hc||Iu&&e instanceof Iu?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,e):E.texImage2D(E.TEXTURE_2D,0,this.format,c,f,0,this.format,E.UNSIGNED_BYTE,e.data);else{var N=r||{x:0,y:0},V=N.x,J=N.y;e instanceof sc||e instanceof lc||e instanceof uc||e instanceof hc||Iu&&e instanceof Iu?E.texSubImage2D(E.TEXTURE_2D,0,V,J,E.RGBA,E.UNSIGNED_BYTE,e):E.texSubImage2D(E.TEXTURE_2D,0,V,J,c,f,E.RGBA,E.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&E.generateMipmap(E.TEXTURE_2D)},Ws.prototype.bind=function(e,t,r){var c=this.context.gl;c.bindTexture(c.TEXTURE_2D,this.texture),r!==c.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(r=c.LINEAR),e!==this.filter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,e),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,r||e),this.filter=e),t!==this.wrap&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,t),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,t),this.wrap=t)},Ws.prototype.isSizePowerOfTwo=function(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0},Ws.prototype.destroy=function(){this.context.gl.deleteTexture(this.texture),this.texture=null};var ph=function(e){var t=this;this._callback=e,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=function(){t._triggered=!1,t._callback()})};ph.prototype.trigger=function(){var e=this;this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(function(){e._triggered=!1,e._callback()},0))},ph.prototype.remove=function(){delete this._channel,this._callback=function(){}};var yl=function(e,t,r){this.target=e,this.parent=t,this.mapId=r,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},X(["receive","process"],this),this.invoker=new ph(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=gt()?e:C};function cc(e,t,r){var c=2*Math.PI*6378137/256/Math.pow(2,r);return[e*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}yl.prototype.send=function(e,t,r,c,f){var g=this;f===void 0&&(f=!1);var w=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(this.callbacks[w]=r);var E=Ae(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:e,hasCallback:!!r,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:Mn(t,E)},E),{cancel:function(){r&&delete g.callbacks[w],g.target.postMessage({id:w,type:"<cancel>",targetMapId:c,sourceMapId:g.mapId})}}},yl.prototype.receive=function(e){var t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){delete this.tasks[r];var c=this.cancelCallbacks[r];delete this.cancelCallbacks[r],c&&c()}else gt()||t.mustQueue?(this.tasks[r]=t,this.taskQueue.push(r),this.invoker.trigger()):this.processTask(r,t)},yl.prototype.process=function(){if(this.taskQueue.length){var e=this.taskQueue.shift(),t=this.tasks[e];delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),t&&this.processTask(e,t)}},yl.prototype.processTask=function(e,t){var r=this;if(t.type==="<response>"){var c=this.callbacks[e];delete this.callbacks[e],c&&(t.error?c(vn(t.error)):c(null,vn(t.data)))}else{var f=!1,g=Ae(this.globalScope)?void 0:[],w=t.hasCallback?function(J,ee){f=!0,delete r.cancelCallbacks[e],r.target.postMessage({id:e,type:"<response>",sourceMapId:r.mapId,error:J?Mn(J):null,data:Mn(ee,g)},g)}:function(J){f=!0},E=null,N=vn(t.data);if(this.parent[t.type])E=this.parent[t.type](t.sourceMapId,N,w);else if(this.parent.getWorkerSource){var V=t.type.split(".");E=this.parent.getWorkerSource(t.sourceMapId,V[0],N.source)[V[1]](N,w)}else w(new Error("Could not find function "+t.type));!f&&E&&E.cancel&&(this.cancelCallbacks[e]=E.cancel)}},yl.prototype.remove=function(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)};var Cn=function(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))};Cn.prototype.setNorthEast=function(e){return this._ne=e instanceof Jr?new Jr(e.lng,e.lat):Jr.convert(e),this},Cn.prototype.setSouthWest=function(e){return this._sw=e instanceof Jr?new Jr(e.lng,e.lat):Jr.convert(e),this},Cn.prototype.extend=function(e){var t,r,c=this._sw,f=this._ne;if(e instanceof Jr)t=e,r=e;else{if(!(e instanceof Cn))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(Cn.convert(e)):this.extend(Jr.convert(e)):this;if(r=e._ne,!(t=e._sw)||!r)return this}return c||f?(c.lng=Math.min(t.lng,c.lng),c.lat=Math.min(t.lat,c.lat),f.lng=Math.max(r.lng,f.lng),f.lat=Math.max(r.lat,f.lat)):(this._sw=new Jr(t.lng,t.lat),this._ne=new Jr(r.lng,r.lat)),this},Cn.prototype.getCenter=function(){return new Jr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)},Cn.prototype.getSouthWest=function(){return this._sw},Cn.prototype.getNorthEast=function(){return this._ne},Cn.prototype.getNorthWest=function(){return new Jr(this.getWest(),this.getNorth())},Cn.prototype.getSouthEast=function(){return new Jr(this.getEast(),this.getSouth())},Cn.prototype.getWest=function(){return this._sw.lng},Cn.prototype.getSouth=function(){return this._sw.lat},Cn.prototype.getEast=function(){return this._ne.lng},Cn.prototype.getNorth=function(){return this._ne.lat},Cn.prototype.toArray=function(){return[this._sw.toArray(),this._ne.toArray()]},Cn.prototype.toString=function(){return"LngLatBounds("+this._sw.toString()+", "+this._ne.toString()+")"},Cn.prototype.isEmpty=function(){return!(this._sw&&this._ne)},Cn.prototype.contains=function(e){var t=Jr.convert(e),r=t.lng,c=t.lat,f=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f},Cn.convert=function(e){return!e||e instanceof Cn?e:new Cn(e)};var Jr=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid LngLat object: ("+e+", "+t+")");if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")};Jr.prototype.wrap=function(){return new Jr(I(this.lng,-180,180),this.lat)},Jr.prototype.toArray=function(){return[this.lng,this.lat]},Jr.prototype.toString=function(){return"LngLat("+this.lng+", "+this.lat+")"},Jr.prototype.distanceTo=function(e){var t=Math.PI/180,r=this.lat*t,c=e.lat*t,f=Math.sin(r)*Math.sin(c)+Math.cos(r)*Math.cos(c)*Math.cos((e.lng-this.lng)*t);return 63710088e-1*Math.acos(Math.min(f,1))},Jr.prototype.toBounds=function(e){e===void 0&&(e=0);var t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Cn(new Jr(this.lng-r,this.lat-t),new Jr(this.lng+r,this.lat+t))},Jr.convert=function(e){if(e instanceof Jr)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Jr(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Jr(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")};var pc=2*Math.PI*63710088e-1;function dc(e){return pc*Math.cos(e*Math.PI/180)}function fc(e){return(180+e)/360}function _c(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function mc(e,t){return e/dc(t)}function dh(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}var Zs=function(e,t,r){r===void 0&&(r=0),this.x=+e,this.y=+t,this.z=+r};Zs.fromLngLat=function(e,t){t===void 0&&(t=0);var r=Jr.convert(e);return new Zs(fc(r.lng),_c(r.lat),mc(t,r.lat))},Zs.prototype.toLngLat=function(){return new Jr(360*this.x-180,dh(this.y))},Zs.prototype.toAltitude=function(){return this.z*dc(dh(this.y))},Zs.prototype.meterInMercatorCoordinateUnits=function(){return 1/pc*(e=dh(this.y),1/Math.cos(e*Math.PI/180));var e};var Vs=function(e,t,r){this.z=e,this.x=t,this.y=r,this.key=$l(0,e,e,t,r)};Vs.prototype.equals=function(e){return this.z===e.z&&this.x===e.x&&this.y===e.y},Vs.prototype.url=function(e,t){var r,c,f,g,w,E=(c=this.y,f=this.z,g=cc(256*(r=this.x),256*(c=Math.pow(2,f)-c-1),f),w=cc(256*(r+1),256*(c+1),f),g[0]+","+g[1]+","+w[0]+","+w[1]),N=function(V,J,ee){for(var he,fe="",Te=V;Te>0;Te--)fe+=(J&(he=1<<Te-1)?1:0)+(ee&he?2:0);return fe}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(t==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",N).replace("{bbox-epsg-3857}",E)},Vs.prototype.getTilePoint=function(e){var t=Math.pow(2,this.z);return new z(8192*(e.x*t-this.x),8192*(e.y*t-this.y))},Vs.prototype.toString=function(){return this.z+"/"+this.x+"/"+this.y};var gc=function(e,t){this.wrap=e,this.canonical=t,this.key=$l(e,t.z,t.z,t.x,t.y)},En=function(e,t,r,c,f){this.overscaledZ=e,this.wrap=t,this.canonical=new Vs(r,+c,+f),this.key=$l(t,e,r,c,f)};function $l(e,t,r,c,f){(e*=2)<0&&(e=-1*e-1);var g=1<<r;return(g*g*e+g*f+c).toString(36)+r.toString(36)+t.toString(36)}En.prototype.equals=function(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)},En.prototype.scaledTo=function(e){var t=this.canonical.z-e;return e>this.canonical.z?new En(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new En(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)},En.prototype.calculateScaledKey=function(e,t){var r=this.canonical.z-e;return e>this.canonical.z?$l(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y):$l(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)},En.prototype.isChildOf=function(e){if(e.wrap!==this.wrap)return!1;var t=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t},En.prototype.children=function(e){if(this.overscaledZ>=e)return[new En(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];var t=this.canonical.z+1,r=2*this.canonical.x,c=2*this.canonical.y;return[new En(t,this.wrap,t,r,c),new En(t,this.wrap,t,r+1,c),new En(t,this.wrap,t,r,c+1),new En(t,this.wrap,t,r+1,c+1)]},En.prototype.isLessThan=function(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))},En.prototype.wrapped=function(){return new En(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)},En.prototype.unwrapTo=function(e){return new En(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)},En.prototype.overscaleFactor=function(){return Math.pow(2,this.overscaledZ-this.canonical.z)},En.prototype.toUnwrapped=function(){return new gc(this.wrap,this.canonical)},En.prototype.toString=function(){return this.overscaledZ+"/"+this.canonical.x+"/"+this.canonical.y},En.prototype.getTilePoint=function(e){return this.canonical.getTilePoint(new Zs(e.x-this.wrap,e.y))},pt("CanonicalTileID",Vs),pt("OverscaledTileID",En,{omit:["posMatrix"]});var ys=function(e,t,r){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&r!=="mapbox"&&r!=="terrarium")return ht('"'+r+'" is not a valid encoding type. Valid types include "mapbox" and "terrarium".');this.stride=t.height;var c=this.dim=t.height-2;this.data=new Uint32Array(t.data.buffer),this.encoding=r||"mapbox";for(var f=0;f<c;f++)this.data[this._idx(-1,f)]=this.data[this._idx(0,f)],this.data[this._idx(c,f)]=this.data[this._idx(c-1,f)],this.data[this._idx(f,-1)]=this.data[this._idx(f,0)],this.data[this._idx(f,c)]=this.data[this._idx(f,c-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(c,-1)]=this.data[this._idx(c-1,0)],this.data[this._idx(-1,c)]=this.data[this._idx(0,c-1)],this.data[this._idx(c,c)]=this.data[this._idx(c-1,c-1)]};ys.prototype.get=function(e,t){var r=new Uint8Array(this.data.buffer),c=4*this._idx(e,t);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(r[c],r[c+1],r[c+2])},ys.prototype.getUnpackVector=function(){return this.encoding==="terrarium"?[256,1,1/256,32768]:[6553.6,25.6,.1,1e4]},ys.prototype._idx=function(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)},ys.prototype._unpackMapbox=function(e,t,r){return(256*e*256+256*t+r)/10-1e4},ys.prototype._unpackTerrarium=function(e,t,r){return 256*e+t+r/256-32768},ys.prototype.getPixels=function(){return new bo({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))},ys.prototype.backfillBorder=function(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");var c=t*this.dim,f=t*this.dim+this.dim,g=r*this.dim,w=r*this.dim+this.dim;switch(t){case-1:c=f-1;break;case 1:f=c+1}switch(r){case-1:g=w-1;break;case 1:w=g+1}for(var E=-t*this.dim,N=-r*this.dim,V=g;V<w;V++)for(var J=c;J<f;J++)this.data[this._idx(J,V)]=e.data[this._idx(J+E,V+N)]},pt("DEMData",ys);var ku=function(e){this._stringToNumber={},this._numberToString=[];for(var t=0;t<e.length;t++){var r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}};ku.prototype.encode=function(e){return this._stringToNumber[e]},ku.prototype.decode=function(e){return this._numberToString[e]};var Au=function(e,t,r,c,f){this.type="Feature",this._vectorTileFeature=e,e._z=t,e._x=r,e._y=c,this.properties=e.properties,this.id=f},fh={geometry:{configurable:!0}};fh.geometry.get=function(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry},fh.geometry.set=function(e){this._geometry=e},Au.prototype.toJSON=function(){var e={geometry:this.geometry};for(var t in this)t!=="_geometry"&&t!=="_vectorTileFeature"&&(e[t]=this[t]);return e},Object.defineProperties(Au.prototype,fh);var vl=function(){this.state={},this.stateChanges={},this.deletedStates={}};vl.prototype.updateState=function(e,t,r){var c=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][c]=this.stateChanges[e][c]||{},F(this.stateChanges[e][c],r),this.deletedStates[e]===null)for(var f in this.deletedStates[e]={},this.state[e])f!==c&&(this.deletedStates[e][f]=null);else if(this.deletedStates[e]&&this.deletedStates[e][c]===null)for(var g in this.deletedStates[e][c]={},this.state[e][c])r[g]||(this.deletedStates[e][c][g]=null);else for(var w in r)this.deletedStates[e]&&this.deletedStates[e][c]&&this.deletedStates[e][c][w]===null&&delete this.deletedStates[e][c][w]},vl.prototype.removeFeatureState=function(e,t,r){if(this.deletedStates[e]!==null){var c=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&t!==void 0)this.deletedStates[e][c]!==null&&(this.deletedStates[e][c]=this.deletedStates[e][c]||{},this.deletedStates[e][c][r]=null);else if(t!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][c])for(r in this.deletedStates[e][c]={},this.stateChanges[e][c])this.deletedStates[e][c][r]=null;else this.deletedStates[e][c]=null;else this.deletedStates[e]=null}},vl.prototype.getState=function(e,t){var r=String(t),c=F({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){var f=this.deletedStates[e][t];if(f===null)return{};for(var g in f)delete c[g]}return c},vl.prototype.initializeTileState=function(e,t){e.setFeatureState(this.state,t)},vl.prototype.coalesceChanges=function(e,t){var r={};for(var c in this.stateChanges){this.state[c]=this.state[c]||{};var f={};for(var g in this.stateChanges[c])this.state[c][g]||(this.state[c][g]={}),F(this.state[c][g],this.stateChanges[c][g]),f[g]=this.state[c][g];r[c]=f}for(var w in this.deletedStates){this.state[w]=this.state[w]||{};var E={};if(this.deletedStates[w]===null)for(var N in this.state[w])E[N]={},this.state[w][N]={};else for(var V in this.deletedStates[w]){if(this.deletedStates[w][V]===null)this.state[w][V]={};else for(var J=0,ee=Object.keys(this.deletedStates[w][V]);J<ee.length;J+=1)delete this.state[w][V][ee[J]];E[V]=this.state[w][V]}r[w]=r[w]||{},F(r[w],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(r).length!==0)for(var he in e)e[he].setFeatureState(r,t)};var vs=function(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Y(8192,16,0),this.grid3D=new Y(8192,16,0),this.featureIndexArray=new u,this.promoteId=t};function yc(e,t,r,c,f){return Me(e,function(g,w){var E=t instanceof Bs?t.get(w):null;return E&&E.evaluate?E.evaluate(r,c,f):E})}function vc(e){for(var t=1/0,r=1/0,c=-1/0,f=-1/0,g=0,w=e;g<w.length;g+=1){var E=w[g];t=Math.min(t,E.x),r=Math.min(r,E.y),c=Math.max(c,E.x),f=Math.max(f,E.y)}return{minX:t,minY:r,maxX:c,maxY:f}}function od(e,t){return t-e}vs.prototype.insert=function(e,t,r,c,f,g){var w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,c,f);for(var E=g?this.grid3D:this.grid,N=0;N<t.length;N++){for(var V=t[N],J=[1/0,1/0,-1/0,-1/0],ee=0;ee<V.length;ee++){var he=V[ee];J[0]=Math.min(J[0],he.x),J[1]=Math.min(J[1],he.y),J[2]=Math.max(J[2],he.x),J[3]=Math.max(J[3],he.y)}J[0]<8192&&J[1]<8192&&J[2]>=0&&J[3]>=0&&E.insert(w,J[0],J[1],J[2],J[3])}},vs.prototype.loadVTLayers=function(){return this.vtLayers||(this.vtLayers=new ul.VectorTile(new xu(this.rawTileData)).layers,this.sourceLayerCoder=new ku(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers},vs.prototype.query=function(e,t,r,c){var f=this;this.loadVTLayers();for(var g=e.params||{},w=8192/e.tileSize/e.scale,E=tr(g.filter),N=e.queryGeometry,V=e.queryPadding*w,J=vc(N),ee=this.grid.query(J.minX-V,J.minY-V,J.maxX+V,J.maxY+V),he=vc(e.cameraQueryGeometry),fe=this.grid3D.query(he.minX-V,he.minY-V,he.maxX+V,he.maxY+V,function(vt,bt,Ot,Vt){return function(oi,Mi,di,Ri,ci){for(var or=0,ji=oi;or<ji.length;or+=1){var Pi=ji[or];if(Mi<=Pi.x&&di<=Pi.y&&Ri>=Pi.x&&ci>=Pi.y)return!0}var fr=[new z(Mi,di),new z(Mi,ci),new z(Ri,ci),new z(Ri,di)];if(oi.length>2){for(var Qi=0,Lr=fr;Qi<Lr.length;Qi+=1)if(Bo(oi,Lr[Qi]))return!0}for(var Ti=0;Ti<oi.length-1;Ti++)if(Mo(oi[Ti],oi[Ti+1],fr))return!0;return!1}(e.cameraQueryGeometry,vt-V,bt-V,Ot+V,Vt+V)}),Te=0,Se=fe;Te<Se.length;Te+=1)ee.push(Se[Te]);ee.sort(od);for(var We,De={},et=function(vt){var bt=ee[vt];if(bt!==We){We=bt;var Ot=f.featureIndexArray.get(bt),Vt=null;f.loadMatchingFeature(De,Ot.bucketIndex,Ot.sourceLayerIndex,Ot.featureIndex,E,g.layers,g.availableImages,t,r,c,function(oi,Mi,di){return Vt||(Vt=Xi(oi)),Mi.queryIntersectsFeature(N,oi,di,Vt,f.z,e.transform,w,e.pixelPosMatrix)})}},ut=0;ut<ee.length;ut++)et(ut);return De},vs.prototype.loadMatchingFeature=function(e,t,r,c,f,g,w,E,N,V,J){var ee=this.bucketLayerIDs[t];if(!g||function(Vt,oi){for(var Mi=0;Mi<Vt.length;Mi++)if(oi.indexOf(Vt[Mi])>=0)return!0;return!1}(g,ee)){var he=this.sourceLayerCoder.decode(r),fe=this.vtLayers[he].feature(c);if(f.filter(new yr(this.tileID.overscaledZ),fe))for(var Te=this.getId(fe,he),Se=0;Se<ee.length;Se++){var We=ee[Se];if(!(g&&g.indexOf(We)<0)){var De=E[We];if(De){var et={};Te!==void 0&&V&&(et=V.getState(De.sourceLayer||"_geojsonTileLayer",Te));var ut=N[We];ut.paint=yc(ut.paint,De.paint,fe,et,w),ut.layout=yc(ut.layout,De.layout,fe,et,w);var vt=!J||J(fe,De,et);if(vt){var bt=new Au(fe,this.z,this.x,this.y,Te);bt.layer=ut;var Ot=e[We];Ot===void 0&&(Ot=e[We]=[]),Ot.push({featureIndex:c,feature:bt,intersectionZ:vt})}}}}}},vs.prototype.lookupSymbolFeatures=function(e,t,r,c,f,g,w,E){var N={};this.loadVTLayers();for(var V=tr(f),J=0,ee=e;J<ee.length;J+=1)this.loadMatchingFeature(N,r,c,ee[J],V,g,w,E,t);return N},vs.prototype.hasLayer=function(e){for(var t=0,r=this.bucketLayerIDs;t<r.length;t+=1)for(var c=0,f=r[t];c<f.length;c+=1)if(e===f[c])return!0;return!1},vs.prototype.getId=function(e,t){var r=e.id;return this.promoteId&&typeof(r=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[t]])=="boolean"&&(r=Number(r)),r},pt("FeatureIndex",vs,{omit:["rawTileData","sourceLayerCoder"]});var eo=function(e,t){this.tileID=e,this.uid=re(),this.uses=0,this.tileSize=t,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"};eo.prototype.registerFadeDuration=function(e){var t=e+this.timeAdded;t<xt.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)},eo.prototype.wasRequested=function(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"},eo.prototype.loadVectorData=function(e,t,r){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){for(var c in e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(V,J){var ee={};if(!J)return ee;for(var he=function(){var Se=Te[fe],We=Se.layerIds.map(function(ut){return J.getLayer(ut)}).filter(Boolean);if(We.length!==0){Se.layers=We,Se.stateDependentLayerIds&&(Se.stateDependentLayers=Se.stateDependentLayerIds.map(function(ut){return We.filter(function(vt){return vt.id===ut})[0]}));for(var De=0,et=We;De<et.length;De+=1)ee[et[De].id]=Se}},fe=0,Te=V;fe<Te.length;fe+=1)he();return ee}(e.buckets,t.style),this.hasSymbolBuckets=!1,this.buckets){var f=this.buckets[c];if(f instanceof Dr){if(this.hasSymbolBuckets=!0,!r)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(var g in this.buckets){var w=this.buckets[g];if(w instanceof Dr&&w.hasRTLText){this.hasRTLText=!0,Wo.isLoading()||Wo.isLoaded()||Dl()!=="deferred"||Ja();break}}for(var E in this.queryPadding=0,this.buckets){var N=this.buckets[E];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(E).queryRadius(N))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage)}else this.collisionBoxArray=new tl},eo.prototype.unloadVectorData=function(){for(var e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"},eo.prototype.getBucket=function(e){return this.buckets[e.id]},eo.prototype.upload=function(e){for(var t in this.buckets){var r=this.buckets[t];r.uploadPending()&&r.upload(e)}var c=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ws(e,this.imageAtlas.image,c.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ws(e,this.glyphAtlasImage,c.ALPHA),this.glyphAtlasImage=null)},eo.prototype.prepare=function(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)},eo.prototype.queryRenderedFeatures=function(e,t,r,c,f,g,w,E,N,V){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:c,cameraQueryGeometry:f,scale:g,tileSize:this.tileSize,pixelPosMatrix:V,transform:E,params:w,queryPadding:this.queryPadding*N},e,t,r):{}},eo.prototype.querySourceFeatures=function(e,t){var r=this.latestFeatureIndex;if(r&&r.rawTileData){var c=r.loadVTLayers(),f=t?t.sourceLayer:"",g=c._geojsonTileLayer||c[f];if(g)for(var w=tr(t&&t.filter),E=this.tileID.canonical,N=E.z,V=E.x,J=E.y,ee={z:N,x:V,y:J},he=0;he<g.length;he++){var fe=g.feature(he);if(w.filter(new yr(this.tileID.overscaledZ),fe)){var Te=r.getId(fe,f),Se=new Au(fe,N,V,J,Te);Se.tile=ee,e.push(Se)}}}},eo.prototype.hasData=function(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"},eo.prototype.patternsLoaded=function(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length},eo.prototype.setExpiryData=function(e){var t=this.expirationTime;if(e.cacheControl){var r=Qe(e.cacheControl);r["max-age"]&&(this.expirationTime=Date.now()+1e3*r["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){var c=Date.now(),f=!1;if(this.expirationTime>c)f=!1;else if(t)if(this.expirationTime<t)f=!0;else{var g=this.expirationTime-t;g?this.expirationTime=c+Math.max(g,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}},eo.prototype.getExpiryTimeout=function(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)},eo.prototype.setFeatureState=function(e,t){if(this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0){var r=this.latestFeatureIndex.loadVTLayers();for(var c in this.buckets)if(t.style.hasLayer(c)){var f=this.buckets[c],g=f.layers[0].sourceLayer||"_geojsonTileLayer",w=r[g],E=e[g];if(w&&E&&Object.keys(E).length!==0){f.update(E,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});var N=t&&t.style&&t.style.getLayer(c);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(f)))}}}},eo.prototype.holdingForFade=function(){return this.symbolFadeHoldUntil!==void 0},eo.prototype.symbolFadeFinished=function(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<xt.now()},eo.prototype.clearFadeHold=function(){this.symbolFadeHoldUntil=void 0},eo.prototype.setHoldDuration=function(e){this.symbolFadeHoldUntil=xt.now()+e},eo.prototype.setDependencies=function(e,t){for(var r={},c=0,f=t;c<f.length;c+=1)r[f[c]]=!0;this.dependencies[e]=r},eo.prototype.hasDependency=function(e,t){for(var r=0,c=e;r<c.length;r+=1){var f=this.dependencies[c[r]];if(f){for(var g=0,w=t;g<w.length;g+=1)if(f[w[g]])return!0}}return!1};var Is=C.performance,bc=function(e){this._marks={start:[e.url,"start"].join("#"),end:[e.url,"end"].join("#"),measure:e.url.toString()},Is.mark(this._marks.start)};bc.prototype.finish=function(){Is.mark(this._marks.end);var e=Is.getEntriesByName(this._marks.measure);return e.length===0&&(Is.measure(this._marks.measure,this._marks.start,this._marks.end),e=Is.getEntriesByName(this._marks.measure),Is.clearMarks(this._marks.start),Is.clearMarks(this._marks.end),Is.clearMeasures(this._marks.measure)),e},h.Actor=yl,h.AlphaImage=La,h.CanonicalTileID=Vs,h.CollisionBoxArray=tl,h.Color=Ei,h.DEMData=ys,h.DataConstantProperty=Ai,h.DictionaryCoder=ku,h.EXTENT=8192,h.ErrorEvent=Oe,h.EvaluationParameters=yr,h.Event=be,h.Evented=je,h.FeatureIndex=vs,h.FillBucket=za,h.FillExtrusionBucket=Ba,h.ImageAtlas=Yl,h.ImagePosition=Pu,h.LineBucket=To,h.LngLat=Jr,h.LngLatBounds=Cn,h.MercatorCoordinate=Zs,h.ONE_EM=24,h.OverscaledTileID=En,h.Point=z,h.Point$1=z,h.Properties=no,h.Protobuf=xu,h.RGBAImage=bo,h.RequestManager=Ft,h.RequestPerformance=bc,h.ResourceType=ho,h.SegmentVector=p,h.SourceFeatureState=vl,h.StructArrayLayout1ui2=el,h.StructArrayLayout2f1f2i16=ps,h.StructArrayLayout2i4=cs,h.StructArrayLayout3ui6=Ya,h.StructArrayLayout4i8=zl,h.SymbolBucket=Dr,h.Texture=Ws,h.Tile=eo,h.Transitionable=ro,h.Uniform1f=Ce,h.Uniform1i=Ge,h.Uniform2f=Ne,h.Uniform3f=Je,h.Uniform4f=lt,h.UniformColor=yt,h.UniformMatrix4f=St,h.UnwrappedTileID=gc,h.ValidationError=Le,h.WritingMode=$o,h.ZoomHistory=Ao,h.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},h.addDynamicAttributes=hh,h.asyncAll=function(e,t,r){if(!e.length)return r(null,[]);var c=e.length,f=new Array(e.length),g=null;e.forEach(function(w,E){t(w,function(N,V){N&&(g=N),f[E]=V,--c==0&&r(g,f)})})},h.bezier=v,h.bindAll=X,h.browser=xt,h.cacheEntryPossiblyAdded=function(e){++wr>wn&&(e.getActor().send("enforceCacheSizeLimit",nn),wr=0)},h.clamp=T,h.clearTileCache=function(e){var t=C.caches.delete("mapbox-tiles");e&&t.catch(e).then(function(){return e()})},h.clipLine=tc,h.clone=function(e){var t=new oo(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},h.clone$1=ot,h.clone$2=function(e){var t=new oo(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},h.collisionCircleLayout=Mp,h.config=ze,h.create=function(){var e=new oo(16);return oo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},h.create$1=function(){var e=new oo(9);return oo!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e},h.create$2=function(){var e=new oo(4);return oo!=Float32Array&&(e[1]=0,e[2]=0),e[0]=1,e[3]=1,e},h.createCommonjsModule=K,h.createExpression=Qt,h.createLayout=Xn,h.createStyleLayer=function(e){return e.type==="custom"?new rd(e):new nd[e.type](e)},h.cross=function(e,t,r){var c=t[0],f=t[1],g=t[2],w=r[0],E=r[1],N=r[2];return e[0]=f*N-g*E,e[1]=g*w-c*N,e[2]=c*E-f*w,e},h.deepEqual=function e(t,r){if(Array.isArray(t)){if(!Array.isArray(r)||t.length!==r.length)return!1;for(var c=0;c<t.length;c++)if(!e(t[c],r[c]))return!1;return!0}if(typeof t=="object"&&t!==null&&r!==null){if(typeof r!="object"||Object.keys(t).length!==Object.keys(r).length)return!1;for(var f in t)if(!e(t[f],r[f]))return!1;return!0}return t===r},h.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},h.dot$1=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},h.ease=m,h.emitValidationErrors=U,h.endsWith=ce,h.enforceCacheSizeLimit=function(e){Pn(),ur&&ur.then(function(t){t.keys().then(function(r){for(var c=0;c<r.length-e;c++)t.delete(r[c])})})},h.evaluateSizeForFeature=Jh,h.evaluateSizeForZoom=Xh,h.evaluateVariableOffset=nc,h.evented=Al,h.extend=F,h.featureFilter=tr,h.filterObject=Be,h.fromRotation=function(e,t){var r=Math.sin(t),c=Math.cos(t);return e[0]=c,e[1]=r,e[2]=0,e[3]=-r,e[4]=c,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},h.getAnchorAlignment=ah,h.getAnchorJustification=uh,h.getArrayBuffer=co,h.getImage=$,h.getJSON=function(e,t){return ln(F(e,{type:"json"}),t)},h.getRTLTextPluginStatus=Dl,h.getReferrer=Po,h.getVideo=function(e,t){var r,c,f=C.document.createElement("video");f.muted=!0,f.onloadstart=function(){t(null,f)};for(var g=0;g<e.length;g++){var w=C.document.createElement("source");r=e[g],c=void 0,(c=C.document.createElement("a")).href=r,(c.protocol!==C.document.location.protocol||c.host!==C.document.location.host)&&(f.crossOrigin="Anonymous"),w.src=e[g],f.appendChild(w)}return{cancel:function(){}}},h.identity=ms,h.invert=function(e,t){var r=t[0],c=t[1],f=t[2],g=t[3],w=t[4],E=t[5],N=t[6],V=t[7],J=t[8],ee=t[9],he=t[10],fe=t[11],Te=t[12],Se=t[13],We=t[14],De=t[15],et=r*E-c*w,ut=r*N-f*w,vt=r*V-g*w,bt=c*N-f*E,Ot=c*V-g*E,Vt=f*V-g*N,oi=J*Se-ee*Te,Mi=J*We-he*Te,di=J*De-fe*Te,Ri=ee*We-he*Se,ci=ee*De-fe*Se,or=he*De-fe*We,ji=et*or-ut*ci+vt*Ri+bt*di-Ot*Mi+Vt*oi;return ji?(e[0]=(E*or-N*ci+V*Ri)*(ji=1/ji),e[1]=(f*ci-c*or-g*Ri)*ji,e[2]=(Se*Vt-We*Ot+De*bt)*ji,e[3]=(he*Ot-ee*Vt-fe*bt)*ji,e[4]=(N*di-w*or-V*Mi)*ji,e[5]=(r*or-f*di+g*Mi)*ji,e[6]=(We*vt-Te*Vt-De*ut)*ji,e[7]=(J*Vt-he*vt+fe*ut)*ji,e[8]=(w*ci-E*di+V*oi)*ji,e[9]=(c*di-r*ci-g*oi)*ji,e[10]=(Te*Ot-Se*vt+De*et)*ji,e[11]=(ee*vt-J*Ot-fe*et)*ji,e[12]=(E*Mi-w*Ri-N*oi)*ji,e[13]=(r*Ri-c*Mi+f*oi)*ji,e[14]=(Se*ut-Te*bt-We*et)*ji,e[15]=(J*bt-ee*ut+he*et)*ji,e):null},h.isChar=ti,h.isMapboxURL=Gt,h.keysDifference=function(e,t){var r=[];for(var c in e)c in t||r.push(c);return r},h.makeRequest=ln,h.mapObject=Me,h.mercatorXfromLng=fc,h.mercatorYfromLat=_c,h.mercatorZfromAltitude=mc,h.mul=lo,h.multiply=Gs,h.mvt=ul,h.nextPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},h.normalize=function(e,t){var r=t[0],c=t[1],f=t[2],g=r*r+c*c+f*f;return g>0&&(g=1/Math.sqrt(g)),e[0]=t[0]*g,e[1]=t[1]*g,e[2]=t[2]*g,e},h.number=qr,h.offscreenCanvasSupported=mn,h.ortho=function(e,t,r,c,f,g,w){var E=1/(t-r),N=1/(c-f),V=1/(g-w);return e[0]=-2*E,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*N,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*V,e[11]=0,e[12]=(t+r)*E,e[13]=(f+c)*N,e[14]=(w+g)*V,e[15]=1,e},h.parseGlyphPBF=function(e){return new xu(e).readFields(zp,[])},h.pbf=xu,h.performSymbolLayout=function(e,t,r,c,f,g,w){e.createArrays(),e.tilePixelRatio=8192/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;var E=e.layers[0].layout,N=e.layers[0]._unevaluatedLayout._values,V={};if(e.textSizeData.kind==="composite"){var J=e.textSizeData,ee=J.maxZoom;V.compositeTextSizes=[N["text-size"].possiblyEvaluate(new yr(J.minZoom),w),N["text-size"].possiblyEvaluate(new yr(ee),w)]}if(e.iconSizeData.kind==="composite"){var he=e.iconSizeData,fe=he.maxZoom;V.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new yr(he.minZoom),w),N["icon-size"].possiblyEvaluate(new yr(fe),w)]}V.layoutTextSize=N["text-size"].possiblyEvaluate(new yr(e.zoom+1),w),V.layoutIconSize=N["icon-size"].possiblyEvaluate(new yr(e.zoom+1),w),V.textMaxSize=N["text-size"].possiblyEvaluate(new yr(18));for(var Te=24*E.get("text-line-height"),Se=E.get("text-rotation-alignment")==="map"&&E.get("symbol-placement")!=="point",We=E.get("text-keep-upright"),De=E.get("text-size"),et=function(){var bt=vt[ut],Ot=E.get("text-font").evaluate(bt,{},w).join(","),Vt=De.evaluate(bt,{},w),oi=V.layoutTextSize.evaluate(bt,{},w),Mi=V.layoutIconSize.evaluate(bt,{},w),di={horizontal:{},vertical:void 0},Ri=bt.text,ci=[0,0];if(Ri){var or=Ri.toString(),ji=24*E.get("text-letter-spacing").evaluate(bt,{},w),Pi=function(vr){for(var Rr=0,Vr=vr;Rr<Vr.length;Rr+=1)if(xr=Vr[Rr].charCodeAt(0),ti.Arabic(xr)||ti["Arabic Supplement"](xr)||ti["Arabic Extended-A"](xr)||ti["Arabic Presentation Forms-A"](xr)||ti["Arabic Presentation Forms-B"](xr))return!1;var xr;return!0}(or)?ji:0,fr=E.get("text-anchor").evaluate(bt,{},w),Qi=E.get("text-variable-anchor");if(!Qi){var Lr=E.get("text-radial-offset").evaluate(bt,{},w);ci=Lr?nc(fr,[24*Lr,lh]):E.get("text-offset").evaluate(bt,{},w).map(function(vr){return 24*vr})}var Ti=Se?"center":E.get("text-justify").evaluate(bt,{},w),Tr=E.get("symbol-placement"),Gr=Tr==="point"?24*E.get("text-max-width").evaluate(bt,{},w):0,Fn=function(){e.allowVerticalPlacement&&va(or)&&(di.vertical=Lu(Ri,t,r,f,Ot,Gr,Te,fr,"left",Pi,ci,$o.vertical,!0,Tr,oi,Vt))};if(!Se&&Qi){for(var jn=Ti==="auto"?Qi.map(function(vr){return uh(vr)}):[Ti],Wr=!1,bn=0;bn<jn.length;bn++){var Zr=jn[bn];if(!di.horizontal[Zr])if(Wr)di.horizontal[Zr]=di.horizontal[0];else{var On=Lu(Ri,t,r,f,Ot,Gr,Te,"center",Zr,Pi,ci,$o.horizontal,!1,Tr,oi,Vt);On&&(di.horizontal[Zr]=On,Wr=On.positionedLines.length===1)}}Fn()}else{Ti==="auto"&&(Ti=uh(fr));var wo=Lu(Ri,t,r,f,Ot,Gr,Te,fr,Ti,Pi,ci,$o.horizontal,!1,Tr,oi,Vt);wo&&(di.horizontal[Ti]=wo),Fn(),va(or)&&Se&&We&&(di.vertical=Lu(Ri,t,r,f,Ot,Gr,Te,fr,Ti,Pi,ci,$o.vertical,!1,Tr,oi,Vt))}}var to=void 0,So=!1;if(bt.icon&&bt.icon.name){var In=c[bt.icon.name];In&&(to=function(vr,Rr,Vr){var xr=ah(Vr),xn=Rr[0]-vr.displaySize[0]*xr.horizontalAlign,uo=Rr[1]-vr.displaySize[1]*xr.verticalAlign;return{image:vr,top:uo,bottom:uo+vr.displaySize[1],left:xn,right:xn+vr.displaySize[0]}}(f[bt.icon.name],E.get("icon-offset").evaluate(bt,{},w),E.get("icon-anchor").evaluate(bt,{},w)),So=In.sdf,e.sdfIcons===void 0?e.sdfIcons=In.sdf:e.sdfIcons!==In.sdf&&ht("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(In.pixelRatio!==e.pixelRatio||E.get("icon-rotate").constantOr(1)!==0)&&(e.iconsNeedLinear=!0))}var kn=ac(di.horizontal)||di.vertical;e.iconsInText=!!kn&&kn.iconsInText,(kn||to)&&function(vr,Rr,Vr,xr,xn,uo,Un,sn,Nn,Kr,dn){var ea=uo.textMaxSize.evaluate(Rr,{});ea===void 0&&(ea=Un);var ts,fn=vr.layers[0].layout,is=fn.get("icon-offset").evaluate(Rr,{},dn),Ma=ac(Vr.horizontal),bl=Un/24,Ks=vr.tilePixelRatio*bl,xl=vr.tilePixelRatio*ea/24,bs=vr.tilePixelRatio*sn,wl=vr.tilePixelRatio*fn.get("symbol-spacing"),Du=fn.get("text-padding")*vr.tilePixelRatio,Pl=fn.get("icon-padding")*vr.tilePixelRatio,eu=fn.get("text-max-angle")/180*Math.PI,Ru=fn.get("text-rotation-alignment")==="map"&&fn.get("symbol-placement")!=="point",zu=fn.get("icon-rotation-alignment")==="map"&&fn.get("symbol-placement")!=="point",xs=fn.get("symbol-placement"),tu=wl/2,Ll=fn.get("icon-text-fit");xr&&Ll!=="none"&&(vr.allowVerticalPlacement&&Vr.vertical&&(ts=qh(xr,Vr.vertical,Ll,fn.get("icon-text-fit-padding"),is,bl)),Ma&&(xr=qh(xr,Ma,Ll,fn.get("icon-text-fit-padding"),is,bl)));var ks=function(ad,uu){uu.x<0||uu.x>=8192||uu.y<0||uu.y>=8192||function(_n,Fa,sd,As,yh,Pc,Gu,rs,Wu,hu,Zu,Vu,vh,Lc,cu,Mc,Tc,Sc,Cc,Ec,ta,Ku,Oc,ns,ld){var Ic,qs,El,Ol,Il,kl=_n.addToLineVertexArray(Fa,sd),kc=0,Ac=0,Dc=0,Rc=0,bh=-1,xh=-1,ws={},zc=H(""),wh=0,Ph=0;if(rs._unevaluatedLayout.getValue("text-radial-offset")===void 0?(wh=(Ic=rs.layout.get("text-offset").evaluate(ta,{},ns).map(function(du){return 24*du}))[0],Ph=Ic[1]):(wh=24*rs.layout.get("text-radial-offset").evaluate(ta,{},ns),Ph=lh),_n.allowVerticalPlacement&&As.vertical){var Bc=rs.layout.get("text-rotate").evaluate(ta,{},ns)+90;Ol=new Eu(Wu,Fa,hu,Zu,Vu,As.vertical,vh,Lc,cu,Bc),Gu&&(Il=new Eu(Wu,Fa,hu,Zu,Vu,Gu,Tc,Sc,cu,Bc))}if(yh){var Lh=rs.layout.get("icon-rotate").evaluate(ta,{}),Fc=rs.layout.get("icon-text-fit")!=="none",jc=ic(yh,Lh,Oc,Fc),Mh=Gu?ic(Gu,Lh,Oc,Fc):void 0;El=new Eu(Wu,Fa,hu,Zu,Vu,yh,Tc,Sc,!1,Lh),kc=4*jc.length;var Uc=_n.iconSizeData,pu=null;Uc.kind==="source"?(pu=[128*rs.layout.get("icon-size").evaluate(ta,{})])[0]>32640&&ht(_n.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'):Uc.kind==="composite"&&((pu=[128*Ku.compositeIconSizes[0].evaluate(ta,{},ns),128*Ku.compositeIconSizes[1].evaluate(ta,{},ns)])[0]>32640||pu[1]>32640)&&ht(_n.layerIds[0]+': Value for "icon-size" is >= 255. Reduce your "icon-size".'),_n.addSymbols(_n.icon,jc,pu,Ec,Cc,ta,!1,Fa,kl.lineStartIndex,kl.lineLength,-1,ns),bh=_n.icon.placedSymbolArray.length-1,Mh&&(Ac=4*Mh.length,_n.addSymbols(_n.icon,Mh,pu,Ec,Cc,ta,$o.vertical,Fa,kl.lineStartIndex,kl.lineLength,-1,ns),xh=_n.icon.placedSymbolArray.length-1)}for(var Nc in As.horizontal){var Hu=As.horizontal[Nc];if(!qs){zc=H(Hu.text);var ud=rs.layout.get("text-rotate").evaluate(ta,{},ns);qs=new Eu(Wu,Fa,hu,Zu,Vu,Hu,vh,Lc,cu,ud)}var Gc=Hu.positionedLines.length===1;if(Dc+=oc(_n,Fa,Hu,Pc,rs,cu,ta,Mc,kl,As.vertical?$o.horizontal:$o.horizontalOnly,Gc?Object.keys(As.horizontal):[Nc],ws,bh,Ku,ns),Gc)break}As.vertical&&(Rc+=oc(_n,Fa,As.vertical,Pc,rs,cu,ta,Mc,kl,$o.vertical,["vertical"],ws,xh,Ku,ns));var hd=qs?qs.boxStartIndex:_n.collisionBoxArray.length,cd=qs?qs.boxEndIndex:_n.collisionBoxArray.length,pd=Ol?Ol.boxStartIndex:_n.collisionBoxArray.length,dd=Ol?Ol.boxEndIndex:_n.collisionBoxArray.length,fd=El?El.boxStartIndex:_n.collisionBoxArray.length,_d=El?El.boxEndIndex:_n.collisionBoxArray.length,md=Il?Il.boxStartIndex:_n.collisionBoxArray.length,gd=Il?Il.boxEndIndex:_n.collisionBoxArray.length,os=-1,qu=function(du,Zc){return du&&du.circleDiameter?Math.max(du.circleDiameter,Zc):Zc};os=qu(qs,os),os=qu(Ol,os),os=qu(El,os);var Wc=(os=qu(Il,os))>-1?1:0;Wc&&(os*=ld/24),_n.glyphOffsetArray.length>=Dr.MAX_GLYPHS&&ht("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),ta.sortKey!==void 0&&_n.addToSortKeyRanges(_n.symbolInstances.length,ta.sortKey),_n.symbolInstances.emplaceBack(Fa.x,Fa.y,ws.right>=0?ws.right:-1,ws.center>=0?ws.center:-1,ws.left>=0?ws.left:-1,ws.vertical||-1,bh,xh,zc,hd,cd,pd,dd,fd,_d,md,gd,hu,Dc,Rc,kc,Ac,Wc,0,vh,wh,Ph,os)}(vr,uu,ad,Vr,xr,xn,ts,vr.layers[0],vr.collisionBoxArray,Rr.index,Rr.sourceLayerIndex,vr.index,Ks,Du,Ru,Nn,bs,Pl,zu,is,Rr,uo,Kr,dn,Un)};if(xs==="line")for(var Ml=0,Bu=tc(Rr.geometry,0,0,8192,8192);Ml<Bu.length;Ml+=1)for(var Fu=Bu[Ml],iu=0,ru=Wp(Fu,wl,eu,Vr.vertical||Ma,xr,24,xl,vr.overscaling,8192);iu<ru.length;iu+=1){var ju=ru[iu];Ma&&Hp(vr,Ma.text,tu,ju)||ks(Fu,ju)}else if(xs==="line-center")for(var nu=0,ou=Rr.geometry;nu<ou.length;nu+=1){var au=ou[nu];if(au.length>1){var Uu=Gp(au,eu,Vr.vertical||Ma,xr,24,xl);Uu&&ks(au,Uu)}}else if(Rr.type==="Polygon")for(var Tl=0,Nu=th(Rr.geometry,0);Tl<Nu.length;Tl+=1){var Sl=Nu[Tl],su=Vp(Sl,16);ks(Sl[0],new dl(su.x,su.y,0))}else if(Rr.type==="LineString")for(var Hs=0,lu=Rr.geometry;Hs<lu.length;Hs+=1){var Cl=lu[Hs];ks(Cl,new dl(Cl[0].x,Cl[0].y,0))}else if(Rr.type==="Point")for(var _h=0,xc=Rr.geometry;_h<xc.length;_h+=1)for(var mh=0,wc=xc[_h];mh<wc.length;mh+=1){var gh=wc[mh];ks([gh],new dl(gh.x,gh.y,0))}}(e,bt,di,to,c,V,oi,Mi,ci,So,w)},ut=0,vt=e.features;ut<vt.length;ut+=1)et();g&&e.generateCollisionDebugBuffers()},h.perspective=function(e,t,r,c,f){var g,w=1/Math.tan(t/2);return e[0]=w/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=w,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,f!=null&&f!==1/0?(e[10]=(f+c)*(g=1/(c-f)),e[14]=2*f*c*g):(e[10]=-1,e[14]=-2*c),e},h.pick=function(e,t){for(var r={},c=0;c<t.length;c++){var f=t[c];f in e&&(r[f]=e[f])}return r},h.plugin=Wo,h.polygonIntersectsPolygon=er,h.postMapLoadEvent=Br,h.postTurnstileEvent=zr,h.potpack=Zh,h.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],h.register=pt,h.registerForPluginStateChange=function(e){return e({pluginStatus:Sr,pluginURL:go}),Al.on("pluginStateChange",e),e},h.renderColorRamp=mu,h.rotate=function(e,t,r){var c=t[0],f=t[1],g=t[2],w=t[3],E=Math.sin(r),N=Math.cos(r);return e[0]=c*N+g*E,e[1]=f*N+w*E,e[2]=c*-E+g*N,e[3]=f*-E+w*N,e},h.rotateX=function(e,t,r){var c=Math.sin(r),f=Math.cos(r),g=t[4],w=t[5],E=t[6],N=t[7],V=t[8],J=t[9],ee=t[10],he=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=g*f+V*c,e[5]=w*f+J*c,e[6]=E*f+ee*c,e[7]=N*f+he*c,e[8]=V*f-g*c,e[9]=J*f-w*c,e[10]=ee*f-E*c,e[11]=he*f-N*c,e},h.rotateZ=function(e,t,r){var c=Math.sin(r),f=Math.cos(r),g=t[0],w=t[1],E=t[2],N=t[3],V=t[4],J=t[5],ee=t[6],he=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=g*f+V*c,e[1]=w*f+J*c,e[2]=E*f+ee*c,e[3]=N*f+he*c,e[4]=V*f-g*c,e[5]=J*f-w*c,e[6]=ee*f-E*c,e[7]=he*f-N*c,e},h.scale=function(e,t,r){var c=r[0],f=r[1],g=r[2];return e[0]=t[0]*c,e[1]=t[1]*c,e[2]=t[2]*c,e[3]=t[3]*c,e[4]=t[4]*f,e[5]=t[5]*f,e[6]=t[6]*f,e[7]=t[7]*f,e[8]=t[8]*g,e[9]=t[9]*g,e[10]=t[10]*g,e[11]=t[11]*g,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},h.scale$1=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},h.scale$2=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},h.setCacheLimits=function(e,t){nn=e,wn=t},h.setRTLTextPlugin=function(e,t,r){if(r===void 0&&(r=!1),Sr==="deferred"||Sr==="loading"||Sr==="loaded")throw new Error("setRTLTextPlugin cannot be called multiple times.");go=xt.resolveURL(e),Sr="deferred",Ls=t,zs(),r||Ja()},h.sphericalToCartesian=function(e){var t=e[0],r=e[1],c=e[2];return r+=90,r*=Math.PI/180,c*=Math.PI/180,{x:t*Math.cos(r)*Math.sin(c),y:t*Math.sin(r)*Math.sin(c),z:t*Math.cos(c)}},h.sqrLen=function(e){var t=e[0],r=e[1];return t*t+r*r},h.styleSpec=xe,h.sub=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},h.symbolSize=Np,h.transformMat3=function(e,t,r){var c=t[0],f=t[1],g=t[2];return e[0]=c*r[0]+f*r[3]+g*r[6],e[1]=c*r[1]+f*r[4]+g*r[7],e[2]=c*r[2]+f*r[5]+g*r[8],e},h.transformMat4=Da,h.translate=function(e,t,r){var c,f,g,w,E,N,V,J,ee,he,fe,Te,Se=r[0],We=r[1],De=r[2];return t===e?(e[12]=t[0]*Se+t[4]*We+t[8]*De+t[12],e[13]=t[1]*Se+t[5]*We+t[9]*De+t[13],e[14]=t[2]*Se+t[6]*We+t[10]*De+t[14],e[15]=t[3]*Se+t[7]*We+t[11]*De+t[15]):(f=t[1],g=t[2],w=t[3],E=t[4],N=t[5],V=t[6],J=t[7],ee=t[8],he=t[9],fe=t[10],Te=t[11],e[0]=c=t[0],e[1]=f,e[2]=g,e[3]=w,e[4]=E,e[5]=N,e[6]=V,e[7]=J,e[8]=ee,e[9]=he,e[10]=fe,e[11]=Te,e[12]=c*Se+E*We+ee*De+t[12],e[13]=f*Se+N*We+he*De+t[13],e[14]=g*Se+V*We+fe*De+t[14],e[15]=w*Se+J*We+Te*De+t[15]),e},h.triggerPluginCompletionEvent=Rs,h.uniqueId=re,h.upstreamVersion="1.12.0",h.validateCustomStyleLayer=function(e){var t=[],r=e.id;return r===void 0&&t.push({message:"layers."+r+': missing required property "id"'}),e.render===void 0&&t.push({message:"layers."+r+': missing required method "render"'}),e.renderingMode&&e.renderingMode!=="2d"&&e.renderingMode!=="3d"&&t.push({message:"layers."+r+': property "renderingMode" must be either "2d" or "3d"'}),t},h.validateLight=o,h.validateStyle=ls,h.values=function(e){var t=[];for(var r in e)t.push(e[r]);return t},h.vectorTile=ul,h.version="1.5.0",h.warnOnce=ht,h.webpSupported=oe,h.window=C,h.wrap=I}),W(["./shared"],function(h){"use strict";function K($){var le=typeof $;if(le==="number"||le==="boolean"||le==="string"||$==null)return JSON.stringify($);if(Array.isArray($)){for(var ue="[",be=0,Oe=$;be<Oe.length;be+=1)ue+=K(Oe[be])+",";return ue+"]"}for(var je=Object.keys($).sort(),xe="{",Le=0;Le<je.length;Le++)xe+=JSON.stringify(je[Le])+":"+K($[je[Le]])+",";return xe+"}"}function k($){for(var le="",ue=0,be=h.refProperties;ue<be.length;ue+=1)le+="/"+K($[be[ue]]);return le}var A=function($){this.keyCache={},$&&this.replace($)};A.prototype.replace=function($){this._layerConfigs={},this._layers={},this.update($,[])},A.prototype.update=function($,le){for(var ue=this,be=0,Oe=$;be<Oe.length;be+=1){var je=Oe[be];this._layerConfigs[je.id]=je;var xe=this._layers[je.id]=h.createStyleLayer(je);xe._featureFilter=h.featureFilter(xe.filter),this.keyCache[je.id]&&delete this.keyCache[je.id]}for(var Le=0,tt=le;Le<tt.length;Le+=1){var rt=tt[Le];delete this.keyCache[rt],delete this._layerConfigs[rt],delete this._layers[rt]}this.familiesBySource={};for(var Mt=0,Wt=function(ri,ki){for(var si={},Gi=0;Gi<ri.length;Gi++){var $i=ki&&ki[ri[Gi].id]||k(ri[Gi]);ki&&(ki[ri[Gi].id]=$i);var dr=si[$i];dr||(dr=si[$i]=[]),dr.push(ri[Gi])}var Vi=[];for(var Ki in si)Vi.push(si[Ki]);return Vi}(h.values(this._layerConfigs),this.keyCache);Mt<Wt.length;Mt+=1){var ft=Wt[Mt].map(function(ri){return ue._layers[ri.id]}),Dt=ft[0];if(Dt.visibility!=="none"){var ai=Dt.source||"",dt=this.familiesBySource[ai];dt||(dt=this.familiesBySource[ai]={});var Zt=Dt.sourceLayer||"_geojsonTileLayer",ii=dt[Zt];ii||(ii=dt[Zt]=[]),ii.push(ft)}}};var z=function($){var le={},ue=[];for(var be in $){var Oe=$[be],je=le[be]={};for(var xe in Oe){var Le=Oe[+xe];if(Le&&Le.bitmap.width!==0&&Le.bitmap.height!==0){var tt={x:0,y:0,w:Le.bitmap.width+2,h:Le.bitmap.height+2};ue.push(tt),je[xe]={rect:tt,metrics:Le.metrics}}}}var rt=h.potpack(ue),Mt=new h.AlphaImage({width:rt.w||1,height:rt.h||1});for(var Wt in $){var ft=$[Wt];for(var Dt in ft){var ai=ft[+Dt];if(ai&&ai.bitmap.width!==0&&ai.bitmap.height!==0){var dt=le[Wt][Dt].rect;h.AlphaImage.copy(ai.bitmap,Mt,{x:0,y:0},{x:dt.x+1,y:dt.y+1},ai.bitmap)}}}this.image=Mt,this.positions=le};h.register("GlyphAtlas",z);var R=function($){this.tileID=new h.OverscaledTileID($.tileID.overscaledZ,$.tileID.wrap,$.tileID.canonical.z,$.tileID.canonical.x,$.tileID.canonical.y),this.uid=$.uid,this.zoom=$.zoom,this.pixelRatio=$.pixelRatio,this.tileSize=$.tileSize,this.source=$.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=$.showCollisionBoxes,this.collectResourceTiming=!!$.collectResourceTiming,this.returnDependencies=!!$.returnDependencies,this.promoteId=$.promoteId};function C($,le,ue){for(var be=new h.EvaluationParameters(le),Oe=0,je=$;Oe<je.length;Oe+=1)je[Oe].recalculate(be,ue)}function x($,le){var ue=h.getArrayBuffer($.request,function(be,Oe,je,xe){be?le(be):Oe&&le(null,{vectorTile:new h.vectorTile.VectorTile(new h.pbf(Oe)),rawData:Oe,cacheControl:je,expires:xe})});return function(){ue.cancel(),le()}}R.prototype.parse=function($,le,ue,be,Oe){var je=this;this.status="parsing",this.data=$,this.collisionBoxArray=new h.CollisionBoxArray;var xe=new h.DictionaryCoder(Object.keys($.layers).sort()),Le=new h.FeatureIndex(this.tileID,this.promoteId);Le.bucketLayerIDs=[];var tt,rt,Mt,Wt,ft={},Dt={featureIndex:Le,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:ue},ai=le.familiesBySource[this.source];for(var dt in ai){var Zt=$.layers[dt];if(Zt){Zt.version===1&&h.warnOnce('Vector tile source "'+this.source+'" layer "'+dt+'" does not use vector tile spec v2 and therefore may have some rendering errors.');for(var ii=xe.encode(dt),ri=[],ki=0;ki<Zt.length;ki++){var si=Zt.feature(ki),Gi=Le.getId(si,dt);ri.push({feature:si,id:Gi,index:ki,sourceLayerIndex:ii})}for(var $i=0,dr=ai[dt];$i<dr.length;$i+=1){var Vi=dr[$i],Ki=Vi[0];Ki.minzoom&&this.zoom<Math.floor(Ki.minzoom)||Ki.maxzoom&&this.zoom>=Ki.maxzoom||Ki.visibility!=="none"&&(C(Vi,this.zoom,ue),(ft[Ki.id]=Ki.createBucket({index:Le.bucketLayerIDs.length,layers:Vi,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ii,sourceID:this.source})).populate(ri,Dt,this.tileID.canonical),Le.bucketLayerIDs.push(Vi.map(function(cr){return cr.id})))}}}var un=h.mapObject(Dt.glyphDependencies,function(cr){return Object.keys(cr).map(Number)});Object.keys(un).length?be.send("getGlyphs",{uid:this.uid,stacks:un},function(cr,Ei){tt||(tt=cr,rt=Ei,jr.call(je))}):rt={};var _r=Object.keys(Dt.iconDependencies);_r.length?be.send("getImages",{icons:_r,source:this.source,tileID:this.tileID,type:"icons"},function(cr,Ei){tt||(tt=cr,Mt=Ei,jr.call(je))}):Mt={};var hn=Object.keys(Dt.patternDependencies);function jr(){if(tt)return Oe(tt);if(rt&&Mt&&Wt){var cr=new z(rt),Ei=new h.ImageAtlas(Mt,Wt);for(var Dn in ft){var Rn=ft[Dn];Rn instanceof h.SymbolBucket?(C(Rn.layers,this.zoom,ue),h.performSymbolLayout(Rn,rt,cr.positions,Mt,Ei.iconPositions,this.showCollisionBoxes,this.tileID.canonical)):Rn.hasPattern&&(Rn instanceof h.LineBucket||Rn instanceof h.FillBucket||Rn instanceof h.FillExtrusionBucket)&&(C(Rn.layers,this.zoom,ue),Rn.addFeatures(Dt,this.tileID.canonical,Ei.patternPositions))}this.status="done",Oe(null,{buckets:h.values(ft).filter(function(Hr){return!Hr.isEmpty()}),featureIndex:Le,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:cr.image,imageAtlas:Ei,glyphMap:this.returnDependencies?rt:null,iconMap:this.returnDependencies?Mt:null,glyphPositions:this.returnDependencies?cr.positions:null})}}hn.length?be.send("getImages",{icons:hn,source:this.source,tileID:this.tileID,type:"patterns"},function(cr,Ei){tt||(tt=cr,Wt=Ei,jr.call(je))}):Wt={},jr.call(this)};var v=function($,le,ue,be){this.actor=$,this.layerIndex=le,this.availableImages=ue,this.loadVectorData=be||x,this.loading={},this.loaded={}};v.prototype.loadTile=function($,le){var ue=this,be=$.uid;this.loading||(this.loading={});var Oe=!!($&&$.request&&$.request.collectResourceTiming)&&new h.RequestPerformance($.request),je=this.loading[be]=new R($);je.abort=this.loadVectorData($,function(xe,Le){if(delete ue.loading[be],xe||!Le)return je.status="done",ue.loaded[be]=je,le(xe);var tt=Le.rawData,rt={};Le.expires&&(rt.expires=Le.expires),Le.cacheControl&&(rt.cacheControl=Le.cacheControl);var Mt={};if(Oe){var Wt=Oe.finish();Wt&&(Mt.resourceTiming=JSON.parse(JSON.stringify(Wt)))}je.vectorTile=Le.vectorTile,je.parse(Le.vectorTile,ue.layerIndex,ue.availableImages,ue.actor,function(ft,Dt){if(ft||!Dt)return le(ft);le(null,h.extend({rawTileData:tt.slice(0)},Dt,rt,Mt))}),ue.loaded=ue.loaded||{},ue.loaded[be]=je})},v.prototype.reloadTile=function($,le){var ue=this,be=this.loaded,Oe=$.uid,je=this;if(be&&be[Oe]){var xe=be[Oe];xe.showCollisionBoxes=$.showCollisionBoxes;var Le=function(tt,rt){var Mt=xe.reloadCallback;Mt&&(delete xe.reloadCallback,xe.parse(xe.vectorTile,je.layerIndex,ue.availableImages,je.actor,Mt)),le(tt,rt)};xe.status==="parsing"?xe.reloadCallback=Le:xe.status==="done"&&(xe.vectorTile?xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,Le):Le())}},v.prototype.abortTile=function($,le){var ue=this.loading,be=$.uid;ue&&ue[be]&&ue[be].abort&&(ue[be].abort(),delete ue[be]),le()},v.prototype.removeTile=function($,le){var ue=this.loaded,be=$.uid;ue&&ue[be]&&delete ue[be],le()};var m=h.window.ImageBitmap,T=function(){this.loaded={}};function I($,le){if($.length!==0){F($[0],le);for(var ue=1;ue<$.length;ue++)F($[ue],!le)}}function F($,le){for(var ue=0,be=0,Oe=$.length,je=Oe-1;be<Oe;je=be++)ue+=($[be][0]-$[je][0])*($[je][1]+$[be][1]);ue>=0!=!!le&&$.reverse()}T.prototype.loadTile=function($,le){var ue=$.uid,be=$.encoding,Oe=$.rawImageData,je=m&&Oe instanceof m?this.getImageData(Oe):Oe,xe=new h.DEMData(ue,je,be);this.loaded=this.loaded||{},this.loaded[ue]=xe,le(null,xe)},T.prototype.getImageData=function($){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas($.width,$.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=$.width,this.offscreenCanvas.height=$.height,this.offscreenCanvasContext.drawImage($,0,0,$.width,$.height);var le=this.offscreenCanvasContext.getImageData(-1,-1,$.width+2,$.height+2);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new h.RGBAImage({width:le.width,height:le.height},le.data)},T.prototype.removeTile=function($){var le=this.loaded,ue=$.uid;le&&le[ue]&&delete le[ue]};var q=h.vectorTile.VectorTileFeature.prototype.toGeoJSON,re=function($){this._feature=$,this.extent=h.EXTENT,this.type=$.type,this.properties=$.tags,"id"in $&&!isNaN($.id)&&(this.id=parseInt($.id,10))};re.prototype.loadGeometry=function(){if(this._feature.type===1){for(var $=[],le=0,ue=this._feature.geometry;le<ue.length;le+=1){var be=ue[le];$.push([new h.Point$1(be[0],be[1])])}return $}for(var Oe=[],je=0,xe=this._feature.geometry;je<xe.length;je+=1){for(var Le=[],tt=0,rt=xe[je];tt<rt.length;tt+=1){var Mt=rt[tt];Le.push(new h.Point$1(Mt[0],Mt[1]))}Oe.push(Le)}return Oe},re.prototype.toGeoJSON=function($,le,ue){return q.call(this,$,le,ue)};var ne=function($){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=h.EXTENT,this.length=$.length,this._features=$};ne.prototype.feature=function($){return new re(this._features[$])};var se=h.vectorTile.VectorTileFeature,X=ce;function ce($,le){this.options=le||{},this.features=$,this.length=$.length}function Me($,le){this.id=typeof $.id=="number"?$.id:void 0,this.type=$.type,this.rawGeometry=$.type===1?[$.geometry]:$.geometry,this.properties=$.tags,this.extent=le||4096}ce.prototype.feature=function($){return new Me(this.features[$],this.options.extent)},Me.prototype.loadGeometry=function(){var $=this.rawGeometry;this.geometry=[];for(var le=0;le<$.length;le++){for(var ue=$[le],be=[],Oe=0;Oe<ue.length;Oe++)be.push(new h.Point$1(ue[Oe][0],ue[Oe][1]));this.geometry.push(be)}return this.geometry},Me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var $=this.geometry,le=1/0,ue=-1/0,be=1/0,Oe=-1/0,je=0;je<$.length;je++)for(var xe=$[je],Le=0;Le<xe.length;Le++){var tt=xe[Le];le=Math.min(le,tt.x),ue=Math.max(ue,tt.x),be=Math.min(be,tt.y),Oe=Math.max(Oe,tt.y)}return[le,be,ue,Oe]},Me.prototype.toGeoJSON=se.prototype.toGeoJSON;var Be=Ue,ot=X;function Ue($){var le=new h.pbf;return function(ue,be){for(var Oe in ue.layers)be.writeMessage(3,ht,ue.layers[Oe])}($,le),le.finish()}function ht($,le){var ue;le.writeVarintField(15,$.version||1),le.writeStringField(1,$.name||""),le.writeVarintField(5,$.extent||4096);var be={keys:[],values:[],keycache:{},valuecache:{}};for(ue=0;ue<$.length;ue++)be.feature=$.feature(ue),le.writeMessage(2,Et,be);var Oe=be.keys;for(ue=0;ue<Oe.length;ue++)le.writeStringField(3,Oe[ue]);var je=be.values;for(ue=0;ue<je.length;ue++)le.writeMessage(4,Ae,je[ue])}function Et($,le){var ue=$.feature;ue.id!==void 0&&le.writeVarintField(1,ue.id),le.writeMessage(2,bi,$),le.writeVarintField(3,ue.type),le.writeMessage(4,we,ue)}function bi($,le){var ue=$.feature,be=$.keys,Oe=$.values,je=$.keycache,xe=$.valuecache;for(var Le in ue.properties){var tt=je[Le];tt===void 0&&(be.push(Le),je[Le]=tt=be.length-1),le.writeVarint(tt);var rt=ue.properties[Le],Mt=typeof rt;Mt!=="string"&&Mt!=="boolean"&&Mt!=="number"&&(rt=JSON.stringify(rt));var Wt=Mt+":"+rt,ft=xe[Wt];ft===void 0&&(Oe.push(rt),xe[Wt]=ft=Oe.length-1),le.writeVarint(ft)}}function gt($,le){return(le<<3)+(7&$)}function Qe($){return $<<1^$>>31}function we($,le){for(var ue=$.loadGeometry(),be=$.type,Oe=0,je=0,xe=ue.length,Le=0;Le<xe;Le++){var tt=ue[Le],rt=1;be===1&&(rt=tt.length),le.writeVarint(gt(1,rt));for(var Mt=be===3?tt.length-1:tt.length,Wt=0;Wt<Mt;Wt++){Wt===1&&be!==1&&le.writeVarint(gt(2,Mt-1));var ft=tt[Wt].x-Oe,Dt=tt[Wt].y-je;le.writeVarint(Qe(ft)),le.writeVarint(Qe(Dt)),Oe+=ft,je+=Dt}be===3&&le.writeVarint(gt(7,1))}}function Ae($,le){var ue=typeof $;ue==="string"?le.writeStringField(1,$):ue==="boolean"?le.writeBooleanField(7,$):ue==="number"&&($%1!=0?le.writeDoubleField(3,$):$<0?le.writeSVarintField(6,$):le.writeVarintField(5,$))}function it($,le,ue,be){Lt($,ue,be),Lt(le,2*ue,2*be),Lt(le,2*ue+1,2*be+1)}function Lt($,le,ue){var be=$[le];$[le]=$[ue],$[ue]=be}function ei($,le,ue,be){var Oe=$-ue,je=le-be;return Oe*Oe+je*je}Be.fromVectorTileJs=Ue,Be.fromGeojsonVt=function($,le){le=le||{};var ue={};for(var be in $)ue[be]=new X($[be].features,le),ue[be].name=be,ue[be].version=le.version,ue[be].extent=le.extent;return Ue({layers:ue})},Be.GeoJSONWrapper=ot;var Si=function($){return $[0]},ui=function($){return $[1]},ni=function($,le,ue,be,Oe){le===void 0&&(le=Si),ue===void 0&&(ue=ui),be===void 0&&(be=64),Oe===void 0&&(Oe=Float64Array),this.nodeSize=be,this.points=$;for(var je=$.length<65536?Uint16Array:Uint32Array,xe=this.ids=new je($.length),Le=this.coords=new Oe(2*$.length),tt=0;tt<$.length;tt++)xe[tt]=tt,Le[2*tt]=le($[tt]),Le[2*tt+1]=ue($[tt]);(function rt(Mt,Wt,ft,Dt,ai,dt){if(!(ai-Dt<=ft)){var Zt=Dt+ai>>1;(function ii(ri,ki,si,Gi,$i,dr){for(;$i>Gi;){if($i-Gi>600){var Vi=$i-Gi+1,Ki=si-Gi+1,un=Math.log(Vi),_r=.5*Math.exp(2*un/3),hn=.5*Math.sqrt(un*_r*(Vi-_r)/Vi)*(Ki-Vi/2<0?-1:1);ii(ri,ki,si,Math.max(Gi,Math.floor(si-Ki*_r/Vi+hn)),Math.min($i,Math.floor(si+(Vi-Ki)*_r/Vi+hn)),dr)}var jr=ki[2*si+dr],cr=Gi,Ei=$i;for(it(ri,ki,Gi,si),ki[2*$i+dr]>jr&&it(ri,ki,Gi,$i);cr<Ei;){for(it(ri,ki,cr,Ei),cr++,Ei--;ki[2*cr+dr]<jr;)cr++;for(;ki[2*Ei+dr]>jr;)Ei--}ki[2*Gi+dr]===jr?it(ri,ki,Gi,Ei):it(ri,ki,++Ei,$i),Ei<=si&&(Gi=Ei+1),si<=Ei&&($i=Ei-1)}})(Mt,Wt,Zt,Dt,ai,dt%2),rt(Mt,Wt,ft,Dt,Zt-1,dt+1),rt(Mt,Wt,ft,Zt+1,ai,dt+1)}})(xe,Le,be,0,xe.length-1,0)};ni.prototype.range=function($,le,ue,be){return function(Oe,je,xe,Le,tt,rt,Mt){for(var Wt,ft,Dt=[0,Oe.length-1,0],ai=[];Dt.length;){var dt=Dt.pop(),Zt=Dt.pop(),ii=Dt.pop();if(Zt-ii<=Mt)for(var ri=ii;ri<=Zt;ri++)ft=je[2*ri+1],(Wt=je[2*ri])>=xe&&Wt<=tt&&ft>=Le&&ft<=rt&&ai.push(Oe[ri]);else{var ki=Math.floor((ii+Zt)/2);ft=je[2*ki+1],(Wt=je[2*ki])>=xe&&Wt<=tt&&ft>=Le&&ft<=rt&&ai.push(Oe[ki]);var si=(dt+1)%2;(dt===0?xe<=Wt:Le<=ft)&&(Dt.push(ii),Dt.push(ki-1),Dt.push(si)),(dt===0?tt>=Wt:rt>=ft)&&(Dt.push(ki+1),Dt.push(Zt),Dt.push(si))}}return ai}(this.ids,this.coords,$,le,ue,be,this.nodeSize)},ni.prototype.within=function($,le,ue){return function(be,Oe,je,xe,Le,tt){for(var rt=[0,be.length-1,0],Mt=[],Wt=Le*Le;rt.length;){var ft=rt.pop(),Dt=rt.pop(),ai=rt.pop();if(Dt-ai<=tt)for(var dt=ai;dt<=Dt;dt++)ei(Oe[2*dt],Oe[2*dt+1],je,xe)<=Wt&&Mt.push(be[dt]);else{var Zt=Math.floor((ai+Dt)/2),ii=Oe[2*Zt],ri=Oe[2*Zt+1];ei(ii,ri,je,xe)<=Wt&&Mt.push(be[Zt]);var ki=(ft+1)%2;(ft===0?je-Le<=ii:xe-Le<=ri)&&(rt.push(ai),rt.push(Zt-1),rt.push(ki)),(ft===0?je+Le>=ii:xe+Le>=ri)&&(rt.push(Zt+1),rt.push(Dt),rt.push(ki))}}return Mt}(this.ids,this.coords,$,le,ue,this.nodeSize)};var Bi={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function($){return $}},Ci=function($){this.options=mt(Object.create(Bi),$),this.trees=new Array(this.options.maxZoom+1)};function xt($,le,ue,be,Oe){return{x:$,y:le,zoom:1/0,id:ue,parentId:-1,numPoints:be,properties:Oe}}function ze($,le){var ue=$.geometry.coordinates,be=ue[1];return{x:Re(ue[0]),y:He(be),zoom:1/0,index:le,parentId:-1}}function oe($){return{type:"Feature",id:$.id,properties:de($),geometry:{type:"Point",coordinates:[(be=$.x,360*(be-.5)),(le=$.y,ue=(180-360*le)*Math.PI/180,360*Math.atan(Math.exp(ue))/Math.PI-90)]}};var le,ue,be}function de($){var le=$.numPoints,ue=le>=1e4?Math.round(le/1e3)+"k":le>=1e3?Math.round(le/100)/10+"k":le;return mt(mt({},$.properties),{cluster:!0,cluster_id:$.id,point_count:le,point_count_abbreviated:ue})}function Re($){return $/360+.5}function He($){var le=Math.sin($*Math.PI/180),ue=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ue<0?0:ue>1?1:ue}function mt($,le){for(var ue in le)$[ue]=le[ue];return $}function Ft($){return $.x}function Gt($){return $.y}function Bt($,le,ue,be,Oe,je){var xe=Oe-ue,Le=je-be;if(xe!==0||Le!==0){var tt=(($-ue)*xe+(le-be)*Le)/(xe*xe+Le*Le);tt>1?(ue=Oe,be=je):tt>0&&(ue+=xe*tt,be+=Le*tt)}return(xe=$-ue)*xe+(Le=le-be)*Le}function Kt($,le,ue,be){var Oe={id:$===void 0?null:$,type:le,geometry:ue,tags:be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(je){var xe=je.geometry,Le=je.type;if(Le==="Point"||Le==="MultiPoint"||Le==="LineString")qt(je,xe);else if(Le==="Polygon"||Le==="MultiLineString")for(var tt=0;tt<xe.length;tt++)qt(je,xe[tt]);else if(Le==="MultiPolygon")for(tt=0;tt<xe.length;tt++)for(var rt=0;rt<xe[tt].length;rt++)qt(je,xe[tt][rt])}(Oe),Oe}function qt($,le){for(var ue=0;ue<le.length;ue+=3)$.minX=Math.min($.minX,le[ue]),$.minY=Math.min($.minY,le[ue+1]),$.maxX=Math.max($.maxX,le[ue]),$.maxY=Math.max($.maxY,le[ue+1])}function fi($,le,ue,be){if(le.geometry){var Oe=le.geometry.coordinates,je=le.geometry.type,xe=Math.pow(ue.tolerance/((1<<ue.maxZoom)*ue.extent),2),Le=[],tt=le.id;if(ue.promoteId?tt=le.properties[ue.promoteId]:ue.generateId&&(tt=be||0),je==="Point")Ii(Oe,Le);else if(je==="MultiPoint")for(var rt=0;rt<Oe.length;rt++)Ii(Oe[rt],Le);else if(je==="LineString")zi(Oe,Le,xe,!1);else if(je==="MultiLineString"){if(ue.lineMetrics){for(rt=0;rt<Oe.length;rt++)zi(Oe[rt],Le=[],xe,!1),$.push(Kt(tt,"LineString",Le,le.properties));return}Yt(Oe,Le,xe,!1)}else if(je==="Polygon")Yt(Oe,Le,xe,!0);else{if(je!=="MultiPolygon"){if(je==="GeometryCollection"){for(rt=0;rt<le.geometry.geometries.length;rt++)fi($,{id:tt,geometry:le.geometry.geometries[rt],properties:le.properties},ue,be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(rt=0;rt<Oe.length;rt++){var Mt=[];Yt(Oe[rt],Mt,xe,!0),Le.push(Mt)}}$.push(Kt(tt,je,Le,le.properties))}}function Ii($,le){le.push(ur($[0])),le.push(yi($[1])),le.push(0)}function zi($,le,ue,be){for(var Oe,je,xe=0,Le=0;Le<$.length;Le++){var tt=ur($[Le][0]),rt=yi($[Le][1]);le.push(tt),le.push(rt),le.push(0),Le>0&&(xe+=be?(Oe*rt-tt*je)/2:Math.sqrt(Math.pow(tt-Oe,2)+Math.pow(rt-je,2))),Oe=tt,je=rt}var Mt=le.length-3;le[2]=1,function Wt(ft,Dt,ai,dt){for(var Zt,ii=dt,ri=ai-Dt>>1,ki=ai-Dt,si=ft[Dt],Gi=ft[Dt+1],$i=ft[ai],dr=ft[ai+1],Vi=Dt+3;Vi<ai;Vi+=3){var Ki=Bt(ft[Vi],ft[Vi+1],si,Gi,$i,dr);if(Ki>ii)Zt=Vi,ii=Ki;else if(Ki===ii){var un=Math.abs(Vi-ri);un<ki&&(Zt=Vi,ki=un)}}ii>dt&&(Zt-Dt>3&&Wt(ft,Dt,Zt,dt),ft[Zt+2]=ii,ai-Zt>3&&Wt(ft,Zt,ai,dt))}(le,0,Mt,ue),le[Mt+2]=1,le.size=Math.abs(xe),le.start=0,le.end=le.size}function Yt($,le,ue,be){for(var Oe=0;Oe<$.length;Oe++){var je=[];zi($[Oe],je,ue,be),le.push(je)}}function ur($){return $/360+.5}function yi($){var le=Math.sin($*Math.PI/180),ue=.5-.25*Math.log((1+le)/(1-le))/Math.PI;return ue<0?0:ue>1?1:ue}function hr($,le,ue,be,Oe,je,xe,Le){if(be/=le,je>=(ue/=le)&&xe<be)return $;if(xe<ue||je>=be)return null;for(var tt=[],rt=0;rt<$.length;rt++){var Mt=$[rt],Wt=Mt.geometry,ft=Mt.type,Dt=Oe===0?Mt.minX:Mt.minY,ai=Oe===0?Mt.maxX:Mt.maxY;if(Dt>=ue&&ai<be)tt.push(Mt);else if(!(ai<ue||Dt>=be)){var dt=[];if(ft==="Point"||ft==="MultiPoint")ir(Wt,dt,ue,be,Oe);else if(ft==="LineString")zr(Wt,dt,ue,be,Oe,!1,Le.lineMetrics);else if(ft==="MultiLineString")Br(Wt,dt,ue,be,Oe,!1);else if(ft==="Polygon")Br(Wt,dt,ue,be,Oe,!0);else if(ft==="MultiPolygon")for(var Zt=0;Zt<Wt.length;Zt++){var ii=[];Br(Wt[Zt],ii,ue,be,Oe,!0),ii.length&&dt.push(ii)}if(dt.length){if(Le.lineMetrics&&ft==="LineString"){for(Zt=0;Zt<dt.length;Zt++)tt.push(Kt(Mt.id,ft,dt[Zt],Mt.tags));continue}ft!=="LineString"&&ft!=="MultiLineString"||(dt.length===1?(ft="LineString",dt=dt[0]):ft="MultiLineString"),ft!=="Point"&&ft!=="MultiPoint"||(ft=dt.length===3?"Point":"MultiPoint"),tt.push(Kt(Mt.id,ft,dt,Mt.tags))}}}return tt.length?tt:null}function ir($,le,ue,be,Oe){for(var je=0;je<$.length;je+=3){var xe=$[je+Oe];xe>=ue&&xe<=be&&(le.push($[je]),le.push($[je+1]),le.push($[je+2]))}}function zr($,le,ue,be,Oe,je,xe){for(var Le,tt,rt=rn($),Mt=Oe===0?wn:Pn,Wt=$.start,ft=0;ft<$.length-3;ft+=3){var Dt=$[ft],ai=$[ft+1],dt=$[ft+2],Zt=$[ft+3],ii=$[ft+4],ri=Oe===0?Dt:ai,ki=Oe===0?Zt:ii,si=!1;xe&&(Le=Math.sqrt(Math.pow(Dt-Zt,2)+Math.pow(ai-ii,2))),ri<ue?ki>ue&&(tt=Mt(rt,Dt,ai,Zt,ii,ue),xe&&(rt.start=Wt+Le*tt)):ri>be?ki<be&&(tt=Mt(rt,Dt,ai,Zt,ii,be),xe&&(rt.start=Wt+Le*tt)):nn(rt,Dt,ai,dt),ki<ue&&ri>=ue&&(tt=Mt(rt,Dt,ai,Zt,ii,ue),si=!0),ki>be&&ri<=be&&(tt=Mt(rt,Dt,ai,Zt,ii,be),si=!0),!je&&si&&(xe&&(rt.end=Wt+Le*tt),le.push(rt),rt=rn($)),xe&&(Wt+=Le)}var Gi=$.length-3;Dt=$[Gi],ai=$[Gi+1],dt=$[Gi+2],(ri=Oe===0?Dt:ai)>=ue&&ri<=be&&nn(rt,Dt,ai,dt),Gi=rt.length-3,je&&Gi>=3&&(rt[Gi]!==rt[0]||rt[Gi+1]!==rt[1])&&nn(rt,rt[0],rt[1],rt[2]),rt.length&&le.push(rt)}function rn($){var le=[];return le.size=$.size,le.start=$.start,le.end=$.end,le}function Br($,le,ue,be,Oe,je){for(var xe=0;xe<$.length;xe++)zr($[xe],le,ue,be,Oe,je,!1)}function nn($,le,ue,be){$.push(le),$.push(ue),$.push(be)}function wn($,le,ue,be,Oe,je){var xe=(je-le)/(be-le);return $.push(je),$.push(ue+(Oe-ue)*xe),$.push(1),xe}function Pn($,le,ue,be,Oe,je){var xe=(je-ue)/(Oe-ue);return $.push(le+(be-le)*xe),$.push(je),$.push(1),xe}function An($,le){for(var ue=[],be=0;be<$.length;be++){var Oe,je=$[be],xe=je.type;if(xe==="Point"||xe==="MultiPoint"||xe==="LineString")Oe=Ni(je.geometry,le);else if(xe==="MultiLineString"||xe==="Polygon"){Oe=[];for(var Le=0;Le<je.geometry.length;Le++)Oe.push(Ni(je.geometry[Le],le))}else if(xe==="MultiPolygon")for(Oe=[],Le=0;Le<je.geometry.length;Le++){for(var tt=[],rt=0;rt<je.geometry[Le].length;rt++)tt.push(Ni(je.geometry[Le][rt],le));Oe.push(tt)}ue.push(Kt(je.id,xe,Oe,je.tags))}return ue}function Ni($,le){var ue=[];ue.size=$.size,$.start!==void 0&&(ue.start=$.start,ue.end=$.end);for(var be=0;be<$.length;be+=3)ue.push($[be]+le,$[be+1],$[be+2]);return ue}function wr($,le){if($.transformed)return $;var ue,be,Oe,je=1<<$.z,xe=$.x,Le=$.y;for(ue=0;ue<$.features.length;ue++){var tt=$.features[ue],rt=tt.geometry,Mt=tt.type;if(tt.geometry=[],Mt===1)for(be=0;be<rt.length;be+=2)tt.geometry.push(mn(rt[be],rt[be+1],le,je,xe,Le));else for(be=0;be<rt.length;be++){var Wt=[];for(Oe=0;Oe<rt[be].length;Oe+=2)Wt.push(mn(rt[be][Oe],rt[be][Oe+1],le,je,xe,Le));tt.geometry.push(Wt)}}return $.transformed=!0,$}function mn($,le,ue,be,Oe,je){return[Math.round(ue*($*be-Oe)),Math.round(ue*(le*be-je))]}function ho($,le,ue,be,Oe){for(var je=le===Oe.maxZoom?0:Oe.tolerance/((1<<le)*Oe.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ue,y:be,z:le,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Le=0;Le<$.length;Le++){xe.numFeatures++,Cr(xe,$[Le],je,Oe);var tt=$[Le].minX,rt=$[Le].minY,Mt=$[Le].maxX,Wt=$[Le].maxY;tt<xe.minX&&(xe.minX=tt),rt<xe.minY&&(xe.minY=rt),Mt>xe.maxX&&(xe.maxX=Mt),Wt>xe.maxY&&(xe.maxY=Wt)}return xe}function Cr($,le,ue,be){var Oe=le.geometry,je=le.type,xe=[];if(je==="Point"||je==="MultiPoint")for(var Le=0;Le<Oe.length;Le+=3)xe.push(Oe[Le]),xe.push(Oe[Le+1]),$.numPoints++,$.numSimplified++;else if(je==="LineString")Po(xe,Oe,$,ue,!1,!1);else if(je==="MultiLineString"||je==="Polygon")for(Le=0;Le<Oe.length;Le++)Po(xe,Oe[Le],$,ue,je==="Polygon",Le===0);else if(je==="MultiPolygon")for(var tt=0;tt<Oe.length;tt++){var rt=Oe[tt];for(Le=0;Le<rt.length;Le++)Po(xe,rt[Le],$,ue,!0,Le===0)}if(xe.length){var Mt=le.tags||null;if(je==="LineString"&&be.lineMetrics){for(var Wt in Mt={},le.tags)Mt[Wt]=le.tags[Wt];Mt.mapbox_clip_start=Oe.start/Oe.size,Mt.mapbox_clip_end=Oe.end/Oe.size}var ft={geometry:xe,type:je==="Polygon"||je==="MultiPolygon"?3:je==="LineString"||je==="MultiLineString"?2:1,tags:Mt};le.id!==null&&(ft.id=le.id),$.features.push(ft)}}function Po($,le,ue,be,Oe,je){var xe=be*be;if(be>0&&le.size<(Oe?xe:be))ue.numPoints+=le.length/3;else{for(var Le=[],tt=0;tt<le.length;tt+=3)(be===0||le[tt+2]>xe)&&(ue.numSimplified++,Le.push(le[tt]),Le.push(le[tt+1])),ue.numPoints++;Oe&&function(rt,Mt){for(var Wt=0,ft=0,Dt=rt.length,ai=Dt-2;ft<Dt;ai=ft,ft+=2)Wt+=(rt[ft]-rt[ai])*(rt[ft+1]+rt[ai+1]);if(Wt>0===Mt)for(ft=0,Dt=rt.length;ft<Dt/2;ft+=2){var dt=rt[ft],Zt=rt[ft+1];rt[ft]=rt[Dt-2-ft],rt[ft+1]=rt[Dt-1-ft],rt[Dt-2-ft]=dt,rt[Dt-1-ft]=Zt}}(Le,je),$.push(Le)}}function Gn($,le){var ue=(le=this.options=function(Oe,je){for(var xe in je)Oe[xe]=je[xe];return Oe}(Object.create(this.options),le)).debug;if(ue&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");var be=function(Oe,je){var xe=[];if(Oe.type==="FeatureCollection")for(var Le=0;Le<Oe.features.length;Le++)fi(xe,Oe.features[Le],je,Le);else fi(xe,Oe.type==="Feature"?Oe:{geometry:Oe},je);return xe}($,le);this.tiles={},this.tileCoords=[],ue&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(be=function(Oe,je){var xe=je.buffer/je.extent,Le=Oe,tt=hr(Oe,1,-1-xe,xe,0,-1,2,je),rt=hr(Oe,1,1-xe,2+xe,0,-1,2,je);return(tt||rt)&&(Le=hr(Oe,1,-xe,1+xe,0,-1,2,je)||[],tt&&(Le=An(tt,1).concat(Le)),rt&&(Le=Le.concat(An(rt,-1)))),Le}(be,le)).length&&this.splitTile(be,0,0,0),ue&&(be.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Xr($,le,ue){return 32*((1<<$)*ue+le)+$}function ln($,le){var ue=$.tileID.canonical;if(!this._geoJSONIndex)return le(null,null);var be=this._geoJSONIndex.getTile(ue.z,ue.x,ue.y);if(!be)return le(null,null);var Oe=new ne(be.features),je=Be(Oe);je.byteOffset===0&&je.byteLength===je.buffer.byteLength||(je=new Uint8Array(je)),le(null,{vectorTile:Oe,rawData:je.buffer})}Ci.prototype.load=function($){var le=this.options,ue=le.log,be=le.minZoom,Oe=le.maxZoom,je=le.nodeSize;ue&&console.time("total time");var xe="prepare "+$.length+" points";ue&&console.time(xe),this.points=$;for(var Le=[],tt=0;tt<$.length;tt++)$[tt].geometry&&Le.push(ze($[tt],tt));this.trees[Oe+1]=new ni(Le,Ft,Gt,je,Float32Array),ue&&console.timeEnd(xe);for(var rt=Oe;rt>=be;rt--){var Mt=+Date.now();Le=this._cluster(Le,rt),this.trees[rt]=new ni(Le,Ft,Gt,je,Float32Array),ue&&console.log("z%d: %d clusters in %dms",rt,Le.length,+Date.now()-Mt)}return ue&&console.timeEnd("total time"),this},Ci.prototype.getClusters=function($,le){var ue=(($[0]+180)%360+360)%360-180,be=Math.max(-90,Math.min(90,$[1])),Oe=$[2]===180?180:(($[2]+180)%360+360)%360-180,je=Math.max(-90,Math.min(90,$[3]));if($[2]-$[0]>=360)ue=-180,Oe=180;else if(ue>Oe){var xe=this.getClusters([ue,be,180,je],le),Le=this.getClusters([-180,be,Oe,je],le);return xe.concat(Le)}for(var tt=this.trees[this._limitZoom(le)],rt=[],Mt=0,Wt=tt.range(Re(ue),He(je),Re(Oe),He(be));Mt<Wt.length;Mt+=1){var ft=tt.points[Wt[Mt]];rt.push(ft.numPoints?oe(ft):this.points[ft.index])}return rt},Ci.prototype.getChildren=function($){var le=this._getOriginId($),ue=this._getOriginZoom($),be="No cluster with the specified id.",Oe=this.trees[ue];if(!Oe)throw new Error(be);var je=Oe.points[le];if(!je)throw new Error(be);for(var xe=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),Le=[],tt=0,rt=Oe.within(je.x,je.y,xe);tt<rt.length;tt+=1){var Mt=Oe.points[rt[tt]];Mt.parentId===$&&Le.push(Mt.numPoints?oe(Mt):this.points[Mt.index])}if(Le.length===0)throw new Error(be);return Le},Ci.prototype.getLeaves=function($,le,ue){var be=[];return this._appendLeaves(be,$,le=le||10,ue=ue||0,0),be},Ci.prototype.getTile=function($,le,ue){var be=this.trees[this._limitZoom($)],Oe=Math.pow(2,$),je=this.options,xe=je.radius/je.extent,Le=(ue-xe)/Oe,tt=(ue+1+xe)/Oe,rt={features:[]};return this._addTileFeatures(be.range((le-xe)/Oe,Le,(le+1+xe)/Oe,tt),be.points,le,ue,Oe,rt),le===0&&this._addTileFeatures(be.range(1-xe/Oe,Le,1,tt),be.points,Oe,ue,Oe,rt),le===Oe-1&&this._addTileFeatures(be.range(0,Le,xe/Oe,tt),be.points,-1,ue,Oe,rt),rt.features.length?rt:null},Ci.prototype.getClusterExpansionZoom=function($){for(var le=this._getOriginZoom($)-1;le<=this.options.maxZoom;){var ue=this.getChildren($);if(le++,ue.length!==1)break;$=ue[0].properties.cluster_id}return le},Ci.prototype._appendLeaves=function($,le,ue,be,Oe){for(var je=0,xe=this.getChildren(le);je<xe.length;je+=1){var Le=xe[je],tt=Le.properties;if(tt&&tt.cluster?Oe+tt.point_count<=be?Oe+=tt.point_count:Oe=this._appendLeaves($,tt.cluster_id,ue,be,Oe):Oe<be?Oe++:$.push(Le),$.length===ue)break}return Oe},Ci.prototype._addTileFeatures=function($,le,ue,be,Oe,je){for(var xe=0,Le=$;xe<Le.length;xe+=1){var tt=le[Le[xe]],rt=tt.numPoints,Mt={type:1,geometry:[[Math.round(this.options.extent*(tt.x*Oe-ue)),Math.round(this.options.extent*(tt.y*Oe-be))]],tags:rt?de(tt):this.points[tt.index].properties},Wt=void 0;rt?Wt=tt.id:this.options.generateId?Wt=tt.index:this.points[tt.index].id&&(Wt=this.points[tt.index].id),Wt!==void 0&&(Mt.id=Wt),je.features.push(Mt)}},Ci.prototype._limitZoom=function($){return Math.max(this.options.minZoom,Math.min(+$,this.options.maxZoom+1))},Ci.prototype._cluster=function($,le){for(var ue=[],be=this.options,Oe=be.reduce,je=be.minPoints,xe=be.radius/(be.extent*Math.pow(2,le)),Le=0;Le<$.length;Le++){var tt=$[Le];if(!(tt.zoom<=le)){tt.zoom=le;for(var rt=this.trees[le+1],Mt=rt.within(tt.x,tt.y,xe),Wt=tt.numPoints||1,ft=Wt,Dt=0,ai=Mt;Dt<ai.length;Dt+=1){var dt=rt.points[ai[Dt]];dt.zoom>le&&(ft+=dt.numPoints||1)}if(ft>=je){for(var Zt=tt.x*Wt,ii=tt.y*Wt,ri=Oe&&Wt>1?this._map(tt,!0):null,ki=(Le<<5)+(le+1)+this.points.length,si=0,Gi=Mt;si<Gi.length;si+=1){var $i=rt.points[Gi[si]];if(!($i.zoom<=le)){$i.zoom=le;var dr=$i.numPoints||1;Zt+=$i.x*dr,ii+=$i.y*dr,$i.parentId=ki,Oe&&(ri||(ri=this._map(tt,!0)),Oe(ri,this._map($i)))}}tt.parentId=ki,ue.push(xt(Zt/ft,ii/ft,ki,ft,ri))}else if(ue.push(tt),ft>1)for(var Vi=0,Ki=Mt;Vi<Ki.length;Vi+=1){var un=rt.points[Ki[Vi]];un.zoom<=le||(un.zoom=le,ue.push(un))}}}return ue},Ci.prototype._getOriginId=function($){return $-this.points.length>>5},Ci.prototype._getOriginZoom=function($){return($-this.points.length)%32},Ci.prototype._map=function($,le){if($.numPoints)return le?mt({},$.properties):$.properties;var ue=this.points[$.index].properties,be=this.options.map(ue);return le&&be===ue?mt({},be):be},Gn.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gn.prototype.splitTile=function($,le,ue,be,Oe,je,xe){for(var Le=[$,le,ue,be],tt=this.options,rt=tt.debug;Le.length;){be=Le.pop(),ue=Le.pop(),le=Le.pop(),$=Le.pop();var Mt=1<<le,Wt=Xr(le,ue,be),ft=this.tiles[Wt];if(!ft&&(rt>1&&console.time("creation"),ft=this.tiles[Wt]=ho($,le,ue,be,tt),this.tileCoords.push({z:le,x:ue,y:be}),rt)){rt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,ue,be,ft.numFeatures,ft.numPoints,ft.numSimplified),console.timeEnd("creation"));var Dt="z"+le;this.stats[Dt]=(this.stats[Dt]||0)+1,this.total++}if(ft.source=$,Oe){if(le===tt.maxZoom||le===Oe)continue;var ai=1<<Oe-le;if(ue!==Math.floor(je/ai)||be!==Math.floor(xe/ai))continue}else if(le===tt.indexMaxZoom||ft.numPoints<=tt.indexMaxPoints)continue;if(ft.source=null,$.length!==0){rt>1&&console.time("clipping");var dt,Zt,ii,ri,ki,si,Gi=.5*tt.buffer/tt.extent,$i=.5-Gi,dr=.5+Gi,Vi=1+Gi;dt=Zt=ii=ri=null,ki=hr($,Mt,ue-Gi,ue+dr,0,ft.minX,ft.maxX,tt),si=hr($,Mt,ue+$i,ue+Vi,0,ft.minX,ft.maxX,tt),$=null,ki&&(dt=hr(ki,Mt,be-Gi,be+dr,1,ft.minY,ft.maxY,tt),Zt=hr(ki,Mt,be+$i,be+Vi,1,ft.minY,ft.maxY,tt),ki=null),si&&(ii=hr(si,Mt,be-Gi,be+dr,1,ft.minY,ft.maxY,tt),ri=hr(si,Mt,be+$i,be+Vi,1,ft.minY,ft.maxY,tt),si=null),rt>1&&console.timeEnd("clipping"),Le.push(dt||[],le+1,2*ue,2*be),Le.push(Zt||[],le+1,2*ue,2*be+1),Le.push(ii||[],le+1,2*ue+1,2*be),Le.push(ri||[],le+1,2*ue+1,2*be+1)}}},Gn.prototype.getTile=function($,le,ue){var be=this.options,Oe=be.extent,je=be.debug;if($<0||$>24)return null;var xe=1<<$,Le=Xr($,le=(le%xe+xe)%xe,ue);if(this.tiles[Le])return wr(this.tiles[Le],Oe);je>1&&console.log("drilling down to z%d-%d-%d",$,le,ue);for(var tt,rt=$,Mt=le,Wt=ue;!tt&&rt>0;)rt--,Mt=Math.floor(Mt/2),Wt=Math.floor(Wt/2),tt=this.tiles[Xr(rt,Mt,Wt)];return tt&&tt.source?(je>1&&console.log("found parent tile z%d-%d-%d",rt,Mt,Wt),je>1&&console.time("drilling down"),this.splitTile(tt.source,rt,Mt,Wt,$,le,ue),je>1&&console.timeEnd("drilling down"),this.tiles[Le]?wr(this.tiles[Le],Oe):null):null};var co=function($){function le(ue,be,Oe,je){$.call(this,ue,be,Oe,ln),je&&(this.loadGeoJSON=je)}return $&&(le.__proto__=$),(le.prototype=Object.create($&&$.prototype)).constructor=le,le.prototype.loadData=function(ue,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),this._pendingCallback=be,this._pendingLoadDataParams=ue,this._state&&this._state!=="Idle"?this._state="NeedsLoadData":(this._state="Coalescing",this._loadData())},le.prototype._loadData=function(){var ue=this;if(this._pendingCallback&&this._pendingLoadDataParams){var be=this._pendingCallback,Oe=this._pendingLoadDataParams;delete this._pendingCallback,delete this._pendingLoadDataParams;var je=!!(Oe&&Oe.request&&Oe.request.collectResourceTiming)&&new h.RequestPerformance(Oe.request);this.loadGeoJSON(Oe,function(xe,Le){if(xe||!Le)return be(xe);if(typeof Le!="object")return be(new Error("Input data given to '"+Oe.source+"' is not a valid GeoJSON object."));(function ft(Dt,ai){var dt,Zt=Dt&&Dt.type;if(Zt==="FeatureCollection")for(dt=0;dt<Dt.features.length;dt++)ft(Dt.features[dt],ai);else if(Zt==="GeometryCollection")for(dt=0;dt<Dt.geometries.length;dt++)ft(Dt.geometries[dt],ai);else if(Zt==="Feature")ft(Dt.geometry,ai);else if(Zt==="Polygon")I(Dt.coordinates,ai);else if(Zt==="MultiPolygon")for(dt=0;dt<Dt.coordinates.length;dt++)I(Dt.coordinates[dt],ai);return Dt})(Le,!0);try{if(Oe.filter){var tt=h.createExpression(Oe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(tt.result==="error")throw new Error(tt.value.map(function(ft){return ft.key+": "+ft.message}).join(", "));var rt=Le.features.filter(function(ft){return tt.value.evaluate({zoom:0},ft)});Le={type:"FeatureCollection",features:rt}}ue._geoJSONIndex=Oe.cluster?new Ci(function(ft){var Dt=ft.superclusterOptions,ai=ft.clusterProperties;if(!ai||!Dt)return Dt;for(var dt={},Zt={},ii={accumulated:null,zoom:0},ri={properties:null},ki=Object.keys(ai),si=0,Gi=ki;si<Gi.length;si+=1){var $i=Gi[si],dr=ai[$i],Vi=dr[0],Ki=h.createExpression(dr[1]),un=h.createExpression(typeof Vi=="string"?[Vi,["accumulated"],["get",$i]]:Vi);dt[$i]=Ki.value,Zt[$i]=un.value}return Dt.map=function(_r){ri.properties=_r;for(var hn={},jr=0,cr=ki;jr<cr.length;jr+=1){var Ei=cr[jr];hn[Ei]=dt[Ei].evaluate(ii,ri)}return hn},Dt.reduce=function(_r,hn){ri.properties=hn;for(var jr=0,cr=ki;jr<cr.length;jr+=1){var Ei=cr[jr];ii.accumulated=_r[Ei],_r[Ei]=Zt[Ei].evaluate(ii,ri)}},Dt}(Oe)).load(Le.features):function(ft,Dt){return new Gn(ft,Dt)}(Le,Oe.geojsonVtOptions)}catch(ft){return be(ft)}ue.loaded={};var Mt={};if(je){var Wt=je.finish();Wt&&(Mt.resourceTiming={},Mt.resourceTiming[Oe.source]=JSON.parse(JSON.stringify(Wt)))}be(null,Mt)})}},le.prototype.coalesce=function(){this._state==="Coalescing"?this._state="Idle":this._state==="NeedsLoadData"&&(this._state="Coalescing",this._loadData())},le.prototype.reloadTile=function(ue,be){var Oe=this.loaded;return Oe&&Oe[ue.uid]?$.prototype.reloadTile.call(this,ue,be):this.loadTile(ue,be)},le.prototype.loadGeoJSON=function(ue,be){if(ue.request)h.getJSON(ue.request,be);else{if(typeof ue.data!="string")return be(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."));try{return be(null,JSON.parse(ue.data))}catch(Oe){return be(new Error("Input data given to '"+ue.source+"' is not a valid GeoJSON object."))}}},le.prototype.removeSource=function(ue,be){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),be()},le.prototype.getClusterExpansionZoom=function(ue,be){try{be(null,this._geoJSONIndex.getClusterExpansionZoom(ue.clusterId))}catch(Oe){be(Oe)}},le.prototype.getClusterChildren=function(ue,be){try{be(null,this._geoJSONIndex.getChildren(ue.clusterId))}catch(Oe){be(Oe)}},le.prototype.getClusterLeaves=function(ue,be){try{be(null,this._geoJSONIndex.getLeaves(ue.clusterId,ue.limit,ue.offset))}catch(Oe){be(Oe)}},le}(v),Fr=function($){var le=this;this.self=$,this.actor=new h.Actor($,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:v,geojson:co},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=function(ue,be){if(le.workerSourceTypes[ue])throw new Error('Worker source with name "'+ue+'" already registered.');le.workerSourceTypes[ue]=be},this.self.registerRTLTextPlugin=function(ue){if(h.plugin.isParsed())throw new Error("RTL text plugin already registered.");h.plugin.applyArabicShaping=ue.applyArabicShaping,h.plugin.processBidirectionalText=ue.processBidirectionalText,h.plugin.processStyledBidirectionalText=ue.processStyledBidirectionalText}};return Fr.prototype.setReferrer=function($,le){this.referrer=le},Fr.prototype.setImages=function($,le,ue){for(var be in this.availableImages[$]=le,this.workerSources[$]){var Oe=this.workerSources[$][be];for(var je in Oe)Oe[je].availableImages=le}ue()},Fr.prototype.setLayers=function($,le,ue){this.getLayerIndex($).replace(le),ue()},Fr.prototype.updateLayers=function($,le,ue){this.getLayerIndex($).update(le.layers,le.removedIds),ue()},Fr.prototype.loadTile=function($,le,ue){this.getWorkerSource($,le.type,le.source).loadTile(le,ue)},Fr.prototype.loadDEMTile=function($,le,ue){this.getDEMWorkerSource($,le.source).loadTile(le,ue)},Fr.prototype.reloadTile=function($,le,ue){this.getWorkerSource($,le.type,le.source).reloadTile(le,ue)},Fr.prototype.abortTile=function($,le,ue){this.getWorkerSource($,le.type,le.source).abortTile(le,ue)},Fr.prototype.removeTile=function($,le,ue){this.getWorkerSource($,le.type,le.source).removeTile(le,ue)},Fr.prototype.removeDEMTile=function($,le){this.getDEMWorkerSource($,le.source).removeTile(le)},Fr.prototype.removeSource=function($,le,ue){if(this.workerSources[$]&&this.workerSources[$][le.type]&&this.workerSources[$][le.type][le.source]){var be=this.workerSources[$][le.type][le.source];delete this.workerSources[$][le.type][le.source],be.removeSource!==void 0?be.removeSource(le,ue):ue()}},Fr.prototype.loadWorkerSource=function($,le,ue){try{this.self.importScripts(le.url),ue()}catch(be){ue(be.toString())}},Fr.prototype.syncRTLPluginState=function($,le,ue){try{h.plugin.setState(le);var be=h.plugin.getPluginURL();if(h.plugin.isLoaded()&&!h.plugin.isParsed()&&be!=null){this.self.importScripts(be);var Oe=h.plugin.isParsed();ue(Oe?void 0:new Error("RTL Text Plugin failed to import scripts from "+be),Oe)}}catch(je){ue(je.toString())}},Fr.prototype.getAvailableImages=function($){var le=this.availableImages[$];return le||(le=[]),le},Fr.prototype.getLayerIndex=function($){var le=this.layerIndexes[$];return le||(le=this.layerIndexes[$]=new A),le},Fr.prototype.getWorkerSource=function($,le,ue){var be=this;return this.workerSources[$]||(this.workerSources[$]={}),this.workerSources[$][le]||(this.workerSources[$][le]={}),this.workerSources[$][le][ue]||(this.workerSources[$][le][ue]=new this.workerSourceTypes[le]({send:function(Oe,je,xe){be.actor.send(Oe,je,xe,$)}},this.getLayerIndex($),this.getAvailableImages($))),this.workerSources[$][le][ue]},Fr.prototype.getDEMWorkerSource=function($,le){return this.demWorkerSources[$]||(this.demWorkerSources[$]={}),this.demWorkerSources[$][le]||(this.demWorkerSources[$][le]=new T),this.demWorkerSources[$][le]},Fr.prototype.enforceCacheSizeLimit=function($,le){h.enforceCacheSizeLimit(le)},typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new Fr(self)),Fr}),W(["./shared"],function(h){"use strict";var K=h.createCommonjsModule(function(n){function u(y){return!a(y)}function a(y){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var S,j,H=new Blob([""],{type:"text/javascript"}),ie=URL.createObjectURL(H);try{j=new Worker(ie),S=!0}catch(_e){S=!1}return j&&j.terminate(),URL.revokeObjectURL(ie),S}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var S=document.createElement("canvas");S.width=S.height=1;var j=S.getContext("2d");if(!j)return!1;var H=j.getImageData(0,0,1,1);return H&&H.width===S.width}()?(p[M=y&&y.failIfMajorPerformanceCaveat]===void 0&&(p[M]=function(S){var j=function(ie){var _e=document.createElement("canvas"),ye=Object.create(u.webGLContextAttributes);return ye.failIfMajorPerformanceCaveat=ie,_e.probablySupportsContext?_e.probablySupportsContext("webgl",ye)||_e.probablySupportsContext("experimental-webgl",ye):_e.supportsContext?_e.supportsContext("webgl",ye)||_e.supportsContext("experimental-webgl",ye):_e.getContext("webgl",ye)||_e.getContext("experimental-webgl",ye)}(S);if(!j)return!1;var H=j.createShader(j.VERTEX_SHADER);return!(!H||j.isContextLost())&&(j.shaderSource(H,"void main() {}"),j.compileShader(H),j.getShaderParameter(H,j.COMPILE_STATUS)===!0)}(M)),p[M]?void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var M}n.exports?n.exports=u:window&&(window.mapboxgl=window.mapboxgl||{},window.mapboxgl.supported=u,window.mapboxgl.notSupportedReason=a);var p={};u.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0}}),k={create:function(n,u,a){var p=h.window.document.createElement(n);return u!==void 0&&(p.className=u),a&&a.appendChild(p),p},createNS:function(n,u){return h.window.document.createElementNS(n,u)}},A=h.window.document&&h.window.document.documentElement.style;function z(n){if(!A)return n[0];for(var u=0;u<n.length;u++)if(n[u]in A)return n[u];return n[0]}var R,C=z(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]);k.disableDrag=function(){A&&C&&(R=A[C],A[C]="none")},k.enableDrag=function(){A&&C&&(A[C]=R)};var x=z(["transform","WebkitTransform"]);k.setTransform=function(n,u){n.style[x]=u};var v=!1;try{var m=Object.defineProperty({},"passive",{get:function(){v=!0}});h.window.addEventListener("test",m,m),h.window.removeEventListener("test",m,m)}catch(n){v=!1}k.addEventListener=function(n,u,a,p){p===void 0&&(p={}),n.addEventListener(u,a,"passive"in p&&v?p:p.capture)},k.removeEventListener=function(n,u,a,p){p===void 0&&(p={}),n.removeEventListener(u,a,"passive"in p&&v?p:p.capture)};var T=function(n){n.preventDefault(),n.stopPropagation(),h.window.removeEventListener("click",T,!0)};function I(n){var u=n.userImage;return!!(u&&u.render&&u.render())&&(n.data.replace(new Uint8Array(u.data.buffer)),!0)}k.suppressClick=function(){h.window.addEventListener("click",T,!0),h.window.setTimeout(function(){h.window.removeEventListener("click",T,!0)},0)},k.mousePos=function(n,u){var a=n.getBoundingClientRect();return new h.Point(u.clientX-a.left-n.clientLeft,u.clientY-a.top-n.clientTop)},k.touchPos=function(n,u){for(var a=n.getBoundingClientRect(),p=[],y=0;y<u.length;y++)p.push(new h.Point(u[y].clientX-a.left-n.clientLeft,u[y].clientY-a.top-n.clientTop));return p},k.mouseButton=function(n){return h.window.InstallTrigger!==void 0&&n.button===2&&n.ctrlKey&&h.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:n.button},k.remove=function(n){n.parentNode&&n.parentNode.removeChild(n)};var F=function(n){function u(){n.call(this),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new h.RGBAImage({width:1,height:1}),this.dirty=!0}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.isLoaded=function(){return this.loaded},u.prototype.setLoaded=function(a){if(this.loaded!==a&&(this.loaded=a,a)){for(var p=0,y=this.requestors;p<y.length;p+=1){var M=y[p];this._notify(M.ids,M.callback)}this.requestors=[]}},u.prototype.getImage=function(a){return this.images[a]},u.prototype.addImage=function(a,p){this._validate(a,p)&&(this.images[a]=p)},u.prototype._validate=function(a,p){var y=!0;return this._validateStretch(p.stretchX,p.data&&p.data.width)||(this.fire(new h.ErrorEvent(new Error('Image "'+a+'" has invalid "stretchX" value'))),y=!1),this._validateStretch(p.stretchY,p.data&&p.data.height)||(this.fire(new h.ErrorEvent(new Error('Image "'+a+'" has invalid "stretchY" value'))),y=!1),this._validateContent(p.content,p)||(this.fire(new h.ErrorEvent(new Error('Image "'+a+'" has invalid "content" value'))),y=!1),y},u.prototype._validateStretch=function(a,p){if(!a)return!0;for(var y=0,M=0,S=a;M<S.length;M+=1){var j=S[M];if(j[0]<y||j[1]<j[0]||p<j[1])return!1;y=j[1]}return!0},u.prototype._validateContent=function(a,p){return!(a&&(a.length!==4||a[0]<0||p.data.width<a[0]||a[1]<0||p.data.height<a[1]||a[2]<0||p.data.width<a[2]||a[3]<0||p.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))},u.prototype.updateImage=function(a,p){p.version=this.images[a].version+1,this.images[a]=p,this.updatedImages[a]=!0},u.prototype.removeImage=function(a){var p=this.images[a];delete this.images[a],delete this.patterns[a],p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()},u.prototype.listImages=function(){return Object.keys(this.images)},u.prototype.getImages=function(a,p){var y=!0;if(!this.isLoaded())for(var M=0,S=a;M<S.length;M+=1)this.images[S[M]]||(y=!1);this.isLoaded()||y?this._notify(a,p):this.requestors.push({ids:a,callback:p})},u.prototype._notify=function(a,p){for(var y={},M=0,S=a;M<S.length;M+=1){var j=S[M];this.images[j]||this.fire(new h.Event("styleimagemissing",{id:j}));var H=this.images[j];H?y[j]={data:H.data.clone(),pixelRatio:H.pixelRatio,sdf:H.sdf,version:H.version,stretchX:H.stretchX,stretchY:H.stretchY,content:H.content,hasRenderCallback:Boolean(H.userImage&&H.userImage.render)}:h.warnOnce('Image "'+j+'" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.')}p(null,y)},u.prototype.getPixelSize=function(){var a=this.atlasImage;return{width:a.width,height:a.height}},u.prototype.getPattern=function(a){var p=this.patterns[a],y=this.getImage(a);if(!y)return null;if(p&&p.position.version===y.version)return p.position;if(p)p.position.version=y.version;else{var M={w:y.data.width+2,h:y.data.height+2,x:0,y:0},S=new h.ImagePosition(M,y);this.patterns[a]={bin:M,position:S}}return this._updatePatternAtlas(),this.patterns[a].position},u.prototype.bind=function(a){var p=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new h.Texture(a,this.atlasImage,p.RGBA),this.atlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE)},u.prototype._updatePatternAtlas=function(){var a=[];for(var p in this.patterns)a.push(this.patterns[p].bin);var y=h.potpack(a),M=y.w,S=y.h,j=this.atlasImage;for(var H in j.resize({width:M||1,height:S||1}),this.patterns){var ie=this.patterns[H].bin,_e=ie.x+1,ye=ie.y+1,ge=this.images[H].data,Ie=ge.width,Ee=ge.height;h.RGBAImage.copy(ge,j,{x:0,y:0},{x:_e,y:ye},{width:Ie,height:Ee}),h.RGBAImage.copy(ge,j,{x:0,y:Ee-1},{x:_e,y:ye-1},{width:Ie,height:1}),h.RGBAImage.copy(ge,j,{x:0,y:0},{x:_e,y:ye+Ee},{width:Ie,height:1}),h.RGBAImage.copy(ge,j,{x:Ie-1,y:0},{x:_e-1,y:ye},{width:1,height:Ee}),h.RGBAImage.copy(ge,j,{x:0,y:0},{x:_e+Ie,y:ye},{width:1,height:Ee})}this.dirty=!0},u.prototype.beginFrame=function(){this.callbackDispatchedThisFrame={}},u.prototype.dispatchRenderCallbacks=function(a){for(var p=0,y=a;p<y.length;p+=1){var M=y[p];if(!this.callbackDispatchedThisFrame[M]){this.callbackDispatchedThisFrame[M]=!0;var S=this.images[M];I(S)&&this.updateImage(M,S)}}},u}(h.Evented),q=ne,re=ne;function ne(n,u,a,p,y,M){this.fontSize=n||24,this.buffer=u===void 0?3:u,this.cutoff=p||.25,this.fontFamily=y||"sans-serif",this.fontWeight=M||"normal",this.radius=a||8;var S=this.size=this.fontSize+2*this.buffer;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=S,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textBaseline="middle",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(S*S),this.gridInner=new Float64Array(S*S),this.f=new Float64Array(S),this.d=new Float64Array(S),this.z=new Float64Array(S+1),this.v=new Int16Array(S),this.middle=Math.round(S/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function se(n,u,a,p,y,M,S){for(var j=0;j<u;j++){for(var H=0;H<a;H++)p[H]=n[H*u+j];for(X(p,y,M,S,a),H=0;H<a;H++)n[H*u+j]=y[H]}for(H=0;H<a;H++){for(j=0;j<u;j++)p[j]=n[H*u+j];for(X(p,y,M,S,u),j=0;j<u;j++)n[H*u+j]=Math.sqrt(y[j])}}function X(n,u,a,p,y){a[0]=0,p[0]=-1e20,p[1]=1e20;for(var M=1,S=0;M<y;M++){for(var j=(n[M]+M*M-(n[a[S]]+a[S]*a[S]))/(2*M-2*a[S]);j<=p[S];)S--,j=(n[M]+M*M-(n[a[S]]+a[S]*a[S]))/(2*M-2*a[S]);a[++S]=M,p[S]=j,p[S+1]=1e20}for(M=0,S=0;M<y;M++){for(;p[S+1]<M;)S++;u[M]=(M-a[S])*(M-a[S])+n[a[S]]}}ne.prototype.draw=function(n){this.ctx.clearRect(0,0,this.size,this.size),this.ctx.fillText(n,this.buffer,this.middle);for(var u=this.ctx.getImageData(0,0,this.size,this.size),a=new Uint8ClampedArray(this.size*this.size),p=0;p<this.size*this.size;p++){var y=u.data[4*p+3]/255;this.gridOuter[p]=y===1?0:y===0?1e20:Math.pow(Math.max(0,.5-y),2),this.gridInner[p]=y===1?1e20:y===0?0:Math.pow(Math.max(0,y-.5),2)}for(se(this.gridOuter,this.size,this.size,this.f,this.d,this.v,this.z),se(this.gridInner,this.size,this.size,this.f,this.d,this.v,this.z),p=0;p<this.size*this.size;p++)a[p]=Math.max(0,Math.min(255,Math.round(255-255*((this.gridOuter[p]-this.gridInner[p])/this.radius+this.cutoff))));return a},q.default=re;var ce=function(n,u){this.requestManager=n,this.localIdeographFontFamily=u,this.entries={}};ce.prototype.setURL=function(n){this.url=n},ce.prototype.getGlyphs=function(n,u){var a=this,p=[];for(var y in n)for(var M=0,S=n[y];M<S.length;M+=1)p.push({stack:y,id:S[M]});h.asyncAll(p,function(j,H){var ie=j.stack,_e=j.id,ye=a.entries[ie];ye||(ye=a.entries[ie]={glyphs:{},requests:{},ranges:{}});var ge=ye.glyphs[_e];if(ge===void 0){if(ge=a._tinySDF(ye,ie,_e))return ye.glyphs[_e]=ge,void H(null,{stack:ie,id:_e,glyph:ge});var Ie=Math.floor(_e/256);if(256*Ie>65535)H(new Error("glyphs > 65535 not supported"));else if(ye.ranges[Ie])H(null,{stack:ie,id:_e,glyph:ge});else{var Ee=ye.requests[Ie];Ee||(Ee=ye.requests[Ie]=[],ce.loadGlyphRange(ie,Ie,a.url,a.requestManager,function(Ge,Ce){if(Ce){for(var Ne in Ce)a._doesCharSupportLocalGlyph(+Ne)||(ye.glyphs[+Ne]=Ce[+Ne]);ye.ranges[Ie]=!0}for(var Je=0,lt=Ee;Je<lt.length;Je+=1)(0,lt[Je])(Ge,Ce);delete ye.requests[Ie]})),Ee.push(function(Ge,Ce){Ge?H(Ge):Ce&&H(null,{stack:ie,id:_e,glyph:Ce[_e]||null})})}}else H(null,{stack:ie,id:_e,glyph:ge})},function(j,H){if(j)u(j);else if(H){for(var ie={},_e=0,ye=H;_e<ye.length;_e+=1){var ge=ye[_e],Ie=ge.stack,Ee=ge.id,Ge=ge.glyph;(ie[Ie]||(ie[Ie]={}))[Ee]=Ge&&{id:Ge.id,bitmap:Ge.bitmap.clone(),metrics:Ge.metrics}}u(null,ie)}})},ce.prototype._doesCharSupportLocalGlyph=function(n){return!!this.localIdeographFontFamily&&(h.isChar["CJK Unified Ideographs"](n)||h.isChar["Hangul Syllables"](n)||h.isChar.Hiragana(n)||h.isChar.Katakana(n))},ce.prototype._tinySDF=function(n,u,a){var p=this.localIdeographFontFamily;if(p&&this._doesCharSupportLocalGlyph(a)){var y=n.tinySDF;if(!y){var M="400";/bold/i.test(u)?M="900":/medium/i.test(u)?M="500":/light/i.test(u)&&(M="200"),y=n.tinySDF=new ce.TinySDF(24,3,8,.25,p,M)}return{id:a,bitmap:new h.AlphaImage({width:30,height:30},y.draw(String.fromCharCode(a))),metrics:{width:24,height:24,left:0,top:-8,advance:24}}}},ce.loadGlyphRange=function(n,u,a,p,y){var M=256*u,S=M+255,j=p.transformRequest(p.normalizeGlyphsURL(a).replace("{fontstack}",n).replace("{range}",M+"-"+S),h.ResourceType.Glyphs);h.getArrayBuffer(j,function(H,ie){if(H)y(H);else if(ie){for(var _e={},ye=0,ge=h.parseGlyphPBF(ie);ye<ge.length;ye+=1){var Ie=ge[ye];_e[Ie.id]=Ie}y(null,_e)}})},ce.TinySDF=q;var Me=function(){this.specification=h.styleSpec.light.position};Me.prototype.possiblyEvaluate=function(n,u){return h.sphericalToCartesian(n.expression.evaluate(u))},Me.prototype.interpolate=function(n,u,a){return{x:h.number(n.x,u.x,a),y:h.number(n.y,u.y,a),z:h.number(n.z,u.z,a)}};var Be=new h.Properties({anchor:new h.DataConstantProperty(h.styleSpec.light.anchor),position:new Me,color:new h.DataConstantProperty(h.styleSpec.light.color),intensity:new h.DataConstantProperty(h.styleSpec.light.intensity)}),ot=function(n){function u(a){n.call(this),this._transitionable=new h.Transitionable(Be),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getLight=function(){return this._transitionable.serialize()},u.prototype.setLight=function(a,p){if(p===void 0&&(p={}),!this._validate(h.validateLight,a,p))for(var y in a){var M=a[y];h.endsWith(y,"-transition")?this._transitionable.setTransition(y.slice(0,-"-transition".length),M):this._transitionable.setValue(y,M)}},u.prototype.updateTransitions=function(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)},u.prototype.hasTransition=function(){return this._transitioning.hasTransition()},u.prototype.recalculate=function(a){this.properties=this._transitioning.possiblyEvaluate(a)},u.prototype._validate=function(a,p,y){return(!y||y.validate!==!1)&&h.emitValidationErrors(this,a.call(h.validateStyle,h.extend({value:p,style:{glyphs:!0,sprite:!0},styleSpec:h.styleSpec})))},u}(h.Evented),Ue=function(n,u){this.width=n,this.height=u,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}};Ue.prototype.getDash=function(n,u){var a=n.join(",")+String(u);return this.dashEntry[a]||(this.dashEntry[a]=this.addDash(n,u)),this.dashEntry[a]},Ue.prototype.getDashRanges=function(n,u,a){var p=[],y=n.length%2==1?-n[n.length-1]*a:0,M=n[0]*a,S=!0;p.push({left:y,right:M,isDash:S,zeroLength:n[0]===0});for(var j=n[0],H=1;H<n.length;H++){var ie=n[H];p.push({left:y=j*a,right:M=(j+=ie)*a,isDash:S=!S,zeroLength:ie===0})}return p},Ue.prototype.addRoundDash=function(n,u,a){for(var p=u/2,y=-a;y<=a;y++)for(var M=this.width*(this.nextRow+a+y),S=0,j=n[S],H=0;H<this.width;H++){H/j.right>1&&(j=n[++S]);var ie=Math.abs(H-j.left),_e=Math.abs(H-j.right),ye=Math.min(ie,_e),ge=void 0,Ie=y/a*(p+1);if(j.isDash){var Ee=p-Math.abs(Ie);ge=Math.sqrt(ye*ye+Ee*Ee)}else ge=p-Math.sqrt(ye*ye+Ie*Ie);this.data[M+H]=Math.max(0,Math.min(255,ge+128))}},Ue.prototype.addRegularDash=function(n){for(var u=n.length-1;u>=0;--u){var a=n[u],p=n[u+1];a.zeroLength?n.splice(u,1):p&&p.isDash===a.isDash&&(p.left=a.left,n.splice(u,1))}var y=n[0],M=n[n.length-1];y.isDash===M.isDash&&(y.left=M.left-this.width,M.right=y.right+this.width);for(var S=this.width*this.nextRow,j=0,H=n[j],ie=0;ie<this.width;ie++){ie/H.right>1&&(H=n[++j]);var _e=Math.abs(ie-H.left),ye=Math.abs(ie-H.right),ge=Math.min(_e,ye);this.data[S+ie]=Math.max(0,Math.min(255,(H.isDash?ge:-ge)+128))}},Ue.prototype.addDash=function(n,u){var a=u?7:0,p=2*a+1;if(this.nextRow+p>this.height)return h.warnOnce("LineAtlas out of space"),null;for(var y=0,M=0;M<n.length;M++)y+=n[M];if(y!==0){var S=this.width/y,j=this.getDashRanges(n,this.width,S);u?this.addRoundDash(j,S,a):this.addRegularDash(j)}var H={y:(this.nextRow+a+.5)/this.height,height:2*a/this.height,width:y};return this.nextRow+=p,this.dirty=!0,H},Ue.prototype.bind=function(n){var u=n.gl;this.texture?(u.bindTexture(u.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,u.texSubImage2D(u.TEXTURE_2D,0,0,0,this.width,this.height,u.ALPHA,u.UNSIGNED_BYTE,this.data))):(this.texture=u.createTexture(),u.bindTexture(u.TEXTURE_2D,this.texture),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.REPEAT),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texImage2D(u.TEXTURE_2D,0,u.ALPHA,this.width,this.height,0,u.ALPHA,u.UNSIGNED_BYTE,this.data))};var ht=function n(u,a){this.workerPool=u,this.actors=[],this.currentActor=0,this.id=h.uniqueId();for(var p=this.workerPool.acquire(this.id),y=0;y<p.length;y++){var M=new n.Actor(p[y],a,this.id);M.name="Worker "+y,this.actors.push(M)}};function Et(n,u,a){var p=function(y,M){if(y)return a(y);if(M){var S=h.pick(h.extend(M,n),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(S.vectorLayers=M.vector_layers,S.vectorLayerIds=S.vectorLayers.map(function(j){return j.id})),S.tiles=u.canonicalizeTileset(S,n.url),a(null,S)}};return n.url?h.getJSON(u.transformRequest(u.normalizeSourceURL(n.url),h.ResourceType.Source),p):h.browser.frame(function(){return p(null,n)})}ht.prototype.broadcast=function(n,u,a){h.asyncAll(this.actors,function(p,y){p.send(n,u,y)},a=a||function(){})},ht.prototype.getActor=function(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]},ht.prototype.remove=function(){this.actors.forEach(function(n){n.remove()}),this.actors=[],this.workerPool.release(this.id)},ht.Actor=h.Actor;var bi=function(n,u,a){this.bounds=h.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=a||24};bi.prototype.validateBounds=function(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]},bi.prototype.contains=function(n){var u=Math.pow(2,n.z),a=Math.floor(h.mercatorXfromLng(this.bounds.getWest())*u),p=Math.floor(h.mercatorYfromLat(this.bounds.getNorth())*u),y=Math.ceil(h.mercatorXfromLng(this.bounds.getEast())*u),M=Math.ceil(h.mercatorYfromLat(this.bounds.getSouth())*u);return n.x>=a&&n.x<y&&n.y>=p&&n.y<M};var gt=function(n){function u(a,p,y,M){if(n.call(this),this.id=a,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,h.extend(this,h.pick(p,["url","scheme","tileSize","promoteId"])),this._options=h.extend({type:"vector"},p),this._collectResourceTiming=p.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(M)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(){var a=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Et(this._options,this.map._requestManager,function(p,y){a._tileJSONRequest=null,a._loaded=!0,p?a.fire(new h.ErrorEvent(p)):y&&(h.extend(a,y),y.bounds&&(a.tileBounds=new bi(y.bounds,a.minzoom,a.maxzoom)),h.postTurnstileEvent(y.tiles,a.map._requestManager._customAccessToken),h.postMapLoadEvent(y.tiles,a.map._getMapId(),a.map._requestManager._skuToken,a.map._requestManager._customAccessToken),a.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),a.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},u.prototype.loaded=function(){return this._loaded},u.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},u.prototype.onAdd=function(a){this.map=a,this.load()},u.prototype.setSourceProperty=function(a){this._tileJSONRequest&&this._tileJSONRequest.cancel(),a(),this.map.style.sourceCaches[this.id].clearTiles(),this.load()},u.prototype.setTiles=function(a){var p=this;return this.setSourceProperty(function(){p._options.tiles=a}),this},u.prototype.setUrl=function(a){var p=this;return this.setSourceProperty(function(){p.url=a,p._options.url=a}),this},u.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},u.prototype.serialize=function(){return h.extend({},this._options)},u.prototype.loadTile=function(a,p){var y=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),M={request:this.map._requestManager.transformRequest(y,h.ResourceType.Tile),uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function S(j,H){return delete a.request,a.aborted?p(null):j&&j.status!==404?p(j):(H&&H.resourceTiming&&(a.resourceTiming=H.resourceTiming),this.map._refreshExpiredTiles&&H&&a.setExpiryData(H),a.loadVectorData(H,this.map.painter),h.cacheEntryPossiblyAdded(this.dispatcher),p(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}M.request.collectResourceTiming=this._collectResourceTiming,a.actor&&a.state!=="expired"?a.state==="loading"?a.reloadCallback=p:a.request=a.actor.send("reloadTile",M,S.bind(this)):(a.actor=this.dispatcher.getActor(),a.request=a.actor.send("loadTile",M,S.bind(this)))},u.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id},void 0)},u.prototype.unloadTile=function(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id},void 0)},u.prototype.hasTransition=function(){return!1},u}(h.Evented),Qe=function(n){function u(a,p,y,M){n.call(this),this.id=a,this.dispatcher=y,this.setEventedParent(M),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=h.extend({type:"raster"},p),h.extend(this,h.pick(p,["url","scheme","tileSize"]))}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(){var a=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Et(this._options,this.map._requestManager,function(p,y){a._tileJSONRequest=null,a._loaded=!0,p?a.fire(new h.ErrorEvent(p)):y&&(h.extend(a,y),y.bounds&&(a.tileBounds=new bi(y.bounds,a.minzoom,a.maxzoom)),h.postTurnstileEvent(y.tiles),h.postMapLoadEvent(y.tiles,a.map._getMapId(),a.map._requestManager._skuToken),a.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})),a.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})))})},u.prototype.loaded=function(){return this._loaded},u.prototype.onAdd=function(a){this.map=a,this.load()},u.prototype.onRemove=function(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)},u.prototype.serialize=function(){return h.extend({},this._options)},u.prototype.hasTile=function(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)},u.prototype.loadTile=function(a,p){var y=this,M=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);a.request=h.getImage(this.map._requestManager.transformRequest(M,h.ResourceType.Tile),function(S,j){if(delete a.request,a.aborted)a.state="unloaded",p(null);else if(S)a.state="errored",p(S);else if(j){y.map._refreshExpiredTiles&&a.setExpiryData(j),delete j.cacheControl,delete j.expires;var H=y.map.painter.context,ie=H.gl;a.texture=y.map.painter.getTileTexture(j.width),a.texture?a.texture.update(j,{useMipmap:!0}):(a.texture=new h.Texture(H,j,ie.RGBA,{useMipmap:!0}),a.texture.bind(ie.LINEAR,ie.CLAMP_TO_EDGE,ie.LINEAR_MIPMAP_NEAREST),H.extTextureFilterAnisotropic&&ie.texParameterf(ie.TEXTURE_2D,H.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,H.extTextureFilterAnisotropicMax)),a.state="loaded",h.cacheEntryPossiblyAdded(y.dispatcher),p(null)}})},u.prototype.abortTile=function(a,p){a.request&&(a.request.cancel(),delete a.request),p()},u.prototype.unloadTile=function(a,p){a.texture&&this.map.painter.saveTileTexture(a.texture),p()},u.prototype.hasTransition=function(){return!1},u}(h.Evented),we=function(n){function u(a,p,y,M){n.call(this,a,p,y,M),this.type="raster-dem",this.maxzoom=22,this._options=h.extend({type:"raster-dem"},p),this.encoding=p.encoding||"mapbox"}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.serialize=function(){return{type:"raster-dem",url:this.url,tileSize:this.tileSize,tiles:this.tiles,bounds:this.bounds,encoding:this.encoding}},u.prototype.loadTile=function(a,p){var y=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),this.tileSize);function M(S,j){S&&(a.state="errored",p(S)),j&&(a.dem=j,a.needsHillshadePrepare=!0,a.state="loaded",p(null))}a.request=h.getImage(this.map._requestManager.transformRequest(y,h.ResourceType.Tile),function(S,j){if(delete a.request,a.aborted)a.state="unloaded",p(null);else if(S)a.state="errored",p(S);else if(j){this.map._refreshExpiredTiles&&a.setExpiryData(j),delete j.cacheControl,delete j.expires;var H=h.window.ImageBitmap&&j instanceof h.window.ImageBitmap&&h.offscreenCanvasSupported()?j:h.browser.getImageData(j,1),ie={uid:a.uid,coord:a.tileID,source:this.id,rawImageData:H,encoding:this.encoding};a.actor&&a.state!=="expired"||(a.actor=this.dispatcher.getActor(),a.actor.send("loadDEMTile",ie,M.bind(this)))}}.bind(this)),a.neighboringTiles=this._getNeighboringTiles(a.tileID)},u.prototype._getNeighboringTiles=function(a){var p=a.canonical,y=Math.pow(2,p.z),M=(p.x-1+y)%y,S=p.x===0?a.wrap-1:a.wrap,j=(p.x+1+y)%y,H=p.x+1===y?a.wrap+1:a.wrap,ie={};return ie[new h.OverscaledTileID(a.overscaledZ,S,p.z,M,p.y).key]={backfilled:!1},ie[new h.OverscaledTileID(a.overscaledZ,H,p.z,j,p.y).key]={backfilled:!1},p.y>0&&(ie[new h.OverscaledTileID(a.overscaledZ,S,p.z,M,p.y-1).key]={backfilled:!1},ie[new h.OverscaledTileID(a.overscaledZ,a.wrap,p.z,p.x,p.y-1).key]={backfilled:!1},ie[new h.OverscaledTileID(a.overscaledZ,H,p.z,j,p.y-1).key]={backfilled:!1}),p.y+1<y&&(ie[new h.OverscaledTileID(a.overscaledZ,S,p.z,M,p.y+1).key]={backfilled:!1},ie[new h.OverscaledTileID(a.overscaledZ,a.wrap,p.z,p.x,p.y+1).key]={backfilled:!1},ie[new h.OverscaledTileID(a.overscaledZ,H,p.z,j,p.y+1).key]={backfilled:!1}),ie},u.prototype.unloadTile=function(a){a.demTexture&&this.map.painter.saveTileTexture(a.demTexture),a.fbo&&(a.fbo.destroy(),delete a.fbo),a.dem&&delete a.dem,delete a.neighboringTiles,a.state="unloaded",a.actor&&a.actor.send("removeDEMTile",{uid:a.uid,source:this.id})},u}(Qe),Ae=function(n){function u(a,p,y,M){n.call(this),this.id=a,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._loaded=!1,this.actor=y.getActor(),this.setEventedParent(M),this._data=p.data,this._options=h.extend({},p),this._collectResourceTiming=p.collectResourceTiming,this._resourceTiming=[],p.maxzoom!==void 0&&(this.maxzoom=p.maxzoom),p.type&&(this.type=p.type),p.attribution&&(this.attribution=p.attribution),this.promoteId=p.promoteId;var S=h.EXTENT/this.tileSize;this.workerOptions=h.extend({source:this.id,cluster:p.cluster||!1,geojsonVtOptions:{buffer:(p.buffer!==void 0?p.buffer:128)*S,tolerance:(p.tolerance!==void 0?p.tolerance:.375)*S,extent:h.EXTENT,maxZoom:this.maxzoom,lineMetrics:p.lineMetrics||!1,generateId:p.generateId||!1},superclusterOptions:{maxZoom:p.clusterMaxZoom!==void 0?Math.min(p.clusterMaxZoom,this.maxzoom-1):this.maxzoom-1,minPoints:Math.max(2,p.clusterMinPoints||2),extent:h.EXTENT,radius:(p.clusterRadius||50)*S,log:!1,generateId:p.generateId||!1},clusterProperties:p.clusterProperties,filter:p.filter},p.workerOptions)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(){var a=this;this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(p){if(p)a.fire(new h.ErrorEvent(p));else{var y={dataType:"source",sourceDataType:"metadata"};a._collectResourceTiming&&a._resourceTiming&&a._resourceTiming.length>0&&(y.resourceTiming=a._resourceTiming,a._resourceTiming=[]),a.fire(new h.Event("data",y))}})},u.prototype.onAdd=function(a){this.map=a,this.load()},u.prototype.setData=function(a){var p=this;return this._data=a,this.fire(new h.Event("dataloading",{dataType:"source"})),this._updateWorkerData(function(y){if(y)p.fire(new h.ErrorEvent(y));else{var M={dataType:"source",sourceDataType:"content"};p._collectResourceTiming&&p._resourceTiming&&p._resourceTiming.length>0&&(M.resourceTiming=p._resourceTiming,p._resourceTiming=[]),p.fire(new h.Event("data",M))}}),this},u.prototype.getClusterExpansionZoom=function(a,p){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:a,source:this.id},p),this},u.prototype.getClusterChildren=function(a,p){return this.actor.send("geojson.getClusterChildren",{clusterId:a,source:this.id},p),this},u.prototype.getClusterLeaves=function(a,p,y,M){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:a,limit:p,offset:y},M),this},u.prototype._updateWorkerData=function(a){var p=this;this._loaded=!1;var y=h.extend({},this.workerOptions),M=this._data;typeof M=="string"?(y.request=this.map._requestManager.transformRequest(h.browser.resolveURL(M),h.ResourceType.Source),y.request.collectResourceTiming=this._collectResourceTiming):y.data=JSON.stringify(M),this.actor.send(this.type+".loadData",y,function(S,j){p._removed||j&&j.abandoned||(p._loaded=!0,j&&j.resourceTiming&&j.resourceTiming[p.id]&&(p._resourceTiming=j.resourceTiming[p.id].slice(0)),p.actor.send(p.type+".coalesce",{source:y.source},null),a(S))})},u.prototype.loaded=function(){return this._loaded},u.prototype.loadTile=function(a,p){var y=this,M=a.actor?"reloadTile":"loadTile";a.actor=this.actor,a.request=this.actor.send(M,{type:this.type,uid:a.uid,tileID:a.tileID,zoom:a.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:h.browser.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},function(S,j){return delete a.request,a.unloadVectorData(),a.aborted?p(null):S?p(S):(a.loadVectorData(j,y.map.painter,M==="reloadTile"),p(null))})},u.prototype.abortTile=function(a){a.request&&(a.request.cancel(),delete a.request),a.aborted=!0},u.prototype.unloadTile=function(a){a.unloadVectorData(),this.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})},u.prototype.onRemove=function(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})},u.prototype.serialize=function(){return h.extend({},this._options,{type:this.type,data:this._data})},u.prototype.hasTransition=function(){return!1},u}(h.Evented),it=h.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]),Lt=function(n){function u(a,p,y,M){n.call(this),this.id=a,this.dispatcher=y,this.coordinates=p.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(M),this.options=p}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(a,p){var y=this;this._loaded=!1,this.fire(new h.Event("dataloading",{dataType:"source"})),this.url=this.options.url,h.getImage(this.map._requestManager.transformRequest(this.url,h.ResourceType.Image),function(M,S){y._loaded=!0,M?y.fire(new h.ErrorEvent(M)):S&&(y.image=S,a&&(y.coordinates=a),p&&p(),y._finishLoading())})},u.prototype.loaded=function(){return this._loaded},u.prototype.updateImage=function(a){var p=this;return this.image&&a.url?(this.options.url=a.url,this.load(a.coordinates,function(){p.texture=null}),this):this},u.prototype._finishLoading=function(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"metadata"})))},u.prototype.onAdd=function(a){this.map=a,this.load()},u.prototype.setCoordinates=function(a){var p=this;this.coordinates=a;var y=a.map(h.MercatorCoordinate.fromLngLat);this.tileID=function(S){for(var j=1/0,H=1/0,ie=-1/0,_e=-1/0,ye=0,ge=S;ye<ge.length;ye+=1){var Ie=ge[ye];j=Math.min(j,Ie.x),H=Math.min(H,Ie.y),ie=Math.max(ie,Ie.x),_e=Math.max(_e,Ie.y)}var Ee=Math.max(ie-j,_e-H),Ge=Math.max(0,Math.floor(-Math.log(Ee)/Math.LN2)),Ce=Math.pow(2,Ge);return new h.CanonicalTileID(Ge,Math.floor((j+ie)/2*Ce),Math.floor((H+_e)/2*Ce))}(y),this.minzoom=this.maxzoom=this.tileID.z;var M=y.map(function(S){return p.tileID.getTilePoint(S)._round()});return this._boundsArray=new h.StructArrayLayout4i8,this._boundsArray.emplaceBack(M[0].x,M[0].y,0,0),this._boundsArray.emplaceBack(M[1].x,M[1].y,h.EXTENT,0),this._boundsArray.emplaceBack(M[3].x,M[3].y,0,h.EXTENT),this._boundsArray.emplaceBack(M[2].x,M[2].y,h.EXTENT,h.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new h.Event("data",{dataType:"source",sourceDataType:"content"})),this},u.prototype.prepare=function(){if(Object.keys(this.tiles).length!==0&&this.image){var a=this.map.painter.context,p=a.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,it.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new h.Texture(a,this.image,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},u.prototype.loadTile=function(a,p){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},p(null)):(a.state="errored",p(null))},u.prototype.serialize=function(){return{type:"image",url:this.options.url,coordinates:this.coordinates}},u.prototype.hasTransition=function(){return!1},u}(h.Evented),ei=function(n){function u(a,p,y,M){n.call(this,a,p,y,M),this.roundZoom=!0,this.type="video",this.options=p}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(){var a=this;this._loaded=!1;var p=this.options;this.urls=[];for(var y=0,M=p.urls;y<M.length;y+=1)this.urls.push(this.map._requestManager.transformRequest(M[y],h.ResourceType.Source).url);h.getVideo(this.urls,function(S,j){a._loaded=!0,S?a.fire(new h.ErrorEvent(S)):j&&(a.video=j,a.video.loop=!0,a.video.addEventListener("playing",function(){a.map.triggerRepaint()}),a.map&&a.video.play(),a._finishLoading())})},u.prototype.pause=function(){this.video&&this.video.pause()},u.prototype.play=function(){this.video&&this.video.play()},u.prototype.seek=function(a){if(this.video){var p=this.video.seekable;a<p.start(0)||a>p.end(0)?this.fire(new h.ErrorEvent(new h.ValidationError("sources."+this.id,null,"Playback for this video can be set only between the "+p.start(0)+" and "+p.end(0)+"-second mark."))):this.video.currentTime=a}},u.prototype.getVideo=function(){return this.video},u.prototype.onAdd=function(a){this.map||(this.map=a,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))},u.prototype.prepare=function(){if(!(Object.keys(this.tiles).length===0||this.video.readyState<2)){var a=this.map.painter.context,p=a.gl;for(var y in this.boundsBuffer||(this.boundsBuffer=a.createVertexBuffer(this._boundsArray,it.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE),p.texSubImage2D(p.TEXTURE_2D,0,0,0,p.RGBA,p.UNSIGNED_BYTE,this.video)):(this.texture=new h.Texture(a,this.video,p.RGBA),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this.tiles){var M=this.tiles[y];M.state!=="loaded"&&(M.state="loaded",M.texture=this.texture)}}},u.prototype.serialize=function(){return{type:"video",urls:this.urls,coordinates:this.coordinates}},u.prototype.hasTransition=function(){return this.video&&!this.video.paused},u}(Lt),Si=function(n){function u(a,p,y,M){n.call(this,a,p,y,M),p.coordinates?Array.isArray(p.coordinates)&&p.coordinates.length===4&&!p.coordinates.some(function(S){return!Array.isArray(S)||S.length!==2||S.some(function(j){return typeof j!="number"})})||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+a,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+a,null,'missing required property "coordinates"'))),p.animate&&typeof p.animate!="boolean"&&this.fire(new h.ErrorEvent(new h.ValidationError("sources."+a,null,'optional "animate" property must be a boolean value'))),p.canvas?typeof p.canvas=="string"||p.canvas instanceof h.window.HTMLCanvasElement||this.fire(new h.ErrorEvent(new h.ValidationError("sources."+a,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new h.ErrorEvent(new h.ValidationError("sources."+a,null,'missing required property "canvas"'))),this.options=p,this.animate=p.animate===void 0||p.animate}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.load=function(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof h.window.HTMLCanvasElement?this.options.canvas:h.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new h.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},u.prototype.getCanvas=function(){return this.canvas},u.prototype.onAdd=function(a){this.map=a,this.load(),this.canvas&&this.animate&&this.play()},u.prototype.onRemove=function(){this.pause()},u.prototype.prepare=function(){var a=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,a=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,a=!0),!this._hasInvalidDimensions()&&Object.keys(this.tiles).length!==0){var p=this.map.painter.context,y=p.gl;for(var M in this.boundsBuffer||(this.boundsBuffer=p.createVertexBuffer(this._boundsArray,it.members)),this.boundsSegments||(this.boundsSegments=h.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(a||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new h.Texture(p,this.canvas,y.RGBA,{premultiply:!0}),this.tiles){var S=this.tiles[M];S.state!=="loaded"&&(S.state="loaded",S.texture=this.texture)}}},u.prototype.serialize=function(){return{type:"canvas",coordinates:this.coordinates}},u.prototype.hasTransition=function(){return this._playing},u.prototype._hasInvalidDimensions=function(){for(var a=0,p=[this.canvas.width,this.canvas.height];a<p.length;a+=1){var y=p[a];if(isNaN(y)||y<=0)return!0}return!1},u}(Lt),ui={vector:gt,raster:Qe,"raster-dem":we,geojson:Ae,video:ei,image:Lt,canvas:Si};function ni(n,u){var a=h.identity([]);return h.translate(a,a,[1,1,0]),h.scale(a,a,[.5*n.width,.5*n.height,1]),h.multiply(a,a,n.calculatePosMatrix(u.toUnwrapped()))}function Bi(n,u,a,p,y,M){var S=function(Ge,Ce,Ne){if(Ge)for(var Je=0,lt=Ge;Je<lt.length;Je+=1){var yt=Ce[lt[Je]];if(yt&&yt.source===Ne&&yt.type==="fill-extrusion")return!0}else for(var _t in Ce){var St=Ce[_t];if(St.source===Ne&&St.type==="fill-extrusion")return!0}return!1}(y&&y.layers,u,n.id),j=M.maxPitchScaleFactor(),H=n.tilesIn(p,j,S);H.sort(Ci);for(var ie=[],_e=0,ye=H;_e<ye.length;_e+=1){var ge=ye[_e];ie.push({wrappedTileID:ge.tileID.wrapped().key,queryResults:ge.tile.queryRenderedFeatures(u,a,n._state,ge.queryGeometry,ge.cameraQueryGeometry,ge.scale,y,M,j,ni(n.transform,ge.tileID))})}var Ie=function(Ge){for(var Ce={},Ne={},Je=0,lt=Ge;Je<lt.length;Je+=1){var yt=lt[Je],_t=yt.queryResults,St=yt.wrappedTileID,zt=Ne[St]=Ne[St]||{};for(var Ht in _t)for(var Ut=_t[Ht],Xt=zt[Ht]=zt[Ht]||{},hi=Ce[Ht]=Ce[Ht]||[],Di=0,Li=Ut;Di<Li.length;Di+=1){var Ji=Li[Di];Xt[Ji.featureIndex]||(Xt[Ji.featureIndex]=!0,hi.push(Ji))}}return Ce}(ie);for(var Ee in Ie)Ie[Ee].forEach(function(Ge){var Ce=Ge.feature,Ne=n.getFeatureState(Ce.layer["source-layer"],Ce.id);Ce.source=Ce.layer.source,Ce.layer["source-layer"]&&(Ce.sourceLayer=Ce.layer["source-layer"]),Ce.state=Ne});return Ie}function Ci(n,u){var a=n.tileID,p=u.tileID;return a.overscaledZ-p.overscaledZ||a.canonical.y-p.canonical.y||a.wrap-p.wrap||a.canonical.x-p.canonical.x}var xt=function(n,u){this.max=n,this.onRemove=u,this.reset()};xt.prototype.reset=function(){for(var n in this.data)for(var u=0,a=this.data[n];u<a.length;u+=1){var p=a[u];p.timeout&&clearTimeout(p.timeout),this.onRemove(p.value)}return this.data={},this.order=[],this},xt.prototype.add=function(n,u,a){var p=this,y=n.wrapped().key;this.data[y]===void 0&&(this.data[y]=[]);var M={value:u,timeout:void 0};if(a!==void 0&&(M.timeout=setTimeout(function(){p.remove(n,M)},a)),this.data[y].push(M),this.order.push(y),this.order.length>this.max){var S=this._getAndRemoveByKey(this.order[0]);S&&this.onRemove(S)}return this},xt.prototype.has=function(n){return n.wrapped().key in this.data},xt.prototype.getAndRemove=function(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null},xt.prototype._getAndRemoveByKey=function(n){var u=this.data[n].shift();return u.timeout&&clearTimeout(u.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),u.value},xt.prototype.getByKey=function(n){var u=this.data[n];return u?u[0].value:null},xt.prototype.get=function(n){return this.has(n)?this.data[n.wrapped().key][0].value:null},xt.prototype.remove=function(n,u){if(!this.has(n))return this;var a=n.wrapped().key,p=u===void 0?0:this.data[a].indexOf(u),y=this.data[a][p];return this.data[a].splice(p,1),y.timeout&&clearTimeout(y.timeout),this.data[a].length===0&&delete this.data[a],this.onRemove(y.value),this.order.splice(this.order.indexOf(a),1),this},xt.prototype.setMaxSize=function(n){for(this.max=n;this.order.length>this.max;){var u=this._getAndRemoveByKey(this.order[0]);u&&this.onRemove(u)}return this},xt.prototype.filter=function(n){var u=[];for(var a in this.data)for(var p=0,y=this.data[a];p<y.length;p+=1){var M=y[p];n(M.value)||u.push(M)}for(var S=0,j=u;S<j.length;S+=1){var H=j[S];this.remove(H.value.tileID,H)}};var ze=function(n,u,a){this.context=n;var p=n.gl;this.buffer=p.createBuffer(),this.dynamicDraw=Boolean(a),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),p.bufferData(p.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer};ze.prototype.bind=function(){this.context.bindElementBuffer.set(this.buffer)},ze.prototype.updateData=function(n){var u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)},ze.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var oe={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"},de=function(n,u,a,p){this.length=u.length,this.attributes=a,this.itemSize=u.bytesPerElement,this.dynamicDraw=p,this.context=n;var y=n.gl;this.buffer=y.createBuffer(),n.bindVertexBuffer.set(this.buffer),y.bufferData(y.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer};de.prototype.bind=function(){this.context.bindVertexBuffer.set(this.buffer)},de.prototype.updateData=function(n){var u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)},de.prototype.enableAttributes=function(n,u){for(var a=0;a<this.attributes.length;a++){var p=u.attributes[this.attributes[a].name];p!==void 0&&n.enableVertexAttribArray(p)}},de.prototype.setVertexAttribPointers=function(n,u,a){for(var p=0;p<this.attributes.length;p++){var y=this.attributes[p],M=u.attributes[y.name];M!==void 0&&n.vertexAttribPointer(M,y.components,n[oe[y.type]],!1,this.itemSize,y.offset+this.itemSize*(a||0))}},de.prototype.destroy=function(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)};var Re=function(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1};Re.prototype.get=function(){return this.current},Re.prototype.set=function(n){},Re.prototype.getDefault=function(){return this.default},Re.prototype.setDefault=function(){this.set(this.default)};var He=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return h.Color.transparent},u.prototype.set=function(a){var p=this.current;(a.r!==p.r||a.g!==p.g||a.b!==p.b||a.a!==p.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},u}(Re),mt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return 1},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)},u}(Re),Ft=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return 0},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)},u}(Re),Gt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return[!0,!0,!0,!0]},u.prototype.set=function(a){var p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||a[3]!==p[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},u}(Re),Bt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!0},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)},u}(Re),Kt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return 255},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)},u}(Re),qt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return{func:this.gl.ALWAYS,ref:0,mask:255}},u.prototype.set=function(a){var p=this.current;(a.func!==p.func||a.ref!==p.ref||a.mask!==p.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)},u}(Re),fi=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){var a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]},u.prototype.set=function(a){var p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)},u}(Re),Ii=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;a?p.enable(p.STENCIL_TEST):p.disable(p.STENCIL_TEST),this.current=a,this.dirty=!1}},u}(Re),zi=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return[0,1]},u.prototype.set=function(a){var p=this.current;(a[0]!==p[0]||a[1]!==p[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)},u}(Re),Yt=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;a?p.enable(p.DEPTH_TEST):p.disable(p.DEPTH_TEST),this.current=a,this.dirty=!1}},u}(Re),ur=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.LESS},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)},u}(Re),yi=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;a?p.enable(p.BLEND):p.disable(p.BLEND),this.current=a,this.dirty=!1}},u}(Re),hr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){var a=this.gl;return[a.ONE,a.ZERO]},u.prototype.set=function(a){var p=this.current;(a[0]!==p[0]||a[1]!==p[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)},u}(Re),ir=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return h.Color.transparent},u.prototype.set=function(a){var p=this.current;(a.r!==p.r||a.g!==p.g||a.b!==p.b||a.a!==p.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)},u}(Re),zr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.FUNC_ADD},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)},u}(Re),rn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;a?p.enable(p.CULL_FACE):p.disable(p.CULL_FACE),this.current=a,this.dirty=!1}},u}(Re),Br=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.BACK},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)},u}(Re),nn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.CCW},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)},u}(Re),wn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.useProgram(a),this.current=a,this.dirty=!1)},u}(Re),Pn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return this.gl.TEXTURE0},u.prototype.set=function(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)},u}(Re),An=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){var a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]},u.prototype.set=function(a){var p=this.current;(a[0]!==p[0]||a[1]!==p[1]||a[2]!==p[2]||a[3]!==p[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)},u}(Re),Ni=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.bindFramebuffer(p.FRAMEBUFFER,a),this.current=a,this.dirty=!1}},u}(Re),wr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.bindRenderbuffer(p.RENDERBUFFER,a),this.current=a,this.dirty=!1}},u}(Re),mn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.bindTexture(p.TEXTURE_2D,a),this.current=a,this.dirty=!1}},u}(Re),ho=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.bindBuffer(p.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}},u}(Re),Cr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){var p=this.gl;p.bindBuffer(p.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1},u}(Re),Po=function(n){function u(a){n.call(this,a),this.vao=a.extVertexArrayObject}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u.prototype.set=function(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)},u}(Re),Gn=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return 4},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}},u}(Re),Xr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}},u}(Re),ln=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return!1},u.prototype.set=function(a){if(a!==this.current||this.dirty){var p=this.gl;p.pixelStorei(p.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}},u}(Re),co=function(n){function u(a,p){n.call(this,a),this.context=a,this.parent=p}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getDefault=function(){return null},u}(Re),Fr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.setDirty=function(){this.dirty=!0},u.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}},u}(co),$=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.set=function(a){if(a!==this.current||this.dirty){this.context.bindFramebuffer.set(this.parent);var p=this.gl;p.framebufferRenderbuffer(p.FRAMEBUFFER,p.DEPTH_ATTACHMENT,p.RENDERBUFFER,a),this.current=a,this.dirty=!1}},u}(co),le=function(n,u,a,p){this.context=n,this.width=u,this.height=a;var y=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new Fr(n,y),p&&(this.depthAttachment=new $(n,y))};le.prototype.destroy=function(){var n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){var a=this.depthAttachment.get();a&&n.deleteRenderbuffer(a)}n.deleteFramebuffer(this.framebuffer)};var ue=function(n,u,a){this.func=n,this.mask=u,this.range=a};ue.ReadOnly=!1,ue.ReadWrite=!0,ue.disabled=new ue(519,ue.ReadOnly,[0,1]);var be=function(n,u,a,p,y,M){this.test=n,this.ref=u,this.mask=a,this.fail=p,this.depthFail=y,this.pass=M};be.disabled=new be({func:519,mask:0},0,0,7680,7680,7680);var Oe=function(n,u,a){this.blendFunction=n,this.blendColor=u,this.mask=a};Oe.disabled=new Oe(Oe.Replace=[1,0],h.Color.transparent,[!1,!1,!1,!1]),Oe.unblended=new Oe(Oe.Replace,h.Color.transparent,[!0,!0,!0,!0]),Oe.alphaBlended=new Oe([1,771],h.Color.transparent,[!0,!0,!0,!0]);var je=function(n,u,a){this.enable=n,this.mode=u,this.frontFace=a};je.disabled=new je(!1,1029,2305),je.backCCW=new je(!0,1029,2305);var xe=function(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new He(this),this.clearDepth=new mt(this),this.clearStencil=new Ft(this),this.colorMask=new Gt(this),this.depthMask=new Bt(this),this.stencilMask=new Kt(this),this.stencilFunc=new qt(this),this.stencilOp=new fi(this),this.stencilTest=new Ii(this),this.depthRange=new zi(this),this.depthTest=new Yt(this),this.depthFunc=new ur(this),this.blend=new yi(this),this.blendFunc=new hr(this),this.blendColor=new ir(this),this.blendEquation=new zr(this),this.cullFace=new rn(this),this.cullFaceSide=new Br(this),this.frontFace=new nn(this),this.program=new wn(this),this.activeTexture=new Pn(this),this.viewport=new An(this),this.bindFramebuffer=new Ni(this),this.bindRenderbuffer=new wr(this),this.bindTexture=new mn(this),this.bindVertexBuffer=new ho(this),this.bindElementBuffer=new Cr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Po(this),this.pixelStoreUnpack=new Gn(this),this.pixelStoreUnpackPremultiplyAlpha=new Xr(this),this.pixelStoreUnpackFlipY=new ln(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)};xe.prototype.setDefault=function(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()},xe.prototype.setDirty=function(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0},xe.prototype.createIndexBuffer=function(n,u){return new ze(this,n,u)},xe.prototype.createVertexBuffer=function(n,u,a){return new de(this,n,u,a)},xe.prototype.createRenderbuffer=function(n,u,a){var p=this.gl,y=p.createRenderbuffer();return this.bindRenderbuffer.set(y),p.renderbufferStorage(p.RENDERBUFFER,n,u,a),this.bindRenderbuffer.set(null),y},xe.prototype.createFramebuffer=function(n,u,a){return new le(this,n,u,a)},xe.prototype.clear=function(n){var u=n.color,a=n.depth,p=this.gl,y=0;u&&(y|=p.COLOR_BUFFER_BIT,this.clearColor.set(u),this.colorMask.set([!0,!0,!0,!0])),a!==void 0&&(y|=p.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),p.clear(y)},xe.prototype.setCullFace=function(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))},xe.prototype.setDepthMode=function(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)},xe.prototype.setStencilMode=function(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)},xe.prototype.setColorMode=function(n){h.deepEqual(n.blendFunction,Oe.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)},xe.prototype.unbindVAO=function(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)};var Le=function(n){function u(a,p,y){var M=this;n.call(this),this.id=a,this.dispatcher=y,this.on("data",function(S){S.dataType==="source"&&S.sourceDataType==="metadata"&&(M._sourceLoaded=!0),M._sourceLoaded&&!M._paused&&S.dataType==="source"&&S.sourceDataType==="content"&&(M.reload(),M.transform&&M.update(M.transform))}),this.on("error",function(){M._sourceErrored=!0}),this._source=function(S,j,H,ie){var _e=new ui[j.type](S,j,H,ie);if(_e.id!==S)throw new Error("Expected Source id to be "+S+" instead of "+_e.id);return h.bindAll(["load","abort","unload","serialize","prepare"],_e),_e}(a,p,y,this),this._tiles={},this._cache=new xt(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new h.SourceFeatureState,this._hidden=!1}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.onAdd=function(a){this.map=a,this._maxTileCacheSize=a?a._maxTileCacheSize:null,this._source&&this._source.onAdd&&this._source.onAdd(a)},u.prototype.onRemove=function(a){this._source&&this._source.onRemove&&this._source.onRemove(a)},u.prototype.loaded=function(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(var a in this._tiles){var p=this._tiles[a];if(p.state!=="loaded"&&p.state!=="errored")return!1}return!0},u.prototype.getSource=function(){return this._source},u.prototype.hide=function(){this._hidden=!0},u.prototype.show=function(){if(this._hidden){var a=this._shouldReloadOnShow;this._hidden=!1,this._shouldReloadOnShow=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},u.prototype.pause=function(){this._paused=!0},u.prototype.resume=function(){if(this._paused){var a=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,a&&this.reload(),this.transform&&this.update(this.transform)}},u.prototype._loadTile=function(a,p){return this._source.loadTile(a,p)},u.prototype._unloadTile=function(a){if(this._source.unloadTile)return this._source.unloadTile(a,function(){})},u.prototype._abortTile=function(a){if(this._source.abortTile)return this._source.abortTile(a,function(){})},u.prototype.serialize=function(){return this._source.serialize()},u.prototype.prepare=function(a){for(var p in this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._tiles){var y=this._tiles[p];y.upload(a),y.prepare(this.map.style.imageManager)}},u.prototype.getIds=function(){return h.values(this._tiles).map(function(a){return a.tileID}).sort(tt).map(function(a){return a.key})},u.prototype.getRenderableIds=function(a){var p=this,y=[];for(var M in this._tiles)this._isIdRenderable(M,a)&&y.push(this._tiles[M]);return a?y.sort(function(S,j){var H=S.tileID,ie=j.tileID,_e=new h.Point(H.canonical.x,H.canonical.y)._rotate(p.transform.angle),ye=new h.Point(ie.canonical.x,ie.canonical.y)._rotate(p.transform.angle);return H.overscaledZ-ie.overscaledZ||ye.y-_e.y||ye.x-_e.x}).map(function(S){return S.tileID.key}):y.map(function(S){return S.tileID}).sort(tt).map(function(S){return S.key})},u.prototype.hasRenderableParent=function(a){var p=this.findLoadedParent(a,0);return!!p&&this._isIdRenderable(p.tileID.key)},u.prototype._isIdRenderable=function(a,p){return this._tiles[a]&&this._tiles[a].hasData()&&!this._coveredTiles[a]&&(p||!this._tiles[a].holdingForFade())},u.prototype.reload=function(){if(this._paused)this._shouldReloadOnResume=!0;else if(this._hidden)this._shouldReloadOnShow=!0;else for(var a in this._cache.reset(),this._tiles)this._tiles[a].state!=="errored"&&this._reloadTile(a,"reloading")},u.prototype._reloadTile=function(a,p){var y=this._tiles[a];y&&(y.state!=="loading"&&(y.state=p),this._loadTile(y,this._tileLoaded.bind(this,y,a,p)))},u.prototype._tileLoaded=function(a,p,y,M){if(M)return a.state="errored",void(M.status!==404?this._source.fire(new h.ErrorEvent(M,{tile:a})):this.update(this.transform));a.timeAdded=h.browser.now(),y==="expired"&&(a.refreshedUponExpiration=!0),this._setTileReloadTimer(p,a),this.getSource().type==="raster-dem"&&a.dem&&this._backfillDEM(a),this._state.initializeTileState(a,this.map?this.map.painter:null),this._source.fire(new h.Event("data",{dataType:"source",tile:a,coord:a.tileID}))},u.prototype._backfillDEM=function(a){for(var p=this.getRenderableIds(),y=0;y<p.length;y++){var M=p[y];if(a.neighboringTiles&&a.neighboringTiles[M]){var S=this.getTileByID(M);j(a,S),j(S,a)}}function j(H,ie){H.needsHillshadePrepare=!0;var _e=ie.tileID.canonical.x-H.tileID.canonical.x,ye=ie.tileID.canonical.y-H.tileID.canonical.y,ge=Math.pow(2,H.tileID.canonical.z),Ie=ie.tileID.key;_e===0&&ye===0||Math.abs(ye)>1||(Math.abs(_e)>1&&(Math.abs(_e+ge)===1?_e+=ge:Math.abs(_e-ge)===1&&(_e-=ge)),ie.dem&&H.dem&&(H.dem.backfillBorder(ie.dem,_e,ye),H.neighboringTiles&&H.neighboringTiles[Ie]&&(H.neighboringTiles[Ie].backfilled=!0)))}},u.prototype.getTile=function(a){return this.getTileByID(a.key)},u.prototype.getTileByID=function(a){return this._tiles[a]},u.prototype._retainLoadedChildren=function(a,p,y,M){for(var S in this._tiles){var j=this._tiles[S];if(!(M[S]||!j.hasData()||j.tileID.overscaledZ<=p||j.tileID.overscaledZ>y)){for(var H=j.tileID;j&&j.tileID.overscaledZ>p+1;){var ie=j.tileID.scaledTo(j.tileID.overscaledZ-1);(j=this._tiles[ie.key])&&j.hasData()&&(H=ie)}for(var _e=H;_e.overscaledZ>p;)if(a[(_e=_e.scaledTo(_e.overscaledZ-1)).key]){M[H.key]=H;break}}}},u.prototype.findLoadedParent=function(a,p){if(a.key in this._loadedParentTiles){var y=this._loadedParentTiles[a.key];return y&&y.tileID.overscaledZ>=p?y:null}for(var M=a.overscaledZ-1;M>=p;M--){var S=a.scaledTo(M),j=this._getLoadedTile(S);if(j)return j}},u.prototype._getLoadedTile=function(a){var p=this._tiles[a.key];return p&&p.hasData()?p:this._cache.getByKey(a.wrapped().key)},u.prototype.updateCacheSize=function(a){var p=Math.ceil(a.width/this._source.tileSize)+1,y=Math.ceil(a.height/this._source.tileSize)+1,M=Math.floor(p*y*5),S=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,M):M;this._cache.setMaxSize(S)},u.prototype.handleWrapJump=function(a){var p=Math.round((a-(this._prevLng===void 0?a:this._prevLng))/360);if(this._prevLng=a,p){var y={};for(var M in this._tiles){var S=this._tiles[M];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+p),y[S.tileID.key]=S}for(var j in this._tiles=y,this._timers)clearTimeout(this._timers[j]),delete this._timers[j];for(var H in this._tiles)this._setTileReloadTimer(H,this._tiles[H])}},u.prototype.update=function(a){var p=this;if(this.transform=a,this._sourceLoaded&&!this._paused&&!this._hidden){var y;this.updateCacheSize(a),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used?this._source.tileID?y=a.getVisibleUnwrappedCoordinates(this._source.tileID).map(function(zt){return new h.OverscaledTileID(zt.canonical.z,zt.wrap,zt.canonical.z,zt.canonical.x,zt.canonical.y)}):(y=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}),this._source.hasTile&&(y=y.filter(function(zt){return p._source.hasTile(zt)}))):y=[];var M=a.coveringZoomLevel(this._source),S=Math.max(M-u.maxOverzooming,this._source.minzoom),j=Math.max(M+u.maxUnderzooming,this._source.minzoom),H=this._updateRetainedTiles(y,M);if(rt(this._source.type)){for(var ie={},_e={},ye=0,ge=Object.keys(H);ye<ge.length;ye+=1){var Ie=ge[ye],Ee=H[Ie],Ge=this._tiles[Ie];if(Ge&&!(Ge.fadeEndTime&&Ge.fadeEndTime<=h.browser.now())){var Ce=this.findLoadedParent(Ee,S);Ce&&(this._addTile(Ce.tileID),ie[Ce.tileID.key]=Ce.tileID),_e[Ie]=Ee}}for(var Ne in this._retainLoadedChildren(_e,M,j,H),ie)H[Ne]||(this._coveredTiles[Ne]=!0,H[Ne]=ie[Ne])}for(var Je in H)this._tiles[Je].clearFadeHold();for(var lt=0,yt=h.keysDifference(this._tiles,H);lt<yt.length;lt+=1){var _t=yt[lt],St=this._tiles[_t];St.hasSymbolBuckets&&!St.holdingForFade()?St.setHoldDuration(this.map._fadeDuration):St.hasSymbolBuckets&&!St.symbolFadeFinished()||this._removeTile(_t)}this._updateLoadedParentTileCache()}},u.prototype.releaseSymbolFadeTiles=function(){for(var a in this._tiles)this._tiles[a].holdingForFade()&&this._removeTile(a)},u.prototype._updateRetainedTiles=function(a,p){for(var y={},M={},S=Math.max(p-u.maxOverzooming,this._source.minzoom),j=Math.max(p+u.maxUnderzooming,this._source.minzoom),H={},ie=0,_e=a;ie<_e.length;ie+=1){var ye=_e[ie],ge=this._addTile(ye);y[ye.key]=ye,ge.hasData()||p<this._source.maxzoom&&(H[ye.key]=ye)}this._retainLoadedChildren(H,p,j,y);for(var Ie=0,Ee=a;Ie<Ee.length;Ie+=1){var Ge=Ee[Ie],Ce=this._tiles[Ge.key];if(!Ce.hasData()){if(p+1>this._source.maxzoom){var Ne=Ge.children(this._source.maxzoom)[0],Je=this.getTile(Ne);if(Je&&Je.hasData()){y[Ne.key]=Ne;continue}}else{var lt=Ge.children(this._source.maxzoom);if(y[lt[0].key]&&y[lt[1].key]&&y[lt[2].key]&&y[lt[3].key])continue}for(var yt=Ce.wasRequested(),_t=Ge.overscaledZ-1;_t>=S;--_t){var St=Ge.scaledTo(_t);if(M[St.key]||(M[St.key]=!0,!(Ce=this.getTile(St))&&yt&&(Ce=this._addTile(St)),Ce&&(y[St.key]=St,yt=Ce.wasRequested(),Ce.hasData())))break}}}return y},u.prototype._updateLoadedParentTileCache=function(){for(var a in this._loadedParentTiles={},this._tiles){for(var p=[],y=void 0,M=this._tiles[a].tileID;M.overscaledZ>0;){if(M.key in this._loadedParentTiles){y=this._loadedParentTiles[M.key];break}p.push(M.key);var S=M.scaledTo(M.overscaledZ-1);if(y=this._getLoadedTile(S))break;M=S}for(var j=0,H=p;j<H.length;j+=1)this._loadedParentTiles[H[j]]=y}},u.prototype._addTile=function(a){var p=this._tiles[a.key];if(p)return p;(p=this._cache.getAndRemove(a))&&(this._setTileReloadTimer(a.key,p),p.tileID=a,this._state.initializeTileState(p,this.map?this.map.painter:null),this._cacheTimers[a.key]&&(clearTimeout(this._cacheTimers[a.key]),delete this._cacheTimers[a.key],this._setTileReloadTimer(a.key,p)));var y=Boolean(p);return y||(p=new h.Tile(a,this._source.tileSize*a.overscaleFactor()),this._loadTile(p,this._tileLoaded.bind(this,p,a.key,p.state))),p?(p.uses++,this._tiles[a.key]=p,y||this._source.fire(new h.Event("dataloading",{tile:p,coord:p.tileID,dataType:"source"})),p):null},u.prototype._setTileReloadTimer=function(a,p){var y=this;a in this._timers&&(clearTimeout(this._timers[a]),delete this._timers[a]);var M=p.getExpiryTimeout();M&&(this._timers[a]=setTimeout(function(){y._reloadTile(a,"expired"),delete y._timers[a]},M))},u.prototype._removeTile=function(a){var p=this._tiles[a];p&&(p.uses--,delete this._tiles[a],this._timers[a]&&(clearTimeout(this._timers[a]),delete this._timers[a]),p.uses>0||(p.hasData()&&p.state!=="reloading"?this._cache.add(p.tileID,p,p.getExpiryTimeout()):(p.aborted=!0,this._abortTile(p),this._unloadTile(p))))},u.prototype.clearTiles=function(){for(var a in this._shouldReloadOnResume=!1,this._shouldReloadOnShow=!1,this._paused=!1,this._tiles)this._removeTile(a);this._cache.reset()},u.prototype.tilesIn=function(a,p,y){var M=this,S=[],j=this.transform;if(!j)return S;for(var H=y?j.getCameraQueryGeometry(a):a,ie=a.map(function(_t){return j.pointCoordinate(_t)}),_e=H.map(function(_t){return j.pointCoordinate(_t)}),ye=this.getIds(),ge=1/0,Ie=1/0,Ee=-1/0,Ge=-1/0,Ce=0,Ne=_e;Ce<Ne.length;Ce+=1){var Je=Ne[Ce];ge=Math.min(ge,Je.x),Ie=Math.min(Ie,Je.y),Ee=Math.max(Ee,Je.x),Ge=Math.max(Ge,Je.y)}for(var lt=function(_t){var St=M._tiles[ye[_t]];if(!St.holdingForFade()){var zt=St.tileID,Ht=Math.pow(2,j.zoom-St.tileID.overscaledZ),Ut=p*St.queryPadding*h.EXTENT/St.tileSize/Ht,Xt=[zt.getTilePoint(new h.MercatorCoordinate(ge,Ie)),zt.getTilePoint(new h.MercatorCoordinate(Ee,Ge))];if(Xt[0].x-Ut<h.EXTENT&&Xt[0].y-Ut<h.EXTENT&&Xt[1].x+Ut>=0&&Xt[1].y+Ut>=0){var hi=ie.map(function(Li){return zt.getTilePoint(Li)}),Di=_e.map(function(Li){return zt.getTilePoint(Li)});S.push({tile:St,tileID:zt,queryGeometry:hi,cameraQueryGeometry:Di,scale:Ht})}}},yt=0;yt<ye.length;yt++)lt(yt);return S},u.prototype.getVisibleCoordinates=function(a){for(var p=this,y=this.getRenderableIds(a).map(function(H){return p._tiles[H].tileID}),M=0,S=y;M<S.length;M+=1){var j=S[M];j.posMatrix=this.transform.calculatePosMatrix(j.toUnwrapped())}return y},u.prototype.hasTransition=function(){if(this._source.hasTransition())return!0;if(rt(this._source.type))for(var a in this._tiles){var p=this._tiles[a];if(p.fadeEndTime!==void 0&&p.fadeEndTime>=h.browser.now())return!0}return!1},u.prototype.setFeatureState=function(a,p,y){this._state.updateState(a=a||"_geojsonTileLayer",p,y)},u.prototype.removeFeatureState=function(a,p,y){this._state.removeFeatureState(a=a||"_geojsonTileLayer",p,y)},u.prototype.getFeatureState=function(a,p){return this._state.getState(a=a||"_geojsonTileLayer",p)},u.prototype.setDependencies=function(a,p,y){var M=this._tiles[a];M&&M.setDependencies(p,y)},u.prototype.reloadTilesForDependencies=function(a,p){for(var y in this._tiles)this._tiles[y].hasDependency(a,p)&&this._reloadTile(y,"reloading");this._cache.filter(function(M){return!M.hasDependency(a,p)})},u}(h.Evented);function tt(n,u){var a=Math.abs(2*n.wrap)-+(n.wrap<0),p=Math.abs(2*u.wrap)-+(u.wrap<0);return n.overscaledZ-u.overscaledZ||p-a||u.canonical.y-n.canonical.y||u.canonical.x-n.canonical.x}function rt(n){return n==="raster"||n==="image"||n==="video"}function Mt(){return new h.window.Worker(rl.workerUrl)}Le.maxOverzooming=10,Le.maxUnderzooming=3;var Wt="mapboxgl_preloaded_worker_pool",ft=function(){this.active={}};ft.prototype.acquire=function(n){if(!this.workers)for(this.workers=[];this.workers.length<ft.workerCount;)this.workers.push(new Mt);return this.active[n]=!0,this.workers.slice()},ft.prototype.release=function(n){delete this.active[n],this.numActive()===0&&(this.workers.forEach(function(u){u.terminate()}),this.workers=null)},ft.prototype.isPreloaded=function(){return!!this.active[Wt]},ft.prototype.numActive=function(){return Object.keys(this.active).length};var Dt,ai=Math.floor(h.browser.hardwareConcurrency/2);function dt(){return Dt||(Dt=new ft),Dt}function Zt(n,u){var a={};for(var p in n)p!=="ref"&&(a[p]=n[p]);return h.refProperties.forEach(function(y){y in u&&(a[y]=u[y])}),a}function ii(n){n=n.slice();for(var u=Object.create(null),a=0;a<n.length;a++)u[n[a].id]=n[a];for(var p=0;p<n.length;p++)"ref"in n[p]&&(n[p]=Zt(n[p],u[n[p].ref]));return n}ft.workerCount=Math.max(Math.min(ai,6),1);var ri={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function ki(n,u,a){a.push({command:ri.addSource,args:[n,u[n]]})}function si(n,u,a){u.push({command:ri.removeSource,args:[n]}),a[n]=!0}function Gi(n,u,a,p){si(n,a,p),ki(n,u,a)}function $i(n,u,a){var p;for(p in n[a])if(n[a].hasOwnProperty(p)&&p!=="data"&&!h.deepEqual(n[a][p],u[a][p]))return!1;for(p in u[a])if(u[a].hasOwnProperty(p)&&p!=="data"&&!h.deepEqual(n[a][p],u[a][p]))return!1;return!0}function dr(n,u,a,p,y,M){var S;for(S in u=u||{},n=n||{})n.hasOwnProperty(S)&&(h.deepEqual(n[S],u[S])||a.push({command:M,args:[p,S,u[S],y]}));for(S in u)u.hasOwnProperty(S)&&!n.hasOwnProperty(S)&&(h.deepEqual(n[S],u[S])||a.push({command:M,args:[p,S,u[S],y]}))}function Vi(n){return n.id}function Ki(n,u){return n[u.id]=u,n}var un=function(n,u){this.reset(n,u)};un.prototype.reset=function(n,u){this.points=n||[],this._distances=[0];for(var a=1;a<this.points.length;a++)this._distances[a]=this._distances[a-1]+this.points[a].dist(this.points[a-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding},un.prototype.lerp=function(n){if(this.points.length===1)return this.points[0];n=h.clamp(n,0,1);for(var u=1,a=this._distances[u],p=n*this.paddedLength+this.padding;a<p&&u<this._distances.length;)a=this._distances[++u];var y=u-1,M=this._distances[y],S=a-M,j=S>0?(p-M)/S:0;return this.points[y].mult(1-j).add(this.points[u].mult(j))};var _r=function(n,u,a){var p=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/a),this.yCellCount=Math.ceil(u/a);for(var M=0;M<this.xCellCount*this.yCellCount;M++)p.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0};function hn(n,u,a,p,y){var M=h.create();return u?(h.scale(M,M,[1/y,1/y,1]),a||h.rotateZ(M,M,p.angle)):h.multiply(M,p.labelPlaneMatrix,n),M}function jr(n,u,a,p,y){if(u){var M=h.clone(n);return h.scale(M,M,[y,y,1]),a||h.rotateZ(M,M,-p.angle),M}return p.glCoordMatrix}function cr(n,u){var a=[n.x,n.y,0,1];Ur(a,a,u);var p=a[3];return{point:new h.Point(a[0]/p,a[1]/p),signedDistanceFromCamera:p}}function Ei(n,u){return .5+n/u*.5}function Dn(n,u){var a=n[0]/n[3],p=n[1]/n[3];return a>=-u[0]&&a<=u[0]&&p>=-u[1]&&p<=u[1]}function Rn(n,u,a,p,y,M,S,j){var H=p?n.textSizeData:n.iconSizeData,ie=h.evaluateSizeForZoom(H,a.transform.zoom),_e=[256/a.width*2+1,256/a.height*2+1],ye=p?n.text.dynamicLayoutVertexArray:n.icon.dynamicLayoutVertexArray;ye.clear();for(var ge=n.lineVertexArray,Ie=p?n.text.placedSymbolArray:n.icon.placedSymbolArray,Ee=a.transform.width/a.transform.height,Ge=!1,Ce=0;Ce<Ie.length;Ce++){var Ne=Ie.get(Ce);if(Ne.hidden||Ne.writingMode===h.WritingMode.vertical&&!Ge)gn(Ne.numGlyphs,ye);else{Ge=!1;var Je=[Ne.anchorX,Ne.anchorY,0,1];if(h.transformMat4(Je,Je,u),Dn(Je,_e)){var lt=Ei(a.transform.cameraToCenterDistance,Je[3]),yt=h.evaluateSizeForFeature(H,ie,Ne),_t=S?yt/lt:yt*lt,St=new h.Point(Ne.anchorX,Ne.anchorY),zt=cr(St,y).point,Ht={},Ut=ja(Ne,_t,!1,j,u,y,M,n.glyphOffsetArray,ge,ye,zt,St,Ht,Ee);Ge=Ut.useVertical,(Ut.notEnoughRoom||Ge||Ut.needsFlipping&&ja(Ne,_t,!0,j,u,y,M,n.glyphOffsetArray,ge,ye,zt,St,Ht,Ee).notEnoughRoom)&&gn(Ne.numGlyphs,ye)}else gn(Ne.numGlyphs,ye)}}p?n.text.dynamicLayoutVertexBuffer.updateData(ye):n.icon.dynamicLayoutVertexBuffer.updateData(ye)}function Hr(n,u,a,p,y,M,S,j,H,ie,_e){var ye=j.glyphStartIndex+j.numGlyphs,ge=j.lineStartIndex,Ie=j.lineStartIndex+j.lineLength,Ee=u.getoffsetX(j.glyphStartIndex),Ge=u.getoffsetX(ye-1),Ce=gr(n*Ee,a,p,y,M,S,j.segment,ge,Ie,H,ie,_e);if(!Ce)return null;var Ne=gr(n*Ge,a,p,y,M,S,j.segment,ge,Ie,H,ie,_e);return Ne?{first:Ce,last:Ne}:null}function Ln(n,u,a,p){return n===h.WritingMode.horizontal&&Math.abs(a.y-u.y)>Math.abs(a.x-u.x)*p?{useVertical:!0}:(n===h.WritingMode.vertical?u.y<a.y:u.x>a.x)?{needsFlipping:!0}:null}function ja(n,u,a,p,y,M,S,j,H,ie,_e,ye,ge,Ie){var Ee,Ge=u/24,Ce=n.lineOffsetX*Ge,Ne=n.lineOffsetY*Ge;if(n.numGlyphs>1){var Je=n.glyphStartIndex+n.numGlyphs,lt=n.lineStartIndex,yt=n.lineStartIndex+n.lineLength,_t=Hr(Ge,j,Ce,Ne,a,_e,ye,n,H,M,ge);if(!_t)return{notEnoughRoom:!0};var St=cr(_t.first.point,S).point,zt=cr(_t.last.point,S).point;if(p&&!a){var Ht=Ln(n.writingMode,St,zt,Ie);if(Ht)return Ht}Ee=[_t.first];for(var Ut=n.glyphStartIndex+1;Ut<Je-1;Ut++)Ee.push(gr(Ge*j.getoffsetX(Ut),Ce,Ne,a,_e,ye,n.segment,lt,yt,H,M,ge));Ee.push(_t.last)}else{if(p&&!a){var Xt=cr(ye,y).point,hi=n.lineStartIndex+n.segment+1,Di=new h.Point(H.getx(hi),H.gety(hi)),Li=cr(Di,y),Ji=Li.signedDistanceFromCamera>0?Li.point:Ta(ye,Di,Xt,1,y),mi=Ln(n.writingMode,Xt,Ji,Ie);if(mi)return mi}var sr=gr(Ge*j.getoffsetX(n.glyphStartIndex),Ce,Ne,a,_e,ye,n.segment,n.lineStartIndex,n.lineStartIndex+n.lineLength,H,M,ge);if(!sr)return{notEnoughRoom:!0};Ee=[sr]}for(var mr=0,lr=Ee;mr<lr.length;mr+=1){var Xi=lr[mr];h.addDynamicAttributes(ie,Xi.point,Xi.angle)}return{}}function Ta(n,u,a,p,y){var M=cr(n.add(n.sub(u)._unit()),y).point,S=a.sub(M);return a.add(S._mult(p/S.mag()))}function gr(n,u,a,p,y,M,S,j,H,ie,_e,ye){var ge=p?n-u:n+u,Ie=ge>0?1:-1,Ee=0;p&&(Ie*=-1,Ee=Math.PI),Ie<0&&(Ee+=Math.PI);for(var Ge=Ie>0?j+S:j+S+1,Ce=y,Ne=y,Je=0,lt=0,yt=Math.abs(ge),_t=[];Je+lt<=yt;){if((Ge+=Ie)<j||Ge>=H)return null;if(Ne=Ce,_t.push(Ce),(Ce=ye[Ge])===void 0){var St=new h.Point(ie.getx(Ge),ie.gety(Ge)),zt=cr(St,_e);if(zt.signedDistanceFromCamera>0)Ce=ye[Ge]=zt.point;else{var Ht=Ge-Ie;Ce=Ta(Je===0?M:new h.Point(ie.getx(Ht),ie.gety(Ht)),St,Ne,yt-Je+1,_e)}}Je+=lt,lt=Ne.dist(Ce)}var Ut=(yt-Je)/lt,Xt=Ce.sub(Ne),hi=Xt.mult(Ut)._add(Ne);hi._add(Xt._unit()._perp()._mult(a*Ie));var Di=Ee+Math.atan2(Ce.y-Ne.y,Ce.x-Ne.x);return _t.push(hi),{point:hi,angle:Di,path:_t}}_r.prototype.keysLength=function(){return this.boxKeys.length+this.circleKeys.length},_r.prototype.insert=function(n,u,a,p,y){this._forEachCell(u,a,p,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(y)},_r.prototype.insertCircle=function(n,u,a,p){this._forEachCell(u-p,a-p,u+p,a+p,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(a),this.circles.push(p)},_r.prototype._insertBoxCell=function(n,u,a,p,y,M){this.boxCells[y].push(M)},_r.prototype._insertCircleCell=function(n,u,a,p,y,M){this.circleCells[y].push(M)},_r.prototype._query=function(n,u,a,p,y,M){if(a<0||n>this.width||p<0||u>this.height)return!y&&[];var S=[];if(n<=0&&u<=0&&this.width<=a&&this.height<=p){if(y)return!0;for(var j=0;j<this.boxKeys.length;j++)S.push({key:this.boxKeys[j],x1:this.bboxes[4*j],y1:this.bboxes[4*j+1],x2:this.bboxes[4*j+2],y2:this.bboxes[4*j+3]});for(var H=0;H<this.circleKeys.length;H++){var ie=this.circles[3*H],_e=this.circles[3*H+1],ye=this.circles[3*H+2];S.push({key:this.circleKeys[H],x1:ie-ye,y1:_e-ye,x2:ie+ye,y2:_e+ye})}return M?S.filter(M):S}return this._forEachCell(n,u,a,p,this._queryCell,S,{hitTest:y,seenUids:{box:{},circle:{}}},M),y?S.length>0:S},_r.prototype._queryCircle=function(n,u,a,p,y){var M=n-a,S=n+a,j=u-a,H=u+a;if(S<0||M>this.width||H<0||j>this.height)return!p&&[];var ie=[];return this._forEachCell(M,j,S,H,this._queryCellCircle,ie,{hitTest:p,circle:{x:n,y:u,radius:a},seenUids:{box:{},circle:{}}},y),p?ie.length>0:ie},_r.prototype.query=function(n,u,a,p,y){return this._query(n,u,a,p,!1,y)},_r.prototype.hitTest=function(n,u,a,p,y){return this._query(n,u,a,p,!0,y)},_r.prototype.hitTestCircle=function(n,u,a,p){return this._queryCircle(n,u,a,!0,p)},_r.prototype._queryCell=function(n,u,a,p,y,M,S,j){var H=S.seenUids,ie=this.boxCells[y];if(ie!==null)for(var _e=this.bboxes,ye=0,ge=ie;ye<ge.length;ye+=1){var Ie=ge[ye];if(!H.box[Ie]){H.box[Ie]=!0;var Ee=4*Ie;if(n<=_e[Ee+2]&&u<=_e[Ee+3]&&a>=_e[Ee+0]&&p>=_e[Ee+1]&&(!j||j(this.boxKeys[Ie]))){if(S.hitTest)return M.push(!0),!0;M.push({key:this.boxKeys[Ie],x1:_e[Ee],y1:_e[Ee+1],x2:_e[Ee+2],y2:_e[Ee+3]})}}}var Ge=this.circleCells[y];if(Ge!==null)for(var Ce=this.circles,Ne=0,Je=Ge;Ne<Je.length;Ne+=1){var lt=Je[Ne];if(!H.circle[lt]){H.circle[lt]=!0;var yt=3*lt;if(this._circleAndRectCollide(Ce[yt],Ce[yt+1],Ce[yt+2],n,u,a,p)&&(!j||j(this.circleKeys[lt]))){if(S.hitTest)return M.push(!0),!0;var _t=Ce[yt],St=Ce[yt+1],zt=Ce[yt+2];M.push({key:this.circleKeys[lt],x1:_t-zt,y1:St-zt,x2:_t+zt,y2:St+zt})}}}},_r.prototype._queryCellCircle=function(n,u,a,p,y,M,S,j){var H=S.circle,ie=S.seenUids,_e=this.boxCells[y];if(_e!==null)for(var ye=this.bboxes,ge=0,Ie=_e;ge<Ie.length;ge+=1){var Ee=Ie[ge];if(!ie.box[Ee]){ie.box[Ee]=!0;var Ge=4*Ee;if(this._circleAndRectCollide(H.x,H.y,H.radius,ye[Ge+0],ye[Ge+1],ye[Ge+2],ye[Ge+3])&&(!j||j(this.boxKeys[Ee])))return M.push(!0),!0}}var Ce=this.circleCells[y];if(Ce!==null)for(var Ne=this.circles,Je=0,lt=Ce;Je<lt.length;Je+=1){var yt=lt[Je];if(!ie.circle[yt]){ie.circle[yt]=!0;var _t=3*yt;if(this._circlesCollide(Ne[_t],Ne[_t+1],Ne[_t+2],H.x,H.y,H.radius)&&(!j||j(this.circleKeys[yt])))return M.push(!0),!0}}},_r.prototype._forEachCell=function(n,u,a,p,y,M,S,j){for(var H=this._convertToXCellCoord(n),ie=this._convertToYCellCoord(u),_e=this._convertToXCellCoord(a),ye=this._convertToYCellCoord(p),ge=H;ge<=_e;ge++)for(var Ie=ie;Ie<=ye;Ie++)if(y.call(this,n,u,a,p,this.xCellCount*Ie+ge,M,S,j))return},_r.prototype._convertToXCellCoord=function(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))},_r.prototype._convertToYCellCoord=function(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))},_r.prototype._circlesCollide=function(n,u,a,p,y,M){var S=p-n,j=y-u,H=a+M;return H*H>S*S+j*j},_r.prototype._circleAndRectCollide=function(n,u,a,p,y,M,S){var j=(M-p)/2,H=Math.abs(n-(p+j));if(H>j+a)return!1;var ie=(S-y)/2,_e=Math.abs(u-(y+ie));if(_e>ie+a)return!1;if(H<=j||_e<=ie)return!0;var ye=H-j,ge=_e-ie;return ye*ye+ge*ge<=a*a};var jo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function gn(n,u){for(var a=0;a<n;a++){var p=u.length;u.resize(p+4),u.float32.set(jo,3*p)}}function Ur(n,u,a){var p=u[0],y=u[1];return n[0]=a[0]*p+a[4]*y+a[12],n[1]=a[1]*p+a[5]*y+a[13],n[3]=a[3]*p+a[7]*y+a[15],n}var cn=function(n,u,a){u===void 0&&(u=new _r(n.width+200,n.height+200,25)),a===void 0&&(a=new _r(n.width+200,n.height+200,25)),this.transform=n,this.grid=u,this.ignoredGrid=a,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+100,this.screenBottomBoundary=n.height+100,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200};function Ir(n,u,a){return u*(h.EXTENT/(n.tileSize*Math.pow(2,a-n.tileID.overscaledZ)))}cn.prototype.placeCollisionBox=function(n,u,a,p,y){var M=this.projectAndGetPerspectiveRatio(p,n.anchorPointX,n.anchorPointY),S=a*M.perspectiveRatio,j=n.x1*S+M.point.x,H=n.y1*S+M.point.y,ie=n.x2*S+M.point.x,_e=n.y2*S+M.point.y;return!this.isInsideGrid(j,H,ie,_e)||!u&&this.grid.hitTest(j,H,ie,_e,y)?{box:[],offscreen:!1}:{box:[j,H,ie,_e],offscreen:this.isOffscreen(j,H,ie,_e)}},cn.prototype.placeCollisionCircles=function(n,u,a,p,y,M,S,j,H,ie,_e,ye,ge){var Ie=[],Ee=new h.Point(u.anchorX,u.anchorY),Ge=cr(Ee,M),Ce=Ei(this.transform.cameraToCenterDistance,Ge.signedDistanceFromCamera),Ne=(ie?y/Ce:y*Ce)/h.ONE_EM,Je=cr(Ee,S).point,lt=Hr(Ne,p,u.lineOffsetX*Ne,u.lineOffsetY*Ne,!1,Je,Ee,u,a,S,{}),yt=!1,_t=!1,St=!0;if(lt){for(var zt=.5*ye*Ce+ge,Ht=new h.Point(-100,-100),Ut=new h.Point(this.screenRightBoundary,this.screenBottomBoundary),Xt=new un,hi=lt.first,Di=lt.last,Li=[],Ji=hi.path.length-1;Ji>=1;Ji--)Li.push(hi.path[Ji]);for(var mi=1;mi<Di.path.length;mi++)Li.push(Di.path[mi]);var sr=2.5*zt;if(j){var mr=Li.map(function(Zo){return cr(Zo,j)});Li=mr.some(function(Zo){return Zo.signedDistanceFromCamera<=0})?[]:mr.map(function(Zo){return Zo.point})}var lr=[];if(Li.length>0){for(var Xi=Li[0].clone(),Pr=Li[0].clone(),qi=1;qi<Li.length;qi++)Xi.x=Math.min(Xi.x,Li[qi].x),Xi.y=Math.min(Xi.y,Li[qi].y),Pr.x=Math.max(Pr.x,Li[qi].x),Pr.y=Math.max(Pr.y,Li[qi].y);lr=Xi.x>=Ht.x&&Pr.x<=Ut.x&&Xi.y>=Ht.y&&Pr.y<=Ut.y?[Li]:Pr.x<Ht.x||Xi.x>Ut.x||Pr.y<Ht.y||Xi.y>Ut.y?[]:h.clipLine([Li],Ht.x,Ht.y,Ut.x,Ut.y)}for(var er=0,Yn=lr;er<Yn.length;er+=1){var an;Xt.reset(Yn[er],.25*zt),an=Xt.length<=.5*zt?1:Math.ceil(Xt.paddedLength/sr)+1;for(var zo=0;zo<an;zo++){var Tn=zo/Math.max(an-1,1),Qn=Xt.lerp(Tn),$n=Qn.x+100,ha=Qn.y+100;Ie.push($n,ha,zt,0);var es=$n-zt,Bo=ha-zt,Mo=$n+zt,Fo=ha+zt;if(St=St&&this.isOffscreen(es,Bo,Mo,Fo),_t=_t||this.isInsideGrid(es,Bo,Mo,Fo),!n&&this.grid.hitTestCircle($n,ha,zt,_e)&&(yt=!0,!H))return{circles:[],offscreen:!1,collisionDetected:yt}}}}return{circles:!H&&yt||!_t?[]:Ie,offscreen:St,collisionDetected:yt}},cn.prototype.queryRenderedSymbols=function(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};for(var u=[],a=1/0,p=1/0,y=-1/0,M=-1/0,S=0,j=n;S<j.length;S+=1){var H=j[S],ie=new h.Point(H.x+100,H.y+100);a=Math.min(a,ie.x),p=Math.min(p,ie.y),y=Math.max(y,ie.x),M=Math.max(M,ie.y),u.push(ie)}for(var _e={},ye={},ge=0,Ie=this.grid.query(a,p,y,M).concat(this.ignoredGrid.query(a,p,y,M));ge<Ie.length;ge+=1){var Ee=Ie[ge],Ge=Ee.key;if(_e[Ge.bucketInstanceId]===void 0&&(_e[Ge.bucketInstanceId]={}),!_e[Ge.bucketInstanceId][Ge.featureIndex]){var Ce=[new h.Point(Ee.x1,Ee.y1),new h.Point(Ee.x2,Ee.y1),new h.Point(Ee.x2,Ee.y2),new h.Point(Ee.x1,Ee.y2)];h.polygonIntersectsPolygon(u,Ce)&&(_e[Ge.bucketInstanceId][Ge.featureIndex]=!0,ye[Ge.bucketInstanceId]===void 0&&(ye[Ge.bucketInstanceId]=[]),ye[Ge.bucketInstanceId].push(Ge.featureIndex))}}return ye},cn.prototype.insertCollisionBox=function(n,u,a,p,y){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:a,featureIndex:p,collisionGroupID:y},n[0],n[1],n[2],n[3])},cn.prototype.insertCollisionCircles=function(n,u,a,p,y){for(var M=u?this.ignoredGrid:this.grid,S={bucketInstanceId:a,featureIndex:p,collisionGroupID:y},j=0;j<n.length;j+=4)M.insertCircle(S,n[j],n[j+1],n[j+2])},cn.prototype.projectAndGetPerspectiveRatio=function(n,u,a){var p=[u,a,0,1];return Ur(p,p,n),{point:new h.Point((p[0]/p[3]+1)/2*this.transform.width+100,(-p[1]/p[3]+1)/2*this.transform.height+100),perspectiveRatio:.5+this.transform.cameraToCenterDistance/p[3]*.5}},cn.prototype.isOffscreen=function(n,u,a,p){return a<100||n>=this.screenRightBoundary||p<100||u>this.screenBottomBoundary},cn.prototype.isInsideGrid=function(n,u,a,p){return a>=0&&n<this.gridRightBoundary&&p>=0&&u<this.gridBottomBoundary},cn.prototype.getViewportMatrix=function(){var n=h.identity([]);return h.translate(n,n,[-100,-100,0]),n};var Wn=function(n,u,a,p){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):p&&a?1:0,this.placed=a};Wn.prototype.isHidden=function(){return this.opacity===0&&!this.placed};var yn=function(n,u,a,p,y){this.text=new Wn(n?n.text:null,u,a,y),this.icon=new Wn(n?n.icon:null,u,p,y)};yn.prototype.isHidden=function(){return this.text.isHidden()&&this.icon.isHidden()};var Sa=function(n,u,a){this.text=n,this.icon=u,this.skipFade=a},Zn=function(){this.invProjMatrix=h.create(),this.viewportMatrix=h.create(),this.circles=[]},Ps=function(n,u,a,p,y){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=a,this.bucketIndex=p,this.tileID=y},Yr=function(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}};function Qr(n,u,a,p,y){var M=h.getAnchorAlignment(n),S=-(M.horizontalAlign-.5)*u,j=-(M.verticalAlign-.5)*a,H=h.evaluateVariableOffset(n,p);return new h.Point(S+H[0]*y,j+H[1]*y)}function zn(n,u,a,p,y,M){var S=n.x1,j=n.x2,H=n.y1,ie=n.y2,_e=n.anchorPointX,ye=n.anchorPointY,ge=new h.Point(u,a);return p&&ge._rotate(y?M:-M),{x1:S+ge.x,y1:H+ge.y,x2:j+ge.x,y2:ie+ge.y,anchorPointX:_e,anchorPointY:ye}}Yr.prototype.get=function(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){var u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:function(a){return a.collisionGroupID===u}}}return this.collisionGroups[n]};var on=function(n,u,a,p){this.transform=n.clone(),this.collisionIndex=new cn(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new Yr(a),this.collisionCircleArrays={},this.prevPlacement=p,p&&(p.prevPlacement=void 0),this.placedOrientations={}};function Co(n,u,a,p,y){n.emplaceBack(u?1:0,a?1:0,p||0,y||0),n.emplaceBack(u?1:0,a?1:0,p||0,y||0),n.emplaceBack(u?1:0,a?1:0,p||0,y||0),n.emplaceBack(u?1:0,a?1:0,p||0,y||0)}on.prototype.getBucketParts=function(n,u,a,p){var y=a.getBucket(u),M=a.latestFeatureIndex;if(y&&M&&u.id===y.layerIds[0]){var S=a.collisionBoxArray,j=y.layers[0].layout,H=Math.pow(2,this.transform.zoom-a.tileID.overscaledZ),ie=a.tileSize/h.EXTENT,_e=this.transform.calculatePosMatrix(a.tileID.toUnwrapped()),ye=j.get("text-pitch-alignment")==="map",ge=j.get("text-rotation-alignment")==="map",Ie=Ir(a,1,this.transform.zoom),Ee=hn(_e,ye,ge,this.transform,Ie),Ge=null;if(ye){var Ce=jr(_e,ye,ge,this.transform,Ie);Ge=h.multiply([],this.transform.labelPlaneMatrix,Ce)}this.retainedQueryData[y.bucketInstanceId]=new Ps(y.bucketInstanceId,M,y.sourceLayerIndex,y.index,a.tileID);var Ne={bucket:y,layout:j,posMatrix:_e,textLabelPlaneMatrix:Ee,labelToScreenMatrix:Ge,scale:H,textPixelRatio:ie,holdingForFade:a.holdingForFade(),collisionBoxArray:S,partiallyEvaluatedTextSize:h.evaluateSizeForZoom(y.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(y.sourceID)};if(p)for(var Je=0,lt=y.sortKeyRanges;Je<lt.length;Je+=1){var yt=lt[Je];n.push({sortKey:yt.sortKey,symbolInstanceStart:yt.symbolInstanceStart,symbolInstanceEnd:yt.symbolInstanceEnd,parameters:Ne})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:y.symbolInstances.length,parameters:Ne})}},on.prototype.attemptAnchorPlacement=function(n,u,a,p,y,M,S,j,H,ie,_e,ye,ge,Ie,Ee){var Ge,Ce=[ye.textOffset0,ye.textOffset1],Ne=Qr(n,a,p,Ce,y),Je=this.collisionIndex.placeCollisionBox(zn(u,Ne.x,Ne.y,M,S,this.transform.angle),_e,j,H,ie.predicate);if(!Ee||this.collisionIndex.placeCollisionBox(zn(Ee,Ne.x,Ne.y,M,S,this.transform.angle),_e,j,H,ie.predicate).box.length!==0)return Je.box.length>0?(this.prevPlacement&&this.prevPlacement.variableOffsets[ye.crossTileID]&&this.prevPlacement.placements[ye.crossTileID]&&this.prevPlacement.placements[ye.crossTileID].text&&(Ge=this.prevPlacement.variableOffsets[ye.crossTileID].anchor),this.variableOffsets[ye.crossTileID]={textOffset:Ce,width:a,height:p,anchor:n,textBoxScale:y,prevAnchor:Ge},this.markUsedJustification(ge,n,ye,Ie),ge.allowVerticalPlacement&&(this.markUsedOrientation(ge,Ie,ye),this.placedOrientations[ye.crossTileID]=Ie),{shift:Ne,placedGlyphBoxes:Je}):void 0},on.prototype.placeLayerBucketPart=function(n,u,a){var p=this,y=n.parameters,M=y.bucket,S=y.layout,j=y.posMatrix,H=y.textLabelPlaneMatrix,ie=y.labelToScreenMatrix,_e=y.textPixelRatio,ye=y.holdingForFade,ge=y.collisionBoxArray,Ie=y.partiallyEvaluatedTextSize,Ee=y.collisionGroup,Ge=S.get("text-optional"),Ce=S.get("icon-optional"),Ne=S.get("text-allow-overlap"),Je=S.get("icon-allow-overlap"),lt=S.get("text-rotation-alignment")==="map",yt=S.get("text-pitch-alignment")==="map",_t=S.get("icon-text-fit")!=="none",St=S.get("symbol-z-order")==="viewport-y",zt=Ne&&(Je||!M.hasIconData()||Ce),Ht=Je&&(Ne||!M.hasTextData()||Ge);!M.collisionArrays&&ge&&M.deserializeCollisionBoxes(ge);var Ut=function(mi,sr){if(!u[mi.crossTileID])if(ye)p.placements[mi.crossTileID]=new Sa(!1,!1,!1);else{var mr,lr=!1,Xi=!1,Pr=!0,qi=null,er={box:null,offscreen:null},Yn={box:null,offscreen:null},an=null,zo=null,Tn=0,Qn=0,$n=0;sr.textFeatureIndex?Tn=sr.textFeatureIndex:mi.useRuntimeCollisionCircles&&(Tn=mi.featureIndex),sr.verticalTextFeatureIndex&&(Qn=sr.verticalTextFeatureIndex);var ha=sr.textBox;if(ha){var es=function(tn){var Qo=h.WritingMode.horizontal;if(M.allowVerticalPlacement&&!tn&&p.prevPlacement){var vo=p.prevPlacement.placedOrientations[mi.crossTileID];vo&&(p.placedOrientations[mi.crossTileID]=vo,p.markUsedOrientation(M,Qo=vo,mi))}return Qo},Bo=function(tn,Qo){if(M.allowVerticalPlacement&&mi.numVerticalGlyphVertices>0&&sr.verticalTextBox)for(var vo=0,La=M.writingModes;vo<La.length&&(La[vo]===h.WritingMode.vertical?(er=Qo(),Yn=er):er=tn(),!(er&&er.box&&er.box.length));vo+=1);else er=tn()};if(S.get("text-variable-anchor")){var Mo=S.get("text-variable-anchor");if(p.prevPlacement&&p.prevPlacement.variableOffsets[mi.crossTileID]){var Fo=p.prevPlacement.variableOffsets[mi.crossTileID];Mo.indexOf(Fo.anchor)>0&&(Mo=Mo.filter(function(tn){return tn!==Fo.anchor})).unshift(Fo.anchor)}var Zo=function(tn,Qo,vo){for(var La=tn.x2-tn.x1,bo=tn.y2-tn.y1,Ju=mi.textBoxScale,mu=_t&&!Je?Qo:null,ol={box:[],offscreen:!1},Xu=Ne?2*Mo.length:Mo.length,al=0;al<Xu;++al){var Gl=p.attemptAnchorPlacement(Mo[al%Mo.length],tn,La,bo,Ju,lt,yt,_e,j,Ee,al>=Mo.length,mi,M,vo,mu);if(Gl&&(ol=Gl.placedGlyphBoxes)&&ol.box&&ol.box.length){lr=!0,qi=Gl.shift;break}}return ol};Bo(function(){return Zo(ha,sr.iconBox,h.WritingMode.horizontal)},function(){var tn=sr.verticalTextBox;return M.allowVerticalPlacement&&!(er&&er.box&&er.box.length)&&mi.numVerticalGlyphVertices>0&&tn?Zo(tn,sr.verticalIconBox,h.WritingMode.vertical):{box:null,offscreen:null}}),er&&(lr=er.box,Pr=er.offscreen);var fs=es(er&&er.box);if(!lr&&p.prevPlacement){var _s=p.prevPlacement.variableOffsets[mi.crossTileID];_s&&(p.variableOffsets[mi.crossTileID]=_s,p.markUsedJustification(M,_s.anchor,mi,fs))}}else{var Ns=function(tn,Qo){var vo=p.collisionIndex.placeCollisionBox(tn,Ne,_e,j,Ee.predicate);return vo&&vo.box&&vo.box.length&&(p.markUsedOrientation(M,Qo,mi),p.placedOrientations[mi.crossTileID]=Qo),vo};Bo(function(){return Ns(ha,h.WritingMode.horizontal)},function(){var tn=sr.verticalTextBox;return M.allowVerticalPlacement&&mi.numVerticalGlyphVertices>0&&tn?Ns(tn,h.WritingMode.vertical):{box:null,offscreen:null}}),es(er&&er.box&&er.box.length)}}if(lr=(mr=er)&&mr.box&&mr.box.length>0,Pr=mr&&mr.offscreen,mi.useRuntimeCollisionCircles){var oo=M.text.placedSymbolArray.get(mi.centerJustifiedTextSymbolIndex),ms=h.evaluateSizeForFeature(M.textSizeData,Ie,oo),Gs=S.get("text-padding");an=p.collisionIndex.placeCollisionCircles(Ne,oo,M.lineVertexArray,M.glyphOffsetArray,ms,j,H,ie,a,yt,Ee.predicate,mi.collisionCircleDiameter,Gs),lr=Ne||an.circles.length>0&&!an.collisionDetected,Pr=Pr&&an.offscreen}if(sr.iconFeatureIndex&&($n=sr.iconFeatureIndex),sr.iconBox){var Aa=function(tn){var Qo=_t&&qi?zn(tn,qi.x,qi.y,lt,yt,p.transform.angle):tn;return p.collisionIndex.placeCollisionBox(Qo,Je,_e,j,Ee.predicate)};Xi=Yn&&Yn.box&&Yn.box.length&&sr.verticalIconBox?(zo=Aa(sr.verticalIconBox)).box.length>0:(zo=Aa(sr.iconBox)).box.length>0,Pr=Pr&&zo.offscreen}var lo=Ge||mi.numHorizontalGlyphVertices===0&&mi.numVerticalGlyphVertices===0,Da=Ce||mi.numIconVertices===0;if(lo||Da?Da?lo||(Xi=Xi&&lr):lr=Xi&&lr:Xi=lr=Xi&&lr,lr&&mr&&mr.box&&p.collisionIndex.insertCollisionBox(mr.box,S.get("text-ignore-placement"),M.bucketInstanceId,Yn&&Yn.box&&Qn?Qn:Tn,Ee.ID),Xi&&zo&&p.collisionIndex.insertCollisionBox(zo.box,S.get("icon-ignore-placement"),M.bucketInstanceId,$n,Ee.ID),an&&(lr&&p.collisionIndex.insertCollisionCircles(an.circles,S.get("text-ignore-placement"),M.bucketInstanceId,Tn,Ee.ID),a)){var nl=M.bucketInstanceId,Ra=p.collisionCircleArrays[nl];Ra===void 0&&(Ra=p.collisionCircleArrays[nl]=new Zn);for(var Es=0;Es<an.circles.length;Es+=4)Ra.circles.push(an.circles[Es+0]),Ra.circles.push(an.circles[Es+1]),Ra.circles.push(an.circles[Es+2]),Ra.circles.push(an.collisionDetected?1:0)}p.placements[mi.crossTileID]=new Sa(lr||zt,Xi||Ht,Pr||M.justReloaded),u[mi.crossTileID]=!0}};if(St)for(var Xt=M.getSortedSymbolIndexes(this.transform.angle),hi=Xt.length-1;hi>=0;--hi){var Di=Xt[hi];Ut(M.symbolInstances.get(Di),M.collisionArrays[Di])}else for(var Li=n.symbolInstanceStart;Li<n.symbolInstanceEnd;Li++)Ut(M.symbolInstances.get(Li),M.collisionArrays[Li]);if(a&&M.bucketInstanceId in this.collisionCircleArrays){var Ji=this.collisionCircleArrays[M.bucketInstanceId];h.invert(Ji.invProjMatrix,j),Ji.viewportMatrix=this.collisionIndex.getViewportMatrix()}M.justReloaded=!1},on.prototype.markUsedJustification=function(n,u,a,p){var y;y=p===h.WritingMode.vertical?a.verticalPlacedTextSymbolIndex:{left:a.leftJustifiedTextSymbolIndex,center:a.centerJustifiedTextSymbolIndex,right:a.rightJustifiedTextSymbolIndex}[h.getAnchorJustification(u)];for(var M=0,S=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex,a.verticalPlacedTextSymbolIndex];M<S.length;M+=1){var j=S[M];j>=0&&(n.text.placedSymbolArray.get(j).crossTileID=y>=0&&j!==y?0:a.crossTileID)}},on.prototype.markUsedOrientation=function(n,u,a){for(var p=u===h.WritingMode.horizontal||u===h.WritingMode.horizontalOnly?u:0,y=u===h.WritingMode.vertical?u:0,M=0,S=[a.leftJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.rightJustifiedTextSymbolIndex];M<S.length;M+=1)n.text.placedSymbolArray.get(S[M]).placedOrientation=p;a.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(a.verticalPlacedTextSymbolIndex).placedOrientation=y)},on.prototype.commit=function(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;var u=this.prevPlacement,a=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;var p=u?u.symbolFadeChange(n):1,y=u?u.opacities:{},M=u?u.variableOffsets:{},S=u?u.placedOrientations:{};for(var j in this.placements){var H=this.placements[j],ie=y[j];ie?(this.opacities[j]=new yn(ie,p,H.text,H.icon),a=a||H.text!==ie.text.placed||H.icon!==ie.icon.placed):(this.opacities[j]=new yn(null,p,H.text,H.icon,H.skipFade),a=a||H.text||H.icon)}for(var _e in y){var ye=y[_e];if(!this.opacities[_e]){var ge=new yn(ye,p,!1,!1);ge.isHidden()||(this.opacities[_e]=ge,a=a||ye.text.placed||ye.icon.placed)}}for(var Ie in M)this.variableOffsets[Ie]||!this.opacities[Ie]||this.opacities[Ie].isHidden()||(this.variableOffsets[Ie]=M[Ie]);for(var Ee in S)this.placedOrientations[Ee]||!this.opacities[Ee]||this.opacities[Ee].isHidden()||(this.placedOrientations[Ee]=S[Ee]);a?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)},on.prototype.updateLayerOpacities=function(n,u){for(var a={},p=0,y=u;p<y.length;p+=1){var M=y[p],S=M.getBucket(n);S&&M.latestFeatureIndex&&n.id===S.layerIds[0]&&this.updateBucketOpacities(S,a,M.collisionBoxArray)}},on.prototype.updateBucketOpacities=function(n,u,a){var p=this;n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();var y=n.layers[0].layout,M=new yn(null,0,!1,!1,!0),S=y.get("text-allow-overlap"),j=y.get("icon-allow-overlap"),H=y.get("text-variable-anchor"),ie=y.get("text-rotation-alignment")==="map",_e=y.get("text-pitch-alignment")==="map",ye=y.get("icon-text-fit")!=="none",ge=new yn(null,0,S&&(j||!n.hasIconData()||y.get("icon-optional")),j&&(S||!n.hasTextData()||y.get("text-optional")),!0);!n.collisionArrays&&a&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(a);for(var Ie=function(Ne,Je,lt){for(var yt=0;yt<Je/4;yt++)Ne.opacityVertexArray.emplaceBack(lt)},Ee=function(Ne){var Je=n.symbolInstances.get(Ne),lt=Je.numHorizontalGlyphVertices,yt=Je.numVerticalGlyphVertices,_t=Je.crossTileID,St=p.opacities[_t];u[_t]?St=M:St||(p.opacities[_t]=St=ge),u[_t]=!0;var zt=Je.numIconVertices>0,Ht=p.placedOrientations[Je.crossTileID],Ut=Ht===h.WritingMode.vertical,Xt=Ht===h.WritingMode.horizontal||Ht===h.WritingMode.horizontalOnly;if(lt>0||yt>0){var hi=Wa(St.text);Ie(n.text,lt,Ut?ia:hi),Ie(n.text,yt,Xt?ia:hi);var Di=St.text.isHidden();[Je.rightJustifiedTextSymbolIndex,Je.centerJustifiedTextSymbolIndex,Je.leftJustifiedTextSymbolIndex].forEach(function(er){er>=0&&(n.text.placedSymbolArray.get(er).hidden=Di||Ut?1:0)}),Je.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Je.verticalPlacedTextSymbolIndex).hidden=Di||Xt?1:0);var Li=p.variableOffsets[Je.crossTileID];Li&&p.markUsedJustification(n,Li.anchor,Je,Ht);var Ji=p.placedOrientations[Je.crossTileID];Ji&&(p.markUsedJustification(n,"left",Je,Ji),p.markUsedOrientation(n,Ji,Je))}if(zt){var mi=Wa(St.icon),sr=!(ye&&Je.verticalPlacedIconSymbolIndex&&Ut);Je.placedIconSymbolIndex>=0&&(Ie(n.icon,Je.numIconVertices,sr?mi:ia),n.icon.placedSymbolArray.get(Je.placedIconSymbolIndex).hidden=St.icon.isHidden()),Je.verticalPlacedIconSymbolIndex>=0&&(Ie(n.icon,Je.numVerticalIconVertices,sr?ia:mi),n.icon.placedSymbolArray.get(Je.verticalPlacedIconSymbolIndex).hidden=St.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){var mr=n.collisionArrays[Ne];if(mr){var lr=new h.Point(0,0);if(mr.textBox||mr.verticalTextBox){var Xi=!0;if(H){var Pr=p.variableOffsets[_t];Pr?(lr=Qr(Pr.anchor,Pr.width,Pr.height,Pr.textOffset,Pr.textBoxScale),ie&&lr._rotate(_e?p.transform.angle:-p.transform.angle)):Xi=!1}mr.textBox&&Co(n.textCollisionBox.collisionVertexArray,St.text.placed,!Xi||Ut,lr.x,lr.y),mr.verticalTextBox&&Co(n.textCollisionBox.collisionVertexArray,St.text.placed,!Xi||Xt,lr.x,lr.y)}var qi=Boolean(!Xt&&mr.verticalIconBox);mr.iconBox&&Co(n.iconCollisionBox.collisionVertexArray,St.icon.placed,qi,ye?lr.x:0,ye?lr.y:0),mr.verticalIconBox&&Co(n.iconCollisionBox.collisionVertexArray,St.icon.placed,!qi,ye?lr.x:0,ye?lr.y:0)}}},Ge=0;Ge<n.symbolInstances.length;Ge++)Ee(Ge);if(n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){var Ce=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Ce.invProjMatrix,n.placementViewportMatrix=Ce.viewportMatrix,n.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}},on.prototype.symbolFadeChange=function(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment},on.prototype.zoomAdjustment=function(n){return Math.max(0,(this.transform.zoom-n)/1.5)},on.prototype.hasTransitions=function(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration},on.prototype.stillRecent=function(n,u){var a=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*a>n},on.prototype.setStale=function(){this.stale=!0};var ca=Math.pow(2,25),ao=Math.pow(2,24),Ua=Math.pow(2,17),as=Math.pow(2,16),Na=Math.pow(2,9),pa=Math.pow(2,8),Ga=Math.pow(2,1);function Wa(n){if(n.opacity===0&&!n.placed)return 0;if(n.opacity===1&&n.placed)return 4294967295;var u=n.placed?1:0,a=Math.floor(127*n.opacity);return a*ca+u*ao+a*Ua+u*as+a*Na+u*pa+a*Ga+u}var ia=0,Uo=function(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]};Uo.prototype.continuePlacement=function(n,u,a,p,y){for(var M=this._bucketParts;this._currentTileIndex<n.length;)if(u.getBucketParts(M,p,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort(function(S,j){return S.sortKey-j.sortKey}));this._currentPartIndex<M.length;)if(u.placeLayerBucketPart(M[this._currentPartIndex],this._seenCrossTileIDs,a),this._currentPartIndex++,y())return!0;return!1};var ra=function(n,u,a,p,y,M,S){this.placement=new on(n,y,M,S),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=a,this._showCollisionBoxes=p,this._done=!1};ra.prototype.isDone=function(){return this._done},ra.prototype.continuePlacement=function(n,u,a){for(var p=this,y=h.browser.now(),M=function(){var H=h.browser.now()-y;return!p._forceFullPlacement&&H>2};this._currentPlacementIndex>=0;){var S=u[n[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(S.type==="symbol"&&(!S.minzoom||S.minzoom<=j)&&(!S.maxzoom||S.maxzoom>j)){if(this._inProgressLayer||(this._inProgressLayer=new Uo(S)),this._inProgressLayer.continuePlacement(a[S.source],this.placement,this._showCollisionBoxes,S,M))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0},ra.prototype.commit=function(n){return this.placement.commit(n),this.placement};var da=512/h.EXTENT/2,fa=function(n,u,a){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=a;for(var p=0;p<u.length;p++){var y=u.get(p),M=y.key;this.indexedSymbolInstances[M]||(this.indexedSymbolInstances[M]=[]),this.indexedSymbolInstances[M].push({crossTileID:y.crossTileID,coord:this.getScaledCoordinates(y,n)})}};fa.prototype.getScaledCoordinates=function(n,u){var a=da/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*h.EXTENT+n.anchorX)*a),y:Math.floor((u.canonical.y*h.EXTENT+n.anchorY)*a)}},fa.prototype.findMatches=function(n,u,a){for(var p=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z),y=0;y<n.length;y++){var M=n.get(y);if(!M.crossTileID){var S=this.indexedSymbolInstances[M.key];if(S)for(var j=this.getScaledCoordinates(M,u),H=0,ie=S;H<ie.length;H+=1){var _e=ie[H];if(Math.abs(_e.coord.x-j.x)<=p&&Math.abs(_e.coord.y-j.y)<=p&&!a[_e.crossTileID]){a[_e.crossTileID]=!0,M.crossTileID=_e.crossTileID;break}}}}};var Vn=function(){this.maxCrossTileID=0};Vn.prototype.generate=function(){return++this.maxCrossTileID};var pn=function(){this.indexes={},this.usedCrossTileIDs={},this.lng=0};pn.prototype.handleWrapJump=function(n){var u=Math.round((n-this.lng)/360);if(u!==0)for(var a in this.indexes){var p=this.indexes[a],y={};for(var M in p){var S=p[M];S.tileID=S.tileID.unwrapTo(S.tileID.wrap+u),y[S.tileID.key]=S}this.indexes[a]=y}this.lng=n},pn.prototype.addBucket=function(n,u,a){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(var p=0;p<u.symbolInstances.length;p++)u.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});var y=this.usedCrossTileIDs[n.overscaledZ];for(var M in this.indexes){var S=this.indexes[M];if(Number(M)>n.overscaledZ)for(var j in S){var H=S[j];H.tileID.isChildOf(n)&&H.findMatches(u.symbolInstances,n,y)}else{var ie=S[n.scaledTo(Number(M)).key];ie&&ie.findMatches(u.symbolInstances,n,y)}}for(var _e=0;_e<u.symbolInstances.length;_e++){var ye=u.symbolInstances.get(_e);ye.crossTileID||(ye.crossTileID=a.generate(),y[ye.crossTileID]=!0)}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new fa(n,u.symbolInstances,u.bucketInstanceId),!0},pn.prototype.removeBucketCrossTileIDs=function(n,u){for(var a in u.indexedSymbolInstances)for(var p=0,y=u.indexedSymbolInstances[a];p<y.length;p+=1)delete this.usedCrossTileIDs[n][y[p].crossTileID]},pn.prototype.removeStaleBuckets=function(n){var u=!1;for(var a in this.indexes){var p=this.indexes[a];for(var y in p)n[p[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(a,p[y]),delete p[y],u=!0)}return u};var Kn=function(){this.layerIndexes={},this.crossTileIDs=new Vn,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}};Kn.prototype.addLayer=function(n,u,a){var p=this.layerIndexes[n.id];p===void 0&&(p=this.layerIndexes[n.id]=new pn);var y=!1,M={};p.handleWrapJump(a);for(var S=0,j=u;S<j.length;S+=1){var H=j[S],ie=H.getBucket(n);ie&&n.id===ie.layerIds[0]&&(ie.bucketInstanceId||(ie.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(H.tileID,ie,this.crossTileIDs)&&(y=!0),M[ie.bucketInstanceId]=!0)}return p.removeStaleBuckets(M)&&(y=!0),y},Kn.prototype.pruneUnusedLayers=function(n){var u={};for(var a in n.forEach(function(p){u[p]=!0}),this.layerIndexes)u[a]||delete this.layerIndexes[a]};var Ko=function(n,u){return h.emitValidationErrors(n,u&&u.filter(function(a){return a.identifier!=="source.canvas"}))},Eo=h.pick(ri,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData"]),Hn=h.pick(ri,["setCenter","setZoom","setBearing","setPitch"]),qn=function(){var n={},u=h.styleSpec.$version;for(var a in h.styleSpec.$root){var p,y=h.styleSpec.$root[a];y.required&&(p=a==="version"?u:y.type==="array"?[]:{})!=null&&(n[a]=p)}return n}(),Mr=function(n){function u(a,p){var y=this;p===void 0&&(p={}),n.call(this),this.map=a,this.dispatcher=new ht(dt(),this),this.imageManager=new F,this.imageManager.setEventedParent(this),this.glyphManager=new ce(a._requestManager,p.localIdeographFontFamily),this.lineAtlas=new Ue(256,512),this.crossTileSymbolIndex=new Kn,this._layers={},this._serializedLayers={},this._order=[],this.sourceCaches={},this.zoomHistory=new h.ZoomHistory,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",h.getReferrer());var M=this;this._rtlTextPluginCallback=u.registerForPluginStateChange(function(S){M.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:S.pluginStatus,pluginURL:S.pluginURL},function(j,H){if(h.triggerPluginCompletionEvent(j),H&&H.every(function(_e){return _e}))for(var ie in M.sourceCaches)M.sourceCaches[ie].reload()})}),this.on("data",function(S){if(S.dataType==="source"&&S.sourceDataType==="metadata"){var j=y.sourceCaches[S.sourceId];if(j){var H=j.getSource();if(H&&H.vectorLayerIds)for(var ie in y._layers){var _e=y._layers[ie];_e.source===H.id&&y._validateLayer(_e)}}}})}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.loadURL=function(a,p){var y=this;p===void 0&&(p={}),this.fire(new h.Event("dataloading",{dataType:"style"}));var M=typeof p.validate=="boolean"?p.validate:!h.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,p.accessToken);var S=this.map._requestManager.transformRequest(a,h.ResourceType.Style);this._request=h.getJSON(S,function(j,H){y._request=null,j?y.fire(new h.ErrorEvent(j)):H&&y._load(H,M)})},u.prototype.loadJSON=function(a,p){var y=this;p===void 0&&(p={}),this.fire(new h.Event("dataloading",{dataType:"style"})),this._request=h.browser.frame(function(){y._request=null,y._load(a,p.validate!==!1)})},u.prototype.loadEmpty=function(){this.fire(new h.Event("dataloading",{dataType:"style"})),this._load(qn,!1)},u.prototype._load=function(a,p){if(!p||!Ko(this,h.validateStyle(a))){for(var y in this._loaded=!0,this.stylesheet=a,a.sources)this.addSource(y,a.sources[y],{validate:!1});a.sprite?this._loadSprite(a.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(a.glyphs);var M=ii(this.stylesheet.layers);this._order=M.map(function(ie){return ie.id}),this._layers={},this._serializedLayers={};for(var S=0,j=M;S<j.length;S+=1){var H=j[S];(H=h.createStyleLayer(H)).setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H,this._serializedLayers[H.id]=H.serialize()}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ot(this.stylesheet.light),this.fire(new h.Event("data",{dataType:"style"})),this.fire(new h.Event("style.load"))}},u.prototype._loadSprite=function(a){var p=this;this._spriteRequest=function(y,M,S){var j,H,ie,_e=h.browser.devicePixelRatio>1?"@2x":"",ye=h.getJSON(M.transformRequest(M.normalizeSpriteURL(y,_e,".json"),h.ResourceType.SpriteJSON),function(Ee,Ge){ye=null,ie||(ie=Ee,j=Ge,Ie())}),ge=h.getImage(M.transformRequest(M.normalizeSpriteURL(y,_e,".png"),h.ResourceType.SpriteImage),function(Ee,Ge){ge=null,ie||(ie=Ee,H=Ge,Ie())});function Ie(){if(ie)S(ie);else if(j&&H){var Ee=h.browser.getImageData(H),Ge={};for(var Ce in j){var Ne=j[Ce],Je=Ne.width,lt=Ne.height,yt=Ne.x,_t=Ne.y,St=Ne.sdf,zt=Ne.pixelRatio,Ht=Ne.stretchX,Ut=Ne.stretchY,Xt=Ne.content,hi=new h.RGBAImage({width:Je,height:lt});h.RGBAImage.copy(Ee,hi,{x:yt,y:_t},{x:0,y:0},{width:Je,height:lt}),Ge[Ce]={data:hi,pixelRatio:zt,sdf:St,stretchX:Ht,stretchY:Ut,content:Xt}}S(null,Ge)}}return{cancel:function(){ye&&(ye.cancel(),ye=null),ge&&(ge.cancel(),ge=null)}}}(a,this.map._requestManager,function(y,M){if(p._spriteRequest=null,y)p.fire(new h.ErrorEvent(y));else if(M)for(var S in M)p.imageManager.addImage(S,M[S]);p.imageManager.setLoaded(!0),p._availableImages=p.imageManager.listImages(),p.dispatcher.broadcast("setImages",p._availableImages),p.fire(new h.Event("data",{dataType:"style"}))})},u.prototype._validateLayer=function(a){var p=this.sourceCaches[a.source];if(p){var y=a.sourceLayer;if(y){var M=p.getSource();(M.type==="geojson"||M.vectorLayerIds&&M.vectorLayerIds.indexOf(y)===-1)&&this.fire(new h.ErrorEvent(new Error('Source layer "'+y+'" does not exist on source "'+M.id+'" as specified by style layer "'+a.id+'"')))}}},u.prototype.loaded=function(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(var a in this.sourceCaches)if(!this.sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()},u.prototype._serializeLayers=function(a){for(var p=[],y=0,M=a;y<M.length;y+=1){var S=this._layers[M[y]];S.type!=="custom"&&p.push(S.serialize())}return p},u.prototype.hasTransitions=function(){if(this.light&&this.light.hasTransition())return!0;for(var a in this.sourceCaches)if(this.sourceCaches[a].hasTransition())return!0;for(var p in this._layers)if(this._layers[p].hasTransition())return!0;return!1},u.prototype._checkLoaded=function(){if(!this._loaded)throw new Error("Style is not done loading")},u.prototype.update=function(a){if(this._loaded){var p=this._changed;if(this._changed){var y=Object.keys(this._updatedLayers),M=Object.keys(this._removedLayers);for(var S in(y.length||M.length)&&this._updateWorkerLayers(y,M),this._updatedSources){var j=this._updatedSources[S];j==="reload"?this._reloadSource(S):j==="clear"&&this._clearSource(S)}for(var H in this._updateTilesForChangedImages(),this._updatedPaintProps)this._layers[H].updateTransitions(a);this.light.updateTransitions(a),this._resetUpdates()}for(var ie in this.sourceCaches)this.sourceCaches[ie].used=!1;for(var _e=0,ye=this._order;_e<ye.length;_e+=1){var ge=this._layers[ye[_e]];ge.recalculate(a,this._availableImages),!ge.isHidden(a.zoom)&&ge.source&&(this.sourceCaches[ge.source].used=!0)}this.light.recalculate(a),this.z=a.zoom,p&&this.fire(new h.Event("data",{dataType:"style"}))}},u.prototype._updateTilesForChangedImages=function(){var a=Object.keys(this._changedImages);if(a.length){for(var p in this.sourceCaches)this.sourceCaches[p].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}},u.prototype._updateWorkerLayers=function(a,p){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:p})},u.prototype._resetUpdates=function(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}},u.prototype.setState=function(a){var p=this;if(this._checkLoaded(),Ko(this,h.validateStyle(a)))return!1;(a=h.clone$1(a)).layers=ii(a.layers);var y=function(S,j){if(!S)return[{command:ri.setStyle,args:[j]}];var H=[];try{if(!h.deepEqual(S.version,j.version))return[{command:ri.setStyle,args:[j]}];h.deepEqual(S.center,j.center)||H.push({command:ri.setCenter,args:[j.center]}),h.deepEqual(S.zoom,j.zoom)||H.push({command:ri.setZoom,args:[j.zoom]}),h.deepEqual(S.bearing,j.bearing)||H.push({command:ri.setBearing,args:[j.bearing]}),h.deepEqual(S.pitch,j.pitch)||H.push({command:ri.setPitch,args:[j.pitch]}),h.deepEqual(S.sprite,j.sprite)||H.push({command:ri.setSprite,args:[j.sprite]}),h.deepEqual(S.glyphs,j.glyphs)||H.push({command:ri.setGlyphs,args:[j.glyphs]}),h.deepEqual(S.transition,j.transition)||H.push({command:ri.setTransition,args:[j.transition]}),h.deepEqual(S.light,j.light)||H.push({command:ri.setLight,args:[j.light]});var ie={},_e=[];(function(ge,Ie,Ee,Ge){var Ce;for(Ce in Ie=Ie||{},ge=ge||{})ge.hasOwnProperty(Ce)&&(Ie.hasOwnProperty(Ce)||si(Ce,Ee,Ge));for(Ce in Ie)Ie.hasOwnProperty(Ce)&&(ge.hasOwnProperty(Ce)?h.deepEqual(ge[Ce],Ie[Ce])||(ge[Ce].type==="geojson"&&Ie[Ce].type==="geojson"&&$i(ge,Ie,Ce)?Ee.push({command:ri.setGeoJSONSourceData,args:[Ce,Ie[Ce].data]}):Gi(Ce,Ie,Ee,Ge)):ki(Ce,Ie,Ee))})(S.sources,j.sources,_e,ie);var ye=[];S.layers&&S.layers.forEach(function(ge){ie[ge.source]?H.push({command:ri.removeLayer,args:[ge.id]}):ye.push(ge)}),H=H.concat(_e),function(ge,Ie,Ee){Ie=Ie||[];var Ge,Ce,Ne,Je,lt,yt,_t,St=(ge=ge||[]).map(Vi),zt=Ie.map(Vi),Ht=ge.reduce(Ki,{}),Ut=Ie.reduce(Ki,{}),Xt=St.slice(),hi=Object.create(null);for(Ge=0,Ce=0;Ge<St.length;Ge++)Ut.hasOwnProperty(Ne=St[Ge])?Ce++:(Ee.push({command:ri.removeLayer,args:[Ne]}),Xt.splice(Xt.indexOf(Ne,Ce),1));for(Ge=0,Ce=0;Ge<zt.length;Ge++)Xt[Xt.length-1-Ge]!==(Ne=zt[zt.length-1-Ge])&&(Ht.hasOwnProperty(Ne)?(Ee.push({command:ri.removeLayer,args:[Ne]}),Xt.splice(Xt.lastIndexOf(Ne,Xt.length-Ce),1)):Ce++,Ee.push({command:ri.addLayer,args:[Ut[Ne],yt=Xt[Xt.length-Ge]]}),Xt.splice(Xt.length-Ge,0,Ne),hi[Ne]=!0);for(Ge=0;Ge<zt.length;Ge++)if(Je=Ht[Ne=zt[Ge]],lt=Ut[Ne],!hi[Ne]&&!h.deepEqual(Je,lt))if(h.deepEqual(Je.source,lt.source)&&h.deepEqual(Je["source-layer"],lt["source-layer"])&&h.deepEqual(Je.type,lt.type)){for(_t in dr(Je.layout,lt.layout,Ee,Ne,null,ri.setLayoutProperty),dr(Je.paint,lt.paint,Ee,Ne,null,ri.setPaintProperty),h.deepEqual(Je.filter,lt.filter)||Ee.push({command:ri.setFilter,args:[Ne,lt.filter]}),h.deepEqual(Je.minzoom,lt.minzoom)&&h.deepEqual(Je.maxzoom,lt.maxzoom)||Ee.push({command:ri.setLayerZoomRange,args:[Ne,lt.minzoom,lt.maxzoom]}),Je)Je.hasOwnProperty(_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?dr(Je[_t],lt[_t],Ee,Ne,_t.slice(6),ri.setPaintProperty):h.deepEqual(Je[_t],lt[_t])||Ee.push({command:ri.setLayerProperty,args:[Ne,_t,lt[_t]]}));for(_t in lt)lt.hasOwnProperty(_t)&&!Je.hasOwnProperty(_t)&&_t!=="layout"&&_t!=="paint"&&_t!=="filter"&&_t!=="metadata"&&_t!=="minzoom"&&_t!=="maxzoom"&&(_t.indexOf("paint.")===0?dr(Je[_t],lt[_t],Ee,Ne,_t.slice(6),ri.setPaintProperty):h.deepEqual(Je[_t],lt[_t])||Ee.push({command:ri.setLayerProperty,args:[Ne,_t,lt[_t]]}))}else Ee.push({command:ri.removeLayer,args:[Ne]}),yt=Xt[Xt.lastIndexOf(Ne)+1],Ee.push({command:ri.addLayer,args:[lt,yt]})}(ye,j.layers,H)}catch(ge){console.warn("Unable to compute style diff:",ge),H=[{command:ri.setStyle,args:[j]}]}return H}(this.serialize(),a).filter(function(S){return!(S.command in Hn)});if(y.length===0)return!1;var M=y.filter(function(S){return!(S.command in Eo)});if(M.length>0)throw new Error("Unimplemented: "+M.map(function(S){return S.command}).join(", ")+".");return y.forEach(function(S){S.command!=="setTransition"&&p[S.command].apply(p,S.args)}),this.stylesheet=a,!0},u.prototype.addImage=function(a,p){if(this.getImage(a))return this.fire(new h.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(a,p),this._afterImageUpdated(a)},u.prototype.updateImage=function(a,p){this.imageManager.updateImage(a,p)},u.prototype.getImage=function(a){return this.imageManager.getImage(a)},u.prototype.removeImage=function(a){if(!this.getImage(a))return this.fire(new h.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(a),this._afterImageUpdated(a)},u.prototype._afterImageUpdated=function(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new h.Event("data",{dataType:"style"}))},u.prototype.listImages=function(){return this._checkLoaded(),this.imageManager.listImages()},u.prototype.addSource=function(a,p,y){var M=this;if(y===void 0&&(y={}),this._checkLoaded(),this.sourceCaches[a]!==void 0)throw new Error("There is already a source with this ID");if(!p.type)throw new Error("The type property must be defined, but only the following properties were given: "+Object.keys(p).join(", ")+".");if(!(["vector","raster","geojson","video","image"].indexOf(p.type)>=0&&this._validate(h.validateStyle.source,"sources."+a,p,null,y))){this.map&&this.map._collectResourceTiming&&(p.collectResourceTiming=!0);var S=this.sourceCaches[a]=new Le(a,p,this.dispatcher);S.style=this,S.options=p,S.setEventedParent(this,function(){return{isSourceLoaded:M.loaded(),source:S.serialize(),sourceId:a}}),S.onAdd(this.map),this._changed=!0}},u.prototype.removeSource=function(a,p){if(this._checkLoaded(),p===void 0&&(p=!1),this.sourceCaches[a]===void 0)throw new Error("There is no source with this ID");if(!p){for(var y in this._layers)if(this._layers[y].source===a)return this.fire(new h.ErrorEvent(new Error('Source "'+a+'" cannot be removed while layer "'+y+'" is using it.')))}var M=this.sourceCaches[a];delete this.sourceCaches[a],delete this._updatedSources[a],M.fire(new h.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:a})),M.setEventedParent(null),M.clearTiles(),M.onRemove&&M.onRemove(this.map),this._changed=!0},u.prototype.setGeoJSONSourceData=function(a,p){this._checkLoaded(),this.sourceCaches[a].getSource().setData(p),this._changed=!0},u.prototype.getSource=function(a){return this.sourceCaches[a]&&this.sourceCaches[a].getSource()},u.prototype.addLayer=function(a,p,y){y===void 0&&(y={}),this._checkLoaded();var M=a.id;if(this.getLayer(M))this.fire(new h.ErrorEvent(new Error('Layer with id "'+M+'" already exists on this map')));else{var S;if(a.type==="custom"){if(Ko(this,h.validateCustomStyleLayer(a)))return;S=h.createStyleLayer(a)}else{if(typeof a.source=="object"&&(this.addSource(M,a.source),a=h.clone$1(a),a=h.extend(a,{source:M})),this._validate(h.validateStyle.layer,"layers."+M,a,{arrayIndex:-1},y))return;S=h.createStyleLayer(a),this._validateLayer(S),S.setEventedParent(this,{layer:{id:M}}),this._serializedLayers[S.id]=S.serialize()}var j=p?this._order.indexOf(p):this._order.length;if(p&&j===-1)this.fire(new h.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.')));else{if(this._order.splice(j,0,M),this._layerOrderChanged=!0,this._layers[M]=S,this._removedLayers[M]&&S.source&&S.type!=="custom"){var H=this._removedLayers[M];delete this._removedLayers[M],H.type!==S.type?this._updatedSources[S.source]="clear":(this._updatedSources[S.source]="reload",this.sourceCaches[S.source].pause())}y.preventUpdate!==void 0&&y.preventUpdate||this._updateLayer(S),S.onAdd&&S.onAdd(this.map)}}},u.prototype.moveLayer=function(a,p){if(this._checkLoaded(),this._changed=!0,this._layers[a]){if(a!==p){var y=this._order.indexOf(a);this._order.splice(y,1);var M=p?this._order.indexOf(p):this._order.length;p&&M===-1?this.fire(new h.ErrorEvent(new Error('Layer with id "'+p+'" does not exist on this map.'))):(this._order.splice(M,0,a),this._layerOrderChanged=!0)}}else this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be moved.")))},u.prototype.removeLayer=function(a){this._checkLoaded();var p=this._layers[a];if(p){p.setEventedParent(null);var y=this._order.indexOf(a);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=p,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],p.onRemove&&p.onRemove(this.map)}else this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be removed.")))},u.prototype.getLayer=function(a){return this._layers[a]},u.prototype.hasLayer=function(a){return a in this._layers},u.prototype.setLayerZoomRange=function(a,p,y){this._checkLoaded();var M=this.getLayer(a);M?M.minzoom===p&&M.maxzoom===y||(p!=null&&(M.minzoom=p),y!=null&&(M.maxzoom=y),this._updateLayer(M)):this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot have zoom extent.")))},u.prototype.setFilter=function(a,p,y){y===void 0&&(y={}),this._checkLoaded();var M=this.getLayer(a);if(M){if(!h.deepEqual(M.filter,p))return p==null?(M.filter=void 0,void this._updateLayer(M)):void(this._validate(h.validateStyle.filter,"layers."+M.id+".filter",p,null,y)||(M.filter=h.clone$1(p),this._updateLayer(M)))}else this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be filtered.")))},u.prototype.getFilter=function(a){return h.clone$1(this.getLayer(a).filter)},u.prototype.setLayoutProperty=function(a,p,y,M){M===void 0&&(M={}),this._checkLoaded();var S=this.getLayer(a);S?h.deepEqual(S.getLayoutProperty(p),y)||(S.setLayoutProperty(p,y,M),this._updateLayer(S)):this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")))},u.prototype.getLayoutProperty=function(a,p){var y=this.getLayer(a);if(y)return y.getLayoutProperty(p);this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style.")))},u.prototype.setPaintProperty=function(a,p,y,M){M===void 0&&(M={}),this._checkLoaded();var S=this.getLayer(a);S?h.deepEqual(S.getPaintProperty(p),y)||(S.setPaintProperty(p,y,M)&&this._updateLayer(S),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new h.ErrorEvent(new Error("The layer '"+a+"' does not exist in the map's style and cannot be styled.")))},u.prototype.getPaintProperty=function(a,p){return this.getLayer(a).getPaintProperty(p)},u.prototype.setFeatureState=function(a,p){this._checkLoaded();var y=a.source,M=a.sourceLayer,S=this.sourceCaches[y];if(S!==void 0){var j=S.getSource().type;j==="geojson"&&M?this.fire(new h.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):j!=="vector"||M?(a.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),S.setFeatureState(M,a.id,p)):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},u.prototype.removeFeatureState=function(a,p){this._checkLoaded();var y=a.source,M=this.sourceCaches[y];if(M!==void 0){var S=M.getSource().type,j=S==="vector"?a.sourceLayer:void 0;S!=="vector"||j?p&&typeof a.id!="string"&&typeof a.id!="number"?this.fire(new h.ErrorEvent(new Error("A feature id is required to remove its specific state property."))):M.removeFeatureState(j,a.id,p):this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+y+"' does not exist in the map's style.")))},u.prototype.getFeatureState=function(a){this._checkLoaded();var p=a.source,y=a.sourceLayer,M=this.sourceCaches[p];if(M!==void 0){if(M.getSource().type!=="vector"||y)return a.id===void 0&&this.fire(new h.ErrorEvent(new Error("The feature id parameter must be provided."))),M.getFeatureState(y,a.id);this.fire(new h.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new h.ErrorEvent(new Error("The source '"+p+"' does not exist in the map's style.")))},u.prototype.getTransition=function(){return h.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)},u.prototype.serialize=function(){return h.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:h.mapObject(this.sourceCaches,function(a){return a.serialize()}),layers:this._serializeLayers(this._order)},function(a){return a!==void 0})},u.prototype._updateLayer=function(a){this._updatedLayers[a.id]=!0,a.source&&!this._updatedSources[a.source]&&this.sourceCaches[a.source].getSource().type!=="raster"&&(this._updatedSources[a.source]="reload",this.sourceCaches[a.source].pause()),this._changed=!0},u.prototype._flattenAndSortRenderedFeatures=function(a){for(var p=this,y=function(Ht){return p._layers[Ht].type==="fill-extrusion"},M={},S=[],j=this._order.length-1;j>=0;j--){var H=this._order[j];if(y(H)){M[H]=j;for(var ie=0,_e=a;ie<_e.length;ie+=1){var ye=_e[ie][H];if(ye)for(var ge=0,Ie=ye;ge<Ie.length;ge+=1)S.push(Ie[ge])}}}S.sort(function(Ht,Ut){return Ut.intersectionZ-Ht.intersectionZ});for(var Ee=[],Ge=this._order.length-1;Ge>=0;Ge--){var Ce=this._order[Ge];if(y(Ce))for(var Ne=S.length-1;Ne>=0;Ne--){var Je=S[Ne].feature;if(M[Je.layer.id]<Ge)break;Ee.push(Je),S.pop()}else for(var lt=0,yt=a;lt<yt.length;lt+=1){var _t=yt[lt][Ce];if(_t)for(var St=0,zt=_t;St<zt.length;St+=1)Ee.push(zt[St].feature)}}return Ee},u.prototype.queryRenderedFeatures=function(a,p,y){p&&p.filter&&this._validate(h.validateStyle.filter,"queryRenderedFeatures.filter",p.filter,null,p);var M={};if(p&&p.layers){if(!Array.isArray(p.layers))return this.fire(new h.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(var S=0,j=p.layers;S<j.length;S+=1){var H=j[S],ie=this._layers[H];if(!ie)return this.fire(new h.ErrorEvent(new Error("The layer '"+H+"' does not exist in the map's style and cannot be queried for features."))),[];M[ie.source]=!0}}var _e=[];for(var ye in p.availableImages=this._availableImages,this.sourceCaches)p.layers&&!M[ye]||_e.push(Bi(this.sourceCaches[ye],this._layers,this._serializedLayers,a,p,y));return this.placement&&_e.push(function(ge,Ie,Ee,Ge,Ce,Ne,Je){for(var lt={},yt=Ne.queryRenderedSymbols(Ge),_t=[],St=0,zt=Object.keys(yt).map(Number);St<zt.length;St+=1)_t.push(Je[zt[St]]);_t.sort(Ci);for(var Ht=function(){var Li=Xt[Ut],Ji=Li.featureIndex.lookupSymbolFeatures(yt[Li.bucketInstanceId],Ie,Li.bucketIndex,Li.sourceLayerIndex,Ce.filter,Ce.layers,Ce.availableImages,ge);for(var mi in Ji){var sr=lt[mi]=lt[mi]||[],mr=Ji[mi];mr.sort(function(Pr,qi){var er=Li.featureSortOrder;if(er){var Yn=er.indexOf(Pr.featureIndex);return er.indexOf(qi.featureIndex)-Yn}return qi.featureIndex-Pr.featureIndex});for(var lr=0,Xi=mr;lr<Xi.length;lr+=1)sr.push(Xi[lr])}},Ut=0,Xt=_t;Ut<Xt.length;Ut+=1)Ht();var hi=function(Li){lt[Li].forEach(function(Ji){var mi=Ji.feature,sr=Ee[ge[Li].source].getFeatureState(mi.layer["source-layer"],mi.id);mi.source=mi.layer.source,mi.layer["source-layer"]&&(mi.sourceLayer=mi.layer["source-layer"]),mi.state=sr})};for(var Di in lt)hi(Di);return lt}(this._layers,this._serializedLayers,this.sourceCaches,a,p,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(_e)},u.prototype.querySourceFeatures=function(a,p){p&&p.filter&&this._validate(h.validateStyle.filter,"querySourceFeatures.filter",p.filter,null,p);var y=this.sourceCaches[a];return y?function(M,S){for(var j=M.getRenderableIds().map(function(Ie){return M.getTileByID(Ie)}),H=[],ie={},_e=0;_e<j.length;_e++){var ye=j[_e],ge=ye.tileID.canonical.key;ie[ge]||(ie[ge]=!0,ye.querySourceFeatures(H,S))}return H}(y,p):[]},u.prototype.addSourceType=function(a,p,y){return u.getSourceType(a)?y(new Error('A source type called "'+a+'" already exists.')):(u.setSourceType(a,p),p.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:p.workerSourceURL},y):y(null,null))},u.prototype.getLight=function(){return this.light.getLight()},u.prototype.setLight=function(a,p){p===void 0&&(p={}),this._checkLoaded();var y=this.light.getLight(),M=!1;for(var S in a)if(!h.deepEqual(a[S],y[S])){M=!0;break}if(M){var j={now:h.browser.now(),transition:h.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(a,p),this.light.updateTransitions(j)}},u.prototype._validate=function(a,p,y,M,S){return S===void 0&&(S={}),(!S||S.validate!==!1)&&Ko(this,a.call(h.validateStyle,h.extend({key:p,style:this.serialize(),value:y,styleSpec:h.styleSpec},M)))},u.prototype._remove=function(){for(var a in this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),h.evented.off("pluginStateChange",this._rtlTextPluginCallback),this._layers)this._layers[a].setEventedParent(null);for(var p in this.sourceCaches)this.sourceCaches[p].clearTiles(),this.sourceCaches[p].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()},u.prototype._clearSource=function(a){this.sourceCaches[a].clearTiles()},u.prototype._reloadSource=function(a){this.sourceCaches[a].resume(),this.sourceCaches[a].reload()},u.prototype._updateSources=function(a){for(var p in this.sourceCaches)this.sourceCaches[p].update(a)},u.prototype._generateCollisionBoxes=function(){for(var a in this.sourceCaches)this._reloadSource(a)},u.prototype._updatePlacement=function(a,p,y,M,S){S===void 0&&(S=!1);for(var j=!1,H=!1,ie={},_e=0,ye=this._order;_e<ye.length;_e+=1){var ge=this._layers[ye[_e]];if(ge.type==="symbol"){if(!ie[ge.source]){var Ie=this.sourceCaches[ge.source];ie[ge.source]=Ie.getRenderableIds(!0).map(function(Je){return Ie.getTileByID(Je)}).sort(function(Je,lt){return lt.tileID.overscaledZ-Je.tileID.overscaledZ||(Je.tileID.isLessThan(lt.tileID)?-1:1)})}var Ee=this.crossTileSymbolIndex.addLayer(ge,ie[ge.source],a.center.lng);j=j||Ee}}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((S=S||this._layerOrderChanged||y===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(h.browser.now(),a.zoom))&&(this.pauseablePlacement=new ra(a,this._order,S,p,y,M,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,ie),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(h.browser.now()),H=!0),j&&this.pauseablePlacement.placement.setStale()),H||j)for(var Ge=0,Ce=this._order;Ge<Ce.length;Ge+=1){var Ne=this._layers[Ce[Ge]];Ne.type==="symbol"&&this.placement.updateLayerOpacities(Ne,ie[Ne.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(h.browser.now())},u.prototype._releaseSymbolFadeTiles=function(){for(var a in this.sourceCaches)this.sourceCaches[a].releaseSymbolFadeTiles()},u.prototype.getImages=function(a,p,y){this.imageManager.getImages(p.icons,y),this._updateTilesForChangedImages();var M=this.sourceCaches[p.source];M&&M.setDependencies(p.tileID.key,p.type,p.icons)},u.prototype.getGlyphs=function(a,p,y){this.glyphManager.getGlyphs(p.stacks,y)},u.prototype.getResource=function(a,p,y){return h.makeRequest(p,y)},u}(h.Evented);Mr.getSourceType=function(n){return ui[n]},Mr.setSourceType=function(n,u){ui[n]=u},Mr.registerForPluginStateChange=h.registerForPluginStateChange;var qr=h.createLayout([{name:"a_pos",type:"Int16",components:2}]),Ho=i(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}`),No=i(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),_a=i(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),Ca=i(`varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,0,1);} else {gl_Position=u_matrix*vec4(circle_center,0,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),ma=i("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),Za=i(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),so=i(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),na=i("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,0.0,1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),Va=i("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),Ea=i("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,0,1);}"),Ds=i(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),Oo=i(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),ga=i(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),Ka=i(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),$r=i(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),qo=i(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),io=i(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),Io=i(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),po=i(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),Jo=i(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_width2=vec2(outset,inset);}`),fo=i(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),Lo=i(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),Go=i(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),ko=i(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),0.0,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));}`),O=i(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),l=i(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),0.0,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(1.0,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`);function i(n,u){var a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=u.match(/attribute ([\w]+) ([\w]+)/g),y=n.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),M=u.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),S=M?M.concat(y):y,j={};return{fragmentSource:n=n.replace(a,function(H,ie,_e,ye,ge){return j[ge]=!0,ie==="define"?`
#ifndef HAS_UNIFORM_u_`+ge+`
varying `+_e+" "+ye+" "+ge+`;
#else
uniform `+_e+" "+ye+" u_"+ge+`;
#endif
`:`
#ifdef HAS_UNIFORM_u_`+ge+`
    `+_e+" "+ye+" "+ge+" = u_"+ge+`;
#endif
`}),vertexSource:u=u.replace(a,function(H,ie,_e,ye,ge){var Ie=ye==="float"?"vec2":"vec4",Ee=ge.match(/color/)?"color":Ie;return j[ge]?ie==="define"?`
#ifndef HAS_UNIFORM_u_`+ge+`
uniform lowp float u_`+ge+`_t;
attribute `+_e+" "+Ie+" a_"+ge+`;
varying `+_e+" "+ye+" "+ge+`;
#else
uniform `+_e+" "+ye+" u_"+ge+`;
#endif
`:Ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ge+`
    `+ge+" = a_"+ge+`;
#else
    `+_e+" "+ye+" "+ge+" = u_"+ge+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ge+`
    `+ge+" = unpack_mix_"+Ee+"(a_"+ge+", u_"+ge+`_t);
#else
    `+_e+" "+ye+" "+ge+" = u_"+ge+`;
#endif
`:ie==="define"?`
#ifndef HAS_UNIFORM_u_`+ge+`
uniform lowp float u_`+ge+`_t;
attribute `+_e+" "+Ie+" a_"+ge+`;
#else
uniform `+_e+" "+ye+" u_"+ge+`;
#endif
`:Ee==="vec4"?`
#ifndef HAS_UNIFORM_u_`+ge+`
    `+_e+" "+ye+" "+ge+" = a_"+ge+`;
#else
    `+_e+" "+ye+" "+ge+" = u_"+ge+`;
#endif
`:`
#ifndef HAS_UNIFORM_u_`+ge+`
    `+_e+" "+ye+" "+ge+" = unpack_mix_"+Ee+"(a_"+ge+", u_"+ge+`_t);
#else
    `+_e+" "+ye+" "+ge+" = u_"+ge+`;
#endif
`}),staticAttributes:p,staticUniforms:S}}var s=Object.freeze({__proto__:null,prelude:Ho,background:No,backgroundPattern:_a,circle:Ca,clippingMask:ma,heatmap:Za,heatmapTexture:so,collisionBox:na,collisionCircle:Va,debug:Ea,fill:Ds,fillOutline:Oo,fillOutlinePattern:ga,fillPattern:Ka,fillExtrusion:$r,fillExtrusionPattern:qo,hillshadePrepare:io,hillshade:Io,line:po,lineGradient:Jo,linePattern:fo,lineSDF:Lo,raster:Go,symbolIcon:ko,symbolSDF:O,symbolTextAndIcon:l}),_=function(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null};function b(n){for(var u=[],a=0;a<n.length;a++)if(n[a]!==null){var p=n[a].split(" ");u.push(p.pop())}return u}_.prototype.bind=function(n,u,a,p,y,M,S,j){this.context=n;for(var H=this.boundPaintVertexBuffers.length!==p.length,ie=0;!H&&ie<p.length;ie++)this.boundPaintVertexBuffers[ie]!==p[ie]&&(H=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===a&&!H&&this.boundIndexBuffer===y&&this.boundVertexOffset===M&&this.boundDynamicVertexBuffer===S&&this.boundDynamicVertexBuffer2===j?(n.bindVertexArrayOES.set(this.vao),S&&S.bind(),y&&y.dynamicDraw&&y.bind(),j&&j.bind()):this.freshBind(u,a,p,y,M,S,j)},_.prototype.freshBind=function(n,u,a,p,y,M,S){var j,H=n.numAttributes,ie=this.context,_e=ie.gl;if(ie.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ie.extVertexArrayObject.createVertexArrayOES(),ie.bindVertexArrayOES.set(this.vao),j=0,this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=a,this.boundIndexBuffer=p,this.boundVertexOffset=y,this.boundDynamicVertexBuffer=M,this.boundDynamicVertexBuffer2=S;else{j=ie.currentNumAttributes||0;for(var ye=H;ye<j;ye++)_e.disableVertexAttribArray(ye)}u.enableAttributes(_e,n);for(var ge=0,Ie=a;ge<Ie.length;ge+=1)Ie[ge].enableAttributes(_e,n);M&&M.enableAttributes(_e,n),S&&S.enableAttributes(_e,n),u.bind(),u.setVertexAttribPointers(_e,n,y);for(var Ee=0,Ge=a;Ee<Ge.length;Ee+=1){var Ce=Ge[Ee];Ce.bind(),Ce.setVertexAttribPointers(_e,n,y)}M&&(M.bind(),M.setVertexAttribPointers(_e,n,y)),p&&p.bind(),S&&(S.bind(),S.setVertexAttribPointers(_e,n,y)),ie.currentNumAttributes=H},_.prototype.destroy=function(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)};var D=function(n,u,a,p,y,M){var S=n.gl;this.program=S.createProgram();for(var j=b(a.staticAttributes),H=p?p.getBinderAttributes():[],ie=j.concat(H),_e=a.staticUniforms?b(a.staticUniforms):[],ye=p?p.getBinderUniforms():[],ge=[],Ie=0,Ee=_e.concat(ye);Ie<Ee.length;Ie+=1){var Ge=Ee[Ie];ge.indexOf(Ge)<0&&ge.push(Ge)}var Ce=p?p.defines():[];M&&Ce.push("#define OVERDRAW_INSPECTOR;");var Ne=Ce.concat(Ho.fragmentSource,a.fragmentSource).join(`
`),Je=Ce.concat(Ho.vertexSource,a.vertexSource).join(`
`),lt=S.createShader(S.FRAGMENT_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(lt,Ne),S.compileShader(lt),S.attachShader(this.program,lt);var yt=S.createShader(S.VERTEX_SHADER);if(S.isContextLost())this.failedToCreate=!0;else{S.shaderSource(yt,Je),S.compileShader(yt),S.attachShader(this.program,yt),this.attributes={};var _t={};this.numAttributes=ie.length;for(var St=0;St<this.numAttributes;St++)ie[St]&&(S.bindAttribLocation(this.program,St,ie[St]),this.attributes[ie[St]]=St);S.linkProgram(this.program),S.deleteShader(yt),S.deleteShader(lt);for(var zt=0;zt<ge.length;zt++){var Ht=ge[zt];if(Ht&&!_t[Ht]){var Ut=S.getUniformLocation(this.program,Ht);Ut&&(_t[Ht]=Ut)}}this.fixedUniforms=y(n,_t),this.binderUniforms=p?p.getUniforms(n,_t):[]}}};function G(n,u,a){var p=1/Ir(a,1,u.transform.tileZoom),y=Math.pow(2,a.tileID.overscaledZ),M=a.tileSize*Math.pow(2,u.transform.tileZoom)/y,S=M*(a.tileID.canonical.x+a.tileID.wrap*y),j=M*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_scale:[p,n.fromScale,n.toScale],u_fade:n.t,u_pixel_coord_upper:[S>>16,j>>16],u_pixel_coord_lower:[65535&S,65535&j]}}D.prototype.draw=function(n,u,a,p,y,M,S,j,H,ie,_e,ye,ge,Ie,Ee,Ge){var Ce,Ne=n.gl;if(!this.failedToCreate){for(var Je in n.program.set(this.program),n.setDepthMode(a),n.setStencilMode(p),n.setColorMode(y),n.setCullFace(M),this.fixedUniforms)this.fixedUniforms[Je].set(S[Je]);Ie&&Ie.setUniforms(n,this.binderUniforms,ye,{zoom:ge});for(var lt=(Ce={},Ce[Ne.LINES]=2,Ce[Ne.TRIANGLES]=3,Ce[Ne.LINE_STRIP]=1,Ce)[u],yt=0,_t=_e.get();yt<_t.length;yt+=1){var St=_t[yt],zt=St.vaos||(St.vaos={});(zt[j]||(zt[j]=new _)).bind(n,this,H,Ie?Ie.getPaintVertexBuffers():[],ie,St.vertexOffset,Ee,Ge),Ne.drawElements(u,St.primitiveLength*lt,Ne.UNSIGNED_SHORT,St.primitiveOffset*lt*2)}}};var Z=function(n,u,a,p){var y=u.style.light,M=y.properties.get("position"),S=[M.x,M.y,M.z],j=h.create$1();y.properties.get("anchor")==="viewport"&&h.fromRotation(j,-u.transform.angle),h.transformMat3(S,S,j);var H=y.properties.get("color");return{u_matrix:n,u_lightpos:S,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[H.r,H.g,H.b],u_vertical_gradient:+a,u_opacity:p}},te=function(n,u,a,p,y,M,S){return h.extend(Z(n,u,a,p),G(M,u,S),{u_height_factor:-Math.pow(2,y.overscaledZ)/S.tileSize/8})},ae=function(n){return{u_matrix:n}},Pe=function(n,u,a,p){return h.extend(ae(n),G(a,u,p))},ve=function(n,u){return{u_matrix:n,u_world:u}},pe=function(n,u,a,p,y){return h.extend(Pe(n,u,a,p),{u_world:y})},Fe=function(n,u,a,p){var y,M,S=n.transform;if(p.paint.get("circle-pitch-alignment")==="map"){var j=Ir(a,1,S.zoom);y=!0,M=[j,j]}else y=!1,M=S.pixelsToGLUnits;return{u_camera_to_center_distance:S.cameraToCenterDistance,u_scale_with_map:+(p.paint.get("circle-pitch-scale")==="map"),u_matrix:n.translatePosMatrix(u.posMatrix,a,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_pitch_with_map:+y,u_device_pixel_ratio:h.browser.devicePixelRatio,u_extrude_scale:M}},ke=function(n,u,a){var p=Ir(a,1,u.zoom),y=Math.pow(2,u.zoom-a.tileID.overscaledZ),M=a.tileID.overscaleFactor();return{u_matrix:n,u_camera_to_center_distance:u.cameraToCenterDistance,u_pixels_to_tile_units:p,u_extrude_scale:[u.pixelsToGLUnits[0]/(p*y),u.pixelsToGLUnits[1]/(p*y)],u_overscale_factor:M}},Ze=function(n,u,a){return{u_matrix:n,u_inv_matrix:u,u_camera_to_center_distance:a.cameraToCenterDistance,u_viewport_size:[a.width,a.height]}},at=function(n,u,a){return a===void 0&&(a=1),{u_matrix:n,u_color:u,u_overlay:0,u_overlay_scale:a}},Ve=function(n){return{u_matrix:n}},st=function(n,u,a,p){return{u_matrix:n,u_extrude_scale:Ir(u,1,a),u_intensity:p}},Pt=function(n,u,a){var p=n.transform;return{u_matrix:nt(n,u,a),u_ratio:1/Ir(u,1,p.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]]}},$e=function(n,u,a,p){return h.extend(Pt(n,u,a),{u_image:0,u_image_height:p})},Ct=function(n,u,a,p){var y=n.transform,M=qe(u,y);return{u_matrix:nt(n,u,a),u_texsize:u.imageAtlasTexture.size,u_ratio:1/Ir(u,1,y.zoom),u_device_pixel_ratio:h.browser.devicePixelRatio,u_image:0,u_scale:[M,p.fromScale,p.toScale],u_fade:p.t,u_units_to_pixels:[1/y.pixelsToGLUnits[0],1/y.pixelsToGLUnits[1]]}},At=function(n,u,a,p,y){var M=n.lineAtlas,S=qe(u,n.transform),j=a.layout.get("line-cap")==="round",H=M.getDash(p.from,j),ie=M.getDash(p.to,j),_e=H.width*y.fromScale,ye=ie.width*y.toScale;return h.extend(Pt(n,u,a),{u_patternscale_a:[S/_e,-H.height/2],u_patternscale_b:[S/ye,-ie.height/2],u_sdfgamma:M.width/(256*Math.min(_e,ye)*h.browser.devicePixelRatio)/2,u_image:0,u_tex_y_a:H.y,u_tex_y_b:ie.y,u_mix:y.t})};function qe(n,u){return 1/Ir(n,1,u.tileZoom)}function nt(n,u,a){return n.translatePosMatrix(u.tileID.posMatrix,u,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}var Xe=function(n,u,a,p,y){return{u_matrix:n,u_tl_parent:u,u_scale_parent:a,u_buffer_scale:1,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(S=y.paint.get("raster-saturation"),S>0?1-1/(1.001-S):-S),u_contrast_factor:(M=y.paint.get("raster-contrast"),M>0?1/(1-M):1+M),u_spin_weights:It(y.paint.get("raster-hue-rotate"))};var M,S};function It(n){n*=Math.PI/180;var u=Math.sin(n),a=Math.cos(n);return[(2*a+1)/3,(-Math.sqrt(3)*u-a+1)/3,(Math.sqrt(3)*u-a+1)/3]}var kt,Nt=function(n,u,a,p,y,M,S,j,H,ie){var _e=y.transform;return{u_is_size_zoom_constant:+(n==="constant"||n==="source"),u_is_size_feature_constant:+(n==="constant"||n==="camera"),u_size_t:u?u.uSizeT:0,u_size:u?u.uSize:0,u_camera_to_center_distance:_e.cameraToCenterDistance,u_pitch:_e.pitch/360*2*Math.PI,u_rotate_symbol:+a,u_aspect_ratio:_e.width/_e.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:M,u_label_plane_matrix:S,u_coord_matrix:j,u_is_text:+H,u_pitch_with_map:+p,u_texsize:ie,u_texture:0}},Rt=function(n,u,a,p,y,M,S,j,H,ie,_e){var ye=y.transform;return h.extend(Nt(n,u,a,p,y,M,S,j,H,ie),{u_gamma_scale:p?Math.cos(ye._pitch)*ye.cameraToCenterDistance:1,u_device_pixel_ratio:h.browser.devicePixelRatio,u_is_halo:+_e})},Qt=function(n,u,a,p,y,M,S,j,H,ie){return h.extend(Rt(n,u,a,p,y,M,S,j,!0,H,!0),{u_texsize_icon:ie,u_texture_icon:1})},Jt=function(n,u,a){return{u_matrix:n,u_opacity:u,u_color:a}},pi=function(n,u,a,p,y,M){return h.extend(function(S,j,H,ie){var _e=H.imageManager.getPattern(S.from.toString()),ye=H.imageManager.getPattern(S.to.toString()),ge=H.imageManager.getPixelSize(),Ie=ge.width,Ee=ge.height,Ge=Math.pow(2,ie.tileID.overscaledZ),Ce=ie.tileSize*Math.pow(2,H.transform.tileZoom)/Ge,Ne=Ce*(ie.tileID.canonical.x+ie.tileID.wrap*Ge),Je=Ce*ie.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:_e.tl,u_pattern_br_a:_e.br,u_pattern_tl_b:ye.tl,u_pattern_br_b:ye.br,u_texsize:[Ie,Ee],u_mix:j.t,u_pattern_size_a:_e.displaySize,u_pattern_size_b:ye.displaySize,u_scale_a:j.fromScale,u_scale_b:j.toScale,u_tile_units_to_pixels:1/Ir(ie,1,H.transform.tileZoom),u_pixel_coord_upper:[Ne>>16,Je>>16],u_pixel_coord_lower:[65535&Ne,65535&Je]}}(p,M,a,y),{u_matrix:n,u_opacity:u})},vi={fillExtrusion:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_lightpos:new h.Uniform3f(n,u.u_lightpos),u_lightintensity:new h.Uniform1f(n,u.u_lightintensity),u_lightcolor:new h.Uniform3f(n,u.u_lightcolor),u_vertical_gradient:new h.Uniform1f(n,u.u_vertical_gradient),u_opacity:new h.Uniform1f(n,u.u_opacity)}},fillExtrusionPattern:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_lightpos:new h.Uniform3f(n,u.u_lightpos),u_lightintensity:new h.Uniform1f(n,u.u_lightintensity),u_lightcolor:new h.Uniform3f(n,u.u_lightcolor),u_vertical_gradient:new h.Uniform1f(n,u.u_vertical_gradient),u_height_factor:new h.Uniform1f(n,u.u_height_factor),u_image:new h.Uniform1i(n,u.u_image),u_texsize:new h.Uniform2f(n,u.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,u.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,u.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,u.u_scale),u_fade:new h.Uniform1f(n,u.u_fade),u_opacity:new h.Uniform1f(n,u.u_opacity)}},fill:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix)}},fillPattern:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_image:new h.Uniform1i(n,u.u_image),u_texsize:new h.Uniform2f(n,u.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,u.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,u.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,u.u_scale),u_fade:new h.Uniform1f(n,u.u_fade)}},fillOutline:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_world:new h.Uniform2f(n,u.u_world)}},fillOutlinePattern:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_world:new h.Uniform2f(n,u.u_world),u_image:new h.Uniform1i(n,u.u_image),u_texsize:new h.Uniform2f(n,u.u_texsize),u_pixel_coord_upper:new h.Uniform2f(n,u.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,u.u_pixel_coord_lower),u_scale:new h.Uniform3f(n,u.u_scale),u_fade:new h.Uniform1f(n,u.u_fade)}},circle:function(n,u){return{u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_scale_with_map:new h.Uniform1i(n,u.u_scale_with_map),u_pitch_with_map:new h.Uniform1i(n,u.u_pitch_with_map),u_extrude_scale:new h.Uniform2f(n,u.u_extrude_scale),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_matrix:new h.UniformMatrix4f(n,u.u_matrix)}},collisionBox:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_pixels_to_tile_units:new h.Uniform1f(n,u.u_pixels_to_tile_units),u_extrude_scale:new h.Uniform2f(n,u.u_extrude_scale),u_overscale_factor:new h.Uniform1f(n,u.u_overscale_factor)}},collisionCircle:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_inv_matrix:new h.UniformMatrix4f(n,u.u_inv_matrix),u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_viewport_size:new h.Uniform2f(n,u.u_viewport_size)}},debug:function(n,u){return{u_color:new h.UniformColor(n,u.u_color),u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_overlay:new h.Uniform1i(n,u.u_overlay),u_overlay_scale:new h.Uniform1f(n,u.u_overlay_scale)}},clippingMask:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix)}},heatmap:function(n,u){return{u_extrude_scale:new h.Uniform1f(n,u.u_extrude_scale),u_intensity:new h.Uniform1f(n,u.u_intensity),u_matrix:new h.UniformMatrix4f(n,u.u_matrix)}},heatmapTexture:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_world:new h.Uniform2f(n,u.u_world),u_image:new h.Uniform1i(n,u.u_image),u_color_ramp:new h.Uniform1i(n,u.u_color_ramp),u_opacity:new h.Uniform1f(n,u.u_opacity)}},hillshade:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_image:new h.Uniform1i(n,u.u_image),u_latrange:new h.Uniform2f(n,u.u_latrange),u_light:new h.Uniform2f(n,u.u_light),u_shadow:new h.UniformColor(n,u.u_shadow),u_highlight:new h.UniformColor(n,u.u_highlight),u_accent:new h.UniformColor(n,u.u_accent)}},hillshadePrepare:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_image:new h.Uniform1i(n,u.u_image),u_dimension:new h.Uniform2f(n,u.u_dimension),u_zoom:new h.Uniform1f(n,u.u_zoom),u_unpack:new h.Uniform4f(n,u.u_unpack)}},line:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_ratio:new h.Uniform1f(n,u.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,u.u_units_to_pixels)}},lineGradient:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_ratio:new h.Uniform1f(n,u.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,u.u_units_to_pixels),u_image:new h.Uniform1i(n,u.u_image),u_image_height:new h.Uniform1f(n,u.u_image_height)}},linePattern:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_texsize:new h.Uniform2f(n,u.u_texsize),u_ratio:new h.Uniform1f(n,u.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_image:new h.Uniform1i(n,u.u_image),u_units_to_pixels:new h.Uniform2f(n,u.u_units_to_pixels),u_scale:new h.Uniform3f(n,u.u_scale),u_fade:new h.Uniform1f(n,u.u_fade)}},lineSDF:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_ratio:new h.Uniform1f(n,u.u_ratio),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_units_to_pixels:new h.Uniform2f(n,u.u_units_to_pixels),u_patternscale_a:new h.Uniform2f(n,u.u_patternscale_a),u_patternscale_b:new h.Uniform2f(n,u.u_patternscale_b),u_sdfgamma:new h.Uniform1f(n,u.u_sdfgamma),u_image:new h.Uniform1i(n,u.u_image),u_tex_y_a:new h.Uniform1f(n,u.u_tex_y_a),u_tex_y_b:new h.Uniform1f(n,u.u_tex_y_b),u_mix:new h.Uniform1f(n,u.u_mix)}},raster:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_tl_parent:new h.Uniform2f(n,u.u_tl_parent),u_scale_parent:new h.Uniform1f(n,u.u_scale_parent),u_buffer_scale:new h.Uniform1f(n,u.u_buffer_scale),u_fade_t:new h.Uniform1f(n,u.u_fade_t),u_opacity:new h.Uniform1f(n,u.u_opacity),u_image0:new h.Uniform1i(n,u.u_image0),u_image1:new h.Uniform1i(n,u.u_image1),u_brightness_low:new h.Uniform1f(n,u.u_brightness_low),u_brightness_high:new h.Uniform1f(n,u.u_brightness_high),u_saturation_factor:new h.Uniform1f(n,u.u_saturation_factor),u_contrast_factor:new h.Uniform1f(n,u.u_contrast_factor),u_spin_weights:new h.Uniform3f(n,u.u_spin_weights)}},symbolIcon:function(n,u){return{u_is_size_zoom_constant:new h.Uniform1i(n,u.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,u.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,u.u_size_t),u_size:new h.Uniform1f(n,u.u_size),u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,u.u_pitch),u_rotate_symbol:new h.Uniform1i(n,u.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,u.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,u.u_fade_change),u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,u.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,u.u_coord_matrix),u_is_text:new h.Uniform1i(n,u.u_is_text),u_pitch_with_map:new h.Uniform1i(n,u.u_pitch_with_map),u_texsize:new h.Uniform2f(n,u.u_texsize),u_texture:new h.Uniform1i(n,u.u_texture)}},symbolSDF:function(n,u){return{u_is_size_zoom_constant:new h.Uniform1i(n,u.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,u.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,u.u_size_t),u_size:new h.Uniform1f(n,u.u_size),u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,u.u_pitch),u_rotate_symbol:new h.Uniform1i(n,u.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,u.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,u.u_fade_change),u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,u.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,u.u_coord_matrix),u_is_text:new h.Uniform1i(n,u.u_is_text),u_pitch_with_map:new h.Uniform1i(n,u.u_pitch_with_map),u_texsize:new h.Uniform2f(n,u.u_texsize),u_texture:new h.Uniform1i(n,u.u_texture),u_gamma_scale:new h.Uniform1f(n,u.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(n,u.u_is_halo)}},symbolTextAndIcon:function(n,u){return{u_is_size_zoom_constant:new h.Uniform1i(n,u.u_is_size_zoom_constant),u_is_size_feature_constant:new h.Uniform1i(n,u.u_is_size_feature_constant),u_size_t:new h.Uniform1f(n,u.u_size_t),u_size:new h.Uniform1f(n,u.u_size),u_camera_to_center_distance:new h.Uniform1f(n,u.u_camera_to_center_distance),u_pitch:new h.Uniform1f(n,u.u_pitch),u_rotate_symbol:new h.Uniform1i(n,u.u_rotate_symbol),u_aspect_ratio:new h.Uniform1f(n,u.u_aspect_ratio),u_fade_change:new h.Uniform1f(n,u.u_fade_change),u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_label_plane_matrix:new h.UniformMatrix4f(n,u.u_label_plane_matrix),u_coord_matrix:new h.UniformMatrix4f(n,u.u_coord_matrix),u_is_text:new h.Uniform1i(n,u.u_is_text),u_pitch_with_map:new h.Uniform1i(n,u.u_pitch_with_map),u_texsize:new h.Uniform2f(n,u.u_texsize),u_texsize_icon:new h.Uniform2f(n,u.u_texsize_icon),u_texture:new h.Uniform1i(n,u.u_texture),u_texture_icon:new h.Uniform1i(n,u.u_texture_icon),u_gamma_scale:new h.Uniform1f(n,u.u_gamma_scale),u_device_pixel_ratio:new h.Uniform1f(n,u.u_device_pixel_ratio),u_is_halo:new h.Uniform1i(n,u.u_is_halo)}},background:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_opacity:new h.Uniform1f(n,u.u_opacity),u_color:new h.UniformColor(n,u.u_color)}},backgroundPattern:function(n,u){return{u_matrix:new h.UniformMatrix4f(n,u.u_matrix),u_opacity:new h.Uniform1f(n,u.u_opacity),u_image:new h.Uniform1i(n,u.u_image),u_pattern_tl_a:new h.Uniform2f(n,u.u_pattern_tl_a),u_pattern_br_a:new h.Uniform2f(n,u.u_pattern_br_a),u_pattern_tl_b:new h.Uniform2f(n,u.u_pattern_tl_b),u_pattern_br_b:new h.Uniform2f(n,u.u_pattern_br_b),u_texsize:new h.Uniform2f(n,u.u_texsize),u_mix:new h.Uniform1f(n,u.u_mix),u_pattern_size_a:new h.Uniform2f(n,u.u_pattern_size_a),u_pattern_size_b:new h.Uniform2f(n,u.u_pattern_size_b),u_scale_a:new h.Uniform1f(n,u.u_scale_a),u_scale_b:new h.Uniform1f(n,u.u_scale_b),u_pixel_coord_upper:new h.Uniform2f(n,u.u_pixel_coord_upper),u_pixel_coord_lower:new h.Uniform2f(n,u.u_pixel_coord_lower),u_tile_units_to_pixels:new h.Uniform1f(n,u.u_tile_units_to_pixels)}}};function gi(n,u,a,p,y,M,S){for(var j=n.context,H=j.gl,ie=n.useProgram("collisionBox"),_e=[],ye=0,ge=0,Ie=0;Ie<p.length;Ie++){var Ee=p[Ie],Ge=u.getTile(Ee),Ce=Ge.getBucket(a);if(Ce){var Ne=Ee.posMatrix;y[0]===0&&y[1]===0||(Ne=n.translatePosMatrix(Ee.posMatrix,Ge,y,M));var Je=S?Ce.textCollisionBox:Ce.iconCollisionBox,lt=Ce.collisionCircleArray;if(lt.length>0){var yt=h.create(),_t=Ne;h.mul(yt,Ce.placementInvProjMatrix,n.transform.glCoordMatrix),h.mul(yt,yt,Ce.placementViewportMatrix),_e.push({circleArray:lt,circleOffset:ge,transform:_t,invTransform:yt}),ge=ye+=lt.length/4}Je&&ie.draw(j,H.LINES,ue.disabled,be.disabled,n.colorModeForRenderPass(),je.disabled,ke(Ne,n.transform,Ge),a.id,Je.layoutVertexBuffer,Je.indexBuffer,Je.segments,null,n.transform.zoom,null,null,Je.collisionVertexBuffer)}}if(S&&_e.length){var St=n.useProgram("collisionCircle"),zt=new h.StructArrayLayout2f1f2i16;zt.resize(4*ye),zt._trim();for(var Ht=0,Ut=0,Xt=_e;Ut<Xt.length;Ut+=1)for(var hi=Xt[Ut],Di=0;Di<hi.circleArray.length/4;Di++){var Li=4*Di,Ji=hi.circleArray[Li+0],mi=hi.circleArray[Li+1],sr=hi.circleArray[Li+2],mr=hi.circleArray[Li+3];zt.emplace(Ht++,Ji,mi,sr,mr,0),zt.emplace(Ht++,Ji,mi,sr,mr,1),zt.emplace(Ht++,Ji,mi,sr,mr,2),zt.emplace(Ht++,Ji,mi,sr,mr,3)}(!kt||kt.length<2*ye)&&(kt=function(an){var zo=2*an,Tn=new h.StructArrayLayout3ui6;Tn.resize(zo),Tn._trim();for(var Qn=0;Qn<zo;Qn++){var $n=6*Qn;Tn.uint16[$n+0]=4*Qn+0,Tn.uint16[$n+1]=4*Qn+1,Tn.uint16[$n+2]=4*Qn+2,Tn.uint16[$n+3]=4*Qn+2,Tn.uint16[$n+4]=4*Qn+3,Tn.uint16[$n+5]=4*Qn+0}return Tn}(ye));for(var lr=j.createIndexBuffer(kt,!0),Xi=j.createVertexBuffer(zt,h.collisionCircleLayout.members,!0),Pr=0,qi=_e;Pr<qi.length;Pr+=1){var er=qi[Pr],Yn=Ze(er.transform,er.invTransform,n.transform);St.draw(j,H.TRIANGLES,ue.disabled,be.disabled,n.colorModeForRenderPass(),je.disabled,Yn,a.id,Xi,lr,h.SegmentVector.simpleSegment(0,2*er.circleOffset,er.circleArray.length,er.circleArray.length/2),null,n.transform.zoom,null,null,null)}Xi.destroy(),lr.destroy()}}var jt=h.identity(new Float32Array(16));function $t(n,u,a,p,y,M){var S=h.getAnchorAlignment(n),j=-(S.horizontalAlign-.5)*u,H=-(S.verticalAlign-.5)*a,ie=h.evaluateVariableOffset(n,p);return new h.Point((j/y+ie[0])*M,(H/y+ie[1])*M)}function Oi(n,u,a,p,y,M,S,j,H,ie,_e){var ye=n.text.placedSymbolArray,ge=n.text.dynamicLayoutVertexArray,Ie=n.icon.dynamicLayoutVertexArray,Ee={};ge.clear();for(var Ge=0;Ge<ye.length;Ge++){var Ce=ye.get(Ge),Ne=Ce.hidden||!Ce.crossTileID||n.allowVerticalPlacement&&!Ce.placedOrientation?null:p[Ce.crossTileID];if(Ne){var Je=new h.Point(Ce.anchorX,Ce.anchorY),lt=cr(Je,a?j:S),yt=Ei(M.cameraToCenterDistance,lt.signedDistanceFromCamera),_t=y.evaluateSizeForFeature(n.textSizeData,ie,Ce)*yt/h.ONE_EM;a&&(_t*=n.tilePixelRatio/H);for(var St=$t(Ne.anchor,Ne.width,Ne.height,Ne.textOffset,Ne.textBoxScale,_t),zt=a?cr(Je.add(St),S).point:lt.point.add(u?St.rotate(-M.angle):St),Ht=n.allowVerticalPlacement&&Ce.placedOrientation===h.WritingMode.vertical?Math.PI/2:0,Ut=0;Ut<Ce.numGlyphs;Ut++)h.addDynamicAttributes(ge,zt,Ht);_e&&Ce.associatedIconIndex>=0&&(Ee[Ce.associatedIconIndex]={shiftedAnchor:zt,angle:Ht})}else gn(Ce.numGlyphs,ge)}if(_e){Ie.clear();for(var Xt=n.icon.placedSymbolArray,hi=0;hi<Xt.length;hi++){var Di=Xt.get(hi);if(Di.hidden)gn(Di.numGlyphs,Ie);else{var Li=Ee[hi];if(Li)for(var Ji=0;Ji<Di.numGlyphs;Ji++)h.addDynamicAttributes(Ie,Li.shiftedAnchor,Li.angle);else gn(Di.numGlyphs,Ie)}}n.icon.dynamicLayoutVertexBuffer.updateData(Ie)}n.text.dynamicLayoutVertexBuffer.updateData(ge)}function Ui(n,u,a){return a.iconsInText&&u?"symbolTextAndIcon":n?"symbolSDF":"symbolIcon"}function xi(n,u,a,p,y,M,S,j,H,ie,_e,ye){for(var ge=n.context,Ie=ge.gl,Ee=n.transform,Ge=j==="map",Ce=H==="map",Ne=Ge&&a.layout.get("symbol-placement")!=="point",Je=Ge&&!Ce&&!Ne,lt=a.layout.get("symbol-sort-key").constantOr(1)!==void 0,yt=n.depthModeForSublayer(0,ue.ReadOnly),_t=a.layout.get("text-variable-anchor"),St=[],zt=0,Ht=p;zt<Ht.length;zt+=1){var Ut=Ht[zt],Xt=u.getTile(Ut),hi=Xt.getBucket(a);if(hi){var Di=y?hi.text:hi.icon;if(Di&&Di.segments.get().length){var Li=Di.programConfigurations.get(a.id),Ji=y||hi.sdfIcons,mi=y?hi.textSizeData:hi.iconSizeData,sr=Ce||Ee.pitch!==0,mr=n.useProgram(Ui(Ji,y,hi),Li),lr=h.evaluateSizeForZoom(mi,Ee.zoom),Xi=void 0,Pr=[0,0],qi=void 0,er=void 0,Yn=null,an=void 0;if(y)qi=Xt.glyphAtlasTexture,er=Ie.LINEAR,Xi=Xt.glyphAtlasTexture.size,hi.iconsInText&&(Pr=Xt.imageAtlasTexture.size,Yn=Xt.imageAtlasTexture,an=sr||n.options.rotating||n.options.zooming||mi.kind==="composite"||mi.kind==="camera"?Ie.LINEAR:Ie.NEAREST);else{var zo=a.layout.get("icon-size").constantOr(0)!==1||hi.iconsNeedLinear;qi=Xt.imageAtlasTexture,er=Ji||n.options.rotating||n.options.zooming||zo||sr?Ie.LINEAR:Ie.NEAREST,Xi=Xt.imageAtlasTexture.size}var Tn=Ir(Xt,1,n.transform.zoom),Qn=hn(Ut.posMatrix,Ce,Ge,n.transform,Tn),$n=jr(Ut.posMatrix,Ce,Ge,n.transform,Tn),ha=_t&&hi.hasTextData(),es=a.layout.get("icon-text-fit")!=="none"&&ha&&hi.hasIconData();Ne&&Rn(hi,Ut.posMatrix,n,y,Qn,$n,Ce,ie);var Bo=n.translatePosMatrix(Ut.posMatrix,Xt,M,S),Mo=Ne||y&&_t||es?jt:Qn,Fo=n.translatePosMatrix($n,Xt,M,S,!0),Zo=Ji&&a.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1)!==0,fs={program:mr,buffers:Di,uniformValues:Ji?hi.iconsInText?Qt(mi.kind,lr,Je,Ce,n,Bo,Mo,Fo,Xi,Pr):Rt(mi.kind,lr,Je,Ce,n,Bo,Mo,Fo,y,Xi,!0):Nt(mi.kind,lr,Je,Ce,n,Bo,Mo,Fo,y,Xi),atlasTexture:qi,atlasTextureIcon:Yn,atlasInterpolation:er,atlasInterpolationIcon:an,isSDF:Ji,hasHalo:Zo};if(lt)for(var _s=0,Ns=Di.segments.get();_s<Ns.length;_s+=1){var oo=Ns[_s];St.push({segments:new h.SegmentVector([oo]),sortKey:oo.sortKey,state:fs})}else St.push({segments:Di.segments,sortKey:0,state:fs})}}}lt&&St.sort(function(nl,Ra){return nl.sortKey-Ra.sortKey});for(var ms=0,Gs=St;ms<Gs.length;ms+=1){var Aa=Gs[ms],lo=Aa.state;if(ge.activeTexture.set(Ie.TEXTURE0),lo.atlasTexture.bind(lo.atlasInterpolation,Ie.CLAMP_TO_EDGE),lo.atlasTextureIcon&&(ge.activeTexture.set(Ie.TEXTURE1),lo.atlasTextureIcon&&lo.atlasTextureIcon.bind(lo.atlasInterpolationIcon,Ie.CLAMP_TO_EDGE)),lo.isSDF){var Da=lo.uniformValues;lo.hasHalo&&(Da.u_is_halo=1,li(lo.buffers,Aa.segments,a,n,lo.program,yt,_e,ye,Da)),Da.u_is_halo=0}li(lo.buffers,Aa.segments,a,n,lo.program,yt,_e,ye,lo.uniformValues)}}function li(n,u,a,p,y,M,S,j,H){var ie=p.context;y.draw(ie,ie.gl.TRIANGLES,M,S,j,je.disabled,H,a.id,n.layoutVertexBuffer,n.indexBuffer,u,a.paint,p.transform.zoom,n.programConfigurations.get(a.id),n.dynamicLayoutVertexBuffer,n.opacityVertexBuffer)}function Fi(n,u,a,p,y,M,S){var j,H,ie,_e,ye,ge=n.context.gl,Ie=a.paint.get("fill-pattern"),Ee=Ie&&Ie.constantOr(1),Ge=a.getCrossfadeParameters();S?(H=Ee&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",j=ge.LINES):(H=Ee?"fillPattern":"fill",j=ge.TRIANGLES);for(var Ce=0,Ne=p;Ce<Ne.length;Ce+=1){var Je=Ne[Ce],lt=u.getTile(Je);if(!Ee||lt.patternsLoaded()){var yt=lt.getBucket(a);if(yt){var _t=yt.programConfigurations.get(a.id),St=n.useProgram(H,_t);Ee&&(n.context.activeTexture.set(ge.TEXTURE0),lt.imageAtlasTexture.bind(ge.LINEAR,ge.CLAMP_TO_EDGE),_t.updatePaintBuffers(Ge));var zt=Ie.constantOr(null);if(zt&&lt.imageAtlas){var Ht=lt.imageAtlas,Ut=Ht.patternPositions[zt.to.toString()],Xt=Ht.patternPositions[zt.from.toString()];Ut&&Xt&&_t.setConstantPatternPositions(Ut,Xt)}var hi=n.translatePosMatrix(Je.posMatrix,lt,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(S){_e=yt.indexBuffer2,ye=yt.segments2;var Di=[ge.drawingBufferWidth,ge.drawingBufferHeight];ie=H==="fillOutlinePattern"&&Ee?pe(hi,n,Ge,lt,Di):ve(hi,Di)}else _e=yt.indexBuffer,ye=yt.segments,ie=Ee?Pe(hi,n,Ge,lt):ae(hi);St.draw(n.context,j,y,n.stencilModeForClipping(Je),M,je.disabled,ie,a.id,yt.layoutVertexBuffer,_e,ye,a.paint,n.transform.zoom,_t)}}}}function Wi(n,u,a,p,y,M,S){for(var j=n.context,H=j.gl,ie=a.paint.get("fill-extrusion-pattern"),_e=ie.constantOr(1),ye=a.getCrossfadeParameters(),ge=a.paint.get("fill-extrusion-opacity"),Ie=0,Ee=p;Ie<Ee.length;Ie+=1){var Ge=Ee[Ie],Ce=u.getTile(Ge),Ne=Ce.getBucket(a);if(Ne){var Je=Ne.programConfigurations.get(a.id),lt=n.useProgram(_e?"fillExtrusionPattern":"fillExtrusion",Je);_e&&(n.context.activeTexture.set(H.TEXTURE0),Ce.imageAtlasTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),Je.updatePaintBuffers(ye));var yt=ie.constantOr(null);if(yt&&Ce.imageAtlas){var _t=Ce.imageAtlas,St=_t.patternPositions[yt.to.toString()],zt=_t.patternPositions[yt.from.toString()];St&&zt&&Je.setConstantPatternPositions(St,zt)}var Ht=n.translatePosMatrix(Ge.posMatrix,Ce,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Ut=a.paint.get("fill-extrusion-vertical-gradient"),Xt=_e?te(Ht,n,Ut,ge,Ge,ye,Ce):Z(Ht,n,Ut,ge);lt.draw(j,j.gl.TRIANGLES,y,M,S,je.backCCW,Xt,a.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,a.paint,n.transform.zoom,Je)}}}function tr(n,u,a,p,y,M){var S=n.context,j=S.gl,H=u.fbo;if(H){var ie=n.useProgram("hillshade");S.activeTexture.set(j.TEXTURE0),j.bindTexture(j.TEXTURE_2D,H.colorAttachment.get());var _e=function(ye,ge,Ie){var Ee=Ie.paint.get("hillshade-shadow-color"),Ge=Ie.paint.get("hillshade-highlight-color"),Ce=Ie.paint.get("hillshade-accent-color"),Ne=Ie.paint.get("hillshade-illumination-direction")*(Math.PI/180);Ie.paint.get("hillshade-illumination-anchor")==="viewport"&&(Ne-=ye.transform.angle);var Je,lt,yt,_t=!ye.options.moving;return{u_matrix:ye.transform.calculatePosMatrix(ge.tileID.toUnwrapped(),_t),u_image:0,u_latrange:(Je=ge.tileID,lt=Math.pow(2,Je.canonical.z),yt=Je.canonical.y,[new h.MercatorCoordinate(0,yt/lt).toLngLat().lat,new h.MercatorCoordinate(0,(yt+1)/lt).toLngLat().lat]),u_light:[Ie.paint.get("hillshade-exaggeration"),Ne],u_shadow:Ee,u_highlight:Ge,u_accent:Ce}}(n,u,a);ie.draw(S,j.TRIANGLES,p,y,M,je.disabled,_e,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}}function Zi(n,u,a,p,y,M){var S=n.context,j=S.gl,H=u.dem;if(H&&H.data){var ie=H.dim,_e=H.stride,ye=H.getPixels();if(S.activeTexture.set(j.TEXTURE1),S.pixelStoreUnpackPremultiplyAlpha.set(!1),u.demTexture=u.demTexture||n.getTileTexture(_e),u.demTexture){var ge=u.demTexture;ge.update(ye,{premultiply:!1}),ge.bind(j.NEAREST,j.CLAMP_TO_EDGE)}else u.demTexture=new h.Texture(S,ye,j.RGBA,{premultiply:!1}),u.demTexture.bind(j.NEAREST,j.CLAMP_TO_EDGE);S.activeTexture.set(j.TEXTURE0);var Ie=u.fbo;if(!Ie){var Ee=new h.Texture(S,{width:ie,height:ie,data:null},j.RGBA);Ee.bind(j.LINEAR,j.CLAMP_TO_EDGE),(Ie=u.fbo=S.createFramebuffer(ie,ie,!0)).colorAttachment.set(Ee.texture)}S.bindFramebuffer.set(Ie.framebuffer),S.viewport.set([0,0,ie,ie]),n.useProgram("hillshadePrepare").draw(S,j.TRIANGLES,p,y,M,je.disabled,function(Ge,Ce){var Ne=Ce.stride,Je=h.create();return h.ortho(Je,0,h.EXTENT,-h.EXTENT,0,0,1),h.translate(Je,Je,[0,-h.EXTENT,0]),{u_matrix:Je,u_image:1,u_dimension:[Ne,Ne],u_zoom:Ge.overscaledZ,u_unpack:Ce.getUnpackVector()}}(u.tileID,H),a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments),u.needsHillshadePrepare=!1}}function Yi(n,u,a,p,y){var M=p.paint.get("raster-fade-duration");if(M>0){var S=h.browser.now(),j=(S-n.timeAdded)/M,H=u?(S-u.timeAdded)/M:-1,ie=a.getSource(),_e=y.coveringZoomLevel({tileSize:ie.tileSize,roundZoom:ie.roundZoom}),ye=!u||Math.abs(u.tileID.overscaledZ-_e)>Math.abs(n.tileID.overscaledZ-_e),ge=ye&&n.refreshedUponExpiration?1:h.clamp(ye?j:1-H,0,1);return n.refreshedUponExpiration&&j>=1&&(n.refreshedUponExpiration=!1),u?{opacity:1,mix:1-ge}:{opacity:ge,mix:0}}return{opacity:1,mix:0}}var ar=new h.Color(1,0,0,1),rr=new h.Color(0,1,0,1),nr=new h.Color(0,0,1,1),br=new h.Color(1,0,1,1),Bn=new h.Color(0,1,1,1);function en(n,u,a,p){oa(n,0,u+a/2,n.transform.width,a,p)}function Oa(n,u,a,p){oa(n,u-a/2,0,a,n.transform.height,p)}function oa(n,u,a,p,y,M){var S=n.context,j=S.gl;j.enable(j.SCISSOR_TEST),j.scissor(u*h.browser.devicePixelRatio,a*h.browser.devicePixelRatio,p*h.browser.devicePixelRatio,y*h.browser.devicePixelRatio),S.clear({color:M}),j.disable(j.SCISSOR_TEST)}function Js(n,u,a){var p=n.context,y=p.gl,M=a.posMatrix,S=n.useProgram("debug"),j=ue.disabled,H=be.disabled,ie=n.colorModeForRenderPass();p.activeTexture.set(y.TEXTURE0),n.emptyTexture.bind(y.LINEAR,y.CLAMP_TO_EDGE),S.draw(p,y.LINE_STRIP,j,H,ie,je.disabled,at(M,h.Color.red),"$debug",n.debugBuffer,n.tileBorderIndexBuffer,n.debugSegments);var _e=u.getTileByID(a.key).latestRawTileData,ye=Math.floor((_e&&_e.byteLength||0)/1024),ge=u.getTile(a).tileSize,Ie=512/Math.min(ge,512)*(a.overscaledZ/n.transform.zoom)*.5,Ee=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(Ee+=" => "+a.overscaledZ),function(Ge,Ce){Ge.initDebugOverlayCanvas();var Ne=Ge.debugOverlayCanvas,Je=Ge.context.gl,lt=Ge.debugOverlayCanvas.getContext("2d");lt.clearRect(0,0,Ne.width,Ne.height),lt.shadowColor="white",lt.shadowBlur=2,lt.lineWidth=1.5,lt.strokeStyle="white",lt.textBaseline="top",lt.font="bold 36px Open Sans, sans-serif",lt.fillText(Ce,5,5),lt.strokeText(Ce,5,5),Ge.debugOverlayTexture.update(Ne),Ge.debugOverlayTexture.bind(Je.LINEAR,Je.CLAMP_TO_EDGE)}(n,Ee+" "+ye+"kb"),S.draw(p,y.TRIANGLES,j,H,Oe.alphaBlended,je.disabled,at(M,h.Color.transparent,Ie),"$debug",n.debugBuffer,n.quadTriangleIndexBuffer,n.debugSegments)}var Xo={symbol:function(n,u,a,p,y){if(n.renderPass==="translucent"){var M=be.disabled,S=n.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(j,H,ie,_e,ye,ge,Ie){for(var Ee=H.transform,Ge=ye==="map",Ce=ge==="map",Ne=0,Je=j;Ne<Je.length;Ne+=1){var lt=Je[Ne],yt=_e.getTile(lt),_t=yt.getBucket(ie);if(_t&&_t.text&&_t.text.segments.get().length){var St=h.evaluateSizeForZoom(_t.textSizeData,Ee.zoom),zt=Ir(yt,1,H.transform.zoom),Ht=hn(lt.posMatrix,Ce,Ge,H.transform,zt),Ut=ie.layout.get("icon-text-fit")!=="none"&&_t.hasIconData();if(St){var Xt=Math.pow(2,Ee.zoom-yt.tileID.overscaledZ);Oi(_t,Ge,Ce,Ie,h.symbolSize,Ee,Ht,lt.posMatrix,Xt,St,Ut)}}}}(p,n,a,u,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),y),a.paint.get("icon-opacity").constantOr(1)!==0&&xi(n,u,a,p,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),M,S),a.paint.get("text-opacity").constantOr(1)!==0&&xi(n,u,a,p,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),M,S),u.map.showCollisionBoxes&&(gi(n,u,a,p,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),gi(n,u,a,p,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))}},circle:function(n,u,a,p){if(n.renderPass==="translucent"){var y=a.paint.get("circle-opacity"),M=a.paint.get("circle-stroke-width"),S=a.paint.get("circle-stroke-opacity"),j=a.layout.get("circle-sort-key").constantOr(1)!==void 0;if(y.constantOr(1)!==0||M.constantOr(1)!==0&&S.constantOr(1)!==0){for(var H=n.context,ie=H.gl,_e=n.depthModeForSublayer(0,ue.ReadOnly),ye=be.disabled,ge=n.colorModeForRenderPass(),Ie=[],Ee=0;Ee<p.length;Ee++){var Ge=p[Ee],Ce=u.getTile(Ge),Ne=Ce.getBucket(a);if(Ne){var Je=Ne.programConfigurations.get(a.id),lt={programConfiguration:Je,program:n.useProgram("circle",Je),layoutVertexBuffer:Ne.layoutVertexBuffer,indexBuffer:Ne.indexBuffer,uniformValues:Fe(n,Ge,Ce,a)};if(j)for(var yt=0,_t=Ne.segments.get();yt<_t.length;yt+=1){var St=_t[yt];Ie.push({segments:new h.SegmentVector([St]),sortKey:St.sortKey,state:lt})}else Ie.push({segments:Ne.segments,sortKey:0,state:lt})}}j&&Ie.sort(function(hi,Di){return hi.sortKey-Di.sortKey});for(var zt=0,Ht=Ie;zt<Ht.length;zt+=1){var Ut=Ht[zt],Xt=Ut.state;Xt.program.draw(H,ie.TRIANGLES,_e,ye,ge,je.disabled,Xt.uniformValues,a.id,Xt.layoutVertexBuffer,Xt.indexBuffer,Ut.segments,a.paint,n.transform.zoom,Xt.programConfiguration)}}}},heatmap:function(n,u,a,p){if(a.paint.get("heatmap-opacity")!==0)if(n.renderPass==="offscreen"){var y=n.context,M=y.gl,S=be.disabled,j=new Oe([M.ONE,M.ONE],h.Color.transparent,[!0,!0,!0,!0]);(function(Ie,Ee,Ge){var Ce=Ie.gl;Ie.activeTexture.set(Ce.TEXTURE1),Ie.viewport.set([0,0,Ee.width/4,Ee.height/4]);var Ne=Ge.heatmapFbo;if(Ne)Ce.bindTexture(Ce.TEXTURE_2D,Ne.colorAttachment.get()),Ie.bindFramebuffer.set(Ne.framebuffer);else{var Je=Ce.createTexture();Ce.bindTexture(Ce.TEXTURE_2D,Je),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_S,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_WRAP_T,Ce.CLAMP_TO_EDGE),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MIN_FILTER,Ce.LINEAR),Ce.texParameteri(Ce.TEXTURE_2D,Ce.TEXTURE_MAG_FILTER,Ce.LINEAR),Ne=Ge.heatmapFbo=Ie.createFramebuffer(Ee.width/4,Ee.height/4,!1),function(lt,yt,_t,St){var zt=lt.gl;zt.texImage2D(zt.TEXTURE_2D,0,zt.RGBA,yt.width/4,yt.height/4,0,zt.RGBA,lt.extRenderToTextureHalfFloat?lt.extTextureHalfFloat.HALF_FLOAT_OES:zt.UNSIGNED_BYTE,null),St.colorAttachment.set(_t)}(Ie,Ee,Je,Ne)}})(y,n,a),y.clear({color:h.Color.transparent});for(var H=0;H<p.length;H++){var ie=p[H];if(!u.hasRenderableParent(ie)){var _e=u.getTile(ie),ye=_e.getBucket(a);if(ye){var ge=ye.programConfigurations.get(a.id);n.useProgram("heatmap",ge).draw(y,M.TRIANGLES,ue.disabled,S,j,je.disabled,st(ie.posMatrix,_e,n.transform.zoom,a.paint.get("heatmap-intensity")),a.id,ye.layoutVertexBuffer,ye.indexBuffer,ye.segments,a.paint,n.transform.zoom,ge)}}}y.viewport.set([0,0,n.width,n.height])}else n.renderPass==="translucent"&&(n.context.setColorMode(n.colorModeForRenderPass()),function(Ie,Ee){var Ge=Ie.context,Ce=Ge.gl,Ne=Ee.heatmapFbo;if(Ne){Ge.activeTexture.set(Ce.TEXTURE0),Ce.bindTexture(Ce.TEXTURE_2D,Ne.colorAttachment.get()),Ge.activeTexture.set(Ce.TEXTURE1);var Je=Ee.colorRampTexture;Je||(Je=Ee.colorRampTexture=new h.Texture(Ge,Ee.colorRamp,Ce.RGBA)),Je.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Ie.useProgram("heatmapTexture").draw(Ge,Ce.TRIANGLES,ue.disabled,be.disabled,Ie.colorModeForRenderPass(),je.disabled,function(lt,yt,_t,St){var zt=h.create();h.ortho(zt,0,lt.width,lt.height,0,0,1);var Ht=lt.context.gl;return{u_matrix:zt,u_world:[Ht.drawingBufferWidth,Ht.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:yt.paint.get("heatmap-opacity")}}(Ie,Ee),Ee.id,Ie.viewportBuffer,Ie.quadTriangleIndexBuffer,Ie.viewportSegments,Ee.paint,Ie.transform.zoom)}}(n,a))},line:function(n,u,a,p){if(n.renderPass==="translucent"){var y=a.paint.get("line-opacity"),M=a.paint.get("line-width");if(y.constantOr(1)!==0&&M.constantOr(1)!==0)for(var S=n.depthModeForSublayer(0,ue.ReadOnly),j=n.colorModeForRenderPass(),H=a.paint.get("line-dasharray"),ie=a.paint.get("line-pattern"),_e=ie.constantOr(1),ye=a.paint.get("line-gradient"),ge=a.getCrossfadeParameters(),Ie=_e?"linePattern":H?"lineSDF":ye?"lineGradient":"line",Ee=n.context,Ge=Ee.gl,Ce=!0,Ne=0,Je=p;Ne<Je.length;Ne+=1){var lt=Je[Ne],yt=u.getTile(lt);if(!_e||yt.patternsLoaded()){var _t=yt.getBucket(a);if(_t){var St=_t.programConfigurations.get(a.id),zt=n.context.program.get(),Ht=n.useProgram(Ie,St),Ut=Ce||Ht.program!==zt,Xt=ie.constantOr(null);if(Xt&&yt.imageAtlas){var hi=yt.imageAtlas,Di=hi.patternPositions[Xt.to.toString()],Li=hi.patternPositions[Xt.from.toString()];Di&&Li&&St.setConstantPatternPositions(Di,Li)}var Ji=_e?Ct(n,yt,a,ge):H?At(n,yt,a,H,ge):ye?$e(n,yt,a,_t.lineClipsArray.length):Pt(n,yt,a);if(_e)Ee.activeTexture.set(Ge.TEXTURE0),yt.imageAtlasTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),St.updatePaintBuffers(ge);else if(H&&(Ut||n.lineAtlas.dirty))Ee.activeTexture.set(Ge.TEXTURE0),n.lineAtlas.bind(Ee);else if(ye){var mi=_t.gradients[a.id],sr=mi.texture;if(a.gradientVersion!==mi.version){var mr=256;if(a.stepInterpolant){var lr=u.getSource().maxzoom,Xi=lt.canonical.z===lr?Math.ceil(1<<n.transform.maxZoom-lt.canonical.z):1;mr=h.clamp(h.nextPowerOfTwo(_t.maxLineLength/h.EXTENT*1024*Xi),256,Ee.maxTextureSize)}mi.gradient=h.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:mr,image:mi.gradient||void 0,clips:_t.lineClipsArray}),mi.texture?mi.texture.update(mi.gradient):mi.texture=new h.Texture(Ee,mi.gradient,Ge.RGBA),mi.version=a.gradientVersion,sr=mi.texture}Ee.activeTexture.set(Ge.TEXTURE0),sr.bind(a.stepInterpolant?Ge.NEAREST:Ge.LINEAR,Ge.CLAMP_TO_EDGE)}Ht.draw(Ee,Ge.TRIANGLES,S,n.stencilModeForClipping(lt),j,je.disabled,Ji,a.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,a.paint,n.transform.zoom,St,_t.layoutVertexBuffer2),Ce=!1}}}}},fill:function(n,u,a,p){var y=a.paint.get("fill-color"),M=a.paint.get("fill-opacity");if(M.constantOr(1)!==0){var S=n.colorModeForRenderPass(),j=a.paint.get("fill-pattern"),H=n.opaquePassEnabledForLayer()&&!j.constantOr(1)&&y.constantOr(h.Color.transparent).a===1&&M.constantOr(0)===1?"opaque":"translucent";if(n.renderPass===H){var ie=n.depthModeForSublayer(1,n.renderPass==="opaque"?ue.ReadWrite:ue.ReadOnly);Fi(n,u,a,p,ie,S,!1)}if(n.renderPass==="translucent"&&a.paint.get("fill-antialias")){var _e=n.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,ue.ReadOnly);Fi(n,u,a,p,_e,S,!0)}}},"fill-extrusion":function(n,u,a,p){var y=a.paint.get("fill-extrusion-opacity");if(y!==0&&n.renderPass==="translucent"){var M=new ue(n.context.gl.LEQUAL,ue.ReadWrite,n.depthRangeFor3D);if(y!==1||a.paint.get("fill-extrusion-pattern").constantOr(1))Wi(n,u,a,p,M,be.disabled,Oe.disabled),Wi(n,u,a,p,M,n.stencilModeFor3D(),n.colorModeForRenderPass());else{var S=n.colorModeForRenderPass();Wi(n,u,a,p,M,be.disabled,S)}}},hillshade:function(n,u,a,p){if(n.renderPass==="offscreen"||n.renderPass==="translucent"){for(var y=n.context,M=n.depthModeForSublayer(0,ue.ReadOnly),S=n.colorModeForRenderPass(),j=n.renderPass==="translucent"?n.stencilConfigForOverlap(p):[{},p],H=j[0],ie=0,_e=j[1];ie<_e.length;ie+=1){var ye=_e[ie],ge=u.getTile(ye);ge.needsHillshadePrepare&&n.renderPass==="offscreen"?Zi(n,ge,a,M,be.disabled,S):n.renderPass==="translucent"&&tr(n,ge,a,M,H[ye.overscaledZ],S)}y.viewport.set([0,0,n.width,n.height])}},raster:function(n,u,a,p){if(n.renderPass==="translucent"&&a.paint&&a.paint.get("raster-opacity")!==0&&p.length)for(var y=n.context,M=y.gl,S=u.getSource(),j=n.useProgram("raster"),H=n.colorModeForRenderPass(),ie=S instanceof Lt?[{},p]:n.stencilConfigForOverlap(p),_e=ie[0],ye=ie[1],ge=ye[ye.length-1].overscaledZ,Ie=!n.options.moving,Ee=0,Ge=ye;Ee<Ge.length;Ee+=1){var Ce=Ge[Ee],Ne=n.depthModeForSublayer(Ce.overscaledZ-ge,a.paint.get("raster-opacity")===1?ue.ReadWrite:ue.ReadOnly,M.LESS),Je=u.getTile(Ce),lt=n.transform.calculatePosMatrix(Ce.toUnwrapped(),Ie);Je.registerFadeDuration(a.paint.get("raster-fade-duration"));var yt=u.findLoadedParent(Ce,0),_t=Yi(Je,yt,u,a,n.transform),St=void 0,zt=void 0,Ht=a.paint.get("raster-resampling")==="nearest"?M.NEAREST:M.LINEAR;y.activeTexture.set(M.TEXTURE0),Je.texture.bind(Ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),y.activeTexture.set(M.TEXTURE1),yt?(yt.texture.bind(Ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST),St=Math.pow(2,yt.tileID.overscaledZ-Je.tileID.overscaledZ),zt=[Je.tileID.canonical.x*St%1,Je.tileID.canonical.y*St%1]):Je.texture.bind(Ht,M.CLAMP_TO_EDGE,M.LINEAR_MIPMAP_NEAREST);var Ut=Xe(lt,zt||[0,0],St||1,_t,a);S instanceof Lt?j.draw(y,M.TRIANGLES,Ne,be.disabled,H,je.disabled,Ut,a.id,S.boundsBuffer,n.quadTriangleIndexBuffer,S.boundsSegments):j.draw(y,M.TRIANGLES,Ne,_e[Ce.overscaledZ],H,je.disabled,Ut,a.id,n.rasterBoundsBuffer,n.quadTriangleIndexBuffer,n.rasterBoundsSegments)}},background:function(n,u,a){var p=a.paint.get("background-color"),y=a.paint.get("background-opacity");if(y!==0){var M=n.context,S=M.gl,j=n.transform,H=j.tileSize,ie=a.paint.get("background-pattern");if(!n.isPatternMissing(ie)){var _e=!ie&&p.a===1&&y===1&&n.opaquePassEnabledForLayer()?"opaque":"translucent";if(n.renderPass===_e){var ye=be.disabled,ge=n.depthModeForSublayer(0,_e==="opaque"?ue.ReadWrite:ue.ReadOnly),Ie=n.colorModeForRenderPass(),Ee=n.useProgram(ie?"backgroundPattern":"background"),Ge=j.coveringTiles({tileSize:H});ie&&(M.activeTexture.set(S.TEXTURE0),n.imageManager.bind(n.context));for(var Ce=a.getCrossfadeParameters(),Ne=0,Je=Ge;Ne<Je.length;Ne+=1){var lt=Je[Ne],yt=n.transform.calculatePosMatrix(lt.toUnwrapped()),_t=ie?pi(yt,y,n,ie,{tileID:lt,tileSize:H},Ce):Jt(yt,y,p);Ee.draw(M,S.TRIANGLES,ge,ye,Ie,je.disabled,_t,a.id,n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}}}},debug:function(n,u,a){for(var p=0;p<a.length;p++)Js(n,u,a[p])},custom:function(n,u,a){var p=n.context,y=a.implementation;if(n.renderPass==="offscreen"){var M=y.prerender;M&&(n.setCustomLayerDefaults(),p.setColorMode(n.colorModeForRenderPass()),M.call(y,p.gl,n.transform.customLayerMatrix()),p.setDirty(),n.setBaseState())}else if(n.renderPass==="translucent"){n.setCustomLayerDefaults(),p.setColorMode(n.colorModeForRenderPass()),p.setStencilMode(be.disabled);var S=y.renderingMode==="3d"?new ue(n.context.gl.LEQUAL,ue.ReadWrite,n.depthRangeFor3D):n.depthModeForSublayer(0,ue.ReadOnly);p.setDepthMode(S),y.render(p.gl,n.transform.customLayerMatrix()),p.setDirty(),n.setBaseState(),p.bindFramebuffer.set(null)}}},kr=function(n,u){this.context=new xe(n),this.transform=u,this._tileTextures={},this.setup(),this.numSublayers=Le.maxUnderzooming+Le.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Kn,this.gpuTimers={}};kr.prototype.resize=function(n,u){if(this.width=n*h.browser.devicePixelRatio,this.height=u*h.browser.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(var a=0,p=this.style._order;a<p.length;a+=1)this.style._layers[p[a]].resize()},kr.prototype.setup=function(){var n=this.context,u=new h.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(h.EXTENT,0),u.emplaceBack(0,h.EXTENT),u.emplaceBack(h.EXTENT,h.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(u,qr.members),this.tileExtentSegments=h.SegmentVector.simpleSegment(0,0,4,2);var a=new h.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(h.EXTENT,0),a.emplaceBack(0,h.EXTENT),a.emplaceBack(h.EXTENT,h.EXTENT),this.debugBuffer=n.createVertexBuffer(a,qr.members),this.debugSegments=h.SegmentVector.simpleSegment(0,0,4,5);var p=new h.StructArrayLayout4i8;p.emplaceBack(0,0,0,0),p.emplaceBack(h.EXTENT,0,h.EXTENT,0),p.emplaceBack(0,h.EXTENT,0,h.EXTENT),p.emplaceBack(h.EXTENT,h.EXTENT,h.EXTENT,h.EXTENT),this.rasterBoundsBuffer=n.createVertexBuffer(p,it.members),this.rasterBoundsSegments=h.SegmentVector.simpleSegment(0,0,4,2);var y=new h.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(1,0),y.emplaceBack(0,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,qr.members),this.viewportSegments=h.SegmentVector.simpleSegment(0,0,4,2);var M=new h.StructArrayLayout1ui2;M.emplaceBack(0),M.emplaceBack(1),M.emplaceBack(3),M.emplaceBack(2),M.emplaceBack(0),this.tileBorderIndexBuffer=n.createIndexBuffer(M);var S=new h.StructArrayLayout3ui6;S.emplaceBack(0,1,2),S.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(S),this.emptyTexture=new h.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA);var j=this.context.gl;this.stencilClearMode=new be({func:j.ALWAYS,mask:0},0,255,j.ZERO,j.ZERO,j.ZERO)},kr.prototype.clearStencil=function(){var n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0;var a=h.create();h.ortho(a,0,this.width,this.height,0,0,1),h.scale(a,a,[u.drawingBufferWidth,u.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(n,u.TRIANGLES,ue.disabled,this.stencilClearMode,Oe.disabled,je.disabled,Ve(a),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)},kr.prototype._renderTileClippingMasks=function(n,u){if(this.currentStencilSource!==n.source&&n.isTileClipped()&&u&&u.length){this.currentStencilSource=n.source;var a=this.context,p=a.gl;this.nextStencilID+u.length>256&&this.clearStencil(),a.setColorMode(Oe.disabled),a.setDepthMode(ue.disabled);var y=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(var M=0,S=u;M<S.length;M+=1){var j=S[M],H=this._tileClippingMaskIDs[j.key]=this.nextStencilID++;y.draw(a,p.TRIANGLES,ue.disabled,new be({func:p.ALWAYS,mask:0},H,255,p.KEEP,p.KEEP,p.REPLACE),Oe.disabled,je.disabled,Ve(j.posMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}},kr.prototype.stencilModeFor3D=function(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();var n=this.nextStencilID++,u=this.context.gl;return new be({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)},kr.prototype.stencilModeForClipping=function(n){var u=this.context.gl;return new be({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)},kr.prototype.stencilConfigForOverlap=function(n){var u,a=this.context.gl,p=n.sort(function(H,ie){return ie.overscaledZ-H.overscaledZ}),y=p[p.length-1].overscaledZ,M=p[0].overscaledZ-y+1;if(M>1){this.currentStencilSource=void 0,this.nextStencilID+M>256&&this.clearStencil();for(var S={},j=0;j<M;j++)S[j+y]=new be({func:a.GEQUAL,mask:255},j+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=M,[S,p]}return[(u={},u[y]=be.disabled,u),p]},kr.prototype.colorModeForRenderPass=function(){var n=this.context.gl;return this._showOverdrawInspector?new Oe([n.CONSTANT_COLOR,n.ONE],new h.Color(1/8,1/8,1/8,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Oe.unblended:Oe.alphaBlended},kr.prototype.depthModeForSublayer=function(n,u,a){if(!this.opaquePassEnabledForLayer())return ue.disabled;var p=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new ue(a||this.context.gl.LEQUAL,u,[p,p])},kr.prototype.opaquePassEnabledForLayer=function(){return this.currentLayer<this.opaquePassCutoff},kr.prototype.render=function(n,u){var a=this;this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(h.browser.now()),this.imageManager.beginFrame();var p=this.style._order,y=this.style.sourceCaches;for(var M in y){var S=y[M];S.used&&S.prepare(this.context)}var j,H,ie={},_e={},ye={};for(var ge in y){var Ie=y[ge];ie[ge]=Ie.getVisibleCoordinates(),_e[ge]=ie[ge].slice().reverse(),ye[ge]=Ie.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(var Ee=0;Ee<p.length;Ee++)if(this.style._layers[p[Ee]].is3D()){this.opaquePassCutoff=Ee;break}this.renderPass="offscreen";for(var Ge=0,Ce=p;Ge<Ce.length;Ge+=1){var Ne=this.style._layers[Ce[Ge]];if(Ne.hasOffscreenPass()&&!Ne.isHidden(this.transform.zoom)){var Je=_e[Ne.source];(Ne.type==="custom"||Je.length)&&this.renderLayer(this,y[Ne.source],Ne,Je)}}for(this.context.bindFramebuffer.set(null),this.context.clear({color:u.showOverdrawInspector?h.Color.black:h.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.depthRangeFor3D=[0,1-(n._order.length+2)*this.numSublayers*this.depthEpsilon],this.renderPass="opaque",this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){var lt=this.style._layers[p[this.currentLayer]],yt=y[lt.source],_t=ie[lt.source];this._renderTileClippingMasks(lt,_t),this.renderLayer(this,yt,lt,_t)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){var St=this.style._layers[p[this.currentLayer]],zt=y[St.source],Ht=(St.type==="symbol"?ye:_e)[St.source];this._renderTileClippingMasks(St,ie[St.source]),this.renderLayer(this,zt,St,Ht)}this.options.showTileBoundaries&&(h.values(this.style._layers).forEach(function(Ut){Ut.source&&!Ut.isHidden(a.transform.zoom)&&(Ut.source!==(H&&H.id)&&(H=a.style.sourceCaches[Ut.source]),(!j||j.getSource().maxzoom<H.getSource().maxzoom)&&(j=H))}),j&&Xo.debug(this,j,j.getVisibleCoordinates())),this.options.showPadding&&function(Ut){var Xt=Ut.transform.padding;en(Ut,Ut.transform.height-(Xt.top||0),3,ar),en(Ut,Xt.bottom||0,3,rr),Oa(Ut,Xt.left||0,3,nr),Oa(Ut,Ut.transform.width-(Xt.right||0),3,br);var hi=Ut.transform.centerPoint;(function(Di,Li,Ji,mi){oa(Di,Li-1,Ji-10,2,20,mi),oa(Di,Li-10,Ji-1,20,2,mi)})(Ut,hi.x,Ut.transform.height-hi.y,Bn)}(this),this.context.setDefault()},kr.prototype.renderLayer=function(n,u,a,p){a.isHidden(this.transform.zoom)||(a.type==="background"||a.type==="custom"||p.length)&&(this.id=a.id,this.gpuTimingStart(a),Xo[a.type](n,u,a,p,this.style.placement.variableOffsets),this.gpuTimingEnd())},kr.prototype.gpuTimingStart=function(n){if(this.options.gpuTiming){var u=this.context.extTimerQuery,a=this.gpuTimers[n.id];a||(a=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),a.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,a.query)}},kr.prototype.gpuTimingEnd=function(){if(this.options.gpuTiming){var n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}},kr.prototype.collectGpuTimers=function(){var n=this.gpuTimers;return this.gpuTimers={},n},kr.prototype.queryGpuTimers=function(n){var u={};for(var a in n){var p=n[a],y=this.context.extTimerQuery,M=y.getQueryObjectEXT(p.query,y.QUERY_RESULT_EXT)/1e6;y.deleteQueryEXT(p.query),u[a]=M}return u},kr.prototype.translatePosMatrix=function(n,u,a,p,y){if(!a[0]&&!a[1])return n;var M=y?p==="map"?this.transform.angle:0:p==="viewport"?-this.transform.angle:0;if(M){var S=Math.sin(M),j=Math.cos(M);a=[a[0]*j-a[1]*S,a[0]*S+a[1]*j]}var H=[y?a[0]:Ir(u,a[0],this.transform.zoom),y?a[1]:Ir(u,a[1],this.transform.zoom),0],ie=new Float32Array(16);return h.translate(ie,n,H),ie},kr.prototype.saveTileTexture=function(n){var u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]},kr.prototype.getTileTexture=function(n){var u=this._tileTextures[n];return u&&u.length>0?u.pop():null},kr.prototype.isPatternMissing=function(n){if(!n)return!1;if(!n.from||!n.to)return!0;var u=this.imageManager.getPattern(n.from.toString()),a=this.imageManager.getPattern(n.to.toString());return!u||!a},kr.prototype.useProgram=function(n,u){this.cache=this.cache||{};var a=""+n+(u?u.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"");return this.cache[a]||(this.cache[a]=new D(this.context,n,s[n],u,vi[n],this._showOverdrawInspector)),this.cache[a]},kr.prototype.setCustomLayerDefaults=function(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()},kr.prototype.setBaseState=function(){var n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)},kr.prototype.initDebugOverlayCanvas=function(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=h.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new h.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))},kr.prototype.destroy=function(){this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()};var ss=function(n,u){this.points=n,this.planes=u};ss.fromInvProjectionMatrix=function(n,u,a){var p=Math.pow(2,a),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(function(S){return h.transformMat4([],S,n)}).map(function(S){return h.scale$1([],S,1/S[3]/u*p)}),M=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(function(S){var j=h.sub([],y[S[0]],y[S[1]]),H=h.sub([],y[S[2]],y[S[1]]),ie=h.normalize([],h.cross([],j,H)),_e=-h.dot(ie,y[S[1]]);return ie.concat(_e)});return new ss(y,M)};var ya=function(n,u){this.min=n,this.max=u,this.center=h.scale$2([],h.add([],this.min,this.max),.5)};ya.prototype.quadrant=function(n){for(var u=[n%2==0,n<2],a=h.clone$2(this.min),p=h.clone$2(this.max),y=0;y<u.length;y++)a[y]=u[y]?this.min[y]:this.center[y],p[y]=u[y]?this.center[y]:this.max[y];return p[2]=this.max[2],new ya(a,p)},ya.prototype.distanceX=function(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]},ya.prototype.distanceY=function(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]},ya.prototype.intersects=function(n){for(var u=[[this.min[0],this.min[1],0,1],[this.max[0],this.min[1],0,1],[this.max[0],this.max[1],0,1],[this.min[0],this.max[1],0,1]],a=!0,p=0;p<n.planes.length;p++){for(var y=n.planes[p],M=0,S=0;S<u.length;S++)M+=h.dot$1(y,u[S])>=0;if(M===0)return 0;M!==u.length&&(a=!1)}if(a)return 2;for(var j=0;j<3;j++){for(var H=Number.MAX_VALUE,ie=-Number.MAX_VALUE,_e=0;_e<n.points.length;_e++){var ye=n.points[_e][j]-this.min[j];H=Math.min(H,ye),ie=Math.max(ie,ye)}if(ie<0||H>this.max[j]-this.min[j])return 0}return 1};var aa=function(n,u,a,p){if(n===void 0&&(n=0),u===void 0&&(u=0),a===void 0&&(a=0),p===void 0&&(p=0),isNaN(n)||n<0||isNaN(u)||u<0||isNaN(a)||a<0||isNaN(p)||p<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=a,this.right=p};aa.prototype.interpolate=function(n,u,a){return u.top!=null&&n.top!=null&&(this.top=h.number(n.top,u.top,a)),u.bottom!=null&&n.bottom!=null&&(this.bottom=h.number(n.bottom,u.bottom,a)),u.left!=null&&n.left!=null&&(this.left=h.number(n.left,u.left,a)),u.right!=null&&n.right!=null&&(this.right=h.number(n.right,u.right,a)),this},aa.prototype.getCenter=function(n,u){var a=h.clamp((this.left+n-this.right)/2,0,n),p=h.clamp((this.top+u-this.bottom)/2,0,u);return new h.Point(a,p)},aa.prototype.equals=function(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right},aa.prototype.clone=function(){return new aa(this.top,this.bottom,this.left,this.right)},aa.prototype.toJSON=function(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}};var pr=function(n,u,a,p,y){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=y===void 0||y,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=a==null?0:a,this._maxPitch=p==null?60:p,this.setMaxBounds(),this.width=0,this.height=0,this._center=new h.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new aa,this._posMatrixCache={},this._alignedPosMatrixCache={}},Ar={minZoom:{configurable:!0},maxZoom:{configurable:!0},minPitch:{configurable:!0},maxPitch:{configurable:!0},renderWorldCopies:{configurable:!0},worldSize:{configurable:!0},centerOffset:{configurable:!0},size:{configurable:!0},bearing:{configurable:!0},pitch:{configurable:!0},fov:{configurable:!0},zoom:{configurable:!0},center:{configurable:!0},padding:{configurable:!0},centerPoint:{configurable:!0},unmodified:{configurable:!0},point:{configurable:!0}};pr.prototype.clone=function(){var n=new pr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.tileSize=this.tileSize,n.latRange=this.latRange,n.width=this.width,n.height=this.height,n._center=this._center,n.zoom=this.zoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._calcMatrices(),n},Ar.minZoom.get=function(){return this._minZoom},Ar.minZoom.set=function(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))},Ar.maxZoom.get=function(){return this._maxZoom},Ar.maxZoom.set=function(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))},Ar.minPitch.get=function(){return this._minPitch},Ar.minPitch.set=function(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))},Ar.maxPitch.get=function(){return this._maxPitch},Ar.maxPitch.set=function(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))},Ar.renderWorldCopies.get=function(){return this._renderWorldCopies},Ar.renderWorldCopies.set=function(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n},Ar.worldSize.get=function(){return this.tileSize*this.scale},Ar.centerOffset.get=function(){return this.centerPoint._sub(this.size._div(2))},Ar.size.get=function(){return new h.Point(this.width,this.height)},Ar.bearing.get=function(){return-this.angle/Math.PI*180},Ar.bearing.set=function(n){var u=-h.wrap(n,-180,180)*Math.PI/180;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=h.create$2(),h.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))},Ar.pitch.get=function(){return this._pitch/Math.PI*180},Ar.pitch.set=function(n){var u=h.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())},Ar.fov.get=function(){return this._fov/Math.PI*180},Ar.fov.set=function(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())},Ar.zoom.get=function(){return this._zoom},Ar.zoom.set=function(n){var u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._zoom=u,this.scale=this.zoomScale(u),this.tileZoom=Math.floor(u),this.zoomFraction=u-this.tileZoom,this._constrain(),this._calcMatrices())},Ar.center.get=function(){return this._center},Ar.center.set=function(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._constrain(),this._calcMatrices())},Ar.padding.get=function(){return this._edgeInsets.toJSON()},Ar.padding.set=function(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())},Ar.centerPoint.get=function(){return this._edgeInsets.getCenter(this.width,this.height)},pr.prototype.isPaddingEqual=function(n){return this._edgeInsets.equals(n)},pr.prototype.interpolatePadding=function(n,u,a){this._unmodified=!1,this._edgeInsets.interpolate(n,u,a),this._constrain(),this._calcMatrices()},pr.prototype.coveringZoomLevel=function(n){var u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)},pr.prototype.getVisibleUnwrappedCoordinates=function(n){var u=[new h.UnwrappedTileID(0,n)];if(this._renderWorldCopies)for(var a=this.pointCoordinate(new h.Point(0,0)),p=this.pointCoordinate(new h.Point(this.width,0)),y=this.pointCoordinate(new h.Point(this.width,this.height)),M=this.pointCoordinate(new h.Point(0,this.height)),S=Math.floor(Math.min(a.x,p.x,y.x,M.x)),j=Math.floor(Math.max(a.x,p.x,y.x,M.x)),H=S-1;H<=j+1;H++)H!==0&&u.push(new h.UnwrappedTileID(H,n));return u},pr.prototype.coveringTiles=function(n){var u=this.coveringZoomLevel(n),a=u;if(n.minzoom!==void 0&&u<n.minzoom)return[];n.maxzoom!==void 0&&u>n.maxzoom&&(u=n.maxzoom);var p=h.MercatorCoordinate.fromLngLat(this.center),y=Math.pow(2,u),M=[y*p.x,y*p.y,0],S=ss.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u),j=n.minzoom||0;this.pitch<=60&&this._edgeInsets.top<.1&&(j=u);var H=function(Ut){return{aabb:new ya([Ut*y,0,0],[(Ut+1)*y,y,0]),zoom:0,x:0,y:0,wrap:Ut,fullyVisible:!1}},ie=[],_e=[],ye=u,ge=n.reparseOverscaled?a:u;if(this._renderWorldCopies)for(var Ie=1;Ie<=3;Ie++)ie.push(H(-Ie)),ie.push(H(Ie));for(ie.push(H(0));ie.length>0;){var Ee=ie.pop(),Ge=Ee.x,Ce=Ee.y,Ne=Ee.fullyVisible;if(!Ne){var Je=Ee.aabb.intersects(S);if(Je===0)continue;Ne=Je===2}var lt=Ee.aabb.distanceX(M),yt=Ee.aabb.distanceY(M),_t=Math.max(Math.abs(lt),Math.abs(yt));if(Ee.zoom===ye||_t>3+(1<<ye-Ee.zoom)-2&&Ee.zoom>=j)_e.push({tileID:new h.OverscaledTileID(Ee.zoom===ye?ge:Ee.zoom,Ee.wrap,Ee.zoom,Ge,Ce),distanceSq:h.sqrLen([M[0]-.5-Ge,M[1]-.5-Ce])});else for(var St=0;St<4;St++){var zt=(Ge<<1)+St%2,Ht=(Ce<<1)+(St>>1);ie.push({aabb:Ee.aabb.quadrant(St),zoom:Ee.zoom+1,x:zt,y:Ht,wrap:Ee.wrap,fullyVisible:Ne})}}return _e.sort(function(Ut,Xt){return Ut.distanceSq-Xt.distanceSq}).map(function(Ut){return Ut.tileID})},pr.prototype.resize=function(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()},Ar.unmodified.get=function(){return this._unmodified},pr.prototype.zoomScale=function(n){return Math.pow(2,n)},pr.prototype.scaleZoom=function(n){return Math.log(n)/Math.LN2},pr.prototype.project=function(n){var u=h.clamp(n.lat,-this.maxValidLatitude,this.maxValidLatitude);return new h.Point(h.mercatorXfromLng(n.lng)*this.worldSize,h.mercatorYfromLat(u)*this.worldSize)},pr.prototype.unproject=function(n){return new h.MercatorCoordinate(n.x/this.worldSize,n.y/this.worldSize).toLngLat()},Ar.point.get=function(){return this.project(this.center)},pr.prototype.setLocationAtPoint=function(n,u){var a=this.pointCoordinate(u),p=this.pointCoordinate(this.centerPoint),y=this.locationCoordinate(n),M=new h.MercatorCoordinate(y.x-(a.x-p.x),y.y-(a.y-p.y));this.center=this.coordinateLocation(M),this._renderWorldCopies&&(this.center=this.center.wrap())},pr.prototype.locationPoint=function(n){return this.coordinatePoint(this.locationCoordinate(n))},pr.prototype.pointLocation=function(n){return this.coordinateLocation(this.pointCoordinate(n))},pr.prototype.locationCoordinate=function(n){return h.MercatorCoordinate.fromLngLat(n)},pr.prototype.coordinateLocation=function(n){return n.toLngLat()},pr.prototype.pointCoordinate=function(n){var u=[n.x,n.y,0,1],a=[n.x,n.y,1,1];h.transformMat4(u,u,this.pixelMatrixInverse),h.transformMat4(a,a,this.pixelMatrixInverse);var p=u[3],y=a[3],M=u[1]/p,S=a[1]/y,j=u[2]/p,H=a[2]/y,ie=j===H?0:(0-j)/(H-j);return new h.MercatorCoordinate(h.number(u[0]/p,a[0]/y,ie)/this.worldSize,h.number(M,S,ie)/this.worldSize)},pr.prototype.coordinatePoint=function(n){var u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return h.transformMat4(u,u,this.pixelMatrix),new h.Point(u[0]/u[3],u[1]/u[3])},pr.prototype.getBounds=function(){return new h.LngLatBounds().extend(this.pointLocation(new h.Point(0,0))).extend(this.pointLocation(new h.Point(this.width,0))).extend(this.pointLocation(new h.Point(this.width,this.height))).extend(this.pointLocation(new h.Point(0,this.height)))},pr.prototype.getMaxBounds=function(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new h.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null},pr.prototype.setMaxBounds=function(n){n?(this.lngRange=[n.getWest(),n.getEast()],this.latRange=[n.getSouth(),n.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])},pr.prototype.calculatePosMatrix=function(n,u){u===void 0&&(u=!1);var a=n.key,p=u?this._alignedPosMatrixCache:this._posMatrixCache;if(p[a])return p[a];var y=n.canonical,M=this.worldSize/this.zoomScale(y.z),S=y.x+Math.pow(2,y.z)*n.wrap,j=h.identity(new Float64Array(16));return h.translate(j,j,[S*M,y.y*M,0]),h.scale(j,j,[M/h.EXTENT,M/h.EXTENT,1]),h.multiply(j,u?this.alignedProjMatrix:this.projMatrix,j),p[a]=new Float32Array(j),p[a]},pr.prototype.customLayerMatrix=function(){return this.mercatorMatrix.slice()},pr.prototype._constrain=function(){if(this.center&&this.width&&this.height&&!this._constraining){this._constraining=!0;var n,u,a,p,y=-90,M=90,S=-180,j=180,H=this.size,ie=this._unmodified;if(this.latRange){var _e=this.latRange;y=h.mercatorYfromLat(_e[1])*this.worldSize,n=(M=h.mercatorYfromLat(_e[0])*this.worldSize)-y<H.y?H.y/(M-y):0}if(this.lngRange){var ye=this.lngRange;S=h.mercatorXfromLng(ye[0])*this.worldSize,u=(j=h.mercatorXfromLng(ye[1])*this.worldSize)-S<H.x?H.x/(j-S):0}var ge=this.point,Ie=Math.max(u||0,n||0);if(Ie)return this.center=this.unproject(new h.Point(u?(j+S)/2:ge.x,n?(M+y)/2:ge.y)),this.zoom+=this.scaleZoom(Ie),this._unmodified=ie,void(this._constraining=!1);if(this.latRange){var Ee=ge.y,Ge=H.y/2;Ee-Ge<y&&(p=y+Ge),Ee+Ge>M&&(p=M-Ge)}if(this.lngRange){var Ce=ge.x,Ne=H.x/2;Ce-Ne<S&&(a=S+Ne),Ce+Ne>j&&(a=j-Ne)}a===void 0&&p===void 0||(this.center=this.unproject(new h.Point(a!==void 0?a:ge.x,p!==void 0?p:ge.y))),this._unmodified=ie,this._constraining=!1}},pr.prototype._calcMatrices=function(){if(this.height){var n=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;var u=Math.PI/2+this._pitch,a=this._fov*(.5+n.y/this.height),p=Math.sin(a)*this.cameraToCenterDistance/Math.sin(h.clamp(Math.PI-u-a,.01,Math.PI-.01)),y=this.point,M=y.x,S=y.y,j=1.01*(Math.cos(Math.PI/2-this._pitch)*p+this.cameraToCenterDistance),H=this.height/50,ie=new Float64Array(16);h.perspective(ie,this._fov,this.width/this.height,H,j),ie[8]=2*-n.x/this.width,ie[9]=2*n.y/this.height,h.scale(ie,ie,[1,-1,1]),h.translate(ie,ie,[0,0,-this.cameraToCenterDistance]),h.rotateX(ie,ie,this._pitch),h.rotateZ(ie,ie,this.angle),h.translate(ie,ie,[-M,-S,0]),this.mercatorMatrix=h.scale([],ie,[this.worldSize,this.worldSize,this.worldSize]),h.scale(ie,ie,[1,1,h.mercatorZfromAltitude(1,this.center.lat)*this.worldSize,1]),this.projMatrix=ie,this.invProjMatrix=h.invert([],this.projMatrix);var _e=this.width%2/2,ye=this.height%2/2,ge=Math.cos(this.angle),Ie=Math.sin(this.angle),Ee=M-Math.round(M)+ge*_e+Ie*ye,Ge=S-Math.round(S)+ge*ye+Ie*_e,Ce=new Float64Array(ie);if(h.translate(Ce,Ce,[Ee>.5?Ee-1:Ee,Ge>.5?Ge-1:Ge,0]),this.alignedProjMatrix=Ce,ie=h.create(),h.scale(ie,ie,[this.width/2,-this.height/2,1]),h.translate(ie,ie,[1,-1,0]),this.labelPlaneMatrix=ie,ie=h.create(),h.scale(ie,ie,[1,-1,1]),h.translate(ie,ie,[-1,-1,0]),h.scale(ie,ie,[2/this.width,2/this.height,1]),this.glCoordMatrix=ie,this.pixelMatrix=h.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),!(ie=h.invert(new Float64Array(16),this.pixelMatrix)))throw new Error("failed to invert matrix");this.pixelMatrixInverse=ie,this._posMatrixCache={},this._alignedPosMatrixCache={}}},pr.prototype.maxPitchScaleFactor=function(){if(!this.pixelMatrixInverse)return 1;var n=this.pointCoordinate(new h.Point(0,0)),u=[n.x*this.worldSize,n.y*this.worldSize,0,1];return h.transformMat4(u,u,this.pixelMatrix)[3]/this.cameraToCenterDistance},pr.prototype.getCameraPoint=function(){var n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new h.Point(0,n))},pr.prototype.getCameraQueryGeometry=function(n){var u=this.getCameraPoint();if(n.length===1)return[n[0],u];for(var a=u.x,p=u.y,y=u.x,M=u.y,S=0,j=n;S<j.length;S+=1){var H=j[S];a=Math.min(a,H.x),p=Math.min(p,H.y),y=Math.max(y,H.x),M=Math.max(M,H.y)}return[new h.Point(a,p),new h.Point(y,p),new h.Point(y,M),new h.Point(a,M),new h.Point(a,p)]},Object.defineProperties(pr.prototype,Ar);var _o=function(n){var u,a,p,y;this._hashName=n&&encodeURIComponent(n),h.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=(u=this._updateHashUnthrottled.bind(this),a=!1,p=null,y=function(){p=null,a&&(u(),p=setTimeout(y,300),a=!1)},function(){return a=!0,p||y(),p})};_o.prototype.addTo=function(n){return this._map=n,h.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this},_o.prototype.remove=function(){return h.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this},_o.prototype.getHashString=function(n){var u=this._map.getCenter(),a=Math.round(100*this._map.getZoom())/100,p=Math.ceil((a*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,p),M=Math.round(u.lng*y)/y,S=Math.round(u.lat*y)/y,j=this._map.getBearing(),H=this._map.getPitch(),ie="";if(ie+=n?"/"+M+"/"+S+"/"+a:a+"/"+S+"/"+M,(j||H)&&(ie+="/"+Math.round(10*j)/10),H&&(ie+="/"+Math.round(H)),this._hashName){var _e=this._hashName,ye=!1,ge=h.window.location.hash.slice(1).split("&").map(function(Ie){var Ee=Ie.split("=")[0];return Ee===_e?(ye=!0,Ee+"="+ie):Ie}).filter(function(Ie){return Ie});return ye||ge.push(_e+"="+ie),"#"+ge.join("&")}return"#"+ie},_o.prototype._getCurrentHash=function(){var n,u=this,a=h.window.location.hash.replace("#","");return this._hashName?(a.split("&").map(function(p){return p.split("=")}).forEach(function(p){p[0]===u._hashName&&(n=p)}),(n&&n[1]||"").split("/")):a.split("/")},_o.prototype._onHashChange=function(){var n=this._getCurrentHash();if(n.length>=3&&!n.some(function(a){return isNaN(a)})){var u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:u,pitch:+(n[4]||0)}),!0}return!1},_o.prototype._updateHashUnthrottled=function(){var n=this.getHashString();try{h.window.history.replaceState(h.window.history.state,"",n)}catch(u){}};var Ha={linearity:.3,easing:h.bezier(0,0,.3,1)},Ia=h.extend({deceleration:2500,maxSpeed:1400},Ha),ls=h.extend({deceleration:20,maxSpeed:1400},Ha),o=h.extend({deceleration:1e3,maxSpeed:360},Ha),d=h.extend({deceleration:1e3,maxSpeed:90},Ha),P=function(n){this._map=n,this.clear()};function U(n,u){(!n.duration||n.duration<u.duration)&&(n.duration=u.duration,n.easing=u.easing)}function Y(n,u,a){var p=a.maxSpeed,y=a.linearity,M=a.deceleration,S=h.clamp(n*y/(u/1e3),-p,p),j=Math.abs(S)/(M*y);return{easing:a.easing,duration:1e3*j,amount:S*(j/2)}}P.prototype.clear=function(){this._inertiaBuffer=[]},P.prototype.record=function(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:h.browser.now(),settings:n})},P.prototype._drainInertiaBuffer=function(){for(var n=this._inertiaBuffer,u=h.browser.now();n.length>0&&u-n[0].time>160;)n.shift()},P.prototype._onMoveEnd=function(n){if(this._drainInertiaBuffer(),!(this._inertiaBuffer.length<2)){for(var u={zoom:0,bearing:0,pitch:0,pan:new h.Point(0,0),pinchAround:void 0,around:void 0},a=0,p=this._inertiaBuffer;a<p.length;a+=1){var y=p[a].settings;u.zoom+=y.zoomDelta||0,u.bearing+=y.bearingDelta||0,u.pitch+=y.pitchDelta||0,y.panDelta&&u.pan._add(y.panDelta),y.around&&(u.around=y.around),y.pinchAround&&(u.pinchAround=y.pinchAround)}var M=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,S={};if(u.pan.mag()){var j=Y(u.pan.mag(),M,h.extend({},Ia,n||{}));S.offset=u.pan.mult(j.amount/u.pan.mag()),S.center=this._map.transform.center,U(S,j)}if(u.zoom){var H=Y(u.zoom,M,ls);S.zoom=this._map.transform.zoom+H.amount,U(S,H)}if(u.bearing){var ie=Y(u.bearing,M,o);S.bearing=this._map.transform.bearing+h.clamp(ie.amount,-179,179),U(S,ie)}if(u.pitch){var _e=Y(u.pitch,M,d);S.pitch=this._map.transform.pitch+_e.amount,U(S,_e)}if(S.zoom||S.bearing){var ye=u.pinchAround===void 0?u.around:u.pinchAround;S.around=ye?this._map.unproject(ye):this._map.getCenter()}return this.clear(),h.extend(S,{noMoveStart:!0})}};var me=function(n){function u(p,y,M,S){S===void 0&&(S={});var j=k.mousePos(y.getCanvasContainer(),M),H=y.unproject(j);n.call(this,p,h.extend({point:j,lngLat:H,originalEvent:M},S)),this._defaultPrevented=!1,this.target=y}n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u;var a={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,a),u}(h.Event),Ke=function(n){function u(p,y,M){var S=p==="touchend"?M.changedTouches:M.touches,j=k.touchPos(y.getCanvasContainer(),S),H=j.map(function(ye){return y.unproject(ye)}),ie=j.reduce(function(ye,ge,Ie,Ee){return ye.add(ge.div(Ee.length))},new h.Point(0,0)),_e=y.unproject(ie);n.call(this,p,{points:j,point:ie,lngLats:H,lngLat:_e,originalEvent:M}),this._defaultPrevented=!1}n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u;var a={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,a),u}(h.Event),Tt=function(n){function u(p,y,M){n.call(this,p,{originalEvent:M}),this._defaultPrevented=!1}n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u;var a={defaultPrevented:{configurable:!0}};return u.prototype.preventDefault=function(){this._defaultPrevented=!0},a.defaultPrevented.get=function(){return this._defaultPrevented},Object.defineProperties(u.prototype,a),u}(h.Event),wt=function(n,u){this._map=n,this._clickTolerance=u.clickTolerance};wt.prototype.reset=function(){delete this._mousedownPos},wt.prototype.wheel=function(n){return this._firePreventable(new Tt(n.type,this._map,n))},wt.prototype.mousedown=function(n,u){return this._mousedownPos=u,this._firePreventable(new me(n.type,this._map,n))},wt.prototype.mouseup=function(n){this._map.fire(new me(n.type,this._map,n))},wt.prototype.click=function(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||this._map.fire(new me(n.type,this._map,n))},wt.prototype.dblclick=function(n){return this._firePreventable(new me(n.type,this._map,n))},wt.prototype.mouseover=function(n){this._map.fire(new me(n.type,this._map,n))},wt.prototype.mouseout=function(n){this._map.fire(new me(n.type,this._map,n))},wt.prototype.touchstart=function(n){return this._firePreventable(new Ke(n.type,this._map,n))},wt.prototype.touchmove=function(n){this._map.fire(new Ke(n.type,this._map,n))},wt.prototype.touchend=function(n){this._map.fire(new Ke(n.type,this._map,n))},wt.prototype.touchcancel=function(n){this._map.fire(new Ke(n.type,this._map,n))},wt.prototype._firePreventable=function(n){if(this._map.fire(n),n.defaultPrevented)return{}},wt.prototype.isEnabled=function(){return!0},wt.prototype.isActive=function(){return!1},wt.prototype.enable=function(){},wt.prototype.disable=function(){};var pt=function(n){this._map=n};pt.prototype.reset=function(){this._delayContextMenu=!1,delete this._contextMenuEvent},pt.prototype.mousemove=function(n){this._map.fire(new me(n.type,this._map,n))},pt.prototype.mousedown=function(){this._delayContextMenu=!0},pt.prototype.mouseup=function(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new me("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)},pt.prototype.contextmenu=function(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new me(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()},pt.prototype.isEnabled=function(){return!0},pt.prototype.isActive=function(){return!1},pt.prototype.enable=function(){},pt.prototype.disable=function(){};var _i=function(n,u){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1};function Hi(n,u){for(var a={},p=0;p<n.length;p++)a[n[p].identifier]=u[p];return a}_i.prototype.isEnabled=function(){return!!this._enabled},_i.prototype.isActive=function(){return!!this._active},_i.prototype.enable=function(){this.isEnabled()||(this._enabled=!0)},_i.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},_i.prototype.mousedown=function(n,u){this.isEnabled()&&n.shiftKey&&n.button===0&&(k.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)},_i.prototype.mousemoveWindow=function(n,u){if(this._active){var a=u;if(!(this._lastPos.equals(a)||!this._box&&a.dist(this._startPos)<this._clickTolerance)){var p=this._startPos;this._lastPos=a,this._box||(this._box=k.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));var y=Math.min(p.x,a.x),M=Math.max(p.x,a.x),S=Math.min(p.y,a.y),j=Math.max(p.y,a.y);k.setTransform(this._box,"translate("+y+"px,"+S+"px)"),this._box.style.width=M-y+"px",this._box.style.height=j-S+"px"}}},_i.prototype.mouseupWindow=function(n,u){var a=this;if(this._active&&n.button===0){var p=this._startPos,y=u;if(this.reset(),k.suppressClick(),p.x!==y.x||p.y!==y.y)return this._map.fire(new h.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:function(M){return M.fitScreenCoordinates(p,y,a._map.getBearing(),{linear:!0})}};this._fireEvent("boxzoomcancel",n)}},_i.prototype.keydown=function(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))},_i.prototype.reset=function(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(k.remove(this._box),this._box=null),k.enableDrag(),delete this._startPos,delete this._lastPos},_i.prototype._fireEvent=function(n,u){return this._map.fire(new h.Event(n,{originalEvent:u}))};var Er=function(n){this.reset(),this.numTouches=n.numTouches};Er.prototype.reset=function(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1},Er.prototype.touchstart=function(n,u,a){(this.centroid||a.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=n.timeStamp),a.length===this.numTouches&&(this.centroid=function(p){for(var y=new h.Point(0,0),M=0,S=p;M<S.length;M+=1)y._add(S[M]);return y.div(p.length)}(u),this.touches=Hi(a,u)))},Er.prototype.touchmove=function(n,u,a){if(!this.aborted&&this.centroid){var p=Hi(a,u);for(var y in this.touches){var M=p[y];(!M||M.dist(this.touches[y])>30)&&(this.aborted=!0)}}},Er.prototype.touchend=function(n,u,a){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),a.length===0){var p=!this.aborted&&this.centroid;if(this.reset(),p)return p}};var Mn=function(n){this.singleTap=new Er(n),this.numTaps=n.numTaps,this.reset()};Mn.prototype.reset=function(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()},Mn.prototype.touchstart=function(n,u,a){this.singleTap.touchstart(n,u,a)},Mn.prototype.touchmove=function(n,u,a){this.singleTap.touchmove(n,u,a)},Mn.prototype.touchend=function(n,u,a){var p=this.singleTap.touchend(n,u,a);if(p){var y=n.timeStamp-this.lastTime<500,M=!this.lastTap||this.lastTap.dist(p)<30;if(y&&M||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=p,this.count===this.numTaps)return this.reset(),p}};var vn=function(){this._zoomIn=new Mn({numTouches:1,numTaps:2}),this._zoomOut=new Mn({numTouches:2,numTaps:1}),this.reset()};vn.prototype.reset=function(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()},vn.prototype.touchstart=function(n,u,a){this._zoomIn.touchstart(n,u,a),this._zoomOut.touchstart(n,u,a)},vn.prototype.touchmove=function(n,u,a){this._zoomIn.touchmove(n,u,a),this._zoomOut.touchmove(n,u,a)},vn.prototype.touchend=function(n,u,a){var p=this,y=this._zoomIn.touchend(n,u,a),M=this._zoomOut.touchend(n,u,a);return y?(this._active=!0,n.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()+1,around:S.unproject(y)},{originalEvent:n})}}):M?(this._active=!0,n.preventDefault(),setTimeout(function(){return p.reset()},0),{cameraAnimation:function(S){return S.easeTo({duration:300,zoom:S.getZoom()-1,around:S.unproject(M)},{originalEvent:n})}}):void 0},vn.prototype.touchcancel=function(){this.reset()},vn.prototype.enable=function(){this._enabled=!0},vn.prototype.disable=function(){this._enabled=!1,this.reset()},vn.prototype.isEnabled=function(){return this._enabled},vn.prototype.isActive=function(){return this._active};var Ao={0:1,2:2},ti=function(n){this.reset(),this._clickTolerance=n.clickTolerance||1};ti.prototype.reset=function(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton},ti.prototype._correctButton=function(n,u){return!1},ti.prototype._move=function(n,u){return{}},ti.prototype.mousedown=function(n,u){if(!this._lastPoint){var a=k.mouseButton(n);this._correctButton(n,a)&&(this._lastPoint=u,this._eventButton=a)}},ti.prototype.mousemoveWindow=function(n,u){var a=this._lastPoint;if(a){if(n.preventDefault(),function(p,y){var M=Ao[y];return p.buttons===void 0||(p.buttons&M)!==M}(n,this._eventButton))this.reset();else if(this._moved||!(u.dist(a)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(a,u)}},ti.prototype.mouseupWindow=function(n){this._lastPoint&&k.mouseButton(n)===this._eventButton&&(this._moved&&k.suppressClick(),this.reset())},ti.prototype.enable=function(){this._enabled=!0},ti.prototype.disable=function(){this._enabled=!1,this.reset()},ti.prototype.isEnabled=function(){return this._enabled},ti.prototype.isActive=function(){return this._active};var va=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.mousedown=function(a,p){n.prototype.mousedown.call(this,a,p),this._lastPoint&&(this._active=!0)},u.prototype._correctButton=function(a,p){return p===0&&!a.ctrlKey},u.prototype._move=function(a,p){return{around:p,panDelta:p.sub(a)}},u}(ti),ba=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype._correctButton=function(a,p){return p===0&&a.ctrlKey||p===2},u.prototype._move=function(a,p){var y=.8*(p.x-a.x);if(y)return this._active=!0,{bearingDelta:y}},u.prototype.contextmenu=function(a){a.preventDefault()},u}(ti),qa=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype._correctButton=function(a,p){return p===0&&a.ctrlKey||p===2},u.prototype._move=function(a,p){var y=-.5*(p.y-a.y);if(y)return this._active=!0,{pitchDelta:y}},u.prototype.contextmenu=function(a){a.preventDefault()},u}(ti),Jn=function(n){this._minTouches=1,this._clickTolerance=n.clickTolerance||1,this.reset()};Jn.prototype.reset=function(){this._active=!1,this._touches={},this._sum=new h.Point(0,0)},Jn.prototype.touchstart=function(n,u,a){return this._calculateTransform(n,u,a)},Jn.prototype.touchmove=function(n,u,a){if(this._active&&!(a.length<this._minTouches))return n.preventDefault(),this._calculateTransform(n,u,a)},Jn.prototype.touchend=function(n,u,a){this._calculateTransform(n,u,a),this._active&&a.length<this._minTouches&&this.reset()},Jn.prototype.touchcancel=function(){this.reset()},Jn.prototype._calculateTransform=function(n,u,a){a.length>0&&(this._active=!0);var p=Hi(a,u),y=new h.Point(0,0),M=new h.Point(0,0),S=0;for(var j in p){var H=p[j],ie=this._touches[j];ie&&(y._add(H),M._add(H.sub(ie)),S++,p[j]=H)}if(this._touches=p,!(S<this._minTouches)&&M.mag()){var _e=M.div(S);if(this._sum._add(_e),!(this._sum.mag()<this._clickTolerance))return{around:y.div(S),panDelta:_e}}},Jn.prototype.enable=function(){this._enabled=!0},Jn.prototype.disable=function(){this._enabled=!1,this.reset()},Jn.prototype.isEnabled=function(){return this._enabled},Jn.prototype.isActive=function(){return this._active};var mo=function(){this.reset()};function us(n,u,a){for(var p=0;p<n.length;p++)if(n[p].identifier===a)return u[p]}function Ls(n,u){return Math.log(n/u)/Math.LN2}mo.prototype.reset=function(){this._active=!1,delete this._firstTwoTouches},mo.prototype._start=function(n){},mo.prototype._move=function(n,u,a){return{}},mo.prototype.touchstart=function(n,u,a){this._firstTwoTouches||a.length<2||(this._firstTwoTouches=[a[0].identifier,a[1].identifier],this._start([u[0],u[1]]))},mo.prototype.touchmove=function(n,u,a){if(this._firstTwoTouches){n.preventDefault();var p=this._firstTwoTouches,y=p[1],M=us(a,u,p[0]),S=us(a,u,y);if(M&&S){var j=this._aroundCenter?null:M.add(S).div(2);return this._move([M,S],j,n)}}},mo.prototype.touchend=function(n,u,a){if(this._firstTwoTouches){var p=this._firstTwoTouches,y=p[1],M=us(a,u,p[0]),S=us(a,u,y);M&&S||(this._active&&k.suppressClick(),this.reset())}},mo.prototype.touchcancel=function(){this.reset()},mo.prototype.enable=function(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"},mo.prototype.disable=function(){this._enabled=!1,this.reset()},mo.prototype.isEnabled=function(){return this._enabled},mo.prototype.isActive=function(){return this._active};var Sr=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.reset=function(){n.prototype.reset.call(this),delete this._distance,delete this._startDistance},u.prototype._start=function(a){this._startDistance=this._distance=a[0].dist(a[1])},u.prototype._move=function(a,p){var y=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Ls(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ls(this._distance,y),pinchAround:p}},u}(mo);function go(n,u){return 180*n.angleWith(u)/Math.PI}var Rs=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.reset=function(){n.prototype.reset.call(this),delete this._minDiameter,delete this._startVector,delete this._vector},u.prototype._start=function(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])},u.prototype._move=function(a,p){var y=this._vector;if(this._vector=a[0].sub(a[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:go(this._vector,y),pinchAround:p}},u.prototype._isBelowThreshold=function(a){this._minDiameter=Math.min(this._minDiameter,a.mag());var p=25/(Math.PI*this._minDiameter)*360,y=go(a,this._startVector);return Math.abs(y)<p},u}(mo);function zs(n){return Math.abs(n.y)>Math.abs(n.x)}var Al=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.reset=function(){n.prototype.reset.call(this),this._valid=void 0,delete this._firstMove,delete this._lastPoints},u.prototype._start=function(a){this._lastPoints=a,zs(a[0].sub(a[1]))&&(this._valid=!1)},u.prototype._move=function(a,p,y){var M=a[0].sub(this._lastPoints[0]),S=a[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(M,S,y.timeStamp),this._valid)return this._lastPoints=a,this._active=!0,{pitchDelta:(M.y+S.y)/2*-.5}},u.prototype.gestureBeginsVertically=function(a,p,y){if(this._valid!==void 0)return this._valid;var M=a.mag()>=2,S=p.mag()>=2;if(M||S){if(!M||!S)return this._firstMove===void 0&&(this._firstMove=y),y-this._firstMove<100&&void 0;var j=a.y>0==p.y>0;return zs(a)&&zs(p)&&j}},u}(mo),Dl={panStep:100,bearingStep:15,pitchStep:10},Ja=function(){var n=Dl;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep};function Wo(n){return n*(2-n)}Ja.prototype.reset=function(){this._active=!1},Ja.prototype.keydown=function(n){var u=this;if(!(n.altKey||n.ctrlKey||n.metaKey)){var a=0,p=0,y=0,M=0,S=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),M=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),M=1);break;case 38:n.shiftKey?y=1:(n.preventDefault(),S=-1);break;case 40:n.shiftKey?y=-1:(n.preventDefault(),S=1);break;default:return}return{cameraAnimation:function(j){var H=j.getZoom();j.easeTo({duration:300,easeId:"keyboardHandler",easing:Wo,zoom:a?Math.round(H)+a*(n.shiftKey?2:1):H,bearing:j.getBearing()+p*u._bearingStep,pitch:j.getPitch()+y*u._pitchStep,offset:[-M*u._panStep,-S*u._panStep],center:j.getCenter()},{originalEvent:n})}}}},Ja.prototype.enable=function(){this._enabled=!0},Ja.prototype.disable=function(){this._enabled=!1,this.reset()},Ja.prototype.isEnabled=function(){return this._enabled},Ja.prototype.isActive=function(){return this._active};var yr=function(n,u){this._map=n,this._el=n.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=1/450,h.bindAll(["_onTimeout"],this)};yr.prototype.setZoomRate=function(n){this._defaultZoomRate=n},yr.prototype.setWheelZoomRate=function(n){this._wheelZoomRate=n},yr.prototype.isEnabled=function(){return!!this._enabled},yr.prototype.isActive=function(){return!!this._active||this._finishTimeout!==void 0},yr.prototype.isZooming=function(){return!!this._zooming},yr.prototype.enable=function(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=n&&n.around==="center")},yr.prototype.disable=function(){this.isEnabled()&&(this._enabled=!1)},yr.prototype.wheel=function(n){if(this.isEnabled()){var u=n.deltaMode===h.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY,a=h.browser.now(),p=a-(this._lastWheelEventTime||0);this._lastWheelEventTime=a,u!==0&&u%4.000244140625==0?this._type="wheel":u!==0&&Math.abs(u)<4?this._type="trackpad":p>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(p*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}},yr.prototype._onTimeout=function(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)},yr.prototype._start=function(n){if(this._delta){this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);var u=k.mousePos(this._el,n);this._around=h.LngLat.convert(this._aroundCenter?this._map.getCenter():this._map.unproject(u)),this._aroundPoint=this._map.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}},yr.prototype.renderFrame=function(){var n=this;if(this._frameId&&(this._frameId=null,this.isActive())){var u=this._map.transform;if(this._delta!==0){var a=this._type==="wheel"&&Math.abs(this._delta)>4.000244140625?this._wheelZoomRate:this._defaultZoomRate,p=2/(1+Math.exp(-Math.abs(this._delta*a)));this._delta<0&&p!==0&&(p=1/p);var y=typeof this._targetZoom=="number"?u.zoomScale(this._targetZoom):u.scale;this._targetZoom=Math.min(u.maxZoom,Math.max(u.minZoom,u.scaleZoom(y*p))),this._type==="wheel"&&(this._startZoom=u.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}var M,S=typeof this._targetZoom=="number"?this._targetZoom:u.zoom,j=this._startZoom,H=this._easing,ie=!1;if(this._type==="wheel"&&j&&H){var _e=Math.min((h.browser.now()-this._lastWheelEventTime)/200,1),ye=H(_e);M=h.number(j,S,ye),_e<1?this._frameId||(this._frameId=!0):ie=!0}else M=S,ie=!0;return this._active=!0,ie&&(this._active=!1,this._finishTimeout=setTimeout(function(){n._zooming=!1,n._handler._triggerRenderFrame(),delete n._targetZoom,delete n._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!ie,zoomDelta:M-u.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}},yr.prototype._smoothOutEasing=function(n){var u=h.ease;if(this._prevEase){var a=this._prevEase,p=(h.browser.now()-a.start)/a.duration,y=a.easing(p+.01)-a.easing(p),M=.27/Math.sqrt(y*y+1e-4)*.01,S=Math.sqrt(.0729-M*M);u=h.bezier(M,S,.25,1)}return this._prevEase={start:h.browser.now(),duration:n,easing:u},u},yr.prototype.reset=function(){this._active=!1};var xa=function(n,u){this._clickZoom=n,this._tapZoom=u};xa.prototype.enable=function(){this._clickZoom.enable(),this._tapZoom.enable()},xa.prototype.disable=function(){this._clickZoom.disable(),this._tapZoom.disable()},xa.prototype.isEnabled=function(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()},xa.prototype.isActive=function(){return this._clickZoom.isActive()||this._tapZoom.isActive()};var sa=function(){this.reset()};sa.prototype.reset=function(){this._active=!1},sa.prototype.dblclick=function(n,u){return n.preventDefault(),{cameraAnimation:function(a){a.easeTo({duration:300,zoom:a.getZoom()+(n.shiftKey?-1:1),around:a.unproject(u)},{originalEvent:n})}}},sa.prototype.enable=function(){this._enabled=!0},sa.prototype.disable=function(){this._enabled=!1,this.reset()},sa.prototype.isEnabled=function(){return this._enabled},sa.prototype.isActive=function(){return this._active};var ro=function(){this._tap=new Mn({numTouches:1,numTaps:1}),this.reset()};ro.prototype.reset=function(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()},ro.prototype.touchstart=function(n,u,a){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?a.length>0&&(this._swipePoint=u[0],this._swipeTouch=a[0].identifier):this._tap.touchstart(n,u,a))},ro.prototype.touchmove=function(n,u,a){if(this._tapTime){if(this._swipePoint){if(a[0].identifier!==this._swipeTouch)return;var p=u[0],y=p.y-this._swipePoint.y;return this._swipePoint=p,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,u,a)},ro.prototype.touchend=function(n,u,a){this._tapTime?this._swipePoint&&a.length===0&&this.reset():this._tap.touchend(n,u,a)&&(this._tapTime=n.timeStamp)},ro.prototype.touchcancel=function(){this.reset()},ro.prototype.enable=function(){this._enabled=!0},ro.prototype.disable=function(){this._enabled=!1,this.reset()},ro.prototype.isEnabled=function(){return this._enabled},ro.prototype.isActive=function(){return this._active};var hs=function(n,u,a){this._el=n,this._mousePan=u,this._touchPan=a};hs.prototype.enable=function(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")},hs.prototype.disable=function(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")},hs.prototype.isEnabled=function(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()},hs.prototype.isActive=function(){return this._mousePan.isActive()||this._touchPan.isActive()};var Xa=function(n,u,a){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=a};Xa.prototype.enable=function(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()},Xa.prototype.disable=function(){this._mouseRotate.disable(),this._mousePitch.disable()},Xa.prototype.isEnabled=function(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())},Xa.prototype.isActive=function(){return this._mouseRotate.isActive()||this._mousePitch.isActive()};var la=function(n,u,a,p){this._el=n,this._touchZoom=u,this._touchRotate=a,this._tapDragZoom=p,this._rotationDisabled=!1,this._enabled=!0};la.prototype.enable=function(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")},la.prototype.disable=function(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")},la.prototype.isEnabled=function(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()},la.prototype.isActive=function(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()},la.prototype.disableRotation=function(){this._rotationDisabled=!0,this._touchRotate.disable()},la.prototype.enableRotation=function(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()};var yo=function(n){return n.zoom||n.drag||n.pitch||n.rotate},Bs=function(n){function u(){n.apply(this,arguments)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u}(h.Event);function Ai(n){return n.panDelta&&n.panDelta.mag()||n.zoomDelta||n.bearingDelta||n.pitchDelta}var wi=function(n,u){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new P(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(u),h.bindAll(["handleEvent","handleWindowEvent"],this);var a=this._el;this._listeners=[[a,"touchstart",{passive:!0}],[a,"touchmove",{passive:!1}],[a,"touchend",void 0],[a,"touchcancel",void 0],[a,"mousedown",void 0],[a,"mousemove",void 0],[a,"mouseup",void 0],[h.window.document,"mousemove",{capture:!0}],[h.window.document,"mouseup",void 0],[a,"mouseover",void 0],[a,"mouseout",void 0],[a,"dblclick",void 0],[a,"click",void 0],[a,"keydown",{capture:!1}],[a,"keyup",void 0],[a,"wheel",{passive:!1}],[a,"contextmenu",void 0],[h.window,"blur",void 0]];for(var p=0,y=this._listeners;p<y.length;p+=1){var M=y[p],S=M[0];k.addEventListener(S,M[1],S===h.window.document?this.handleWindowEvent:this.handleEvent,M[2])}};wi.prototype.destroy=function(){for(var n=0,u=this._listeners;n<u.length;n+=1){var a=u[n],p=a[0];k.removeEventListener(p,a[1],p===h.window.document?this.handleWindowEvent:this.handleEvent,a[2])}},wi.prototype._addDefaultHandlers=function(n){var u=this._map,a=u.getCanvasContainer();this._add("mapEvent",new wt(u,n));var p=u.boxZoom=new _i(u,n);this._add("boxZoom",p);var y=new vn,M=new sa;u.doubleClickZoom=new xa(M,y),this._add("tapZoom",y),this._add("clickZoom",M);var S=new ro;this._add("tapDragZoom",S);var j=u.touchPitch=new Al;this._add("touchPitch",j);var H=new ba(n),ie=new qa(n);u.dragRotate=new Xa(n,H,ie),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",ie,["mouseRotate"]);var _e=new va(n),ye=new Jn(n);u.dragPan=new hs(a,_e,ye),this._add("mousePan",_e),this._add("touchPan",ye,["touchZoom","touchRotate"]);var ge=new Rs,Ie=new Sr;u.touchZoomRotate=new la(a,Ie,ge,S),this._add("touchRotate",ge,["touchPan","touchZoom"]),this._add("touchZoom",Ie,["touchPan","touchRotate"]);var Ee=u.scrollZoom=new yr(u,this);this._add("scrollZoom",Ee,["mousePan"]);var Ge=u.keyboard=new Ja;this._add("keyboard",Ge),this._add("blockableMapEvent",new pt(u));for(var Ce=0,Ne=["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"];Ce<Ne.length;Ce+=1){var Je=Ne[Ce];n.interactive&&n[Je]&&u[Je].enable(n[Je])}},wi.prototype._add=function(n,u,a){this._handlers.push({handlerName:n,handler:u,allowed:a}),this._handlersById[n]=u},wi.prototype.stop=function(n){if(!this._updatingCamera){for(var u=0,a=this._handlers;u<a.length;u+=1)a[u].handler.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}},wi.prototype.isActive=function(){for(var n=0,u=this._handlers;n<u.length;n+=1)if(u[n].handler.isActive())return!0;return!1},wi.prototype.isZooming=function(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()},wi.prototype.isRotating=function(){return!!this._eventsInProgress.rotate},wi.prototype.isMoving=function(){return Boolean(yo(this._eventsInProgress))||this.isZooming()},wi.prototype._blockedByActive=function(n,u,a){for(var p in n)if(p!==a&&(!u||u.indexOf(p)<0))return!0;return!1},wi.prototype.handleWindowEvent=function(n){this.handleEvent(n,n.type+"Window")},wi.prototype._getMapTouches=function(n){for(var u=[],a=0,p=n;a<p.length;a+=1){var y=p[a];this._el.contains(y.target)&&u.push(y)}return u},wi.prototype.handleEvent=function(n,u){if(n.type!=="blur"){this._updatingCamera=!0;for(var a=n.type==="renderFrame"?void 0:n,p={needsRenderFrame:!1},y={},M={},S=n.touches?this._getMapTouches(n.touches):void 0,j=S?k.touchPos(this._el,S):k.mousePos(this._el,n),H=0,ie=this._handlers;H<ie.length;H+=1){var _e=ie[H],ye=_e.handlerName,ge=_e.handler,Ie=_e.allowed;if(ge.isEnabled()){var Ee=void 0;this._blockedByActive(M,Ie,ye)?ge.reset():ge[u||n.type]&&(Ee=ge[u||n.type](n,j,S),this.mergeHandlerResult(p,y,Ee,ye,a),Ee&&Ee.needsRenderFrame&&this._triggerRenderFrame()),(Ee||ge.isActive())&&(M[ye]=ge)}}var Ge={};for(var Ce in this._previousActiveHandlers)M[Ce]||(Ge[Ce]=a);this._previousActiveHandlers=M,(Object.keys(Ge).length||Ai(p))&&(this._changes.push([p,y,Ge]),this._triggerRenderFrame()),(Object.keys(M).length||Ai(p))&&this._map._stop(!0),this._updatingCamera=!1;var Ne=p.cameraAnimation;Ne&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Ne(this._map))}else this.stop(!0)},wi.prototype.mergeHandlerResult=function(n,u,a,p,y){if(a){h.extend(n,a);var M={handlerName:p,originalEvent:a.originalEvent||y};a.zoomDelta!==void 0&&(u.zoom=M),a.panDelta!==void 0&&(u.drag=M),a.pitchDelta!==void 0&&(u.pitch=M),a.bearingDelta!==void 0&&(u.rotate=M)}},wi.prototype._applyChanges=function(){for(var n={},u={},a={},p=0,y=this._changes;p<y.length;p+=1){var M=y[p],S=M[0],j=M[1],H=M[2];S.panDelta&&(n.panDelta=(n.panDelta||new h.Point(0,0))._add(S.panDelta)),S.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+S.zoomDelta),S.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+S.bearingDelta),S.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+S.pitchDelta),S.around!==void 0&&(n.around=S.around),S.pinchAround!==void 0&&(n.pinchAround=S.pinchAround),S.noInertia&&(n.noInertia=S.noInertia),h.extend(u,j),h.extend(a,H)}this._updateMapTransform(n,u,a),this._changes=[]},wi.prototype._updateMapTransform=function(n,u,a){var p=this._map,y=p.transform;if(!Ai(n))return this._fireEvents(u,a,!0);var M=n.panDelta,S=n.zoomDelta,j=n.bearingDelta,H=n.pitchDelta,ie=n.around,_e=n.pinchAround;_e!==void 0&&(ie=_e),p._stop(!0),ie=ie||p.transform.centerPoint;var ye=y.pointLocation(M?ie.sub(M):ie);j&&(y.bearing+=j),H&&(y.pitch+=H),S&&(y.zoom+=S),y.setLocationAtPoint(ye,ie),this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,a,!0)},wi.prototype._fireEvents=function(n,u,a){var p=this,y=yo(this._eventsInProgress),M=yo(n),S={};for(var j in n)this._eventsInProgress[j]||(S[j+"start"]=n[j].originalEvent),this._eventsInProgress[j]=n[j];for(var H in!y&&M&&this._fireEvent("movestart",M.originalEvent),S)this._fireEvent(H,S[H]);for(var ie in M&&this._fireEvent("move",M.originalEvent),n)this._fireEvent(ie,n[ie].originalEvent);var _e,ye={};for(var ge in this._eventsInProgress){var Ie=this._eventsInProgress[ge],Ee=Ie.handlerName,Ge=Ie.originalEvent;this._handlersById[Ee].isActive()||(delete this._eventsInProgress[ge],ye[ge+"end"]=_e=u[Ee]||Ge)}for(var Ce in ye)this._fireEvent(Ce,ye[Ce]);var Ne=yo(this._eventsInProgress);if(a&&(y||M)&&!Ne){this._updatingCamera=!0;var Je=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),lt=function(yt){return yt!==0&&-p._bearingSnap<yt&&yt<p._bearingSnap};Je?(lt(Je.bearing||this._map.getBearing())&&(Je.bearing=0),this._map.easeTo(Je,{originalEvent:_e})):(this._map.fire(new h.Event("moveend",{originalEvent:_e})),lt(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}},wi.prototype._fireEvent=function(n,u){this._map.fire(new h.Event(n,u?{originalEvent:u}:{}))},wi.prototype._requestFrame=function(){var n=this;return this._map.triggerRepaint(),this._map._renderTaskQueue.add(function(u){delete n._frameId,n.handleEvent(new Bs("renderFrame",{timeStamp:u})),n._applyChanges()})},wi.prototype._triggerRenderFrame=function(){this._frameId===void 0&&(this._frameId=this._requestFrame())};var Xs=function(n){function u(a,p){n.call(this),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=p.bearingSnap,h.bindAll(["_renderFrameCallback"],this)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.getCenter=function(){return new h.LngLat(this.transform.center.lng,this.transform.center.lat)},u.prototype.setCenter=function(a,p){return this.jumpTo({center:a},p)},u.prototype.panBy=function(a,p,y){return a=h.Point.convert(a).mult(-1),this.panTo(this.transform.center,h.extend({offset:a},p),y)},u.prototype.panTo=function(a,p,y){return this.easeTo(h.extend({center:a},p),y)},u.prototype.getZoom=function(){return this.transform.zoom},u.prototype.setZoom=function(a,p){return this.jumpTo({zoom:a},p),this},u.prototype.zoomTo=function(a,p,y){return this.easeTo(h.extend({zoom:a},p),y)},u.prototype.zoomIn=function(a,p){return this.zoomTo(this.getZoom()+1,a,p),this},u.prototype.zoomOut=function(a,p){return this.zoomTo(this.getZoom()-1,a,p),this},u.prototype.getBearing=function(){return this.transform.bearing},u.prototype.setBearing=function(a,p){return this.jumpTo({bearing:a},p),this},u.prototype.getPadding=function(){return this.transform.padding},u.prototype.setPadding=function(a,p){return this.jumpTo({padding:a},p),this},u.prototype.rotateTo=function(a,p,y){return this.easeTo(h.extend({bearing:a},p),y)},u.prototype.resetNorth=function(a,p){return this.rotateTo(0,h.extend({duration:1e3},a),p),this},u.prototype.resetNorthPitch=function(a,p){return this.easeTo(h.extend({bearing:0,pitch:0,duration:1e3},a),p),this},u.prototype.snapToNorth=function(a,p){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,p):this},u.prototype.getPitch=function(){return this.transform.pitch},u.prototype.setPitch=function(a,p){return this.jumpTo({pitch:a},p),this},u.prototype.cameraForBounds=function(a,p){return a=h.LngLatBounds.convert(a),this._cameraForBoxAndBearing(a.getNorthWest(),a.getSouthEast(),0,p)},u.prototype._cameraForBoxAndBearing=function(a,p,y,M){var S={top:0,bottom:0,right:0,left:0};if(typeof(M=h.extend({padding:S,offset:[0,0],maxZoom:this.transform.maxZoom},M)).padding=="number"){var j=M.padding;M.padding={top:j,bottom:j,right:j,left:j}}M.padding=h.extend(S,M.padding);var H=this.transform,ie=H.padding,_e=H.project(h.LngLat.convert(a)),ye=H.project(h.LngLat.convert(p)),ge=_e.rotate(-y*Math.PI/180),Ie=ye.rotate(-y*Math.PI/180),Ee=new h.Point(Math.max(ge.x,Ie.x),Math.max(ge.y,Ie.y)),Ge=new h.Point(Math.min(ge.x,Ie.x),Math.min(ge.y,Ie.y)),Ce=Ee.sub(Ge),Ne=(H.width-(ie.left+ie.right+M.padding.left+M.padding.right))/Ce.x,Je=(H.height-(ie.top+ie.bottom+M.padding.top+M.padding.bottom))/Ce.y;if(!(Je<0||Ne<0)){var lt=Math.min(H.scaleZoom(H.scale*Math.min(Ne,Je)),M.maxZoom),yt=h.Point.convert(M.offset),_t=new h.Point(yt.x+(M.padding.left-M.padding.right)/2,yt.y+(M.padding.top-M.padding.bottom)/2).mult(H.scale/H.zoomScale(lt));return{center:H.unproject(_e.add(ye).div(2).sub(_t)),zoom:lt,bearing:y}}h.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")},u.prototype.fitBounds=function(a,p,y){return this._fitInternal(this.cameraForBounds(a,p),p,y)},u.prototype.fitScreenCoordinates=function(a,p,y,M,S){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(h.Point.convert(a)),this.transform.pointLocation(h.Point.convert(p)),y,M),M,S)},u.prototype._fitInternal=function(a,p,y){return a?(delete(p=h.extend(a,p)).padding,p.linear?this.easeTo(p,y):this.flyTo(p,y)):this},u.prototype.jumpTo=function(a,p){this.stop();var y=this.transform,M=!1,S=!1,j=!1;return"zoom"in a&&y.zoom!==+a.zoom&&(M=!0,y.zoom=+a.zoom),a.center!==void 0&&(y.center=h.LngLat.convert(a.center)),"bearing"in a&&y.bearing!==+a.bearing&&(S=!0,y.bearing=+a.bearing),"pitch"in a&&y.pitch!==+a.pitch&&(j=!0,y.pitch=+a.pitch),a.padding==null||y.isPaddingEqual(a.padding)||(y.padding=a.padding),this.fire(new h.Event("movestart",p)).fire(new h.Event("move",p)),M&&this.fire(new h.Event("zoomstart",p)).fire(new h.Event("zoom",p)).fire(new h.Event("zoomend",p)),S&&this.fire(new h.Event("rotatestart",p)).fire(new h.Event("rotate",p)).fire(new h.Event("rotateend",p)),j&&this.fire(new h.Event("pitchstart",p)).fire(new h.Event("pitch",p)).fire(new h.Event("pitchend",p)),this.fire(new h.Event("moveend",p))},u.prototype.easeTo=function(a,p){var y=this;this._stop(!1,a.easeId),((a=h.extend({offset:[0,0],duration:500,easing:h.ease},a)).animate===!1||!a.essential&&h.browser.prefersReducedMotion)&&(a.duration=0);var M=this.transform,S=this.getZoom(),j=this.getBearing(),H=this.getPitch(),ie=this.getPadding(),_e="zoom"in a?+a.zoom:S,ye="bearing"in a?this._normalizeBearing(a.bearing,j):j,ge="pitch"in a?+a.pitch:H,Ie="padding"in a?a.padding:M.padding,Ee=h.Point.convert(a.offset),Ge=M.centerPoint.add(Ee),Ce=M.pointLocation(Ge),Ne=h.LngLat.convert(a.center||Ce);this._normalizeCenter(Ne);var Je,lt,yt=M.project(Ce),_t=M.project(Ne).sub(yt),St=M.zoomScale(_e-S);a.around&&(Je=h.LngLat.convert(a.around),lt=M.locationPoint(Je));var zt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||_e!==S,this._rotating=this._rotating||j!==ye,this._pitching=this._pitching||ge!==H,this._padding=!M.isPaddingEqual(Ie),this._easeId=a.easeId,this._prepareEase(p,a.noMoveStart,zt),this._ease(function(Ht){if(y._zooming&&(M.zoom=h.number(S,_e,Ht)),y._rotating&&(M.bearing=h.number(j,ye,Ht)),y._pitching&&(M.pitch=h.number(H,ge,Ht)),y._padding&&(M.interpolatePadding(ie,Ie,Ht),Ge=M.centerPoint.add(Ee)),Je)M.setLocationAtPoint(Je,lt);else{var Ut=M.zoomScale(M.zoom-S),Xt=_e>S?Math.min(2,St):Math.max(.5,St),hi=Math.pow(Xt,1-Ht),Di=M.unproject(yt.add(_t.mult(Ht*hi)).mult(Ut));M.setLocationAtPoint(M.renderWorldCopies?Di.wrap():Di,Ge)}y._fireMoveEvents(p)},function(Ht){y._afterEase(p,Ht)},a),this},u.prototype._prepareEase=function(a,p,y){y===void 0&&(y={}),this._moving=!0,p||y.moving||this.fire(new h.Event("movestart",a)),this._zooming&&!y.zooming&&this.fire(new h.Event("zoomstart",a)),this._rotating&&!y.rotating&&this.fire(new h.Event("rotatestart",a)),this._pitching&&!y.pitching&&this.fire(new h.Event("pitchstart",a))},u.prototype._fireMoveEvents=function(a){this.fire(new h.Event("move",a)),this._zooming&&this.fire(new h.Event("zoom",a)),this._rotating&&this.fire(new h.Event("rotate",a)),this._pitching&&this.fire(new h.Event("pitch",a))},u.prototype._afterEase=function(a,p){if(!this._easeId||!p||this._easeId!==p){delete this._easeId;var y=this._zooming,M=this._rotating,S=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new h.Event("zoomend",a)),M&&this.fire(new h.Event("rotateend",a)),S&&this.fire(new h.Event("pitchend",a)),this.fire(new h.Event("moveend",a))}},u.prototype.flyTo=function(a,p){var y=this;if(!a.essential&&h.browser.prefersReducedMotion){var M=h.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(M,p)}this.stop(),a=h.extend({offset:[0,0],speed:1.2,curve:1.42,easing:h.ease},a);var S=this.transform,j=this.getZoom(),H=this.getBearing(),ie=this.getPitch(),_e=this.getPadding(),ye="zoom"in a?h.clamp(+a.zoom,S.minZoom,S.maxZoom):j,ge="bearing"in a?this._normalizeBearing(a.bearing,H):H,Ie="pitch"in a?+a.pitch:ie,Ee="padding"in a?a.padding:S.padding,Ge=S.zoomScale(ye-j),Ce=h.Point.convert(a.offset),Ne=S.centerPoint.add(Ce),Je=S.pointLocation(Ne),lt=h.LngLat.convert(a.center||Je);this._normalizeCenter(lt);var yt=S.project(Je),_t=S.project(lt).sub(yt),St=a.curve,zt=Math.max(S.width,S.height),Ht=zt/Ge,Ut=_t.mag();if("minZoom"in a){var Xt=h.clamp(Math.min(a.minZoom,j,ye),S.minZoom,S.maxZoom),hi=zt/S.zoomScale(Xt-j);St=Math.sqrt(hi/Ut*2)}var Di=St*St;function Li(qi){var er=(Ht*Ht-zt*zt+(qi?-1:1)*Di*Di*Ut*Ut)/(2*(qi?Ht:zt)*Di*Ut);return Math.log(Math.sqrt(er*er+1)-er)}function Ji(qi){return(Math.exp(qi)-Math.exp(-qi))/2}function mi(qi){return(Math.exp(qi)+Math.exp(-qi))/2}var sr=Li(0),mr=function(qi){return mi(sr)/mi(sr+St*qi)},lr=function(qi){return zt*((mi(sr)*(Ji(er=sr+St*qi)/mi(er))-Ji(sr))/Di)/Ut;var er},Xi=(Li(1)-sr)/St;if(Math.abs(Ut)<1e-6||!isFinite(Xi)){if(Math.abs(zt-Ht)<1e-6)return this.easeTo(a,p);var Pr=Ht<zt?-1:1;Xi=Math.abs(Math.log(Ht/zt))/St,lr=function(){return 0},mr=function(qi){return Math.exp(Pr*St*qi)}}return a.duration="duration"in a?+a.duration:1e3*Xi/("screenSpeed"in a?+a.screenSpeed/St:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0),this._zooming=!0,this._rotating=H!==ge,this._pitching=Ie!==ie,this._padding=!S.isPaddingEqual(Ee),this._prepareEase(p,!1),this._ease(function(qi){var er=qi*Xi,Yn=1/mr(er);S.zoom=qi===1?ye:j+S.scaleZoom(Yn),y._rotating&&(S.bearing=h.number(H,ge,qi)),y._pitching&&(S.pitch=h.number(ie,Ie,qi)),y._padding&&(S.interpolatePadding(_e,Ee,qi),Ne=S.centerPoint.add(Ce));var an=qi===1?lt:S.unproject(yt.add(_t.mult(lr(er))).mult(Yn));S.setLocationAtPoint(S.renderWorldCopies?an.wrap():an,Ne),y._fireMoveEvents(p)},function(){return y._afterEase(p)},a),this},u.prototype.isEasing=function(){return!!this._easeFrameId},u.prototype.stop=function(){return this._stop()},u.prototype._stop=function(a,p){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){var y=this._onEaseEnd;delete this._onEaseEnd,y.call(this,p)}if(!a){var M=this.handlers;M&&M.stop(!1)}return this},u.prototype._ease=function(a,p,y){y.animate===!1||y.duration===0?(a(1),p()):(this._easeStart=h.browser.now(),this._easeOptions=y,this._onEaseFrame=a,this._onEaseEnd=p,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))},u.prototype._renderFrameCallback=function(){var a=Math.min((h.browser.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},u.prototype._normalizeBearing=function(a,p){a=h.wrap(a,-180,180);var y=Math.abs(a-p);return Math.abs(a-360-p)<y&&(a-=360),Math.abs(a+360-p)<y&&(a+=360),a},u.prototype._normalizeCenter=function(a){var p=this.transform;if(p.renderWorldCopies&&!p.lngRange){var y=a.lng-p.center.lng;a.lng+=y>180?-360:y<-180?360:0}},u}(h.Evented),Do=function(n){n===void 0&&(n={}),this.options=n,h.bindAll(["_updateEditLink","_updateData","_updateCompact"],this)};Do.prototype.getDefaultPosition=function(){return"bottom-right"},Do.prototype.onAdd=function(n){var u=this.options&&this.options.compact;return this._map=n,this._container=k.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._innerContainer=k.create("div","mapboxgl-ctrl-attrib-inner",this._container),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),u===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container},Do.prototype.onRemove=function(){k.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0},Do.prototype._updateEditLink=function(){var n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));var u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||h.config.ACCESS_TOKEN}];if(n){var a=u.reduce(function(p,y,M){return y.value&&(p+=y.key+"="+y.value+(M<u.length-1?"&":"")),p},"?");n.href=h.config.FEEDBACK_URL+"/"+a+(this._map._hash?this._map._hash.getHashString(!0):""),n.rel="noopener nofollow"}},Do.prototype._updateData=function(n){!n||n.sourceDataType!=="metadata"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())},Do.prototype._updateAttributions=function(){if(this._map.style){var n=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=n.concat(this.options.customAttribution.map(function(j){return typeof j!="string"?"":j})):typeof this.options.customAttribution=="string"&&n.push(this.options.customAttribution)),this._map.style.stylesheet){var u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}var a=this._map.style.sourceCaches;for(var p in a){var y=a[p];if(y.used){var M=y.getSource();M.attribution&&n.indexOf(M.attribution)<0&&n.push(M.attribution)}}n.sort(function(j,H){return j.length-H.length});var S=(n=n.filter(function(j,H){for(var ie=H+1;ie<n.length;ie++)if(n[ie].indexOf(j)>=0)return!1;return!0})).join(" | ");S!==this._attribHTML&&(this._attribHTML=S,n.length?(this._innerContainer.innerHTML=S,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}},Do.prototype._updateCompact=function(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact")};var ua=function(){h.bindAll(["_updateLogo"],this),h.bindAll(["_updateCompact"],this)};ua.prototype.onAdd=function(n){this._map=n,this._container=k.create("div","mapboxgl-ctrl");var u=k.create("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container},ua.prototype.onRemove=function(){k.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)},ua.prototype.getDefaultPosition=function(){return"bottom-left"},ua.prototype._updateLogo=function(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")},ua.prototype._logoRequired=function(){if(this._map.style){var n=this._map.style.sourceCaches;for(var u in n)if(n[u].getSource().mapbox_logo)return!0;return!1}},ua.prototype._updateCompact=function(){var n=this._container.children;if(n.length){var u=n[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}};var no=function(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1};no.prototype.add=function(n){var u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u},no.prototype.remove=function(n){for(var u=this._currentlyRunning,a=0,p=u?this._queue.concat(u):this._queue;a<p.length;a+=1){var y=p[a];if(y.id===n)return void(y.cancelled=!0)}},no.prototype.run=function(n){n===void 0&&(n=0);var u=this._currentlyRunning=this._queue;this._queue=[];for(var a=0,p=u;a<p.length;a+=1){var y=p[a];if(!y.cancelled&&(y.callback(n),this._cleared))break}this._cleared=!1,this._currentlyRunning=!1},no.prototype.clear=function(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]};var wa={"FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},Rl=h.window.HTMLImageElement,Ys=h.window.HTMLElement,Or=h.window.ImageBitmap,Xn={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},fu=function(n){function u(p){var y=this;if((p=h.extend({},Xn,p)).minZoom!=null&&p.maxZoom!=null&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(p.minPitch!=null&&p.maxPitch!=null&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(p.minPitch!=null&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(p.maxPitch!=null&&p.maxPitch>60)throw new Error("maxPitch must be less than or equal to 60");var M=new pr(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies);if(n.call(this,M,p),this._options=p,this._interactive=p.interactive,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._crossSourceCollisions=p.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=p.collectResourceTiming,this._renderTaskQueue=new no,this._controls=[],this._mapId=h.uniqueId(),this._locale=h.extend({},wa,p.locale),this._requestManager=new h.RequestManager(p.transformRequest,p.accessToken),typeof p.container=="string"){if(this._container=h.window.document.getElementById(p.container),!this._container)throw new Error("Container '"+p.container+"' not found.")}else{if(!(p.container instanceof Ys))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(p.maxBounds&&this.setMaxBounds(p.maxBounds),h.bindAll(["_onWindowOnline","_onWindowResize","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",function(){return y._update(!1)}),this.on("moveend",function(){return y._update(!1)}),this.on("zoom",function(){return y._update(!0)}),h.window!==void 0&&(h.window.addEventListener("online",this._onWindowOnline,!1),h.window.addEventListener("resize",this._onWindowResize,!1),h.window.addEventListener("orientationchange",this._onWindowResize,!1)),this.handlers=new wi(this,p),this._hash=p.hash&&new _o(typeof p.hash=="string"&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,h.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localIdeographFontFamily:p.localIdeographFontFamily}),p.attributionControl&&this.addControl(new Do({customAttribution:p.customAttribution})),this.addControl(new ua,p.logoPosition),this.on("style.load",function(){y.transform.unmodified&&y.jumpTo(y.style.stylesheet)}),this.on("data",function(S){y._update(S.dataType==="style"),y.fire(new h.Event(S.dataType+"data",S))}),this.on("dataloading",function(S){y.fire(new h.Event(S.dataType+"dataloading",S))})}n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u;var a={showTileBoundaries:{configurable:!0},showPadding:{configurable:!0},showCollisionBoxes:{configurable:!0},showOverdrawInspector:{configurable:!0},repaint:{configurable:!0},vertices:{configurable:!0},version:{configurable:!0}};return u.prototype._getMapId=function(){return this._mapId},u.prototype.addControl=function(p,y){if(y===void 0&&p.getDefaultPosition&&(y=p.getDefaultPosition()),y===void 0&&(y="top-right"),!p||!p.onAdd)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));var M=p.onAdd(this);this._controls.push(p);var S=this._controlPositions[y];return y.indexOf("bottom")!==-1?S.insertBefore(M,S.firstChild):S.appendChild(M),this},u.prototype.removeControl=function(p){if(!p||!p.onRemove)return this.fire(new h.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));var y=this._controls.indexOf(p);return y>-1&&this._controls.splice(y,1),p.onRemove(this),this},u.prototype.resize=function(p){var y=this._containerDimensions(),M=y[0],S=y[1];this._resizeCanvas(M,S),this.transform.resize(M,S),this.painter.resize(M,S);var j=!this._moving;return j&&(this.stop(),this.fire(new h.Event("movestart",p)).fire(new h.Event("move",p))),this.fire(new h.Event("resize",p)),j&&this.fire(new h.Event("moveend",p)),this},u.prototype.getBounds=function(){return this.transform.getBounds()},u.prototype.getMaxBounds=function(){return this.transform.getMaxBounds()},u.prototype.setMaxBounds=function(p){return this.transform.setMaxBounds(h.LngLatBounds.convert(p)),this._update()},u.prototype.setMinZoom=function(p){if((p=p==null?-2:p)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p&&this.setZoom(p),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")},u.prototype.getMinZoom=function(){return this.transform.minZoom},u.prototype.setMaxZoom=function(p){if((p=p==null?22:p)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p&&this.setZoom(p),this;throw new Error("maxZoom must be greater than the current minZoom")},u.prototype.getMaxZoom=function(){return this.transform.maxZoom},u.prototype.setMinPitch=function(p){if((p=p==null?0:p)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p&&this.setPitch(p),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")},u.prototype.getMinPitch=function(){return this.transform.minPitch},u.prototype.setMaxPitch=function(p){if((p=p==null?60:p)>60)throw new Error("maxPitch must be less than or equal to 60");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p&&this.setPitch(p),this;throw new Error("maxPitch must be greater than the current minPitch")},u.prototype.getMaxPitch=function(){return this.transform.maxPitch},u.prototype.getRenderWorldCopies=function(){return this.transform.renderWorldCopies},u.prototype.setRenderWorldCopies=function(p){return this.transform.renderWorldCopies=p,this._update()},u.prototype.project=function(p){return this.transform.locationPoint(h.LngLat.convert(p))},u.prototype.unproject=function(p){return this.transform.pointLocation(h.Point.convert(p))},u.prototype.isMoving=function(){return this._moving||this.handlers.isMoving()},u.prototype.isZooming=function(){return this._zooming||this.handlers.isZooming()},u.prototype.isRotating=function(){return this._rotating||this.handlers.isRotating()},u.prototype._createDelegatedListener=function(p,y,M){var S,j=this;if(p==="mouseenter"||p==="mouseover"){var H=!1;return{layer:y,listener:M,delegates:{mousemove:function(_e){var ye=j.getLayer(y)?j.queryRenderedFeatures(_e.point,{layers:[y]}):[];ye.length?H||(H=!0,M.call(j,new me(p,j,_e.originalEvent,{features:ye}))):H=!1},mouseout:function(){H=!1}}}}if(p==="mouseleave"||p==="mouseout"){var ie=!1;return{layer:y,listener:M,delegates:{mousemove:function(_e){(j.getLayer(y)?j.queryRenderedFeatures(_e.point,{layers:[y]}):[]).length?ie=!0:ie&&(ie=!1,M.call(j,new me(p,j,_e.originalEvent)))},mouseout:function(_e){ie&&(ie=!1,M.call(j,new me(p,j,_e.originalEvent)))}}}}return{layer:y,listener:M,delegates:(S={},S[p]=function(_e){var ye=j.getLayer(y)?j.queryRenderedFeatures(_e.point,{layers:[y]}):[];ye.length&&(_e.features=ye,M.call(j,_e),delete _e.features)},S)}},u.prototype.on=function(p,y,M){if(M===void 0)return n.prototype.on.call(this,p,y);var S=this._createDelegatedListener(p,y,M);for(var j in this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(S),S.delegates)this.on(j,S.delegates[j]);return this},u.prototype.once=function(p,y,M){if(M===void 0)return n.prototype.once.call(this,p,y);var S=this._createDelegatedListener(p,y,M);for(var j in S.delegates)this.once(j,S.delegates[j]);return this},u.prototype.off=function(p,y,M){var S=this;return M===void 0?n.prototype.off.call(this,p,y):(this._delegatedListeners&&this._delegatedListeners[p]&&function(j){for(var H=j[p],ie=0;ie<H.length;ie++){var _e=H[ie];if(_e.layer===y&&_e.listener===M){for(var ye in _e.delegates)S.off(ye,_e.delegates[ye]);return H.splice(ie,1),S}}}(this._delegatedListeners),this)},u.prototype.queryRenderedFeatures=function(p,y){if(!this.style)return[];var M;if(y!==void 0||p===void 0||p instanceof h.Point||Array.isArray(p)||(y=p,p=void 0),y=y||{},(p=p||[[0,0],[this.transform.width,this.transform.height]])instanceof h.Point||typeof p[0]=="number")M=[h.Point.convert(p)];else{var S=h.Point.convert(p[0]),j=h.Point.convert(p[1]);M=[S,new h.Point(j.x,S.y),j,new h.Point(S.x,j.y),S]}return this.style.queryRenderedFeatures(M,y,this.transform)},u.prototype.querySourceFeatures=function(p,y){return this.style.querySourceFeatures(p,y)},u.prototype.setStyle=function(p,y){return(y=h.extend({},{localIdeographFontFamily:this._localIdeographFontFamily},y)).diff!==!1&&y.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&p?(this._diffStyle(p,y),this):(this._localIdeographFontFamily=y.localIdeographFontFamily,this._updateStyle(p,y))},u.prototype._getUIString=function(p){var y=this._locale[p];if(y==null)throw new Error("Missing UI string '"+p+"'");return y},u.prototype._updateStyle=function(p,y){return this.style&&(this.style.setEventedParent(null),this.style._remove()),p?(this.style=new Mr(this,y||{}),this.style.setEventedParent(this,{style:this.style}),typeof p=="string"?this.style.loadURL(p):this.style.loadJSON(p),this):(delete this.style,this)},u.prototype._lazyInitEmptyStyle=function(){this.style||(this.style=new Mr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())},u.prototype._diffStyle=function(p,y){var M=this;if(typeof p=="string"){var S=this._requestManager.normalizeStyleURL(p),j=this._requestManager.transformRequest(S,h.ResourceType.Style);h.getJSON(j,function(H,ie){H?M.fire(new h.ErrorEvent(H)):ie&&M._updateDiff(ie,y)})}else typeof p=="object"&&this._updateDiff(p,y)},u.prototype._updateDiff=function(p,y){try{this.style.setState(p)&&this._update(!0)}catch(M){h.warnOnce("Unable to perform style diff: "+(M.message||M.error||M)+".  Rebuilding the style from scratch."),this._updateStyle(p,y)}},u.prototype.getStyle=function(){if(this.style)return this.style.serialize()},u.prototype.isStyleLoaded=function(){return this.style?this.style.loaded():h.warnOnce("There is no style added to the map.")},u.prototype.addSource=function(p,y){return this._lazyInitEmptyStyle(),this.style.addSource(p,y),this._update(!0)},u.prototype.isSourceLoaded=function(p){var y=this.style&&this.style.sourceCaches[p];if(y!==void 0)return y.loaded();this.fire(new h.ErrorEvent(new Error("There is no source with ID '"+p+"'")))},u.prototype.areTilesLoaded=function(){var p=this.style&&this.style.sourceCaches;for(var y in p){var M=p[y]._tiles;for(var S in M){var j=M[S];if(j.state!=="loaded"&&j.state!=="errored")return!1}}return!0},u.prototype.addSourceType=function(p,y,M){return this._lazyInitEmptyStyle(),this.style.addSourceType(p,y,M)},u.prototype.removeSource=function(p,y){return this.style.removeSource(p,y),this._update(!0)},u.prototype.getSource=function(p){return this.style.getSource(p)},u.prototype.addImage=function(p,y,M){M===void 0&&(M={});var S=M.pixelRatio;S===void 0&&(S=1);var j=M.sdf;j===void 0&&(j=!1);var H=M.stretchX,ie=M.stretchY,_e=M.content;if(this._lazyInitEmptyStyle(),y instanceof Rl||Or&&y instanceof Or){var ye=h.browser.getImageData(y);this.style.addImage(p,{data:new h.RGBAImage({width:ye.width,height:ye.height},ye.data),pixelRatio:S,stretchX:H,stretchY:ie,content:_e,sdf:j,version:0})}else{if(y.width===void 0||y.height===void 0)return this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));var ge=y;this.style.addImage(p,{data:new h.RGBAImage({width:y.width,height:y.height},new Uint8Array(y.data)),pixelRatio:S,stretchX:H,stretchY:ie,content:_e,sdf:j,version:0,userImage:ge}),ge.onAdd&&ge.onAdd(this,p)}},u.prototype.updateImage=function(p,y){var M=this.style.getImage(p);if(!M)return this.fire(new h.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));var S=y instanceof Rl||Or&&y instanceof Or?h.browser.getImageData(y):y,j=S.width,H=S.height,ie=S.data;return j===void 0||H===void 0?this.fire(new h.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):j!==M.data.width||H!==M.data.height?this.fire(new h.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(M.data.replace(ie,!(y instanceof Rl||Or&&y instanceof Or)),void this.style.updateImage(p,M))},u.prototype.hasImage=function(p){return p?!!this.style.getImage(p):(this.fire(new h.ErrorEvent(new Error("Missing required image id"))),!1)},u.prototype.removeImage=function(p){this.style.removeImage(p)},u.prototype.loadImage=function(p,y){h.getImage(this._requestManager.transformRequest(p,h.ResourceType.Image),y)},u.prototype.listImages=function(){return this.style.listImages()},u.prototype.addLayer=function(p,y,M){return M===void 0&&(M={}),this._lazyInitEmptyStyle(),this.style.addLayer(p,y,M),this._update(!0)},u.prototype.moveLayer=function(p,y){return this.style.moveLayer(p,y),this._update(!0)},u.prototype.removeLayer=function(p){return this.style.removeLayer(p),this._update(!0)},u.prototype.getLayer=function(p){return this.style.getLayer(p)},u.prototype.setLayerZoomRange=function(p,y,M){return this.style.setLayerZoomRange(p,y,M),this._update(!0)},u.prototype.setFilter=function(p,y,M){return M===void 0&&(M={}),this.style.setFilter(p,y,M),this._update(!0)},u.prototype.getFilter=function(p){return this.style.getFilter(p)},u.prototype.setPaintProperty=function(p,y,M,S){return S===void 0&&(S={}),this.style.setPaintProperty(p,y,M,S),this._update(!0)},u.prototype.getPaintProperty=function(p,y){return this.style.getPaintProperty(p,y)},u.prototype.setLayoutProperty=function(p,y,M,S){return S===void 0&&(S={}),this.style.setLayoutProperty(p,y,M,S),this._update(!0)},u.prototype.getLayoutProperty=function(p,y){return this.style.getLayoutProperty(p,y)},u.prototype.setLight=function(p,y){return y===void 0&&(y={}),this._lazyInitEmptyStyle(),this.style.setLight(p,y),this._update(!0)},u.prototype.getLight=function(){return this.style.getLight()},u.prototype.setFeatureState=function(p,y){return this.style.setFeatureState(p,y),this._update()},u.prototype.removeFeatureState=function(p,y){return this.style.removeFeatureState(p,y),this._update()},u.prototype.getFeatureState=function(p){return this.style.getFeatureState(p)},u.prototype.getContainer=function(){return this._container},u.prototype.getCanvasContainer=function(){return this._canvasContainer},u.prototype.getCanvas=function(){return this._canvas},u.prototype._containerDimensions=function(){var p=0,y=0;return this._container&&(p=this._container.clientWidth||400,y=this._container.clientHeight||300),[p,y]},u.prototype._detectMissingCSS=function(){},u.prototype._setupContainer=function(){var p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=k.create("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();var y=this._canvasContainer=k.create("div","mapboxgl-canvas-container",p);this._interactive&&y.classList.add("mapboxgl-interactive"),this._canvas=k.create("canvas","mapboxgl-canvas",y),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map");var M=this._containerDimensions();this._resizeCanvas(M[0],M[1]);var S=this._controlContainer=k.create("div","mapboxgl-control-container",p),j=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(function(H){j[H]=k.create("div","mapboxgl-ctrl-"+H,S)})},u.prototype._resizeCanvas=function(p,y){var M=h.browser.devicePixelRatio||1;this._canvas.width=M*p,this._canvas.height=M*y,this._canvas.style.width=p+"px",this._canvas.style.height=y+"px"},u.prototype._setupPainter=function(){var p=h.extend({},K.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),y=this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);y?(this.painter=new kr(y,this.transform),h.webpSupported.testSupport(y)):this.fire(new h.ErrorEvent(new Error("Failed to initialize WebGL")))},u.prototype._contextLost=function(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new h.Event("webglcontextlost",{originalEvent:p}))},u.prototype._contextRestored=function(p){this._setupPainter(),this.resize(),this._update(),this.fire(new h.Event("webglcontextrestored",{originalEvent:p}))},u.prototype.loaded=function(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()},u.prototype._update=function(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this},u.prototype._requestRenderFrame=function(p){return this._update(),this._renderTaskQueue.add(p)},u.prototype._cancelRenderFrame=function(p){this._renderTaskQueue.remove(p)},u.prototype._render=function(p){var y,M=this,S=0,j=this.painter.context.extTimerQuery;if(this.listens("gpu-timing-frame")&&(y=j.createQueryEXT(),j.beginQueryEXT(j.TIME_ELAPSED_EXT,y),S=h.browser.now()),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(p),!this._removed){var H=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;var ie=this.transform.zoom,_e=h.browser.now();this.style.zoomHistory.update(ie,_e);var ye=new h.EvaluationParameters(ie,{now:_e,fadeDuration:this._fadeDuration,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),ge=ye.crossFadingFactor();ge===1&&ge===this._crossFadingFactor||(H=!0,this._crossFadingFactor=ge),this.style.update(ye)}if(this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,this._fadeDuration,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:this._fadeDuration,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer")}),this.fire(new h.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new h.Event("load"))),this.style&&(this.style.hasTransitions()||H)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){var Ie=h.browser.now()-S;j.endQueryEXT(j.TIME_ELAPSED_EXT,y),setTimeout(function(){var Ce=j.getQueryObjectEXT(y,j.QUERY_RESULT_EXT)/1e6;j.deleteQueryEXT(y),M.fire(new h.Event("gpu-timing-frame",{cpuTime:Ie,gpuTime:Ce}))},50)}if(this.listens("gpu-timing-layer")){var Ee=this.painter.collectGpuTimers();setTimeout(function(){var Ce=M.painter.queryGpuTimers(Ee);M.fire(new h.Event("gpu-timing-layer",{layerTimes:Ce}))},50)}var Ge=this._sourcesDirty||this._styleDirty||this._placementDirty;return Ge||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new h.Event("idle")),!this._loaded||this._fullyLoaded||Ge||(this._fullyLoaded=!0),this}},u.prototype.remove=function(){this._hash&&this._hash.remove();for(var p=0,y=this._controls;p<y.length;p+=1)y[p].onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),h.window!==void 0&&(h.window.removeEventListener("resize",this._onWindowResize,!1),h.window.removeEventListener("orientationchange",this._onWindowResize,!1),h.window.removeEventListener("online",this._onWindowOnline,!1));var M=this.painter.context.gl.getExtension("WEBGL_lose_context");M&&M.loseContext(),cs(this._canvasContainer),cs(this._controlContainer),cs(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),this._removed=!0,this.fire(new h.Event("remove"))},u.prototype.triggerRepaint=function(){var p=this;this.style&&!this._frame&&(this._frame=h.browser.frame(function(y){p._frame=null,p._render(y)}))},u.prototype._onWindowOnline=function(){this._update()},u.prototype._onWindowResize=function(p){this._trackResize&&this.resize({originalEvent:p})._update()},a.showTileBoundaries.get=function(){return!!this._showTileBoundaries},a.showTileBoundaries.set=function(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())},a.showPadding.get=function(){return!!this._showPadding},a.showPadding.set=function(p){this._showPadding!==p&&(this._showPadding=p,this._update())},a.showCollisionBoxes.get=function(){return!!this._showCollisionBoxes},a.showCollisionBoxes.set=function(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())},a.showOverdrawInspector.get=function(){return!!this._showOverdrawInspector},a.showOverdrawInspector.set=function(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())},a.repaint.get=function(){return!!this._repaint},a.repaint.set=function(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())},a.vertices.get=function(){return!!this._vertices},a.vertices.set=function(p){this._vertices=p,this._update()},u.prototype._setCacheLimits=function(p,y){h.setCacheLimits(p,y)},a.version.get=function(){return h.version},Object.defineProperties(u.prototype,a),u}(Xs);function cs(n){n.parentNode&&n.parentNode.removeChild(n)}var zl={showCompass:!0,showZoom:!0,visualizePitch:!1},ka=function(n){var u=this;this.options=h.extend({},zl,n),this._container=k.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",function(a){return a.preventDefault()}),this.options.showZoom&&(h.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",function(a){return u._map.zoomIn({},{originalEvent:a})}),k.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",function(a){return u._map.zoomOut({},{originalEvent:a})}),k.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(h.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",function(a){u.options.visualizePitch?u._map.resetNorthPitch({},{originalEvent:a}):u._map.resetNorth({},{originalEvent:a})}),this._compassIcon=k.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))};ka.prototype._updateZoomButtons=function(){var n=this._map.getZoom();this._zoomInButton.disabled=n===this._map.getMaxZoom(),this._zoomOutButton.disabled=n===this._map.getMinZoom()},ka.prototype._rotateCompassArrow=function(){var n=this.options.visualizePitch?"scale("+1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)+") rotateX("+this._map.transform.pitch+"deg) rotateZ("+this._map.transform.angle*(180/Math.PI)+"deg)":"rotate("+this._map.transform.angle*(180/Math.PI)+"deg)";this._compassIcon.style.transform=n},ka.prototype.onAdd=function(n){return this._map=n,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ro(this._map,this._compass,this.options.visualizePitch)),this._container},ka.prototype.onRemove=function(){k.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map},ka.prototype._createButton=function(n,u){var a=k.create("button",n,this._container);return a.type="button",a.addEventListener("click",u),a},ka.prototype._setButtonTitle=function(n,u){var a=this._map._getUIString("NavigationControl."+u);n.title=a,n.setAttribute("aria-label",a)};var Ro=function(n,u,a){a===void 0&&(a=!1),this._clickTolerance=10,this.element=u,this.mouseRotate=new ba({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,a&&(this.mousePitch=new qa({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),h.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),k.addEventListener(u,"mousedown",this.mousedown),k.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),k.addEventListener(u,"touchmove",this.touchmove),k.addEventListener(u,"touchend",this.touchend),k.addEventListener(u,"touchcancel",this.reset)};function Ms(n,u,a){if(n=new h.LngLat(n.lng,n.lat),u){var p=new h.LngLat(n.lng-360,n.lat),y=new h.LngLat(n.lng+360,n.lat),M=a.locationPoint(n).distSqr(u);a.locationPoint(p).distSqr(u)<M?n=p:a.locationPoint(y).distSqr(u)<M&&(n=y)}for(;Math.abs(n.lng-a.center.lng)>180;){var S=a.locationPoint(n);if(S.x>=0&&S.y>=0&&S.x<=a.width&&S.y<=a.height)break;n.lng>a.center.lng?n.lng-=360:n.lng+=360}return n}Ro.prototype.down=function(n,u){this.mouseRotate.mousedown(n,u),this.mousePitch&&this.mousePitch.mousedown(n,u),k.disableDrag()},Ro.prototype.move=function(n,u){var a=this.map,p=this.mouseRotate.mousemoveWindow(n,u);if(p&&p.bearingDelta&&a.setBearing(a.getBearing()+p.bearingDelta),this.mousePitch){var y=this.mousePitch.mousemoveWindow(n,u);y&&y.pitchDelta&&a.setPitch(a.getPitch()+y.pitchDelta)}},Ro.prototype.off=function(){var n=this.element;k.removeEventListener(n,"mousedown",this.mousedown),k.removeEventListener(n,"touchstart",this.touchstart,{passive:!1}),k.removeEventListener(n,"touchmove",this.touchmove),k.removeEventListener(n,"touchend",this.touchend),k.removeEventListener(n,"touchcancel",this.reset),this.offTemp()},Ro.prototype.offTemp=function(){k.enableDrag(),k.removeEventListener(h.window,"mousemove",this.mousemove),k.removeEventListener(h.window,"mouseup",this.mouseup)},Ro.prototype.mousedown=function(n){this.down(h.extend({},n,{ctrlKey:!0,preventDefault:function(){return n.preventDefault()}}),k.mousePos(this.element,n)),k.addEventListener(h.window,"mousemove",this.mousemove),k.addEventListener(h.window,"mouseup",this.mouseup)},Ro.prototype.mousemove=function(n){this.move(n,k.mousePos(this.element,n))},Ro.prototype.mouseup=function(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()},Ro.prototype.touchstart=function(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=k.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:function(){return n.preventDefault()}},this._startPos))},Ro.prototype.touchmove=function(n){n.targetTouches.length!==1?this.reset():(this._lastPos=k.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:function(){return n.preventDefault()}},this._lastPos))},Ro.prototype.touchend=function(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()},Ro.prototype.reset=function(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()};var Pa={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Qs(n,u,a){var p=n.classList;for(var y in Pa)p.remove("mapboxgl-"+a+"-anchor-"+y);p.add("mapboxgl-"+a+"-anchor-"+u)}var Ts,Fs=function(n){function u(a,p){var y=this;if(n.call(this),(a instanceof h.window.HTMLElement||p)&&(a=h.extend({element:a},p)),h.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment!=="auto"?a.pitchAlignment:this._rotationAlignment,a&&a.element)this._element=a.element,this._offset=h.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=k.create("div"),this._element.setAttribute("aria-label","Map marker");var M=k.createNS("http://www.w3.org/2000/svg","svg");M.setAttributeNS(null,"display","block"),M.setAttributeNS(null,"height","41px"),M.setAttributeNS(null,"width","27px"),M.setAttributeNS(null,"viewBox","0 0 27 41");var S=k.createNS("http://www.w3.org/2000/svg","g");S.setAttributeNS(null,"stroke","none"),S.setAttributeNS(null,"stroke-width","1"),S.setAttributeNS(null,"fill","none"),S.setAttributeNS(null,"fill-rule","evenodd");var j=k.createNS("http://www.w3.org/2000/svg","g");j.setAttributeNS(null,"fill-rule","nonzero");var H=k.createNS("http://www.w3.org/2000/svg","g");H.setAttributeNS(null,"transform","translate(3.0, 29.0)"),H.setAttributeNS(null,"fill","#000000");for(var ie=0,_e=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];ie<_e.length;ie+=1){var ye=_e[ie],ge=k.createNS("http://www.w3.org/2000/svg","ellipse");ge.setAttributeNS(null,"opacity","0.04"),ge.setAttributeNS(null,"cx","10.5"),ge.setAttributeNS(null,"cy","5.80029008"),ge.setAttributeNS(null,"rx",ye.rx),ge.setAttributeNS(null,"ry",ye.ry),H.appendChild(ge)}var Ie=k.createNS("http://www.w3.org/2000/svg","g");Ie.setAttributeNS(null,"fill",this._color);var Ee=k.createNS("http://www.w3.org/2000/svg","path");Ee.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),Ie.appendChild(Ee);var Ge=k.createNS("http://www.w3.org/2000/svg","g");Ge.setAttributeNS(null,"opacity","0.25"),Ge.setAttributeNS(null,"fill","#000000");var Ce=k.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Ge.appendChild(Ce);var Ne=k.createNS("http://www.w3.org/2000/svg","g");Ne.setAttributeNS(null,"transform","translate(6.0, 7.0)"),Ne.setAttributeNS(null,"fill","#FFFFFF");var Je=k.createNS("http://www.w3.org/2000/svg","g");Je.setAttributeNS(null,"transform","translate(8.0, 8.0)");var lt=k.createNS("http://www.w3.org/2000/svg","circle");lt.setAttributeNS(null,"fill","#000000"),lt.setAttributeNS(null,"opacity","0.25"),lt.setAttributeNS(null,"cx","5.5"),lt.setAttributeNS(null,"cy","5.5"),lt.setAttributeNS(null,"r","5.4999962");var yt=k.createNS("http://www.w3.org/2000/svg","circle");yt.setAttributeNS(null,"fill","#FFFFFF"),yt.setAttributeNS(null,"cx","5.5"),yt.setAttributeNS(null,"cy","5.5"),yt.setAttributeNS(null,"r","5.4999962"),Je.appendChild(lt),Je.appendChild(yt),j.appendChild(H),j.appendChild(Ie),j.appendChild(Ge),j.appendChild(Ne),j.appendChild(Je),M.appendChild(j),M.setAttributeNS(null,"height",41*this._scale+"px"),M.setAttributeNS(null,"width",27*this._scale+"px"),this._element.appendChild(M),this._offset=h.Point.convert(a&&a.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",function(_t){_t.preventDefault()}),this._element.addEventListener("mousedown",function(_t){_t.preventDefault()}),this._element.addEventListener("focus",function(){var _t=y._map.getContainer();_t.scrollTop=0,_t.scrollLeft=0}),Qs(this._element,this._anchor,"marker"),this._popup=null}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.addTo=function(a){return this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._update),a.on("moveend",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this},u.prototype.remove=function(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),k.remove(this._element),this._popup&&this._popup.remove(),this},u.prototype.getLngLat=function(){return this._lngLat},u.prototype.setLngLat=function(a){return this._lngLat=h.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this},u.prototype.getElement=function(){return this._element},u.prototype.setPopup=function(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){var p=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[p,-1*(24.6+p)],"bottom-right":[-p,-1*(24.6+p)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this},u.prototype._onKeyPress=function(a){var p=a.code,y=a.charCode||a.keyCode;p!=="Space"&&p!=="Enter"&&y!==32&&y!==13||this.togglePopup()},u.prototype._onMapClick=function(a){var p=a.originalEvent.target,y=this._element;this._popup&&(p===y||y.contains(p))&&this.togglePopup()},u.prototype.getPopup=function(){return this._popup},u.prototype.togglePopup=function(){var a=this._popup;return a?(a.isOpen()?a.remove():a.addTo(this._map),this):this},u.prototype._update=function(a){if(this._map){this._map.transform.renderWorldCopies&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);var p="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?p="rotateZ("+this._rotation+"deg)":this._rotationAlignment==="map"&&(p="rotateZ("+(this._rotation-this._map.getBearing())+"deg)");var y="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?y="rotateX(0deg)":this._pitchAlignment==="map"&&(y="rotateX("+this._map.getPitch()+"deg)"),a&&a.type!=="moveend"||(this._pos=this._pos.round()),k.setTransform(this._element,Pa[this._anchor]+" translate("+this._pos.x+"px, "+this._pos.y+"px) "+y+" "+p)}},u.prototype.getOffset=function(){return this._offset},u.prototype.setOffset=function(a){return this._offset=h.Point.convert(a),this._update(),this},u.prototype._onMove=function(a){this._pos=a.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new h.Event("dragstart"))),this.fire(new h.Event("drag"))},u.prototype._onUp=function(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new h.Event("dragend")),this._state="inactive"},u.prototype._addDragHandler=function(a){this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(this._pos).add(this._offset),this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},u.prototype.setDraggable=function(a){return this._draggable=!!a,this._map&&(a?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this},u.prototype.isDraggable=function(){return this._draggable},u.prototype.setRotation=function(a){return this._rotation=a||0,this._update(),this},u.prototype.getRotation=function(){return this._rotation},u.prototype.setRotationAlignment=function(a){return this._rotationAlignment=a||"auto",this._update(),this},u.prototype.getRotationAlignment=function(){return this._rotationAlignment},u.prototype.setPitchAlignment=function(a){return this._pitchAlignment=a&&a!=="auto"?a:this._rotationAlignment,this._update(),this},u.prototype.getPitchAlignment=function(){return this._pitchAlignment},u}(h.Evented),Bl={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0},Ss=0,ps=!1,Fl=function(n){function u(a){n.call(this),this.options=h.extend({},Bl,a),h.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker"],this)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.onAdd=function(a){var p;return this._map=a,this._container=k.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),p=this._setupUI,Ts!==void 0?p(Ts):h.window.navigator.permissions!==void 0?h.window.navigator.permissions.query({name:"geolocation"}).then(function(y){p(Ts=y.state!=="denied")}):p(Ts=!!h.window.navigator.geolocation),this._container},u.prototype.onRemove=function(){this._geolocationWatchID!==void 0&&(h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),k.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Ss=0,ps=!1},u.prototype._isOutOfMapMaxBounds=function(a){var p=this._map.getMaxBounds(),y=a.coords;return p&&(y.longitude<p.getWest()||y.longitude>p.getEast()||y.latitude<p.getSouth()||y.latitude>p.getNorth())},u.prototype._setErrorState=function(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}},u.prototype._onSuccess=function(a){if(this._map){if(this._isOutOfMapMaxBounds(a))return this._setErrorState(),this.fire(new h.Event("outofmaxbounds",a)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=a,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(a),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(a),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("geolocate",a)),this._finish()}},u.prototype._updateCamera=function(a){var p=new h.LngLat(a.coords.longitude,a.coords.latitude),y=a.coords.accuracy,M=this._map.getBearing(),S=h.extend({bearing:M},this.options.fitBoundsOptions);this._map.fitBounds(p.toBounds(y),S,{geolocateSource:!0})},u.prototype._updateMarker=function(a){if(a){var p=new h.LngLat(a.coords.longitude,a.coords.latitude);this._accuracyCircleMarker.setLngLat(p).addTo(this._map),this._userLocationDotMarker.setLngLat(p).addTo(this._map),this._accuracy=a.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},u.prototype._updateCircleRadius=function(){var a=this._map._container.clientHeight/2,p=this._map.unproject([0,a]),y=this._map.unproject([1,a]),M=p.distanceTo(y),S=Math.ceil(2*this._accuracy/M);this._circleElement.style.width=S+"px",this._circleElement.style.height=S+"px"},u.prototype._onZoom=function(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},u.prototype._onError=function(a){if(this._map){if(this.options.trackUserLocation)if(a.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;var p=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=p,this._geolocateButton.setAttribute("aria-label",p),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(a.code===3&&ps)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new h.Event("error",a)),this._finish()}},u.prototype._finish=function(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},u.prototype._setupUI=function(a){var p=this;if(this._container.addEventListener("contextmenu",function(S){return S.preventDefault()}),this._geolocateButton=k.create("button","mapboxgl-ctrl-geolocate",this._container),k.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",a===!1){h.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");var y=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=y,this._geolocateButton.setAttribute("aria-label",y)}else{var M=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=M,this._geolocateButton.setAttribute("aria-label",M)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=k.create("div","mapboxgl-user-location-dot"),this._userLocationDotMarker=new Fs(this._dotElement),this._circleElement=k.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Fs({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",function(S){S.geolocateSource||p._watchState!=="ACTIVE_LOCK"||S.originalEvent&&S.originalEvent.type==="resize"||(p._watchState="BACKGROUND",p._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),p._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),p.fire(new h.Event("trackuserlocationend")))})},u.prototype.trigger=function(){if(!this._setup)return h.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new h.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Ss--,ps=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new h.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new h.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){var a;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),++Ss>1?(a={maximumAge:6e5,timeout:0},ps=!0):(a=this.options.positionOptions,ps=!1),this._geolocationWatchID=h.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,a)}}else h.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0},u.prototype._clearWatch=function(){h.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)},u}(h.Evented),Ya={maxWidth:100,unit:"metric"},Qa=function(n){this.options=h.extend({},Ya,n),h.bindAll(["_onMove","setUnit"],this)};function $s(n,u,a){var p=a&&a.maxWidth||100,y=n._container.clientHeight/2,M=n.unproject([0,y]),S=n.unproject([p,y]),j=M.distanceTo(S);if(a&&a.unit==="imperial"){var H=3.2808*j;H>5280?$a(u,p,H/5280,n._getUIString("ScaleControl.Miles")):$a(u,p,H,n._getUIString("ScaleControl.Feet"))}else a&&a.unit==="nautical"?$a(u,p,j/1852,n._getUIString("ScaleControl.NauticalMiles")):j>=1e3?$a(u,p,j/1e3,n._getUIString("ScaleControl.Kilometers")):$a(u,p,j,n._getUIString("ScaleControl.Meters"))}function $a(n,u,a,p){var y,M,S,j=(y=a,(M=Math.pow(10,(""+Math.floor(y)).length-1))*(S=(S=y/M)>=10?10:S>=5?5:S>=3?3:S>=2?2:S>=1?1:function(H){var ie=Math.pow(10,Math.ceil(-Math.log(H)/Math.LN10));return Math.round(H*ie)/ie}(S)));n.style.width=u*(j/a)+"px",n.innerHTML=j+"&nbsp;"+p}Qa.prototype.getDefaultPosition=function(){return"bottom-left"},Qa.prototype._onMove=function(){$s(this._map,this._container,this.options)},Qa.prototype.onAdd=function(n){return this._map=n,this._container=k.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",n.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container},Qa.prototype.onRemove=function(){k.remove(this._container),this._map.off("move",this._onMove),this._map=void 0},Qa.prototype.setUnit=function(n){this.options.unit=n,$s(this._map,this._container,this.options)};var Yo=function(n){this._fullscreen=!1,n&&n.container&&(n.container instanceof h.window.HTMLElement?this._container=n.container:h.warnOnce("Full screen control 'container' must be a DOM element.")),h.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in h.window.document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in h.window.document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in h.window.document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in h.window.document&&(this._fullscreenchange="MSFullscreenChange")};Yo.prototype.onAdd=function(n){return this._map=n,this._container||(this._container=this._map.getContainer()),this._controlContainer=k.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",h.warnOnce("This device does not support fullscreen mode.")),this._controlContainer},Yo.prototype.onRemove=function(){k.remove(this._controlContainer),this._map=null,h.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)},Yo.prototype._checkFullscreenSupport=function(){return!!(h.window.document.fullscreenEnabled||h.window.document.mozFullScreenEnabled||h.window.document.msFullscreenEnabled||h.window.document.webkitFullscreenEnabled)},Yo.prototype._setupUI=function(){var n=this._fullscreenButton=k.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);k.create("span","mapboxgl-ctrl-icon",n).setAttribute("aria-hidden",!0),n.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),h.window.document.addEventListener(this._fullscreenchange,this._changeIcon)},Yo.prototype._updateTitle=function(){var n=this._getTitle();this._fullscreenButton.setAttribute("aria-label",n),this._fullscreenButton.title=n},Yo.prototype._getTitle=function(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")},Yo.prototype._isFullscreen=function(){return this._fullscreen},Yo.prototype._changeIcon=function(){(h.window.document.fullscreenElement||h.window.document.mozFullScreenElement||h.window.document.webkitFullscreenElement||h.window.document.msFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())},Yo.prototype._onClickFullscreen=function(){this._isFullscreen()?h.window.document.exitFullscreen?h.window.document.exitFullscreen():h.window.document.mozCancelFullScreen?h.window.document.mozCancelFullScreen():h.window.document.msExitFullscreen?h.window.document.msExitFullscreen():h.window.document.webkitCancelFullScreen&&h.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()};var jl={closeButton:!0,closeOnClick:!0,className:"",maxWidth:"240px"},js=function(n){function u(a){n.call(this),this.options=h.extend(Object.create(jl),a),h.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this)}return n&&(u.__proto__=n),(u.prototype=Object.create(n&&n.prototype)).constructor=u,u.prototype.addTo=function(a){return this._map&&this.remove(),this._map=a,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("mapboxgl-popup-track-pointer"),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new h.Event("open")),this},u.prototype.isOpen=function(){return!!this._map},u.prototype.remove=function(){return this._content&&k.remove(this._content),this._container&&(k.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new h.Event("close")),this},u.prototype.getLngLat=function(){return this._lngLat},u.prototype.setLngLat=function(a){return this._lngLat=h.LngLat.convert(a),this._pos=null,this._trackPointer=!1,this._update(),this},u.prototype.trackPointer=function(){return this._trackPointer=!0,this._pos=null,this._update(),this},u.prototype.getElement=function(){return this._container},u.prototype.setText=function(a){return this.setDOMContent(h.window.document.createTextNode(a))},u.prototype.setHTML=function(a){var p,y=h.window.document.createDocumentFragment(),M=h.window.document.createElement("body");for(M.innerHTML=a;p=M.firstChild;)y.appendChild(p);return this.setDOMContent(y)},u.prototype.getMaxWidth=function(){return this._container&&this._container.style.maxWidth},u.prototype.setMaxWidth=function(a){return this.options.maxWidth=a,this._update(),this},u.prototype.setDOMContent=function(a){return this._createContent(),this._content.appendChild(a),this._update(),this},u.prototype.addClassName=function(a){this._container&&this._container.classList.add(a)},u.prototype.removeClassName=function(a){this._container&&this._container.classList.remove(a)},u.prototype.toggleClassName=function(a){if(this._container)return this._container.classList.toggle(a)},u.prototype._createContent=function(){this._content&&k.remove(this._content),this._content=k.create("div","mapboxgl-popup-content",this._container),this.options.closeButton&&(this._closeButton=k.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))},u.prototype._onMouseUp=function(a){this._update(a.point)},u.prototype._onMouseMove=function(a){this._update(a.point)},u.prototype._onDrag=function(a){this._update(a.point)},u.prototype._update=function(a){var p=this;if(this._map&&(this._lngLat||this._trackPointer)&&this._content&&(this._container||(this._container=k.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=k.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className&&this.options.className.split(" ").forEach(function(ye){return p._container.classList.add(ye)}),this._trackPointer&&this._container.classList.add("mapboxgl-popup-track-pointer")),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Ms(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||a)){var y=this._pos=this._trackPointer&&a?a:this._map.project(this._lngLat),M=this.options.anchor,S=function ye(ge){if(ge){if(typeof ge=="number"){var Ie=Math.round(Math.sqrt(.5*Math.pow(ge,2)));return{center:new h.Point(0,0),top:new h.Point(0,ge),"top-left":new h.Point(Ie,Ie),"top-right":new h.Point(-Ie,Ie),bottom:new h.Point(0,-ge),"bottom-left":new h.Point(Ie,-Ie),"bottom-right":new h.Point(-Ie,-Ie),left:new h.Point(ge,0),right:new h.Point(-ge,0)}}if(ge instanceof h.Point||Array.isArray(ge)){var Ee=h.Point.convert(ge);return{center:Ee,top:Ee,"top-left":Ee,"top-right":Ee,bottom:Ee,"bottom-left":Ee,"bottom-right":Ee,left:Ee,right:Ee}}return{center:h.Point.convert(ge.center||[0,0]),top:h.Point.convert(ge.top||[0,0]),"top-left":h.Point.convert(ge["top-left"]||[0,0]),"top-right":h.Point.convert(ge["top-right"]||[0,0]),bottom:h.Point.convert(ge.bottom||[0,0]),"bottom-left":h.Point.convert(ge["bottom-left"]||[0,0]),"bottom-right":h.Point.convert(ge["bottom-right"]||[0,0]),left:h.Point.convert(ge.left||[0,0]),right:h.Point.convert(ge.right||[0,0])}}return ye(new h.Point(0,0))}(this.options.offset);if(!M){var j,H=this._container.offsetWidth,ie=this._container.offsetHeight;j=y.y+S.bottom.y<ie?["top"]:y.y>this._map.transform.height-ie?["bottom"]:[],y.x<H/2?j.push("left"):y.x>this._map.transform.width-H/2&&j.push("right"),M=j.length===0?"bottom":j.join("-")}var _e=y.add(S[M]).round();k.setTransform(this._container,Pa[M]+" translate("+_e.x+"px,"+_e.y+"px)"),Qs(this._container,M,"popup")}},u.prototype._onClose=function(){this.remove()},u}(h.Evented);function el(n,u,a,p,y){var M=arguments[5];if(!(!p||M||Ul(n,p)&&ds(n,p)===u))throw new Error("beforeId must be the id of a layer within the same group");p||M||(p=il(n,Cs(n,u)-1));var S=Object.assign({},a,{metadata:Object.assign({},a.metadata||{},{group:u})});n.addLayer(S,p,{preventUpdate:y})}function Cs(n,u){return il(n,Us(n,u))}function Us(n,u){for(var a=n.getStyle().layers,p=0;p<a.length;p++){var y=a[p];if(y.metadata&&y.metadata.group===u)return p}return-1}function tl(n,u){var a=n.getStyle().layers,p=Us(n,u);if(p===-1)return-1;for(;p<a.length&&(a[p].id===u||a[p].metadata&&a[p].metadata.group===u);)p++;return p-1}function il(n,u){if(u!==-1){var a=n.getStyle().layers;return a[u]&&a[u].id}}function ds(n,u){var a=n.getLayer(u);if(a&&a.metadata&&a.metadata.group)return a.metadata.group}function Ul(n,u){return!!n.getLayer(u)}function Nl(n,u){return u&&!Ul(n,u)?Cs(n,u):u&&ds(n,u)?Cs(n,ds(n,u)):u}var _u=h.window.mapboxgl,rl={version:h.upstreamVersion,supported:K,setRTLTextPlugin:h.setRTLTextPlugin,getRTLTextPluginStatus:h.getRTLTextPluginStatus,Map:fu,OverscaledTileID:h.OverscaledTileID,Tile:h.Tile,NavigationControl:ka,GeolocateControl:Fl,AttributionControl:Do,ScaleControl:Qa,FullscreenControl:Yo,Popup:js,Marker:Fs,Style:Mr,LngLat:h.LngLat,LngLatBounds:h.LngLatBounds,Point:h.Point,MercatorCoordinate:h.MercatorCoordinate,Evented:h.Evented,config:h.config,layerGroups:{addGroup:function(n,u,a,p,y){for(var M=Nl(n,p),S=0;S<a.length;S++)el(n,u,a[S],M,y,!0)},removeGroup:function(n,u){for(var a=n.getStyle().layers,p=0;p<a.length;p++){var y=a[p];ds(n,y.id)&&y.metadata.group===u&&n.removeLayer(y.id)}},moveGroup:function(n,u,a){for(var p=Nl(n,a),y=n.getStyle().layers,M=0;M<y.length;M++){var S=y[M];ds(n,S.id)&&S.metadata.group===u&&n.moveLayer(S.id,p)}},addLayerToGroup:el,getGroupFirstLayer:Cs,getGroupLastLayer:function(n,u){return il(n,tl(n,u))},getGroupFirstLayerIndex:Us,getGroupLastLayerIndex:tl,getLayerGroup:ds,hasGroup:function(n,u){return Us(n,u)>=0},removeLayerFromGroup:function(n,u,a){var p=n.getLayer(a);p&&p.metadata&&p.metadata.group===u&&(p.metadata.group=void 0)},moveLayerToGroup:function(n,u,a){var p=n.getLayer(a);p&&(p.metadata||(p.metadata={}),p.metadata.group=u)}},prewarm:function(){dt().acquire(Wt)},clearPrewarmedResources:function(){var n=Dt;n&&(n.isPreloaded()&&n.numActive()===1?(n.release(Wt),Dt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return h.config.ACCESS_TOKEN},set accessToken(n){h.config.ACCESS_TOKEN=n},get baseApiUrl(){return h.config.API_URL},set baseApiUrl(n){h.config.API_URL=n},get workerCount(){return ft.workerCount},set workerCount(n){ft.workerCount=n},get maxParallelImageRequests(){return h.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(n){h.config.MAX_PARALLEL_IMAGE_REQUESTS=n},clearStorage:function(n){h.clearTileCache(n)},workerUrl:""};return h.window.mapboxgl=rl,h.window.mapboxgl.noConflict=function(){return h.window.mapboxgl=_u,this},rl}),Q})},59900:(ct,Ye,B)=>{"use strict";B.d(Ye,{V:()=>Q});var Q=function(){function W(){}return W.prototype.compareTo=function(h){return-1},W.prototype.equals=function(h){return h==null?!1:this.compareTo(h)==0},W.prototype.isGreaterThan=function(h){return this.compareTo(h)==1},W.prototype.isGreaterThanOrEqual=function(h){return this.compareTo(h)!=-1},W.prototype.isLessThan=function(h){return this.compareTo(h)==-1},W.prototype.isLessThanOrEqual=function(h){return this.compareTo(h)!=1},W.prototype.notEquals=function(h){return!this.equals(h)},W}()},28360:(ct,Ye,B)=>{"use strict";B.d(Ye,{j:()=>h});var Q=B(66071),W=function(){function K(){this.callback=null,this.context=null}return K}(),h=function(){function K(){this._listeners={}}return Object.defineProperty(K.prototype,"hasListeners",{get:function(){var k=Object.prototype.hasOwnProperty;for(var A in this._listeners)if(k.call(this._listeners,A))return!0;return!1},enumerable:!0,configurable:!0}),K.prototype.added=function(){},K.prototype.addListener=function(k,A){var z="__cb_"+(0,Q.cm)(),R=new W;R.callback=k,R.context=A||null,this._listeners[z]=R,this.added()},K.prototype.clearListeners=function(){this._listeners={}},K.prototype.removed=function(){},K.prototype.removeListener=function(k,A){for(var z in this._listeners){var R=this._listeners[z];if(A!=null&&R.context===A&&R.callback===k){delete this._listeners[z];break}else if(A===void 0&&R.context===null&&R.callback===k){delete this._listeners[z];break}}this.removed()},K.prototype.trigger=function(k){k===void 0&&(k={});for(var A in this._listeners){var z=this._listeners[A],R=z.context||this;(k.target===void 0||k.target===null)&&(k.target=R),z.callback.call(R,k)}},K.addDomListener=function(k,A,z,R,C){var x=null;R&&(x=(0,Q.ak)(z,R));var v=(0,Q.cm)(),m={boundHandler:x,rawHandler:z};k._listeners||(k._listeners={}),k._listeners[v]=m,k.addEventListener?k.addEventListener(A,x||z,C):k.attachEvent("on"+A,function(){var T=x||z;T.call(k)},C)},K.addEventListener=function(k,A,z,R,C){K.addDomListener(k,A,z,R,C)},K.cancel=function(k){k.preventDefault?k.preventDefault():k.returnValue=!1},K.deriveDomElement=function(k){var A;return k||(k=window.event),k.target?A=k.target:k.srcElement&&(A=k.srcElement),A.nodeType==3&&(A=A.parentNode),A},K.removeDomListener=function(k,A,z,R){if(k._listeners)for(var C in k._listeners){var x=k._listeners[C];if(x.rawHandler===z){var v=x.boundHandler||z;k.removeEventListener?k.removeEventListener(A,v):k.detachEvent("on"+A,v),delete this[C];return}}k.removeEventListener?k.removeEventListener(A,z):k.detachEvent("on"+A,z)},K.removeEventListener=function(k,A,z,R){K.removeDomListener(k,A,z,R)},K}()},93126:(ct,Ye,B)=>{"use strict";B.d(Ye,{E:()=>Q});var Q=function(){function W(h,K){this.x=h,this.y=K}return Object.defineProperty(W.prototype,"x",{get:function(){return this._x},set:function(h){this._x=h},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"y",{get:function(){return this._y},set:function(h){this._y=h},enumerable:!0,configurable:!0}),W.prototype.clone=function(){return new W(this.x,this.y)},W.prototype.distanceTo=function(h){var K=h.x-this.x,k=h.y-this.y;return Math.sqrt(K*K+k*k)},W.prototype.round=function(){this.x=Math.round(this.x),this.y=Math.round(this.y)},W.prototype.add=function(h){this._x+=h.x,this._y+=h.y},W.prototype.toString=function(){return[this.x,this.y].join()},W}()},19501:(ct,Ye,B)=>{"use strict";B.d(Ye,{$:()=>Q});var Q=function(){function W(h,K){this.width=h,this.height=K}return W.prototype.clone=function(){return new W(this.width,this.height)},Object.defineProperty(W.prototype,"height",{get:function(){return this._height},set:function(h){this._height=h},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"width",{get:function(){return this._width},set:function(h){this._width=h},enumerable:!0,configurable:!0}),W.prototype.round=function(){this.width=Math.round(this.width),this.height=Math.round(this.height)},W.prototype.toString=function(){var h=""+this.width+"w x "+this.height+"h";return h},W}()},66071:(ct,Ye,B)=>{"use strict";B.d(Ye,{jd:()=>K,$i:()=>A,v2:()=>R,HW:()=>C,ee:()=>x,i8:()=>v,f0:()=>m,ak:()=>T,le:()=>I,Oq:()=>F,oY:()=>q,cm:()=>ne,Q_:()=>se});var Q=null,W=null,h;(function(X){X[X.Left=0]="Left",X[X.None=1]="None",X[X.Right=2]="Right"})(h||(h={}));var K;(function(X){X[X.Unloaded=0]="Unloaded",X[X.Loading=1]="Loading",X[X.Loaded=2]="Loaded"})(K||(K={}));var k;(function(X){X[X.Ascending=0]="Ascending",X[X.Descending=1]="Descending"})(k||(k={}));var A;(function(X){X[X.Absolute=0]="Absolute",X[X.Relative=1]="Relative"})(A||(A={}));var z;(function(X){X[X.Down=0]="Down",X[X.None=1]="None",X[X.Up=2]="Up"})(z||(z={}));var R;(function(X){X[X.Left=0]="Left",X[X.Center=1]="Center",X[X.Right=2]="Right"})(R||(R={}));var C;(function(X){X[X.Top=0]="Top",X[X.Middle=1]="Middle",X[X.Bottom=2]="Bottom"})(C||(C={}));var x;(function(X){X[X.Center=0]="Center",X[X.TopLeft=1]="TopLeft",X[X.Top=2]="Top",X[X.TopRight=3]="TopRight",X[X.Right=4]="Right",X[X.BottomRight=5]="BottomRight",X[X.Bottom=6]="Bottom",X[X.BottomLeft=7]="BottomLeft",X[X.Left=8]="Left"})(x||(x={}));var v="2.20.0";function m(X,ce){for(var Me=Object(X),ce=Object(ce),Be=Object.keys(ce),ot=0,Ue=Be.length;ot<Ue;ot++){var ht=Be[ot],Et=Object.getOwnPropertyDescriptor(ce,ht);Et!==void 0&&Et.enumerable&&(Me[ht]=ce[ht])}}function T(X,ce){var Me=function(){},Be=function(){return X.apply(ce,[].concat([].slice.call(arguments)))};return X.prototype&&(Me.prototype=X.prototype),Be.prototype=new Me,Be}function I(X){return X==null}function F(X){var ce=Array.isArray(X)&&Array.isArray(X[0]);return ce}function q(X,ce){return Math.log(X)/Math.log(ce)}function re(X){return typeof X!="number"?Number.NaN:X>0?1:X<1?-1:0}function ne(){var X="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(ce){var Me=Math.random()*16|0,Be=ce=="x"?Me:Me&3|8;return Be.toString(16)});return X}function se(X,ce,Me){if(Me==null||Me==="")throw new Error("InvalidArgumentException: padString must have a valid string value");try{for(var Be=""+X;Be.length<ce;)Be=Me+Be;return Be}catch(ot){console.log(ot)}}},73690:(ct,Ye,B)=>{"use strict";B.d(Ye,{U:()=>W});var Q=B(28360),W=function(){function h(K,k){k===void 0&&(k="GET"),this._isPolling=!1,this._isAsync=!0,this._method="GET",this._objectLiteral=null,this._pollCount=0,this._pollingInterval=6e4,this._protocol="CORS",this._withCredentials=!1,this._response=null,this._text=null,this._timeout=15e3,this._url=null,this._xmlDocument=null,this.errored=new Q.j,this.modified=new Q.j,this.polled=new Q.j,this.polling=new Q.j,this.timedOut=new Q.j,this.url=K,this.method=k}return h.prototype._setLastModified=function(K){this._lastModified=K;var k={lastModified:this.lastModified};this.modified.trigger(k)},Object.defineProperty(h.prototype,"isAsync",{get:function(){return this._isAsync},set:function(K){this._isAsync=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isPolling",{get:function(){return this._isPolling},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"lastModified",{get:function(){return this._lastModified},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"method",{get:function(){return this._method},set:function(K){this._method=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"objectLiteral",{get:function(){return this._objectLiteral},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"pollCount",{get:function(){return this._pollCount},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"pollingInterval",{get:function(){return this._pollingInterval},set:function(K){this._pollingInterval=K,this.stopPolling(),this.startPolling()},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"protocol",{get:function(){return this._protocol},set:function(K){this._protocol=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"response",{get:function(){return this._response},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"text",{get:function(){return this._text},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"timeout",{get:function(){return this._timeout},set:function(K){this._timeout=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"url",{get:function(){return this._url},set:function(K){this._url=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"withCredentials",{get:function(){return this._withCredentials},set:function(K){this._withCredentials=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"xmlDocument",{get:function(){return this._xmlDocument},enumerable:!0,configurable:!0}),h.prototype._poll=function(){this.sendRequest()},h.prototype._sendPaddedRequest=function(){throw new Error("NotImplementedException: sendPaddedRequest")},h.prototype._sendAjaxRequest=function(){throw new Error("NotImplementedException: sendAjaxRequest")},h.prototype._sendCorsRequest=function(){var K=this;this.polling.trigger(this);var k=!1,A=h.createCorsRequest(this.method,this.url,this.isAsync,this.withCredentials);A.timeout=this.timeout,A.onerror=function(z){K.errored.trigger(K),console.log(z)},A.ontimeout=function(z){K.timedOut.trigger(K),console.log(z)},A.onload=function(z){if(!k)try{if(A.responseXML&&(K._xmlDocument=A.responseXML),A.responseText){K._text=A.responseText;try{K._objectLiteral=JSON.parse(A.responseText)}catch(C){}}A.response&&(K._response=A.response),K._setLastModified(new Date),K._pollCount++;var R={pollCount:K.pollCount};K.polled.trigger(R),k=!0}catch(C){console.log(C)}},A.send()},h.prototype.sendRequest=function(){switch(this.protocol){case"JSONP":this._sendPaddedRequest();break;case"AJAX":this._sendAjaxRequest();break;case"CORS":default:this._sendCorsRequest();break}},h.prototype.startPolling=function(K){var k=this;this._isPolling||(this._isPolling=!0,K?this._delay=window.setTimeout(function(){k._poll(),k._timer=window.setInterval(function(){k._poll()},k.pollingInterval)},K):(this._poll(),this._timer=window.setInterval(function(){k._poll()},this.pollingInterval)))},h.prototype.stopPolling=function(){this._isPolling&&(this._isPolling=!1,clearTimeout(this._delay),clearInterval(this._timer))},h.createAjaxRequest=function(K,k){if(!XMLHttpRequest)return null;var A=new XMLHttpRequest;return A.open(K,k),A!==null&&(A.onabort=function(){},A.onerror=function(){},A.onload=function(){},A.onloadend=function(){},A.onloadstart=function(){},A.onprogress=function(){},A.onreadystatechange=function(){},A.ontimeout=function(){}),A},h.createCorsRequest=function(K,k,A,z){if(A===void 0&&(A=!0),z===void 0&&(z=!1),!XMLHttpRequest)return null;var R=new XMLHttpRequest;return"withCredentials"in R?(R.open(K,k,A),z&&(R.withCredentials=!0)):typeof XDomainRequest!="undefined"?(R=new XDomainRequest,R.open(K,k)):R=null,K.toUpperCase()==="POST"&&R.setRequestHeader("Content-type","application/x-www-form-urlencoded"),R!==null&&(R.onabort=function(C){console.log(C)},R.onerror=function(C){console.log(C)},R.onload=function(C){},R.onloadend=function(C){},R.onloadstart=function(C){},R.onprogress=function(C){},R.onreadystatechange=function(C){},R.ontimeout=function(C){console.log(C)}),R},h.createPaddedRequest=function(K,k){var A={};return A.url=K,A.jsonp=k,A.send=function(){var z,R=document.getElementsByTagName("head")[0],C="__wxMap"+"xxxxxx_xxxxxx4xxxyx_xxxxxxxxxxxx".replace(/[xy]/g,function(v){var m=Math.random()*16|0,T=v=="x"?m:m&3|8;return T.toString(16)});window[C]=function(){A.callback(arguments[0])};var x=this.url+(this.url.indexOf("?")>=0?"&":"?")+this.jsonp+"="+C;z=document.createElement("script"),z.async=!0,z.src=x,z.onload=z.onreadystatechange=function(v,m){(m||!z.readyState||/loaded|complete/.test(z.readyState))&&(z.onload=z.onreadystatechange=null,z.parentNode&&z.parentNode.removeChild(z),z=null)},R.insertBefore(z,R.firstChild)},A.abort=function(){throw new Error("Abort not yet created")},A.callback=function(){},A},h}()},5860:(ct,Ye,B)=>{"use strict";B.d(Ye,{d:()=>W});var Q=B(38433),W=function(){function h(K,k){this._validTime=k,this._modelRun=K}return Object.defineProperty(h.prototype,"key",{get:function(){if(!this._key){var K="";this._modelRun&&(K+=(0,Q.RQ)(this._modelRun.value)+"_"),this._validTime&&(K+=(0,Q.RQ)(this._validTime.value)),this._key=K||null}return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"modelRun",{get:function(){return this._modelRun},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"validTime",{get:function(){return this._validTime},enumerable:!0,configurable:!0}),h.prototype.equals=function(K){var k,A=this.toString(),z=K.toString();return k=A===z,k},h.prototype.toString=function(){var K=this.modelRun?this.modelRun.toString():"0",k=this.validTime?this.validTime.toString():"0",A=K+"."+k;return A},h}()},69548:(ct,Ye,B)=>{"use strict";B.d(Ye,{o:()=>W});var Q=B(38433),W=function(){function h(K,k){K===void 0&&(K=null),this._validTimes=[],this._value=K,k&&(this._validTimes=k)}return Object.defineProperty(h.prototype,"validTimes",{get:function(){return this._validTimes},set:function(K){this._validTimes=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this._value},set:function(K){this._value=K},enumerable:!0,configurable:!0}),h.prototype.toString=function(){var K="0";return this.value&&(K=(0,Q.RQ)(this.value)),K},h}()},18078:(ct,Ye,B)=>{"use strict";B.d(Ye,{e:()=>h});var Q=B(38433),W=B(72503),h=function(){function K(k,A){this._startTime=k,this._endTime=A,this._lastUpdated=new Date}return Object.defineProperty(K.prototype,"startTime",{get:function(){return this._startTime},set:function(k){this._startTime=k},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"endTime",{get:function(){return this._endTime},set:function(k){this._endTime=k},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"iteration",{get:function(){return this._iteration},set:function(k){this._iteration=k},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"span",{get:function(){var k=W.i.fromDates(this._startTime,this._endTime);return k},enumerable:!0,configurable:!0}),K.prototype.equals=function(k){var A,z=this.toString(),R=k.toString();return A=z===R,A},K.prototype.modify=function(k,A){this._startTime=k,this._endTime=A},K.prototype.toChronoString=function(){var k=(0,Q.RQ)(this._startTime),A=(0,Q.RQ)(this._endTime),z=k+"-"+A;return isNaN(this.iteration)||(z+=":"+this.iteration),z},K.prototype.toEpochString=function(){var k=this._startTime.getTime(),A=this._endTime.getTime(),z=k+"-"+A;return isNaN(this.iteration)||(z+=":"+this.iteration),z},K.prototype.inRange=function(k){if(!this._startTime||!this._endTime)return!0;var A=this._startTime.getTime(),z=this._endTime.getTime(),R;k instanceof Date?R=k.getTime():R=k;var C=R<=z&&R>=A;return C},K.prototype.intersects=function(k,A,z){if(z===void 0&&(z=!0),!this._startTime||!this._endTime)return!0;var R=this._startTime.getTime(),C=this._endTime.getTime(),x,v;k instanceof Date?x=k.getTime():x=k,A instanceof Date?v=A.getTime():v=A;var m;return z?m=x<=C&&R<=v:m=x<C&&R<v,m},K.prototype._increment=function(){if(!(!this._startTime&&!this._endTime)){var k=new Date,A=new Date(this._lastUpdated.getTime());this._lastUpdated=k;var z=W.i.fromDates(A,k);this._startTime&&(this._startTime=new Date(this._startTime.getTime()+z.totalMilliseconds)),this._endTime&&(this._endTime=new Date(this._endTime.getTime()+z.totalMilliseconds))}},K}()},72503:(ct,Ye,B)=>{"use strict";B.d(Ye,{i:()=>Q});var Q=function(){function W(h,K,k,A,z){h===void 0&&(h=0),K===void 0&&(K=0),k===void 0&&(k=0),A===void 0&&(A=0),z===void 0&&(z=0),this._milliseconds=0,this._milliseconds+=z*W.millisecondsPerDay,this._milliseconds+=A*W.millisecondsPerHour,this._milliseconds+=k*W.millisecondsPerMinute,this._milliseconds+=K*W.millisecondsPerSecond,this._milliseconds+=h}return Object.defineProperty(W,"max",{get:function(){return W._max},enumerable:!0,configurable:!0}),Object.defineProperty(W,"millisecondsPerDay",{get:function(){return W._millisecondsPerDay},enumerable:!0,configurable:!0}),Object.defineProperty(W,"millisecondsPerHour",{get:function(){return W._millisecondsPerHour},enumerable:!0,configurable:!0}),Object.defineProperty(W,"millisecondsPerMinute",{get:function(){return W._millisecondsPerMinute},enumerable:!0,configurable:!0}),Object.defineProperty(W,"millisecondsPerSecond",{get:function(){return W._millisecondsPerSecond},enumerable:!0,configurable:!0}),Object.defineProperty(W,"min",{get:function(){return W._min},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"days",{get:function(){var h=this._milliseconds>0?Math.floor(this._milliseconds/W.millisecondsPerDay):Math.ceil(this._milliseconds/W.millisecondsPerDay),K=h%365;return K},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"hours",{get:function(){var h=this._milliseconds>0?Math.floor(this._milliseconds/W.millisecondsPerHour):Math.ceil(this._milliseconds/W.millisecondsPerHour),K=h%24;return K},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"milliseconds",{get:function(){return this._milliseconds%1e3},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"minutes",{get:function(){var h=this._milliseconds>0?Math.floor(this._milliseconds/W.millisecondsPerMinute):Math.ceil(this._milliseconds/W.millisecondsPerMinute),K=h%60;return K},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"seconds",{get:function(){var h=this._milliseconds>0?Math.floor(this._milliseconds/W.millisecondsPerSecond):Math.ceil(this._milliseconds/W.millisecondsPerSecond),K=h%60;return K},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"totalDays",{get:function(){var h=this._milliseconds/W.millisecondsPerDay;return h},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"totalHours",{get:function(){var h=this._milliseconds/W.millisecondsPerHour;return h},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"totalMilliseconds",{get:function(){return this._milliseconds},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"totalMinutes",{get:function(){var h=this._milliseconds/W.millisecondsPerMinute;return h},enumerable:!0,configurable:!0}),Object.defineProperty(W.prototype,"totalSeconds",{get:function(){var h=this._milliseconds/W.millisecondsPerSecond;return h},enumerable:!0,configurable:!0}),W.prototype.add=function(h){this._milliseconds+=h.totalMilliseconds},W.prototype.addDays=function(h){this._milliseconds+=h*W.millisecondsPerDay},W.prototype.addHours=function(h){this._milliseconds+=h*W.millisecondsPerHour},W.prototype.addMilliseconds=function(h){this._milliseconds+=h},W.prototype.addMinutes=function(h){this._milliseconds+=h*W.millisecondsPerMinute},W.prototype.addSeconds=function(h){this._milliseconds+=h*W.millisecondsPerSecond},W.prototype.equals=function(h){return this._milliseconds===h.totalMilliseconds},W.prototype.subtract=function(h){this._milliseconds-=h.totalMilliseconds},W.prototype.subtractDays=function(h){this._milliseconds-=h*W.millisecondsPerDay},W.prototype.subtractHours=function(h){this._milliseconds-=h*W.millisecondsPerHour},W.prototype.subtractMilliseconds=function(h){this._milliseconds-=h},W.prototype.subtractMinutes=function(h){this._milliseconds-=h*W.millisecondsPerMinute},W.prototype.subtractSeconds=function(h){this._milliseconds-=h*W.millisecondsPerSecond},W.prototype.toString=function(){var h=this.days,K=this.hours,k=this.minutes,A=this.seconds,z=this.milliseconds,R=h+"."+K+":"+k+":"+A+":"+z;return R},W.fromDates=function(h,K,k){k===void 0&&(k=!1);var A=K.getTime()-h.getTime();return k===!0&&(A=Math.abs(A)),new W(A,0,0,0,0)},W.parse=function(h){var K=h.split("."),k=K.length-1,A=K[k],z=K.length>1&&parseInt(K[0])||0,R=A.split(":");if(R.length<3)throw Error("FormatException: Argument provided does not follow the required hh:mm:ss format. Invalid length");var C=parseInt(R[0])||0,x=parseInt(R[1])||0,v=parseInt(R[2])||0,m=R.length>=4&&parseInt(R[3])||0,T=new W(m,v,x,C,z);return T},W._millisecondsPerDay=864e5,W._millisecondsPerHour=36e5,W._millisecondsPerMinute=6e4,W._millisecondsPerSecond=1e3,W._ctor=function(){return W._max=new W(Number.MAX_VALUE,0,0,0,0),W._min=new W(0,0,0,0,0),W._ctor=void 0,null}(),W}()},38433:(ct,Ye,B)=>{"use strict";B.d(Ye,{VV:()=>W,Fp:()=>h,g7:()=>A,RQ:()=>x,K2:()=>v});var Q=B(66071),W=new Date(1,0,1,0,0,0),h=new Date(9999,11,31,23,59,59,999);function K(m){var T=parseInt(m.substr(0,4))||0,I=parseInt(m.substr(4,2),10)||0,F=parseInt(m.substr(6,2),10)||0,q=parseInt(m.substr(8,2),10)||0,re=parseInt(m.substr(10,2),10)||0,ne=parseInt(m.substr(12,2),10)||0,se=new Date(T,I-1,F,q,re,ne,0);return se}function k(m){var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],I=parseInt(m.substr(7,4))||0,F=m.substr(3,3),q=T.indexOf(F),re=parseInt(m.substr(0,2),10)||0,ne=parseInt(m.substr(12,2),10)||0,se=parseInt(m.substr(15,2),10)||0,X=parseInt(m.substr(18,2),10)||0,ce=new Date(I,q,re,ne,se,X,0);return ce}function A(m){if(!m)throw new Error("InvalidArgumentException: must be a properly formatted chrono-data string.");var T=parseInt(m.substr(0,4))||0,I=parseInt(m.substr(4,2),10)||0,F=parseInt(m.substr(6,2),10)||0,q=parseInt(m.substr(8,2),10)||0,re=parseInt(m.substr(10,2),10)||0,ne=parseInt(m.substr(12,2),10)||0,se=new Date(Date.UTC(T,I-1,F,q,re,ne));return se}function z(m){if(!m)throw new Error("InvalidArgumentException: must be a properly formatted chrono-data string.");var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],I=parseInt(m.substr(7,4))||0,F=parseInt(m.substr(3,3),10)||0,q=m.substr(3,3),F=T.indexOf(q),re=parseInt(m.substr(0,2),10)||0,ne=parseInt(m.substr(12,2),10)||0,se=parseInt(m.substr(15,2),10)||0,X=parseInt(m.substr(18,2),10)||0,ce=new Date(Date.UTC(I,F,re,ne,se,X));return ce}function R(m){var T=m.getFullYear()+padLeft((m.getMonth()+1).toString(),2,"0")+padLeft(m.getDate().toString(),2,"0")+padLeft(m.getHours().toString(),2,"0")+padLeft(m.getMinutes().toString(),2,"0")+padLeft(m.getSeconds().toString(),2,"0");return T}function C(m){try{var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],I=padLeft(m.getDate(),2,"0")+" "+T[m.getMonth()]+" "+m.getFullYear()+" "+padLeft(m.getHours(),2,"0")+":"+padLeft(m.getMinutes(),2,"0")+":"+padLeft(m.getSeconds(),2,"0");return I}catch(F){return"Invalid Date"}}function x(m){var T=m.getUTCFullYear()+(0,Q.Q_)((m.getUTCMonth()+1).toString(),2,"0")+(0,Q.Q_)(m.getUTCDate().toString(),2,"0")+(0,Q.Q_)(m.getUTCHours().toString(),2,"0")+(0,Q.Q_)(m.getUTCMinutes().toString(),2,"0")+(0,Q.Q_)(m.getUTCSeconds().toString(),2,"0");return T}function v(m){try{var T=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],I=(0,Q.Q_)(m.getUTCDate(),2,"0")+" "+T[m.getUTCMonth()]+" "+m.getUTCFullYear()+" "+(0,Q.Q_)(m.getUTCHours(),2,"0")+":"+(0,Q.Q_)(m.getUTCMinutes(),2,"0")+":"+(0,Q.Q_)(m.getUTCSeconds(),2,"0");return I}catch(F){return"Invalid Date"}}},59687:(ct,Ye,B)=>{"use strict";B.d(Ye,{T:()=>W});var Q=B(38433),W=function(){function h(K,k){if(!(K instanceof Date))throw new Error("wx.dateTime.ValidTime requires a Date object as its first parameter");this._value=K,this._cipher=k||""}return Object.defineProperty(h.prototype,"cipher",{get:function(){return this._cipher},set:function(K){this._cipher=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"value",{get:function(){return this._value},set:function(K){this._value=K},enumerable:!0,configurable:!0}),h.prototype.toString=function(){var K="0";return this.value&&(K=(0,Q.K2)(this.value)),K},h}()},58326:(ct,Ye,B)=>{"use strict";B.d(Ye,{R:()=>h});var Q=B(59900),W=function(){var K=function(k,A){return K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,R){z.__proto__=R}||function(z,R){for(var C in R)R.hasOwnProperty(C)&&(z[C]=R[C])},K(k,A)};return function(k,A){K(k,A);function z(){this.constructor=k}k.prototype=A===null?Object.create(A):(z.prototype=A.prototype,new z)}}(),h=function(K){W(k,K);function k(A){var z=K.call(this)||this;return z._radians=0,z._radians=A||0,z}return Object.defineProperty(k.prototype,"degrees",{get:function(){return k.radiansToDegrees(this._radians)},set:function(A){A!=null&&(this._radians=k.degreesToRadians(A))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"radians",{get:function(){return this._radians},set:function(A){A!=null&&(this._radians=A)},enumerable:!0,configurable:!0}),k.prototype.compareTo=function(A){return this._radians==A.radians?0:this._radians<A.radians?-1:1},k.degreesToRadians=function(A){return A*.017453292519943295},k.fromDegrees=function(A){var z=k.degreesToRadians(A);return new k(z)},k.fromRadians=function(A){return new k(A)},k.radiansToDegrees=function(A){return A*57.29577951308232},k}(Q.V)},22236:(ct,Ye,B)=>{"use strict";B.d(Ye,{r:()=>K});var Q=B(59900),W=B(58326),h=function(){var k=function(A,z){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,C){R.__proto__=C}||function(R,C){for(var x in C)C.hasOwnProperty(x)&&(R[x]=C[x])},k(A,z)};return function(A,z){k(A,z);function R(){this.constructor=A}A.prototype=z===null?Object.create(z):(R.prototype=z.prototype,new R)}}(),K=function(k){h(A,k);function A(z){var R=k.call(this)||this;return R._meters=z||0,R}return Object.defineProperty(A.prototype,"feet",{get:function(){return this._meters*(1/.3048)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"kilometers",{get:function(){return this._meters*.001},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"meters",{get:function(){return this._meters},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"miles",{get:function(){return this._meters*(1/1609.344)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"nauticalMiles",{get:function(){return this._meters*(1/1852)},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"yards",{get:function(){return this._meters*(1/.9144)},enumerable:!0,configurable:!0}),A.prototype.add=function(z){return new A(this._meters+z.meters)},A.prototype.compareTo=function(z){return this._meters==z.meters?0:this._meters<z.meters?-1:1},A.prototype.subtract=function(z){return new A(this._meters-z.meters)},A.prototype.toAngularDistance=function(){return W.R.fromRadians(this._meters/6371009)},A.fromFeet=function(z){return new A(z*.3048)},A.fromKilometers=function(z){return new A(z*1e3)},A.fromMeters=function(z){return new A(z)},A.fromMiles=function(z){return new A(z*1609.344)},A.fromNauticalMiles=function(z){return new A(z*1852)},A.fromPoints=function(z,R){var C=z.longitude.radians,x=z.latitude.radians,v=R.longitude.radians,m=R.latitude.radians,T=m-x,I=v-C,F=Math.sin(T/2)*Math.sin(T/2)+Math.cos(x)*Math.cos(m)*Math.sin(I/2)*Math.sin(I/2),q=2*Math.atan2(Math.sqrt(F),Math.sqrt(1-F)),re=6371009*q;return A.fromMeters(re)},A.fromYards=function(z){return new A(z*.9144)},A}(Q.V)},49744:(ct,Ye,B)=>{"use strict";B.d(Ye,{G:()=>k});var Q=B(50042),W=B(9506),h=B(22045),K=B(1068),k=function(){function A(z){this._distance=z}return A.prototype.filter=function(z){for(var R=[],C=new K.P,x=z.length,v=0;v<x;v++){var m=z[v],T=m,I=T.bounds.centerPoint,F=this._distance.nauticalMiles,q=I.latitude.radians,re=F/60/2*1.2*(2-Math.abs(Math.cos(q))),ne=new Q.c;ne.west=h.o.fromDegrees(I.longitude.degrees-re),ne.east=h.o.fromDegrees(I.longitude.degrees+re),ne.north=W.K.fromDegrees(I.latitude.degrees+re),ne.south=W.K.fromDegrees(I.latitude.degrees-re),C.insertNoCollision(ne)&&R.push(m)}return R},A}()},50042:(ct,Ye,B)=>{"use strict";B.d(Ye,{c:()=>R});var Q=B(84922),W=B.n(Q),h=B(96302),K=B.n(h),k=B(9654),A=B(9506),z=B(22045),R=function(){function C(x,v,m,T){this.north=x||A.K.fromDegrees(-90),this.west=v||z.o.fromDegrees(180),this.south=m||A.K.fromDegrees(90),this.east=T||z.o.fromDegrees(-180)}return Object.defineProperty(C,"minimum",{get:function(){return C._minimum},enumerable:!0,configurable:!0}),Object.defineProperty(C,"world",{get:function(){return C._world},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"bottomLeftGeoPoint",{get:function(){return this._bottomLeftGeoPoint?(this._bottomLeftGeoPoint.latitude.radians=this.south.radians,this._bottomLeftGeoPoint.longitude.radians=this.west.radians):this._bottomLeftGeoPoint=new k.F(this.south,this.west),this._bottomLeftGeoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"bottomLeftQuadrant",{get:function(){var x=new C;return x.north=A.K.fromRadians((this.north.radians+this.south.radians)/2),x.west=this.west,x.east=z.o.fromRadians((this.east.radians+this.west.radians)/2),x.south=this.south,x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"bottomRightGeoPoint",{get:function(){return this._bottomRightGeoPoint?(this._bottomRightGeoPoint.latitude.radians=this.south.radians,this._bottomRightGeoPoint.longitude.radians=this.east.radians):this._bottomRightGeoPoint=new k.F(this.south,this.east),this._bottomRightGeoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"bottomRightQuadrant",{get:function(){var x=new C;return x.north=A.K.fromRadians((this.north.radians+this.south.radians)/2),x.west=z.o.fromRadians((this.east.radians+this.west.radians)/2),x.east=this.east,x.south=this.south,x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"bounds",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"centerPoint",{get:function(){var x=(this.west.radians+this.east.radians)/2,v=(this.north.radians+this.south.radians)/2;return this._centerPoint?(this._centerPoint.latitude.radians=v,this._centerPoint.longitude.radians=x):this._centerPoint=k.F.fromRadians(v,x),this._centerPoint},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"east",{get:function(){return this._east},set:function(x){this._east=x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"isIdlVisible",{get:function(){var x;this._idlBounds?(x=this._idlBounds,this._idlBounds.north.radians=this.north.radians,this._idlBounds.west.radians=this.west.radians,this._idlBounds.south.radians=this.south.radians,this._idlBounds.east.radians=this.east.radians):x=this._idlBounds=new C(this.north,this.west,this.south,this.east),x.normalize();var v=x.west.degrees>=x.east.degrees;return v},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"height",{get:function(){var x=this.north.subtractAngle(this.south.angle);return x.angle},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"north",{get:function(){return this._north},set:function(x){this._north=x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"south",{get:function(){return this._south},set:function(x){this._south=x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"topLeftGeoPoint",{get:function(){return this._topLeftGeoPoint?(this._topLeftGeoPoint.latitude.radians=this.north.radians,this._topLeftGeoPoint.longitude.radians=this.west.radians):this._topLeftGeoPoint=new k.F(this.north,this.west),this._topLeftGeoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"topLeftQuadrant",{get:function(){var x=new C;return x.north=this.north,x.west=this.west,x.east=z.o.fromRadians((this.east.radians+this.west.radians)/2),x.south=A.K.fromRadians((this.north.radians+this.south.radians)/2),x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"topRightGeoPoint",{get:function(){return this._topRightGeoPoint?(this._topRightGeoPoint.latitude.radians=this.north.radians,this._topRightGeoPoint.longitude.radians=this.east.radians):this._topRightGeoPoint=new k.F(this.north,this.east),this._topRightGeoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"topRightQuadrant",{get:function(){var x=new C;return x.north=this.north,x.west=z.o.fromRadians((this.east.radians+this.west.radians)/2),x.east=this.east,x.south=A.K.fromRadians((this.north.radians+this.south.radians)/2),x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"west",{get:function(){return this._west},set:function(x){this._west=x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"width",{get:function(){var x=this.east.subtractAngle(this.west.angle);return x.angle},enumerable:!0,configurable:!0}),C.prototype.containsBounds=function(x){return this.west.isLessThanOrEqual(x.west)&&this.east.isGreaterThanOrEqual(x.east)&&this.north.isGreaterThanOrEqual(x.north)&&this.south.isLessThanOrEqual(x.south)},C.prototype.containsPoint=function(x){var v=x.longitude,m=x.latitude;return this.west.isGreaterThan(this.east)?(v.isGreaterThanOrEqual(this.west)&&v.degrees<=180||v.isLessThanOrEqual(this.east)&&v.degrees>=-180)&&m.isGreaterThanOrEqual(this.south)&&m.isLessThanOrEqual(this.north):v.isGreaterThanOrEqual(this.west)&&v.isLessThanOrEqual(this.east)&&m.isGreaterThanOrEqual(this.south)&&m.isLessThanOrEqual(this.north)},C.prototype.expand=function(x){var v=x.longitude,m=x.latitude;v.isLessThanOrEqual(this.west)&&(this.west.radians=v.radians),v.isGreaterThanOrEqual(this.east)&&(this.east.radians=v.radians),m.isLessThanOrEqual(this.south)&&(this.south.radians=m.radians),m.isGreaterThanOrEqual(this.north)&&(this.north.radians=m.radians)},C.prototype.add=function(x){this.expand(x.topLeftGeoPoint),this.expand(x.bottomRightGeoPoint)},C.prototype.intersects=function(x){if(this.west.isGreaterThan(this.east)){var v=C.fromDegrees(this.north.degrees,this.west.degrees,this.south.degrees,180),m=C.fromDegrees(this.north.degrees,-180,this.south.degrees,this.east.degrees);return v.intersects(x)||m.intersects(x)}if(x.west.isGreaterThan(x.east)){var v=C.fromDegrees(x.north.degrees,x.west.degrees,x.south.degrees,180),m=C.fromDegrees(x.north.degrees,-180,x.south.degrees,x.east.degrees);return this.intersects(v)||this.intersects(m)}return!(this.north.isLessThan(x.south)||this.south.isGreaterThan(x.north)||this.west.isGreaterThan(x.east)||this.east.isLessThan(x.west))},C.prototype.invalidate=function(){this.north=A.K.fromDegrees(-90),this.south=A.K.fromDegrees(90),this.west=z.o.fromDegrees(180),this.east=z.o.fromDegrees(-180)},C.prototype.normalize=function(){this.east.normalize(),this.west.normalize(),this.south.normalize(),this.north.normalize()},C.prototype.clone=function(){return C.fromDegrees(this._north.degrees,this._west.degrees,this._south.degrees,this._east.degrees)},C.prototype.toLeaflet=function(){var x=new(K()).LatLng(this.south.degrees,this.west.degrees),v=new(K()).LatLng(this.north.degrees,this.east.degrees),m=new(K()).LatLngBounds(x,v);return m},C.prototype.toMapbox=function(){var x=new(W()).LngLat(this.west.degrees,this.south.degrees),v=new(W()).LngLat(this.east.degrees,this.north.degrees),m=new(W()).LngLatBounds(x,v);return m},C.prototype.toString=function(){var x=this.north.toString()+"N:"+this.east.toString()+"E:"+this.south.toString()+"S:"+this.west.toString()+"W";return x},C.fromLeaflet=function(x){var v=x.getSouth(),m=x.getWest(),T=x.getNorth(),I=x.getEast(),F=A.K.fromDegrees(T),q=A.K.fromDegrees(v),re=z.o.fromDegrees(I),ne=z.o.fromDegrees(m),se=new C(F,ne,q,re);return se},C.fromDegrees=function(x,v,m,T){var I=A.K.fromDegrees(x),F=A.K.fromDegrees(m),q=z.o.fromDegrees(v),re=z.o.fromDegrees(T);return new C(I,q,F,re)},C._world=C.fromDegrees(90,-180,-90,180),C._minimum=C.fromDegrees(0,0,0,0),C}()},9654:(ct,Ye,B)=>{"use strict";B.d(Ye,{F:()=>R});var Q=B(84922),W=B.n(Q),h=B(96302),K=B.n(h),k=function(){function C(){throw new Error("Static class cannot be instantiated")}return C._refine_interval=function(x,v,m){v&m?x[0]=(x[0]+x[1])/2:x[1]=(x[0]+x[1])/2},C._calculateAdjacent=function(x,v){x=x.toLowerCase();var m=x.charAt(x.length-1),T=x.length%2?"odd":"even",I=x.substring(0,x.length-1);return C.BORDERS[v][T].indexOf(m)!=-1&&(I=C._calculateAdjacent(I,v)),I+C.BASE32[C.NEIGHBORS[v][T].indexOf(m)]},C.decodeGeoHash=function(x){var v=!0,m=[],T=[];m[0]=-90,m[1]=90,T[0]=-180,T[1]=180;for(var I=90,F=180,q=0,re=x.length;q<re;q++)for(var ne=x[q],se=C.BASE32.indexOf(ne),X=0;X<5;X++){var ce=C.BITS[X];v?(F/=2,C._refine_interval(T,se,ce)):(I/=2,C._refine_interval(m,se,ce)),v=!v}return m[2]=(m[0]+m[1])/2,T[2]=(T[0]+T[1])/2,{latitude:m,longitude:T}},C.encodeGeoHash=function(x,v){var m=!0,T=0,I=[],F=[],q=0,re=0,ne=12,se="";for(I[0]=-90,I[1]=90,F[0]=-180,F[1]=180;se.length<ne;){if(m){var X=(F[0]+F[1])/2;v>X?(re|=C.BITS[q],F[0]=X):F[1]=X}else X=(I[0]+I[1])/2,x>X?(re|=C.BITS[q],I[0]=X):I[1]=X;m=!m,q<4?q++:(se+=C.BASE32[re],q=0,re=0)}return se},C.BITS=[16,8,4,2,1],C.BASE32="0123456789bcdefghjkmnpqrstuvwxyz",C._ctor=function(){var x={right:{even:"bc01fg45238967deuvhjyznpkmstqrwx"},left:{even:"238967debc01fg45kmstqrwxuvhjyznp"},top:{even:"p0r21436x8zb9dcf5h7kjnmqesgutwvy"},bottom:{even:"14365h7k9dcfesgujnmqp0r2twvyx8zb"}},v={right:{even:"bcfguvyz"},left:{even:"0145hjnp"},top:{even:"prxz"},bottom:{even:"028b"}};return x.bottom.odd=x.left.even,x.top.odd=x.right.even,x.left.odd=x.bottom.even,x.right.odd=x.top.even,v.bottom.odd=v.left.even,v.top.odd=v.right.even,v.left.odd=v.bottom.even,v.right.odd=v.top.even,C.NEIGHBORS=x,C.BORDERS=v,null}(),C}(),A=B(9506),z=B(22045),R=function(){function C(x,v){this.longitude=v||z.o.fromDegrees(0),this.latitude=x||A.K.fromDegrees(0)}return Object.defineProperty(C.prototype,"latitude",{get:function(){return this._latitude},set:function(x){this._latitude=x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"longitude",{get:function(){return this._longitude},set:function(x){this._longitude=x},enumerable:!0,configurable:!0}),C.prototype.equals=function(x){var v,m,T=x.longitude,I=x.latitude;this.longitude.isGreaterThan(T)?v=this.longitude.degrees-T.degrees:v=T.degrees-this.longitude.degrees,this.latitude.isGreaterThan(I)?m=this.latitude.degrees-I.degrees:m=I.degrees-this.latitude.degrees;var F=1e-6;return v<F&&m<F},C.prototype.normalize=function(){this.longitude.normalize(),this.latitude.normalize()},C.prototype.toLeaflet=function(){var x=new(K()).LatLng(this.latitude.degrees,this.longitude.degrees);return x},C.prototype.toMapbox=function(){var x=new(W()).LngLat(this.longitude.degrees,this.latitude.degrees);return x},C.prototype.toString=function(){var x=[this.latitude.degrees,this.longitude.degrees].join();return x},C.prototype.clone=function(){return C.fromDegrees(this.latitude.degrees,this.longitude.degrees)},C.prototype.toGeoHash=function(){var x=k.encodeGeoHash(this.latitude.degrees,this.longitude.degrees);return x},C.fromDegrees=function(x,v){var m=A.K.fromDegrees(x),T=z.o.fromDegrees(v),I=new C(m,T);return I},C.fromLeaflet=function(x){var v=C.fromDegrees(x.lat,x.lng);return v},C.fromMapbox=function(x){var v=C.fromDegrees(x.lat,x.lng);return v},C.fromRadians=function(x,v){var m=A.K.fromRadians(x),T=z.o.fromRadians(v),I=new C(m,T);return I},C.fromGeoHash=function(x){var v=k.decodeGeoHash(x),m=C.fromDegrees(v.latitude,v.longitude);return m},C}()},24940:(ct,Ye,B)=>{"use strict";B.d(Ye,{h:()=>W});var Q=B(50042),W=function(){function h(K){this._polygon=[],this._isBoundingBoxComputed=!1,K&&(this.polylines=K),this._boundingBox=new Q.c,this._boundingBox.invalidate()}return Object.defineProperty(h.prototype,"bounds",{get:function(){return this._isBoundingBoxComputed?this._boundingBox:(this._boundingBox=this._computeBoundingBox(),this._boundingBox)},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"polylines",{get:function(){return this._polygon},set:function(K){this._polygon=K,this._isBoundingBoxComputed=!1},enumerable:!0,configurable:!0}),h.prototype._computeBoundingBox=function(){this._boundingBox.invalidate();for(var K=this._polygon.length,k=0;k<K;k++)for(var A=this._polygon[k],z=A.points,R=z.length,C=0;C<R;++C){var x=z[C];this._boundingBox.expand(x)}return this._isBoundingBoxComputed=!0,this._boundingBox},h}()},29227:(ct,Ye,B)=>{"use strict";B.d(Ye,{A:()=>W});var Q=B(50042),W=function(){function h(K){if(this._polyline=[],this._boundingBox=new Q.c,this._isClosed=!1,this._isDirty=!1,this._vertices=0,this._boundingBox.invalidate(),K)for(var k=0,A=K.length;k<A;k++){var z=K[k];this.add(z)}}return Object.defineProperty(h.prototype,"bounds",{get:function(){return this._boundingBox},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isClosed",{get:function(){return this._isClosed},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"latitudes",{get:function(){return this._latitudes},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"longitudes",{get:function(){return this._longitudes},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"points",{get:function(){return this._polyline},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"vertices",{get:function(){return this._vertices},enumerable:!0,configurable:!0}),h.prototype._bind=function(){var K=this._polyline[0],k=this._polyline[this._polyline.length-1];this._isClosed=K.equals(k),this._vertices=this._isClosed?this._polyline.length-1:this._polyline.length,this._longitudes=[],this._latitudes=[];for(var A=0;A<this._vertices;A++){var z=this._polyline[A];this._longitudes.push(z.longitude),this._latitudes.push(z.latitude)}},h.prototype.add=function(K){this._polyline.push(K),this._boundingBox.expand(K),this._bind()},h.prototype.append=function(K){if(!K._polyline||K._polyline.length<=0)throw new Error("invalid argument: geoPolyline");var k=K.points,A=this.points,z=this._polyline.length,R=A[z-1],C=k[0];(z===0||z!=0&&!R.equals(C))&&this.add(k[0]);for(var x=1,v=k.length;x<v;x++){var m=k[x];this.add(m)}},h.prototype.clone=function(){for(var K=new h,k=this._polyline.length,A=0;A<k;A++){var z=this._polyline[A];K.add(z)}return K},h.prototype.contains=function(K){for(var k=!1,A=K.longitude.degrees,z=K.latitude.degrees,R=0,C=this._vertices-1;R<this._vertices;R++){var x=this._latitudes[R].degrees,v=this._latitudes[C].degrees,m=this._longitudes[R].degrees,T=this._longitudes[C].degrees;(x<z&&v>=z||v<z&&x>=z)&&(m<=A||T<=A)&&m+(z-x)/(v-x)*(T-m)<A&&(k=!k),C=R}return k},h.prototype.reverse=function(){this._polyline&&(this._polyline.reverse(),this._bind())},h}()},9506:(ct,Ye,B)=>{"use strict";B.d(Ye,{K:()=>K});var Q=B(59900),W=B(58326),h=function(){var k=function(A,z){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,C){R.__proto__=C}||function(R,C){for(var x in C)C.hasOwnProperty(x)&&(R[x]=C[x])},k(A,z)};return function(A,z){k(A,z);function R(){this.constructor=A}A.prototype=z===null?Object.create(z):(R.prototype=z.prototype,new R)}}(),K=function(k){h(A,k);function A(z){var R=k.call(this)||this;return R._angle=z||new W.R,R}return Object.defineProperty(A.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"degrees",{get:function(){return this._angle.degrees},set:function(z){this._angle.degrees=z},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"radians",{get:function(){return this._angle.radians},set:function(z){this._angle.radians=z},enumerable:!0,configurable:!0}),A.prototype.addAngle=function(z){return A.fromRadians(this.radians+z.radians)},A.prototype.compareTo=function(z){return this._angle.compareTo(z.angle)},A.prototype.normalize=function(){var z=Math.PI/2,R=this.radians;R%=Math.PI,R<-z&&(R=-Math.PI-R),R>z&&(R=Math.PI-R),this.radians=R},A.prototype.subtractAngle=function(z){return A.fromRadians(this.radians-z.radians)},A.prototype.toString=function(z){z===void 0&&(z=!1);var R=this.degrees;if(isNaN(R))return"NaN";if(z){var C=Math.abs(R).toString();return C=R>=0?C+"N":C+"S",C}else return R.toString()},A.fromDegrees=function(z){return new A(W.R.fromDegrees(z))},A.fromRadians=function(z){return new A(W.R.fromRadians(z))},A}(Q.V)},22045:(ct,Ye,B)=>{"use strict";B.d(Ye,{o:()=>K});var Q=B(59900),W=B(58326),h=function(){var k=function(A,z){return k=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(R,C){R.__proto__=C}||function(R,C){for(var x in C)C.hasOwnProperty(x)&&(R[x]=C[x])},k(A,z)};return function(A,z){k(A,z);function R(){this.constructor=A}A.prototype=z===null?Object.create(z):(R.prototype=z.prototype,new R)}}(),K=function(k){h(A,k);function A(z){var R=k.call(this)||this;return R._angle=z||new W.R,R}return Object.defineProperty(A.prototype,"angle",{get:function(){return this._angle},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"degrees",{get:function(){return this._angle.degrees},set:function(z){this._angle.degrees=z},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"radians",{get:function(){return this._angle.radians},set:function(z){this._angle.radians=z},enumerable:!0,configurable:!0}),A.prototype.addAngle=function(z){return A.fromRadians(this.radians+z.radians)},A.prototype.compareTo=function(z){return this._angle.compareTo(z.angle)},A.prototype.normalize=function(z){z===void 0&&(z=!1);for(var R=this.radians;R<-Math.PI;)R+=Math.PI*2;for(;R>Math.PI;)R-=Math.PI*2;return z?A.fromRadians(R):(this.radians=R,this)},A.prototype.subtractAngle=function(z){return A.fromRadians(this.radians-z.radians)},A.prototype.toString=function(z){z===void 0&&(z=!1);var R=this.degrees;if(isNaN(R))return"NaN";if(z){var C=Math.abs(R).toString();return C=R>=0?C+"E":C+"W",C}else return R.toString()},A.fromDegrees=function(z){return new A(W.R.fromDegrees(z))},A.fromRadians=function(z){return new A(W.R.fromRadians(z))},A}(Q.V)},4225:(ct,Ye,B)=>{"use strict";B.d(Ye,{_:()=>K});var Q=B(93126),W=B(96002),h=B(9654),K=function(){function k(){}return k._longitudeToX=function(A){return W.UU.meters*A},k._latitudeToY=function(A){return W.UU.meters/2*Math.log((1+Math.sin(A))/(1-Math.sin(A)))},k._xToLongitude=function(A){return A/W.UU.meters},k._yToLatitude=function(A){return Math.PI/2-2*Math.atan(Math.exp(-1*A/W.UU.meters))},k.prototype.geoToMap=function(A){var z=k._longitudeToX(A.longitude.radians),R=k._latitudeToY(A.latitude.radians);return new Q.E(z,R)},k.prototype.mapToGeo=function(A){var z=k._xToLongitude(A.x),R=k._yToLatitude(A.y);return h.F.fromRadians(R,z)},k}()},9606:(ct,Ye,B)=>{"use strict";B.d(Ye,{x:()=>R});var Q=B(66071),W=B(93126),h=B(19501),K=B(50042),k=B(9654),A=B(4225),z=B(68575),R=function(){function C(){}return Object.defineProperty(C,"extent",{get:function(){return C._extent},enumerable:!0,configurable:!0}),Object.defineProperty(C,"halfExtent",{get:function(){return C._halfExtent},enumerable:!0,configurable:!0}),Object.defineProperty(C,"projection",{get:function(){return C._projection},enumerable:!0,configurable:!0}),C.clip=function(x,v,m){return Math.min(Math.max(x,v),m)},C.deriveMapSize=function(x){var v=256*Math.pow(2,x),m=new h.$(v,v);return m},C.deriveTiles=function(x,v,m,T,I){m===void 0&&(m=256),T===void 0&&(T=!0);var F,q;Math.abs(x.east.degrees-x.west.degrees)>360&&(F=180,q=-180),x.normalize(),F&&q&&(x.east.degrees=F,x.west.degrees=q);var re=[],ne=[],se=Math.floor(v),X=m>0?(0,Q.oY)(m/256,2):0,ce=Math.pow(2,se-X),Me=ce-1,Be=[],ot=x.west.degrees>=x.east.degrees;if(ot){var Ue=C._lastLeftWorld;Ue.north.radians=x.north.radians,Ue.west.radians=x.west.radians,Ue.south.radians=x.south.radians,Ue.east.degrees=180,Be.push(Ue);var ht=C._lastRightWorld;ht.north.radians=x.north.radians,ht.west.degrees=-180,ht.south.radians=x.south.radians,ht.east.radians=x.east.radians,Be.push(ht)}else Be.push(x);for(var Et=0,bi=Be.length;Et<bi;Et++)for(var gt=Be[Et],Qe=C.convertGeoToPixel(gt.topLeftGeoPoint,se,C._lastTopLeftPixelPoint),we=C.convertGeoToPixel(gt.bottomRightGeoPoint,se,C._lastBottomRightPixelPoint),Ae=Math.max(Math.floor(Qe.x/m),0),it=Math.min(Math.floor(we.x/m),Me),Lt=Math.max(Math.floor(Qe.y/m),0),ei=Math.min(Math.floor(we.y/m),Me),Si=Ae;Si<=it;){for(var ui=Lt;ui<=ei;){var ni=T?Me-ui:ui,Bi=se+"_"+Si+"_"+ni;if(ne.indexOf(Bi)===-1){var Ci=I?I(se,Si,ni,T,m):new z.n(se,Si,ni,T,m);re.push(Ci),ne.push(Bi)}ui++}Si++}return re},C.deriveScale=function(x,v){return v===void 0&&(v=256),v*Math.pow(2,x)/C.extent},C.deriveZoomLevel=function(x,v){return v===void 0&&(v=256),Math.ceil((0,Q.oY)(x*C.extent,2)-(0,Q.oY)(v,2))},C.deriveZoomLevelExact=function(x,v){return v===void 0&&(v=256),(0,Q.oY)(x*C.extent,2)-(0,Q.oY)(v,2)},C.deriveMapWidth=function(x,v){return v===void 0&&(v=256),v*Math.pow(2,x)},C.deriveGroundResolution=function(x,v){var x=C.clip(x,C.MinLatitude,C.MaxLatitude);return Math.cos(x*Math.PI/180)*2*Math.PI*C.EarthRadius/C.deriveMapWidth(v)},C.deriveScaleExact=function(x,v,m){return C.deriveGroundResolution(x,v)*m/.0254},C.deriveNativeZoomLevel=function(x,v){var m=(v.north.radians-v.south.radians)/Math.PI,T=v.east.degrees-v.west.degrees,I=(T<0?T+360:T)/360,F=Math.log(x.height/256/m)/Math.LN2,q=Math.log(x.width/256/I)/Math.LN2;return(F+q)/2},C.convertGeoToPixel=function(x,v,m){return C.convertLatLngToPixel(x.latitude,x.longitude,v,m)},C.convertLatLngToPixel=function(x,v,m,T){var I=C.deriveMapWidth(m),F=(v.degrees+180)/360*I,q=Math.sin(x.radians),re=(.5-Math.log((1+q)/(1-q))/(4*Math.PI))*I;return T?(T.x=F,T.y=re):T=new W.E(F,re),T},C.convertPixelToGeo=function(x,v,m){var T=C.deriveMapWidth(v),I=x.x/T-.5,F=.5-x.y/T,q=Math.PI/2-2*Math.atan(Math.exp(-F*2*Math.PI)),re=2*Math.PI*I;return m?(m.latitude.radians=q,m.longitude.radians=re):m=k.F.fromRadians(q,re),m},C.convertPixelToTile=function(x,v,m,T){m===void 0&&(m=256);var I=v,F=m>0?(0,Q.oY)(m/256,2):0,q=Math.pow(2,v-F),re=Math.floor(x.x/m%q),ne=Math.abs(Math.floor(x.y/m%(q*2)));return re<0&&(re=q+re),ne>=q&&(ne=2*q-ne-1),T?(T.x=re,T.y=ne,T.z=v||T.z):T=new z.n(I,re,ne),T},C.convertTileToPixel=function(x,v,m){v===void 0&&(v=256);var T=x.x*v,I=x.y*v;return m?(m.x=T,m.y=I):m=new W.E(T,I),m},C.convertQuadKeyToTile=function(x,v,m){v===void 0&&(v=!1);var T=x.length;m?(m.x=m.y=0,m.z=T):m=new z.n(T,0,0),m.x=m.y=0;for(var I=T;I>0;I--){var F=1<<I-1;switch(x[T-I]){case"0":break;case"1":m.x|=F;break;case"2":m.y|=F;break;case"3":m.x|=F,m.y|=F;break;default:throw new Error("ArgumentException: Invalid QuadKey digit sequence.")}}if(v){var q=Math.pow(2,T);m.y=q-m.y-1}return m},C.convertTileToQuadkey=function(x){var v="",m=x.z,T=x.x,I=x.y;if(x.isTms){var F=Math.pow(2,m);I=F-x.y-1}for(var q=m;q>0;q--){var re=48,ne=1<<q-1;(T&ne)!=0&&re++,(I&ne)!=0&&(re++,re++);var se=String.fromCharCode(re);v+=se}return v},C.convertGeoToTile=function(x,v,m,T){m===void 0&&(m=256);var I=C.convertGeoToPixel(x,v,C._lastScreenPoint),F=m>0?(0,Q.oY)(m/256,2):0,q=Math.pow(2,v-F),re=Math.floor(I.x/m),ne=q-Math.floor(I.y/m)-1;return T?(T.x=re,T.y=ne,T.z=v||T.z):T=new z.n(v,re,ne),T},C.convertTileToGeo=function(x,v,m){v===void 0&&(v=256);var T=x.z,I=v>0?(0,Q.oY)(v/256,2):0,F=Math.pow(2,T-I),q=v*x.x,re=v*(x.isTms?F-x.y-1:x.y),ne=q+v,se=re+v,X=C._lastBottomLeftPixel;X.x=q,X.y=se;var ce=C._lastTopRightPixel;ce.x=ne,ce.y=re;var Me=C.convertPixelToGeo(X,T,C._lastBottomLeftGeo),Be=C.convertPixelToGeo(ce,T,C._lastTopRightGeo);return m||(m=new K.c),m.north.radians=Be.latitude.radians,m.west.radians=Me.longitude.radians,m.south.radians=Me.latitude.radians,m.east.radians=Be.longitude.radians,m},C._lastScreenPoint=new W.E(0,0),C._lastBottomLeftPixel=new W.E(0,0),C._lastTopRightPixel=new W.E(0,0),C._lastBottomLeftGeo=k.F.fromRadians(0,0),C._lastTopRightGeo=k.F.fromRadians(0,0),C._lastLeftWorld=new K.c,C._lastRightWorld=new K.c,C._lastTopLeftPixelPoint=new W.E(0,0),C._lastBottomRightPixelPoint=new W.E(0,0),C._projection=new A._,C._extent=C.projection.geoToMap(k.F.fromRadians(0,Math.PI)).x-C.projection.geoToMap(k.F.fromRadians(0,-Math.PI)).x,C._halfExtent=C._extent/2,C.EarthRadius=6378137,C.MinLatitude=-85.05112878,C.MaxLatitude=85.05112878,C.MinLongitude=-180,C.MaxLongitude=180,C}()},1068:(ct,Ye,B)=>{"use strict";B.d(Ye,{P:()=>k});var Q=B(9506),W=B(22045),h=B(50042),K=function(){function A(){this._geoBoundingBox=new h.c,this._elements=[]}return Object.defineProperty(A.prototype,"east",{get:function(){return this._geoBoundingBox.east},set:function(z){this._geoBoundingBox.east=z},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"north",{get:function(){return this._geoBoundingBox.north},set:function(z){this._geoBoundingBox.north=z},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"south",{get:function(){return this._geoBoundingBox.south},set:function(z){this._geoBoundingBox.south=z},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"west",{get:function(){return this._geoBoundingBox.west},set:function(z){this._geoBoundingBox.west=z},enumerable:!0,configurable:!0}),A.prototype._siftDown=function(){var z=this._elements;this._elements=[];for(var R=z.length,C=0;C<R;C++){var x=z[C];this.insert(x)}},A.prototype._collect=function(z,R){var C=this._elements.length;if(z.containsBounds(this._geoBoundingBox))for(var x=0;x<C;x++){var v=this._elements[x];R.push(v)}else for(var x=0;x<C;x++){var v=this._elements[x],m=v,T=m.bounds;z.intersects(T)&&R.push(v)}},A.prototype.checkCollision=function(z){for(var R=z,C=R.bounds,x=this._elements.length,v=0;v<x;v++){var m=this._elements[v];if(m.bounds.intersects(C))return!0}return!!(this._topLeft!=null&&this._topLeft._geoBoundingBox.intersects(C)&&this._topLeft.checkCollision(z)||this._topRight!=null&&this._topRight._geoBoundingBox.intersects(C)&&this._topRight.checkCollision(z)||this._bottomLeft!=null&&this._bottomLeft._geoBoundingBox.intersects(C)&&this._bottomLeft.checkCollision(z)||this._bottomRight!=null&&this._bottomRight._geoBoundingBox.intersects(C)&&this._bottomRight.checkCollision(z))},A.prototype.insert=function(z){var R=this._elements.length>25&&this._geoBoundingBox.width.degrees>.1&&this._geoBoundingBox.height.degrees>.1,C=z,x=C.bounds;if(this._topLeft!=null&&this._topLeft._geoBoundingBox.containsBounds(x))this._topLeft.insert(z);else if(this._topRight!=null&&this._topRight._geoBoundingBox.containsBounds(x))this._topRight.insert(z);else if(this._bottomLeft!=null&&this._bottomLeft._geoBoundingBox.containsBounds(x))this._bottomLeft.insert(z);else if(this._bottomRight!=null&&this._bottomRight._geoBoundingBox.containsBounds(x))this._bottomRight.insert(z);else if(R){var v=this._geoBoundingBox.topLeftQuadrant,m=this._geoBoundingBox.topRightQuadrant,T=this._geoBoundingBox.bottomLeftQuadrant,I=this._geoBoundingBox.bottomRightQuadrant;v.containsBounds(x)?(this._topLeft=new A,this._topLeft._geoBoundingBox.north=v.north,this._topLeft._geoBoundingBox.west=v.west,this._topLeft._geoBoundingBox.south=v.south,this._topLeft._geoBoundingBox.east=v.east,this._topLeft.insert(z),this._siftDown()):m.containsBounds(x)?(this._topRight=new A,this._topRight._geoBoundingBox.north=m.north,this._topRight._geoBoundingBox.west=m.west,this._topRight._geoBoundingBox.south=m.south,this._topRight._geoBoundingBox.east=m.east,this._topRight.insert(z),this._siftDown()):T.containsBounds(x)?(this._bottomLeft=new A,this._bottomLeft._geoBoundingBox.north=T.north,this._bottomLeft._geoBoundingBox.west=T.west,this._bottomLeft._geoBoundingBox.south=T.south,this._bottomLeft._geoBoundingBox.east=T.east,this._bottomLeft.insert(z),this._siftDown()):I.containsBounds(x)?(this._bottomRight=new A,this._bottomRight._geoBoundingBox.north=I.north,this._bottomRight._geoBoundingBox.west=I.west,this._bottomRight._geoBoundingBox.south=I.south,this._bottomRight._geoBoundingBox.east=I.east,this._bottomRight.insert(z),this._siftDown()):this._elements.push(z)}else this._elements.push(z)},A.prototype.insertNoCollision=function(z){var R=!1;return this.checkCollision(z)||(this.insert(z),R=!0),R},A.prototype.retrieve=function(z,R){this._collect(z,R),this._topLeft!=null&&this._topLeft._geoBoundingBox.intersects(z)&&this._topLeft.retrieve(z,R),this._topRight!=null&&this._topRight._geoBoundingBox.intersects(z)&&this._topRight.retrieve(z,R),this._bottomLeft!=null&&this._bottomLeft._geoBoundingBox.intersects(z)&&this._bottomLeft.retrieve(z,R),this._bottomRight!=null&&this._bottomRight._geoBoundingBox.intersects(z)&&this._bottomRight.retrieve(z,R)},A}(),k=function(){function A(){this._root=new K;var z=Q.K.fromDegrees(90);this._root.north=z;var R=W.o.fromDegrees(-180);this._root.west=R;var C=W.o.fromDegrees(180);this._root.east=C;var x=Q.K.fromDegrees(-90);this._root.south=x}return A.prototype.insert=function(z){this._root.insert(z)},A.prototype.insertNoCollision=function(z){return this._root.insertNoCollision(z)},A.prototype.retrieve=function(z,R){this._root.retrieve(z,R)},A}()},9099:(ct,Ye,B)=>{"use strict";B.d(Ye,{n:()=>W});var Q=B(1068),W=function(){function h(){this._length=0,this._quadTree=new Q.P,this._filters=[]}return Object.defineProperty(h.prototype,"length",{get:function(){return this._length},set:function(K){this._length=K},enumerable:!0,configurable:!0}),h.prototype.addFilter=function(K){this._filters.push(K)},h.prototype.clearFilters=function(){this._filters=[]},h.prototype.insert=function(K){this._length++,this._quadTree.insert(K)},h.prototype.removeFilter=function(K){var k=this._filters.indexOf(K);this._filters.splice(k,1)},h.prototype.retrieve=function(K){var k=[];this._quadTree.retrieve(K,k);for(var A=this._filters.length,z=0;z<A;z++){var R=this._filters[z];k=R.filter(k)}return k},h}()},68575:(ct,Ye,B)=>{"use strict";B.d(Ye,{n:()=>K});var Q=function(){function k(A){this._bottomLeft=null,this._bottomRight=null,this._topLeft=null,this._topRight=null;var z=A.z+1,R=A.x*2,C=A.y*2;this._bottomLeft=new K(z,R,C),this._topRight=new K(z,R+1,C+1),this._topLeft=new K(z,R,C+1),this._bottomRight=new K(z,R+1,C)}return Object.defineProperty(k.prototype,"bottomLeft",{get:function(){return this._bottomLeft},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"bottomRight",{get:function(){return this._bottomRight},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"topLeft",{get:function(){return this._topLeft},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"topRight",{get:function(){return this._topRight},enumerable:!0,configurable:!0}),k}(),W=B(9606),h=B(96002),K=function(){function k(A,z,R,C,x){C===void 0&&(C=!0),x===void 0&&(x=256),this._children=null,this.z=A,this.x=z,this.y=R,this.isTms=C,this._dimension=x}return Object.defineProperty(k,"world",{get:function(){return k._world},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"children",{get:function(){return this._children===null&&(this._children=new Q(this)),this._children},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"bounds",{get:function(){return this._bounds||(this._bounds=W.x.convertTileToGeo(this,this._dimension)),this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"dimension",{get:function(){return this._dimension},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"parent",{get:function(){return this.z!=0?new k(this.z-1,this.x>>1,this.y>>1):null},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"isTms",{get:function(){return this._isTms},set:function(A){this._isTms=A,this._bounds=void 0},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"x",{get:function(){return this._x},set:function(A){this._x=A,this._children=null,this._bounds=null},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"y",{get:function(){return this._y},set:function(A){this._y=A,this._children=null,this._bounds=null},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"z",{get:function(){return this._z},set:function(A){this._z=A,this._children=null,this._bounds=null},enumerable:!0,configurable:!0}),k.convertToWmts=function(A){if(A.isTms){var z=Math.pow(2,A.z);return A.y=z-A.y-1,A}else return A},k.convertToTms=function(A){if(A.isTms)return A;var z=Math.pow(2,A.z);return A.y=z-A.y-1,A},k.fromGeoPoint=function(A,z){if(A.latitude.isGreaterThan(h.y_)||A.latitude.isLessThan(h.AC))throw new Error("ArgumentOutOfBoundsException: Mercator tile latitudes are constrained between "+h.AC.degrees+" and "+h.y_.degrees);var R=Math.pow(2,z),C=Math.floor((A.longitude.degrees+180)/360*R),x=Math.floor((1-Math.log(Math.tan(A.latitude.radians)+1/Math.cos(A.latitude.radians))/Math.PI)/2*R);C=Math.min(R-1,Math.max(0,C)),x=Math.min(R-1,Math.max(0,x));var v=new k(z,C,x);return v},k.prototype.toString=function(){return[this.z,this.x,this.y].join()},k._world=new k(0,0,0),k}()},96002:(ct,Ye,B)=>{"use strict";B.d(Ye,{UU:()=>m,rm:()=>ne,y_:()=>ce,AC:()=>Be,h8:()=>ht,Nr:()=>Et,uY:()=>bi});var Q=B(58326),W=B(9654),h=B(22236),K=B(9506),k=B(22045),A=null,z=null,R=null,C=null,x=Math.PI/2,v=h.r.fromMeters(6371009),m=h.r.fromMeters(6378137),T=h.r.fromMeters(63567523142e-4),I=T.meters/m.meters,F=Math.sqrt(1-I*I),q=.5*F,re=h.r.fromMeters(6378137),ne=6.28318531,se=360,X=Math.PI/180,ce=K.K.fromDegrees(85.05112878),Me=k.o.fromDegrees(180),Be=K.K.fromDegrees(-85.05112878),ot=k.o.fromDegrees(-180),Ue=180/Math.PI;function ht(gt,Qe){Qe===void 0&&(Qe=180);var we=[];if(gt.length===0)return[];if(gt.length===1){var Ae=W.F.fromDegrees(gt[0].latitude.degrees,gt[0].longitude.degrees);return we.push(Ae),we}Qe>180&&(Qe=180);var it=!1,Lt=gt[0].longitude.degrees,ei=!1,Si=0;we[0]=W.F.fromRadians(gt[0].latitude.radians,gt[0].longitude.radians);for(var ui=1,ni=gt.length;ui<ni;++ui){var Bi=W.F.fromRadians(gt[ui].latitude.radians,gt[ui].longitude.radians);we[ui]=Bi;var Ci=Bi.longitude;Ci.normalize();var xt=Ci.degrees,ze=xt-Lt;ei?Math.abs(ze)>Qe&&(Si=0):Math.abs(ze)>Qe&&(Si=ze<0?360:-360),Si!=0?(Bi.longitude=k.o.fromDegrees(xt+Si),we[ui]=Bi,ei=!0,it=!0):ei=!1,Lt=xt}if(it){for(var oe=we[0].longitude.degrees,de=oe,ui=1,ni=we.length;ui<ni;ui++){var Bi=we[ui],Re=Bi.longitude.degrees;Re<oe?oe=Re:Re>de&&(de=Re)}var He=oe+(de-oe)/2,mt=0;if(He>Qe&&(mt=-360),He<-Qe&&(mt=360),mt!=0)for(var ui=0,ni=we.length;ui<ni;ui++){var Bi=we[ui];Bi.longitude=k.o.fromDegrees(Bi.longitude.degrees+mt),we[ui]=Bi}return we}else return null}function Et(gt,Qe,we){var Ae=gt.longitude.radians,it=gt.latitude.radians,Lt=Qe.radians,ei=we.meters/re.meters,Si=Math.sin(it),ui=Math.cos(it),ni=Math.sin(ei),Bi=Math.cos(ei),Ci=Math.asin(Si*Bi+ui*ni*Math.cos(Lt)),xt=Ae+Math.atan2(Math.sin(Lt)*ni*ui,Bi-Si*Math.sin(Ci));return W.F.fromRadians(Ci,xt)}function bi(gt,Qe,we){Qe===void 0&&(Qe=new Q.R),we===void 0&&(we=new Q.R);var Ae=Array.isArray(gt)&&Array.isArray(gt[0]);if(Ae){for(var it=[],Lt=gt,ei=0,Si=Lt.length;ei<Si;ei++){for(var ui=Lt[ei],ni=[],Bi=0,Ci=ui.length;Bi<Ci;Bi++){var xt=ui[Bi],ze=xt.latitude.addAngle(Qe),oe=xt.longitude.addAngle(we),xt=new W.F(ze,oe);ni.push(xt)}it.push(ni)}return it}else{for(var de=[],ui=gt,ei=0,Ci=ui.length;ei<Ci;ei++){var xt=ui[ei],ze=xt.latitude.addAngle(Qe),oe=xt.longitude.addAngle(we),xt=new W.F(ze,oe);de.push(xt)}return de}}},35992:(ct,Ye,B)=>{"use strict";B.d(Ye,{M:()=>A,m:()=>z});var Q=B(84922),W=B.n(Q),h=B(66071),K=B(28360),k=B(69011),A=function(){function R(C){C===void 0&&(C={}),this.bounds=void 0,this.id=void 0,this.maximumZoom=void 0,this.meta={},this.minimumZoom=void 0,this.opacity=void 0,(0,h.f0)(this,C)}return R}(),z=function(){function R(C){this._loadState=h.jd.Unloaded,this._mapboxGroup=[],this.loaded=new K.j,this.loading=new K.j,this.unloaded=new K.j,this.updated=new K.j,this.opacityChanged=new K.j,C=C instanceof A?C:new A(C),arguments.length>1?(this._map=arguments[0],this._options=arguments[1]instanceof A?arguments[1]:new A(arguments[1])):this._options=C,C=this._options,this._opacity=C.opacity!==void 0?C.opacity:1,this._minimumZoom=C.minimumZoom||0,this._maximumZoom=C.maximumZoom||21,this._id=C.id||(0,h.cm)(),this._bounds=C.bounds,this._meta=C.meta||{}}return R.prototype._getZIndex=function(){return this._zIndex},R.prototype._setZIndex=function(C){switch(this._zIndex=C,this.map.renderer){case k.Renderer.WebDOM:this._leafletPane.style.zIndex=C;break;case k.Renderer.WebGL:this._loadMapboxGroup();break}},Object.defineProperty(R.prototype,"opacity",{get:function(){return this._opacity},set:function(C){this._changeOpacity(C)},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"id",{get:function(){return this._id},set:function(C){this._id=C},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"loadState",{get:function(){return this._loadState},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"minimumZoom",{get:function(){return this._minimumZoom},set:function(C){this._minimumZoom=C},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"maximumZoom",{get:function(){return this._maximumZoom},set:function(C){this._maximumZoom=C},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"meta",{get:function(){return this._meta},enumerable:!0,configurable:!0}),R.prototype._addToMap=function(C,x){x===void 0&&(x=!1),this._map=C,this._load(x)},R.prototype._removeFromMap=function(C,x){x===void 0&&(x=!1),this._unload(x),this._changeLoadState(h.jd.Unloaded),this._map=void 0},R.prototype._changeLoadState=function(C){if(this._loadState!=C)switch(this._loadState=C,C){case h.jd.Unloaded:this.unloaded.trigger();break;case h.jd.Loading:this.loading.trigger();break;case h.jd.Loaded:this.loaded.trigger();break}},R.prototype._changeOpacity=function(C){var x=this._opacity;x!=C&&(this._opacity=C,this.opacityChanged.trigger({old:x,new:C}))},R.prototype.update=function(){},R.prototype._loadLeafletPane=function(){var C=this.map.engine.createPane(this.id);C.style["pointer-events"]="none",C.style.background="none !important",C.style.filter="Alpha(opacity=0)",this._leafletPane=C},R.prototype._loadMapboxGroup=function(){var C=this._zIndex;if(C!=null){var x=this.map._mapboxEngine,v=this.map,m=v._deriveBeforeId(C),T=W().layerGroups.getGroupFirstLayerIndex(x,this.id)>=0;if(T){var I=W().layerGroups.getGroupFirstLayer(x,this.id);m!=I&&W().layerGroups.moveGroup(x,this.id,m)}else W().layerGroups.addGroup(x,this.id,this._mapboxGroup,m)}},R.prototype._unloadMapboxGroup=function(){W().layerGroups.removeGroup(this.map._mapboxEngine,this.id)},R}()},66017:(ct,Ye,B)=>{"use strict";B.d(Ye,{Y:()=>h});var Q=B(28360),W=B(66071),h=function(){function K(k,A){if(A===void 0&&(A={}),this._colors=[],this.changed=new Q.j,!k)throw new Error("NullArgumentException");if(k.length<=0)throw new Error("InvalidArgumentException: at least one color step required");this._colors=k,this._colors.sort(function(z,R){return z.step-R.step}),this._id=A.id!==void 0?A.id:(0,W.cm)(),this._precision=A.precision!==void 0?A.precision:0,this._extendMaximumColor=A.extendMaximumColor!==void 0?A.extendMaximumColor:!1,this._extendMinimumColor=A.extendMinimumColor!==void 0?A.extendMinimumColor:!1,this._isInterpolated=A.isInterpolated!==void 0?A.isInterpolated:!1,this._hash=K._createHash(this._colors,this._isInterpolated,this._precision)}return Object.defineProperty(K.prototype,"gl",{get:function(){return this._gl},set:function(k){k!==this._gl?(this._gl=k,this._clearTexture(),this._rasterize()):(0,W.le)(k)&&this._clearTexture()},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"texture",{get:function(){return this._texture},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"id",{get:function(){return this._id},set:function(k){this._id=k},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"colors",{get:function(){return this._colors},set:function(k){if(k.length>0)this._colors=k,this._steps=void 0,this._colors.sort(function(A,z){return A.step-z.step}),this._hash=K._createHash(this._colors,this._isInterpolated,this._precision),this._rasterize(),this.changed.trigger();else throw new Error("InvalidArgumentException: at least one color step required")},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"extendMinimumColor",{get:function(){return this._extendMinimumColor},set:function(k){this._extendMinimumColor!==k&&(this._extendMinimumColor=k,this.changed.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"extendMaximumColor",{get:function(){return this._extendMaximumColor},set:function(k){this._extendMaximumColor!==k&&(this._extendMaximumColor=k,this.changed.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"isInterpolated",{get:function(){return this._isInterpolated},set:function(k){this._isInterpolated!==k&&(this._isInterpolated=k,this._hash=K._createHash(this._colors,this._isInterpolated,this._precision),this._rasterize(),this.changed.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"precision",{get:function(){return this._precision},set:function(k){this._precision!==k&&(this._precision=k,this._steps=void 0,this._hash=K._createHash(this._colors,this._isInterpolated,this._precision),this._rasterize(),this.changed.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(K.prototype,"steps",{get:function(){if(!this._steps){var k=this._colors,A=k[0].step,z=k.length,R=k[z-1].step,C=(Math.ceil(R)-Math.floor(A))*Math.pow(10,this._precision),x=1024*Math.pow(2,Math.floor(C/1024));x=Math.min(x,8192),this._steps=x}return this._steps},enumerable:!0,configurable:!0}),K._createHash=function(k,A,z){var R=Math.pow(10,z),C=Math.ceil(k[0].step*R),x=Math.floor(k[k.length-1].step*R),v=(x-C)*4,m=new DataView(new ArrayBuffer(v+4)),T=0,I=0,F=k[I];if(k.length===1){var q=Math.floor(F.rgba[0]),re=Math.floor(F.rgba[1]),ne=Math.floor(F.rgba[2]),se=Math.floor(F.rgba[3]);m.setUint8(T,q),m.setUint8(T+1,re),m.setUint8(T+2,ne),m.setUint8(T+3,se)}else{for(var X=k[I+1],ce=(F.step-X.step)*R*4,Me=F.rgba[0]-X.rgba[0],Be=F.rgba[1]-X.rgba[1],ot=F.rgba[2]-X.rgba[2],Ue=F.rgba[3]-X.rgba[3],q=void 0,re=void 0,ne=void 0,se=void 0;T<v;){for(;T>=Math.ceil(X.step*R-C)*4;)I++,F=k[I],X=k[I+1],ce=Math.floor((F.step-X.step)*R)*4,Me=F.rgba[0]-X.rgba[0],Be=F.rgba[1]-X.rgba[1],ot=F.rgba[2]-X.rgba[2],Ue=F.rgba[3]-X.rgba[3];var ht=(Math.floor(F.step*R)-C)*4;if(q=Math.floor(F.rgba[0]),re=Math.floor(F.rgba[1]),ne=Math.floor(F.rgba[2]),se=Math.floor(F.rgba[3]),A){var Et=T-ht,bi=Et/ce,gt=bi*Me,Qe=bi*Be,we=bi*ot,Ae=bi*Ue;q=Math.floor(q+gt),re=Math.floor(re+Qe),ne=Math.floor(ne+we),se=Math.floor(se+Ae),m.setUint8(T++,q),m.setUint8(T++,re),m.setUint8(T++,ne),m.setUint8(T++,se)}else m.setUint8(T++,q),m.setUint8(T++,re),m.setUint8(T++,ne),m.setUint8(T++,se)}q=Math.floor(X.rgba[0]),re=Math.floor(X.rgba[1]),ne=Math.floor(X.rgba[2]),se=Math.floor(X.rgba[3]),m.setUint8(T++,q),m.setUint8(T++,re),m.setUint8(T++,ne),m.setUint8(T++,se)}return m},K.prototype._clamp=function(k,A,z){return k<A?A:k>z?z:k},K.prototype._normalize=function(k,A,z){var R=this._clamp(k,A,z);return(R-A)/(z-A)},K.prototype._interpolate=function(k,A,z){return k*(1-z)+A*z},K.prototype._loadTexture=function(k){var A=this._gl,z=A.createTexture();return A.bindTexture(A.TEXTURE_2D,z),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,A.LINEAR),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),A.texImage2D(A.TEXTURE_2D,0,A.RGBA,A.RGBA,A.UNSIGNED_BYTE,k),z},K.prototype._rasterize=function(){var k=this._gl;if(!!k){var A=this._colors,z=A[0].step,R=A.length,C=A[R-1].step,x=Math.ceil(C-z)*(this._precision+1),v=1024*Math.pow(2,Math.floor(x/1024));v=Math.min(v,8192),this._steps=v;var m=document.createElement("canvas");m.width=v,m.height=1;for(var T=m.getContext("2d"),I=T.createLinearGradient(0,0,v,0),F,q,re,ne,se,X=A[0],ce=0,Me=1;ce!=A.length-1;ce++,Me++){se=A[ce],X=A[Me];var Be=this._normalize(se.step,z,C),ot=this._normalize(X.step,z,C);F=se.rgba[0],q=se.rgba[1],re=se.rgba[2],ne=se.rgba[3],I.addColorStop(Be,"rgba("+F+","+q+","+re+","+ne/255+")"),this._isInterpolated||I.addColorStop(ot,"rgba("+F+","+q+","+re+","+ne/255+")")}F=X.rgba[0],q=X.rgba[1],re=X.rgba[2],ne=X.rgba[3],I.addColorStop(1,"rgba("+F+","+q+","+re+","+ne/255+")"),T.fillStyle=I,T.fillRect(0,0,v,1);var Ue=this._loadTexture(m);return this._texture=Ue,Ue}},K.prototype._clearTexture=function(){this._texture=void 0},K.prototype.apply=function(k){var A=Math.pow(10,this._precision),z=this._colors[0],R=(Math.floor(k*A)-Math.ceil(z.step*A))*4,C=this._hash,x;if(R>=0&&R<C.byteLength){var v=C.getUint8(R),m=C.getUint8(R+1),T=C.getUint8(R+2),I=C.getUint8(R+3);x=[v,m,T,I]}if(!x){if((0,W.le)(k)||isNaN(k))return K.invisible;var F=this._colors,z=F[0],q=F[F.length-1];this._extendMinimumColor&&R<0?x=z.rgba:this._extendMaximumColor&&R>=C.byteLength?x=q.rgba:x=K.invisible}return x},K.invisible=[0,0,0,0],K}()},55117:(ct,Ye,B)=>{"use strict";B.d(Ye,{l:()=>h});var Q=B(72503),W=B(5860),h=function(){function K(){this._modelRuns=[],this._validTimes=[]}return K.prototype._deriveModelRun=function(){var k=this._modelRuns,A=null;return k&&k.length>0&&(this._providedModelRun&&this._validateModelRun(this._providedModelRun)?A=this._providedModelRun:(this._providedModelRun=void 0,A=this._modelRuns.length>1?this._modelRuns[1]:k[0])),A},K.prototype._deriveValidTime=function(k,A){for(var z=A?A.validTimes:this._validTimes,R=Q.i.max,C=null,x=0,v=z.length;x<v;++x){var m=z[x],T=Q.i.fromDates(m.value,k,!0);T.totalMilliseconds<R.totalMilliseconds&&this._validateValidTime(m,k)&&(R=T,C=m)}return C},K.prototype._deriveValidTimes=function(){var k=this._deriveModelRun(),A=k!=null?k.validTimes:this._validTimes;return A},K.prototype._deriveDiscreteTime=function(k){var A=this._deriveModelRun(),z=this._deriveValidTime(k,A),R=new W.d(A,z);return R},K.prototype._validateModelRun=function(k){for(var A=!1,z=this._modelRuns,R=0,C=z.length;R<C;R++){var x=z[R];if(x.toString()===k.toString()){A=!0;break}}return A},K.prototype._validateValidTime=function(k,A){var z=k.value.getTime(),R=z-this._validBackward.totalMilliseconds,C=z+this._validForward.totalMilliseconds,x=A.getTime(),v=this._timeRange.intersects(R,C),m=x>=R&&x<=C&&v;return m},K.prototype._unload=function(){this._validTimes=[],this._modelRuns=[],this._currentDiscreteTime=void 0},K}()},74776:(ct,Ye,B)=>{"use strict";B.d(Ye,{Yh:()=>Q,qC:()=>W,TW:()=>h,yn:()=>K,JH:()=>k});var Q;(function(x){x[x.SpeedData=0]="SpeedData",x[x.DirectionData=1]="DirectionData",x[x.PaletteData=2]="PaletteData"})(Q||(Q={}));var W;(function(x){x[x.MetersPerSecond=0]="MetersPerSecond",x[x.CentimetersPerSecond=1]="CentimetersPerSecond",x[x.FeetPerSecond=2]="FeetPerSecond",x[x.KilometersPerHour=3]="KilometersPerHour",x[x.MilesPerHour=4]="MilesPerHour",x[x.Knots=5]="Knots"})(W||(W={}));var h;(function(x){x[x.Radians=0]="Radians",x[x.Degrees=1]="Degrees"})(h||(h={}));var K;(function(x){x[x.None=0]="None",x[x.Land=1]="Land",x[x.Water=2]="Water"})(K||(K={}));var k;(function(x){x[x.Immediate=0]="Immediate",x[x.Retain=1]="Retain"})(k||(k={}));var A;(function(x){x[x.Overlays=0]="Overlays",x[x.Canvas=1]="Canvas"})(A||(A={}));var z=null,R=null,C=null},83009:(ct,Ye,B)=>{"use strict";B.d(Ye,{g:()=>h});var Q=B(96302),W=B.n(Q),h=function(){function K(k){this._leafletPane=k,this._layerAdd=this.onAdd,this._layerRemove=this.onRemove,this._canvas=W().DomUtil.create("canvas","leaflet-zoom-hide"),this._canvas.style.top="-1px",this._canvas.style.left="-1px",this.canvas.style.position="absolute"}return Object.defineProperty(K.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),K.prototype.setZIndex=function(k){this.canvas.style.zIndex=k.toString()},K.prototype._reset=function(){var k=W().DomUtil.getPosition(this._map.getPanes().mapPane);if(k){var A=new(W()).Point(-k.x,-k.y);W().DomUtil.setPosition(this._canvas,A)}},K.prototype.addEventListener=function(){},K.prototype.addOneTimeEventListener=function(){},K.prototype.removeEventListener=function(){},K.prototype.hasEventListeners=function(k){return!1},K.prototype.fireEvent=function(){},K.prototype.clearAllEventListeners=function(){},K.prototype.on=function(){},K.prototype.once=function(){},K.prototype.off=function(){},K.prototype.fire=function(){},K.prototype.onAdd=function(k){var A=k.target;this._map=A;var z=this._leafletPane||A.getPanes().overlayPane;z.appendChild(this.canvas),A.on("move",this._reset,this),A.on("viewreset",this._reset,this),this._reset()},K.prototype.onRemove=function(k){var A=this._map,z=this._leafletPane||A.getPanes().overlayPane;z.removeChild(this.canvas),A.off("move",this._reset,this),A.off("viewreset",this._reset,this)},K}()},36971:(ct,Ye,B)=>{"use strict";B.d(Ye,{s:()=>k});var Q=B(36450),W=B(28360),h=B(66071),K=function(){function A(z){z===void 0&&(z={}),this.id=void 0,this.style=void 0,this.minimumZoom=void 0,this.maximumZoom=void 0,this.excludeWithChildren=void 0,(0,h.f0)(this,z)}return A}(),k=function(){function A(z,R){this.propertyChanged=new W.j,R=R instanceof K?R:new K(R),this._administrativeLevel=z,this._id=R.id!==void 0?R.id:(0,h.cm)(),this._excludeWithChildren=R.excludeWithChildren!==void 0?R.excludeWithChildren:!1,this._minimumZoom=R.minimumZoom!==void 0?R.minimumZoom:0,this._maximumZoom=R.maximumZoom!==void 0?R.maximumZoom:21,this._style=R.style||new Q.l(new Q.H({strokeWidth:.2,strokeOpacity:.5,strokeColor:"rgba(0,0,0,1)",fillColor:"rgba(255,255,255,0)",fillOpacity:1}))}return Object.defineProperty(A.prototype,"administrativeLevel",{get:function(){return this._administrativeLevel},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"style",{get:function(){return this._style},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"minimumZoom",{get:function(){return this._minimumZoom},set:function(z){this._minimumZoom!==z&&(this._minimumZoom=z,this.propertyChanged.trigger({rule:this,property:"minimumZoom",value:z}))},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"maximumZoom",{get:function(){return this._maximumZoom},set:function(z){this._maximumZoom!==z&&(this._maximumZoom=z,this.propertyChanged.trigger({rule:this,property:"maximumZoom",value:z}))},enumerable:!0,configurable:!0}),Object.defineProperty(A.prototype,"excludeWithChildren",{get:function(){return this._excludeWithChildren},set:function(z){this.excludeWithChildren!==z&&(this._excludeWithChildren=z,this.propertyChanged.trigger({rule:this,property:"excludeWithChildren",value:z}))},enumerable:!0,configurable:!0}),A}()},36450:(ct,Ye,B)=>{"use strict";B.d(Ye,{H:()=>h,l:()=>K});var Q=B(28360),W=B(66071),h=function(){function k(A){A===void 0&&(A={}),this.id=void 0,this.strokeColor=void 0,this.strokeWidth=void 0,this.strokeOpacity=void 0,this.fillInterpolated=void 0,this.fillOpacity=void 0,this.fillColor=void 0,this.fillColors=void 0,this.fillPattern=void 0,(0,W.f0)(this,A)}return k}(),K=function(){function k(A){this.propertyChanged=new Q.j,A=A instanceof h?A:new h(A),this._strokeWidth=A.strokeWidth,this._strokeOpacity=A.strokeOpacity,this._strokeColor=A.strokeColor,this._fillOpacity=A.fillOpacity,this._fillColors=A.fillColors,this._fillColor=A.fillColor,this._fillPattern=A.fillPattern,this._fillInterpolated=A.fillInterpolated,this._id=A.id!==void 0?A.id:(0,W.cm)()}return Object.defineProperty(k.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(A){this._strokeColor!==A&&(this._strokeColor=A,this.propertyChanged.trigger({style:this,property:"strokeColor",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(A){this._strokeWidth!==A&&(this._strokeWidth=A,this.propertyChanged.trigger({style:this,property:"strokeWidth",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(A){this._strokeOpacity!==A&&(this._strokeOpacity=A,this.propertyChanged.trigger({style:this,property:"strokeOpacity",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"fillInterpolated",{get:function(){return this._fillInterpolated},set:function(A){this._fillInterpolated!==A&&(this._fillInterpolated=A,this.propertyChanged.trigger({style:this,property:"fillInterpolated",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"fillColor",{get:function(){return this._fillColor},set:function(A){this._fillColor!==A&&(this._fillColor=A,this.propertyChanged.trigger({style:this,property:"fillColor",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"fillColors",{get:function(){return this._fillColors},set:function(A){this._fillColors!==A&&(this._fillColors=A,this.propertyChanged.trigger({style:this,property:"fillColors",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"fillPattern",{get:function(){return this._fillPattern},set:function(A){this._fillPattern!==A&&(this._fillPattern=A,this.propertyChanged.trigger({style:this,property:"fillPattern",value:A}))},enumerable:!0,configurable:!0}),Object.defineProperty(k.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(A){this._fillOpacity!==A&&(this._fillOpacity=A,this.propertyChanged.trigger({style:this,property:"fillOpacity",value:A}))},enumerable:!0,configurable:!0}),k}()},27098:(ct,Ye,B)=>{"use strict";B.d(Ye,{b:()=>z,C:()=>R});var Q=B(66071),W=B(69011),h=B(35992),K=B(9654),k=B(50042),A=function(){var C=function(x,v){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var I in T)T.hasOwnProperty(I)&&(m[I]=T[I])},C(x,v)};return function(x,v){C(x,v);function m(){this.constructor=x}x.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}}(),z=function(C){A(x,C);function x(v){v===void 0&&(v={});var m=C.call(this,v)||this;return m.sunApiKey=void 0,m.properties=void 0,m.target=void 0,m.worldView=void 0,m.rules=void 0,m.convert=void 0,(0,Q.f0)(m,v),m}return x}(h.M),R=function(C){A(x,C);function x(v){var m=C.call(this,v=v instanceof z?v:new z(v))||this;return m._tileSet=[],m._convert=void 0,m._properties=[],m._featureMap={},m._highlightMap={},m._options=void 0,m._boundaryAdmin0={type:"vector",tiles:["https://api.weather.com/v2/boundaries/admins/adm0-v1/{z}/{x}/{y}.pbf?apiKey={apiKey}"]},m._boundaryAdmin1={type:"vector",tiles:["https://api.weather.com/v2/boundaries/admins/adm1-v1/{z}/{x}/{y}.pbf?apiKey={apiKey}"]},m._boundaryAdmin2={type:"vector",tiles:["https://api.weather.com/v2/boundaries/admins/adm2-v1/{z}/{x}/{y}.pbf?apiKey={apiKey}"]},m._properties=v.properties,m._target=v.target,m._convert=v.convert,m._worldView=v.worldView||"IN",m._options=v,m._rules=v.rules||[],m._applyRules(),m._features={admin0:[],admin1:[],admin2:[],admin3:[],admin4:[]},m}return Object.defineProperty(x.prototype,"features",{get:function(){var v=[];for(var m in this._features)v.push.apply(v,this._features[m]);return v},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"properties",{get:function(){return this._properties},set:function(v){this._changeProperties(v)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"target",{get:function(){return this._target},set:function(v){this._changeTarget(v)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"convert",{get:function(){return this._convert},set:function(v){this._changeConvert(v)},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"worldView",{get:function(){return this._worldView},set:function(v){if(!!this.map&&v!==this._worldView){this._worldView=v;for(var m=this.map,T=0;T<this._rules.length;T++){var I=this._rules[T];I._backgroundLayer&&m.engine.setFilter(I._backgroundLayer.id,["any",["==","all",["get","worldview"]],["in",v,["get","worldview"]]]),I._foregroundLayer&&m.engine.setFilter(I._foregroundLayer.id,["any",["==","all",["get","worldview"]],["in",v,["get","worldview"]]]),I._strokeLayer&&m.engine.setFilter(I._strokeLayer.id,["any",["==","all",["get","worldview"]],["in",v,["get","worldview"]]])}}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"rules",{get:function(){return this._rules},set:function(v){this._clearRules(),this._rules=v,this._applyRules()},enumerable:!0,configurable:!0}),x.prototype._load=function(){var v=this._options.sunApiKey||this.map.sunApiKey;switch(this._boundaryAdmin0.tiles[0]=this._boundaryAdmin0.tiles[0].replace("{apiKey}",v),this._boundaryAdmin1.tiles[0]=this._boundaryAdmin1.tiles[0].replace("{apiKey}",v),this._boundaryAdmin2.tiles[0]=this._boundaryAdmin2.tiles[0].replace("{apiKey}",v),this._changeLoadState(Q.jd.Loaded),this.map.renderer){case W.Renderer.WebDOM:this._loadLeaflet();break;case W.Renderer.WebGL:this._loadMapbox();break}this._applyState()},x.prototype._unload=function(){switch(this.map.renderer){case W.Renderer.WebDOM:this._unloadLeaflet();break;case W.Renderer.WebGL:this._unloadMapbox();break}},x.prototype._constructId=function(v){return v},x.prototype._loadLeaflet=function(){throw new Error("NotSupportedException: ChoroplethLayer not currently supported by the WebDOM renderer.")},x.prototype._unloadLeaflet=function(){},x.prototype._loadMapbox=function(){this._addSources(),this.map.engine.on("sourcedata",this._onSourceData.bind(this)),this._mapboxGroup=this._createLayers()},x.prototype._appendBackgroundGroups=function(){for(var v=0,m=this._rules.length;v<m;v++){var T=this._rules[v];T.style.fillPattern&&this._mapboxGroup.unshift(this._createBackground(T))}},x.prototype._unloadMapbox=function(){this.map.engine.off("sourcedata",this._onSourceData),this._unloadMapboxGroup(),this._removeSources(),this._mapboxGroup=[],this._zIndex=void 0},x.prototype._addSources=function(){this.map.engine.addSource(this.id+"_admin0",this._boundaryAdmin0),this.map.engine.addSource(this.id+"_admin1",this._boundaryAdmin1),this.map.engine.addSource(this.id+"_admin2",this._boundaryAdmin2)},x.prototype._removeSources=function(){this.map.engine.removeSource(this.id+"_admin0"),this.map.engine.removeSource(this.id+"_admin1"),this.map.engine.removeSource(this.id+"_admin2")},x.prototype._createLayers=function(){for(var v=[!1,!1,!1,!1,!1],m=[],T=0,I=this._rules.length;T<I;T++){var F=this._rules[T];v[F.administrativeLevel]=!0,F.style.fillPattern&&(F._backgroundLayer=this._createBackground(F),m.push(F._backgroundLayer)),F._foregroundLayer=this._createForeground(F),m.push(F._foregroundLayer),F._strokeLayer=this._createStroke(F),m.push(F._strokeLayer)}for(var T=0,q=v.length;T<q;T++)if(v[T]){var re=this._createBlank(T);m.push(re)}return m},x.prototype._createBlank=function(v){return{id:this._id+"_blankAdmin"+v,type:"fill",minzoom:0,maxzoom:21,source:this._id+"_admin"+v,"source-layer":"boundaries_adm"+v,filter:["any",["==","all",["get","worldview"]],["in",this._worldView,["get","worldview"]]],paint:{"fill-opacity-transition":x.TRANSITION,"fill-color-transition":x.TRANSITION,"fill-opacity":1,"fill-color":"rgba(0,0,0,0)"}}},x.prototype._createForeground=function(v){var m;v.style.fillColors&&v.style.fillColors.length>0?m=this._createMapboxFillColors(v.style.fillColors,v.style.fillInterpolated):v.style.fillColor?m=this._createMapboxFillColor(v.style.fillColor):m="rgba(0,0,0,0)";var T=this._createMapboxFillOpacity(v.style.fillOpacity,v.excludeWithChildren),I=this._id+"_foregroundAdmin"+v.administrativeLevel+"_"+v.id;return{id:I,type:"fill",minzoom:Math.max(0,v.minimumZoom-1),maxzoom:Math.max(0,v.maximumZoom-1),source:this._id+"_admin"+v.administrativeLevel,"source-layer":"boundaries_adm"+v.administrativeLevel,filter:["any",["==","all",["get","worldview"]],["in",this._worldView,["get","worldview"]]],paint:{"fill-opacity-transition":x.TRANSITION,"fill-color-transition":x.TRANSITION,"fill-opacity":T,"fill-color":m}}},x.prototype._createBackground=function(v){var m=this._createMapboxBackgroundFillOpacity(v.style.fillOpacity);return{id:this._id+"_backgroundAdmin"+v.administrativeLevel+"_"+v.id,type:"fill",minzoom:Math.max(0,v.minimumZoom-1),maxzoom:Math.max(0,v.maximumZoom-1),source:this._id+"_admin"+v.administrativeLevel,"source-layer":"boundaries_adm"+v.administrativeLevel,filter:["all",["!",["has","dispute"]],["any",["==","all",["get","worldview"]],["in",this._worldView,["get","worldview"]]]],paint:{"fill-opacity-transition":x.TRANSITION,"fill-opacity":m,"fill-pattern":v.style.fillPattern}}},x.prototype._createStroke=function(v){var m=this._createMapboxLineColor(v.style.strokeColor),T=this._createMapboxLineWidth(v.style.strokeWidth),I=this._createMapboxLineOpacity(v.style.strokeOpacity);return{id:this._id+"_strokeAdmin"+v.administrativeLevel+"_"+v.id,type:"line",minzoom:Math.max(0,v.minimumZoom-1),maxzoom:Math.max(0,v.maximumZoom-1),source:this.id+"_admin"+v.administrativeLevel,"source-layer":"boundaries_adm"+v.administrativeLevel,filter:["any",["==","all",["get","worldview"]],["in",this._worldView,["get","worldview"]]],paint:{"line-width-transition":x.TRANSITION,"line-color-transition":x.TRANSITION,"line-opacity-transition":x.TRANSITION,"line-color":m,"line-opacity":I,"line-width":T}}},x.prototype._createMapboxFillColors=function(v,m){if(v.length===0)return"rgba(0,0,0,0)";var T;m?T=["case",["boolean",["feature-state","highlightFillColor"],!1],["feature-state","fillColor"],["interpolate",["linear"],["number",["feature-state","target"],0]]]:T=["case",["boolean",["feature-state","highlightFillColor"],!1],["feature-state","fillColor"],["step",["number",["feature-state","target"],Number.MIN_SAFE_INTEGER],["rgba",0,0,0,0]]];for(var I=0,F=v.length;I<F;I++){var q=v[I];T[3].push(q.step),T[3].push("rgba("+q.rgba[0]+","+q.rgba[1]+","+q.rgba[2]+","+q.rgba[3]+")")}return T},x.prototype._createMapboxFillColor=function(v){return v===void 0&&(v="rgba(255,255,255,0)"),["case",["boolean",["feature-state","highlightFillColor"],!1],["feature-state","fillColor"],v]},x.prototype._createMapboxFillOpacity=function(v,m){m===void 0&&(m=!1),v===void 0&&(v=1);var T=["case",["boolean",["feature-state","highlightFillOpacity"],!1],["feature-state","fillOpacity"],Math.max(0,Math.min(1,this._opacity*v))];if(m){var I=["boolean",["feature-state","children"],!1];T.splice(1,0,I,0)}return T},x.prototype._createMapboxBackgroundFillOpacity=function(v){return v===void 0&&(v=1),["case",["==",["number",["feature-state","target"],-1],-1],Math.max(0,Math.min(1,this._opacity*v)),0]},x.prototype._createMapboxLineColor=function(v){return v===void 0&&(v="rgba(0,0,0,1)"),["case",["boolean",["feature-state","highlightStrokeColor"],!1],["feature-state","strokeColor"],v]},x.prototype._createMapboxLineWidth=function(v){return v===void 0&&(v=.2),["case",["boolean",["feature-state","highlightStrokeWidth"],!1],["feature-state","strokeWidth"],v]},x.prototype._createMapboxLineOpacity=function(v){return v===void 0&&(v=.5),["case",["boolean",["feature-state","highlightStrokeOpacity"],!1],["feature-state","strokeOpacity"],Math.max(0,Math.min(1,this._opacity*v))]},x.prototype._changeTarget=function(v){this._target=v,this._clearState(),this._applyState()},x.prototype._changeConvert=function(v){this._convert=v,this._tileSet=[],this._clearState(),this._clearTally();for(var m=0,T=3;m<T;m++){var I="admin"+m,F=this._features[I];this._applyTally(F,this._properties,m)}this._applyState()},x.prototype._changeProperties=function(v){this._properties=v,this._tileSet=[],this._clearState(),this._clearTally();for(var m=0,T=3;m<T;m++){var I="admin"+m,F=this._features[I];this._applyTally(F,this._properties,m)}this._applyState()},x.prototype._changeOpacity=function(v){if(!(0,Q.le)(v)&&v!=this._opacity){var m=this._opacity;if(this._opacity=v,this.map)for(var T=this.map.engine,I=0,F=this._rules.length;I<F;I++){var q=this._rules[I],re=q.style,ne=this._createMapboxFillOpacity(re.fillOpacity,q.excludeWithChildren),se=this._createMapboxLineOpacity(re.strokeOpacity);if(q._backgroundLayer){var X=this._createMapboxBackgroundFillOpacity(re.fillOpacity);T.setPaintProperty(q._backgroundLayer.id,"fill-opacity",X)}T.setPaintProperty(q._foregroundLayer.id,"fill-opacity",ne),T.setPaintProperty(q._strokeLayer.id,"line-opacity",se)}this.opacityChanged.trigger({old:m,new:v})}},x.prototype._clearRules=function(){for(var v=0,m=this._rules.length;v<m;v++){var T=this._rules[v];T.propertyChanged.removeListener(this._onRuleChanged,this)}for(var I in this._styles){var F=this._styles[I];F.propertyChanged.removeListener(this._onStyleChanged,this)}},x.prototype._clearState=function(){if(!!this.map){var v=this.map.engine;v.removeFeatureState({source:this.id+"_admin0",sourceLayer:"boundaries_adm0"}),v.removeFeatureState({source:this.id+"_admin1",sourceLayer:"boundaries_adm1"}),v.removeFeatureState({source:this.id+"_admin2",sourceLayer:"boundaries_adm2"})}},x.prototype._clearLayers=function(){this._mapboxGroup=[]},x.prototype._applyRules=function(){for(var v={},m=0,T=this._rules.length;m<T;m++){var I=this._rules[m];I.propertyChanged.addListener(this._onRuleChanged,this),v[I.style.id]=I.style}for(var F in v){var q=v[F];q.propertyChanged.addListener(this._onStyleChanged,this)}this._styles=v},x.prototype._applyState=function(){if(!!this.map){for(var v=this.map,m=v.engine,T=this._featureMap,I=[],F=v.zoomLevel,q=0,re=this._rules.length;q<re;q++){var ne=this._rules[q];if(F>=ne.minimumZoom&&F<ne.maximumZoom){var se=ne.administrativeLevel;I.indexOf(se)===-1&&I.push(se)}}for(var X in T)for(var ce=T[X],Me=0;Me<I.length;Me++){var Be=I[Me];if(ce.level===Be){var ot={id:X,source:this._id+"_admin"+Be,sourceLayer:"boundaries_adm"+Be},Ue=m.getFeatureState(ot);if(!Ue.target&&ce.targets){var ht=this._convert?"_convertedFunction":this._target,Et={target:ce.targets[ht]};m.setFeatureState(ot,Et)}}}}},x.prototype._clearTally=function(){this._featureMap={}},x.prototype._applyTally=function(v,m,T){if(!!this.map)for(var I=0,F=v.length;I<F;I++){var q=v[I],re=q.properties,ne={};if(this._convert){var se=this._convert(q);typeof se=="number"&&!isNaN(se)&&(ne._convertedFunction=se)}else for(var X=0,ce=m.length;X<ce;X++){var Me=m[X];re[Me]!==void 0&&(ne[Me]=re[Me])}if(re.__boundaryId)this._featureMap[re.__boundaryId]={targets:ne,feature:q,level:T};else{var Be=this.map.fromGeoToScreen(q.geoCenter),ot=this.map._mapboxEngine.queryRenderedFeatures([Be.x,Be.y],{layers:[this.id+"_blankAdmin"+T]});if(ot&&ot.length>0){var Ue=ot[0],ht=Ue.properties.worldview;if(ht==="all"||ht.includes(this._worldView)){var Et=Ue.id;this._featureMap[Et]={targets:ne,feature:q,level:T}}}}}},x.prototype.addFeatures=function(v,m){var T;this._applyTally(v,this._properties,m),(T=this._features["admin"+m]).push.apply(T,v),this._applyState()},x.prototype.fetchFeatures=function(v){return this._features["admin"+v]},x.prototype.clearFeatures=function(v){if(v===void 0)for(var m in this._features)this._features[m].length=0;else this._features["admin"+v].length=0;this._applyState()},x.prototype.inspect=function(v,m,T){if(!this.map)return[];var I=[],F=this._featureMap,q=this.map.fromGeoToScreen(v),re=this.map._mapboxEngine.queryRenderedFeatures([q.x,q.y],{layers:[this.id+"_blankAdmin"+T]});if(re&&re.length>0){var ne={},se=re[0],X=se.properties.worldview;if(X==="all"||X.includes(this._worldView)){var ce=this._constructId(se.id),Me=F[ce];if(Me){for(var Be=0,ot=m.length;Be<ot;Be++){var Ue=m[Be];ne[Ue]=Me.targets[Ue]}I.push(ne)}}}return I},x.prototype.findFeature=function(v,m){var T=this._findFeatureMap(v,m);return T?T.feature:null},x.prototype._findFeatureMap=function(v,m){if(!this.map)return null;var T=this.map.fromGeoToScreen(v),I=this.map._mapboxEngine.queryRenderedFeatures([T.x,T.y],{layers:[this.id+"_blankAdmin"+m]});if(I&&I.length>0){var F=I[0],q=this._constructId(F.id),re=this._featureMap[q];if(re)return re}return null},x.prototype.findBounds=function(v,m){if(!this.map)return null;var T=this.map.fromGeoToScreen(v),I=this.map._mapboxEngine.queryRenderedFeatures([T.x,T.y],{layers:[this.id+"_blankAdmin"+m]}),F=new k.c;if(I&&I.length===1){var q=I[0],re=q.geometry,ne=re.type,se=re.coordinates;if(ne==="MultiPolygon")for(var X=0,ce=se.length;X<ce;X++)for(var Me=se[X][0],Be=0,ot=Me.length;Be<ot;Be++){var Ue=Me[Be],ht=K.F.fromDegrees(Ue[1],Ue[0]);F.expand(ht)}else if(ne==="Polygon")for(var Me=se[0],X=0,ce=Me.length;X<ce;X++){var Ue=Me[X],ht=K.F.fromDegrees(Ue[1],Ue[0]);F.expand(ht)}return F}},x.prototype.highlight=function(v,m,T){if(!!this.map){var I=this.map,F=I.engine,q=this.map.fromGeoToScreen(v),re=this.map._mapboxEngine.queryRenderedFeatures([q.x,q.y],{layers:[this.id+"_blankAdmin"+m]});if(re.length>0){var ne=re[0],se=ne.properties.worldview;if(se==="all"||se.includes(this._worldView)){var X=ne.id,ce={id:X,source:this._id+"_admin"+m,sourceLayer:"boundaries_adm"+m},Me=F.getFeatureState(ce);T.strokeColor!==void 0&&(Me.highlightStrokeColor=!0,Me.strokeColor=T.strokeColor),T.strokeWidth!==void 0&&(Me.highlightStrokeWidth=!0,Me.strokeWidth=T.strokeWidth),T.strokeOpacity!==void 0&&(Me.highlightStrokeOpacity=!0,Me.strokeOpacity=T.strokeOpacity),T.fillColor!==void 0&&(Me.highlightFillColor=!0,Me.fillColor=T.fillColor),T.fillOpacity!==void 0&&(Me.highlightFillOpacity=!0,Me.fillOpacity=T.fillOpacity);var Be={id:X,source:this._id+"_admin"+m,sourceLayer:"boundaries_adm"+m,state:Me};this._highlightMap[ne.id]=Be,F.setFeatureState(ce,Me)}}}},x.prototype.clearHighlights=function(){if(!!this.map){var v=this.map.engine;for(var m in this._highlightMap){var T=this._highlightMap[m];T.id=m;for(var I in T.state)I.includes("highlight")&&v.removeFeatureState(T,I)}}},x.prototype._onRuleChanged=function(v){var m=v.rule;if(!!this.map){var T=this.map.engine;T.setLayerZoomRange(m._foregroundLayer.id,m.minimumZoom,m.maximumZoom),T.setLayerZoomRange(m._strokeLayer.id,m.minimumZoom,m.maximumZoom),m._backgroundLayer&&T.setLayerZoomRange(m._backgroundLayer.id,m.minimumZoom,m.maximumZoom)}},x.prototype._onStyleChanged=function(v){var m=v.style;if(!!this.map)for(var T=v.property,I=v.value,F=this.map.engine,q,re=0,ne=this._rules.length;re<ne;re++){var se=this._rules[re];if(se.style===m)switch(T){case"strokeColor":var X=this._createMapboxLineColor(I);F.setPaintProperty(se._strokeLayer.id,"line-color",X);break;case"strokeWidth":var ce=this._createMapboxLineWidth(I);F.setPaintProperty(se._strokeLayer.id,"line-width",ce);break;case"strokeOpacity":var Me=this._createMapboxLineOpacity(I);F.setPaintProperty(se._strokeLayer.id,"line-opacity",Me);break;case"fillInterpolated":m.fillColors&&m.fillColors.length>0&&(q=this._createMapboxFillColors(m.fillColors,I),F.setPaintProperty(se._foregroundLayer.id,"fill-color",q));break;case"fillColors":if(I.length>0){q=this._createMapboxFillColors(I,m.fillInterpolated),F.setPaintProperty(se._foregroundLayer.id,"fill-color",q);break}case"fillColor":if(!m.fillColors||m.fillColors.length===0){var Be=I;Be.constructor===Array&&(Be=m.fillColor||"rgba(0,0,0,0)");var ot=this._createMapboxFillColor(Be);F.setPaintProperty(se._foregroundLayer.id,"fill-color",ot)}break;case"fillPattern":if(se._backgroundLayer===void 0){var Ue=this._mapboxGroup.indexOf(se._foregroundLayer);se._backgroundLayer=this._createBackground(se),this._unloadMapboxGroup(),this._mapboxGroup.splice(Ue,0,se._backgroundLayer),this._loadMapboxGroup()}else F.setPaintProperty(se._backgroundLayer.id,"fill-pattern",I);break;case"fillOpacity":var ht=this._createMapboxFillOpacity(I,se.excludeWithChildren);if(F.setPaintProperty(se._foregroundLayer.id,"fill-opacity",ht),se._backgroundLayer){var Et=this._createMapboxBackgroundFillOpacity(I);F.setPaintProperty(se._backgroundLayer.id,"fill-opacity",Et)}break}}},x.prototype._onMapMoving=function(v){for(var m=this.map._calculateTiles(this.map.zoomLevel,512,!1),T=!1,I=0,F=m.length;I<F;I++){var q=m[I].toString();this._tileSet[q]||(this._tileSet[q]=!0,T=!0)}T&&this._applyState()},x.prototype._onSourceData=function(v){if(!!this.map)switch(v.sourceId){case this._id+"_admin0":case this._id+"_admin1":case this._id+"_admin2":case this._id+"_admin3":case this._id+"_admin4":var m=this.map.engine.style.sourceCaches[v.sourceId];if(m){var T=parseInt(v.sourceId.slice(-1),10),I="admin"+T,F=this._features[I];this._applyTally(F,this._properties,T),this._applyState()}break}},x.TRANSITION={delay:0,duration:0},x}(h.m)},58961:(ct,Ye,B)=>{"use strict";B.d(Ye,{Y:()=>v});var Q=B(66071),W=B(28360),h=B(27098),K=B(73690),k=B(72503),A=B(44427),z=B(21574),R=B(69011),C=function(){var m=function(T,I){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,q){F.__proto__=q}||function(F,q){for(var re in q)q.hasOwnProperty(re)&&(F[re]=q[re])},m(T,I)};return function(T,I){m(T,I);function F(){this.constructor=T}T.prototype=I===null?Object.create(I):(F.prototype=I.prototype,new F)}}(),x=function(m){C(T,m);function T(I){I===void 0&&(I={});var F=m.call(this,I)||this;return F.productKey=void 0,F.infoUrl=void 0,F.featuresUrl=void 0,F.detailsUrl=void 0,F.infoPollingInterval=void 0,F.infoPollingTimeout=void 0,F.apiKey=void 0,F.validity=void 0,(0,Q.f0)(F,I),F}return T}(h.b),v=function(m){C(T,m);function T(I){var F=m.call(this,I=I instanceof x?I:new x(I))||this;return F._tileSet=[],F._hasMetaData=!1,F._times=[],F._timeSystem="timed",F._isVisible=!1,F._subdomains=[],F._isDataDirty=!0,F._cachedTiles={},F._pendingRequests={},F._pendingTiles={},F._pendingTilesCount=0,F._requestMethod="GET",F._highlightMap={},F.metaDataLoaded=new W.j,F.metaDataModified=new W.j,F._productKey=I.productKey,F._infoUrl=I.infoUrl,F._featuresUrl=I.featuresUrl,F._detailsUrl=I.detailsUrl,F._infoPollingInterval=I.infoPollingInterval||new k.i(6e4),F._infoPollingTimeout=I.infoPollingTimeout||new k.i(5e3),F._apiKey=I.apiKey,F}return Object.defineProperty(T.prototype,"times",{get:function(){return this._times},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"productKey",{get:function(){return this._productKey},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"features",{get:function(){if(this._currentTime){var I=this._cachedTiles[this._currentTime.getTime()];if(I)return I.features}return[]},enumerable:!0,configurable:!0}),T.prototype._load=function(){if(!this._infoClient){this._startService();var I=this._options.sunApiKey||this.map.sunApiKey;switch(this._boundaryAdmin0.tiles[0]=this._boundaryAdmin0.tiles[0].replace("{apiKey}",I),this._boundaryAdmin1.tiles[0]=this._boundaryAdmin1.tiles[0].replace("{apiKey}",I),this._boundaryAdmin2.tiles[0]=this._boundaryAdmin2.tiles[0].replace("{apiKey}",I),this._changeLoadState(Q.jd.Loading),this.map.renderer){case R.Renderer.WebDOM:this._loadLeaflet();break;case R.Renderer.WebGL:this._loadMapbox();break}}this.map.clock.timeChanged.addListener(this._onTimeChanged,this),this.map.moving.addListener(this._onMapMoving,this)},T.prototype._unload=function(){this._stopService(),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this),this.map.moving.removeListener(this._onMapMoving,this),m.prototype._unload.call(this)},T.prototype._startService=function(I,F){if(!this._infoClient){var q=F||this._apiKey||this.map.sunApiKey,re=I||this._infoUrl||this.map.sunFeatureUrl;re=re+"&tile-size=512",re=re+"&meta=true",re=re.replace("{productKey}",this._productKey),re=re.replace("{apiKey}",q),this._infoClient=new K.U(re),this._infoClient.timeout=this._infoPollingTimeout.totalMilliseconds,this._infoClient.pollingInterval=this._infoPollingInterval.totalMilliseconds,this._infoClient.modified.addListener(this._onInfoLoaded,this),this._infoClient.startPolling()}},T.prototype._stopService=function(){this._infoClient&&(this._infoClient.stopPolling(),this._infoClient.modified.removeListener(this._onInfoLoaded,this),delete this._infoClient)},T.prototype._deriveTime=function(){for(var I=k.i.max,F=null,q=this.map.clock.time,re=this._times.length||0,ne=0;ne<re;ne++){var se=this._times[ne],X=k.i.fromDates(q,se,!0);X.totalMilliseconds<I.totalMilliseconds&&(I=X,F=se)}return F},T.prototype._convertInfo=function(){var I=this._infoClient.objectLiteral,F=I.products[this._productKey];if(this._featuresUrl=this._options.featuresUrl||I.featuresUrl,this._detailsUrl=this._options.detailsUrl||I.detailsUrl,this._subdomains=I.subdomains,F.meta){var q=F.meta;q.timeMode&&(this._timeSystem=q.timeMode),this._options.validity?this._validity=this._options.validity:q.defaultValidity&&(this._validity=new k.i(q.defaultValidity)),this._options.meta&&(0,Q.f0)(q,this._options.meta),this._meta=q}for(var re=[],ne=F.time.length>0?Math.max(F.time.length-1,1):0,se,X=!1,ce=0;ce<ne;ce++){var Me=F.time[ce],Be=Me.split("/"),ot=Me.split(":"),Ue=void 0;if(Be[1])if(!se||se===parseInt(Be[0]))Ue=parseInt(Be[1]),se=parseInt(Be[0]);else if(se>parseInt(Be[0]))re=[],Ue=parseInt(Be[1]),se=parseInt(Be[0]);else break;else Ue=parseInt(Be[0]);var ht;ot[1]&&(ht=parseInt(ot[1]));var Et=new Date(Ue);Et.__iteration=ht,re.push(Et)}return re.length>0&&(!this._times||re.length!=this._times.length||JSON.stringify(re)!=JSON.stringify(this._times))&&(X=!0,this._times=re,this._isDataDirty=!0,this._purgeTimes()),re.length===0&&this._changeLoadState(Q.jd.Loaded),X},T.prototype._purgeTimes=function(){var I=[],F=this._times.length;for(var q in this._cachedTiles){for(var re=this._cachedTiles[q],ne=!1,se=0;se<F;se++){var X=this._times[se];if(X&&X.getTime()===re.time.getTime()){ne=!0;break}}ne||I.push(re)}},T.prototype._deriveUrl=function(I){var F=(0+0)%this._subdomains.length,q=this._subdomains[F]||"0",re=I.time.getTime().toString();I.time.__iteration&&(re=re+":"+I.time.__iteration);var ne=this._featuresUrl;return ne=ne.replace("{subdomain}",q).replace("{time}",re).replace("{productKey}",this._productKey).replace("{apiKey}",this._apiKey||this.map.sunApiKey).replace("{lod}","0").replace("{x}","0").replace("{y}","0").replace("&tile-size=512",""),ne=ne+"&tile-size=512",ne=ne.replace("?&","?"),ne},T.prototype._requestTile=function(I){var F=this;this._changeLoadState(Q.jd.Loading);var q=this._deriveUrl(I),re=K.U.createCorsRequest(this._requestMethod,q,!0,!1);re.onerror=function(){F._registerTile(I)},re.timeout=function(){F._registerTile(I)},re.onabort=function(){F._registerTile(I)},re.onprogress=function(){},re.onload=function(){F._registerTile(I),F._formatTile(re.responseText,I),F.update()};var ne="";if(this._requestMethod.toUpperCase()==="POST"){var se=q.split("POST");se.length===2&&(q=se[0],ne=se[1])}this._pendingTiles[I.key]=I,this._pendingRequests[I.key]=re,this._pendingTilesCount++,re.send(ne)},T.prototype._registerTile=function(I){var F=I.key;this._pendingTiles[F]&&(this._pendingTilesCount--,delete this._pendingTiles[F]),this._pendingRequests[F]&&delete this._pendingRequests[F],this._pendingTilesCount<=0&&this.loadState!=Q.jd.Loaded&&(this._pendingTilesCount=0,this._changeLoadState(Q.jd.Loaded))},T.prototype._formatTile=function(I,F){if(!!this.map.isEnabled){var q=F.time.getTime();if(!this._cachedTiles[q]){this._cachedTiles[q]=F;var re=void 0;if(typeof I=="string"?re=this._parse(I):re=(0,A.x)(I),re){F.features=re;for(var ne=0,se=re.length;ne<se;ne++){var X=re[ne];X.id||(X.id=(0,Q.cm)()),X._tile=F,X._layer=this}var ce=this._properties.length>0?this._properties:[this._target],Me=F.features;this._applyTally(Me,ce),this._applyState()}}}},T.prototype._parse=function(I){var F=JSON.parse(I),q=F.message?[]:(0,A.x)(F);return q},T.prototype._constructId=function(I){return this._currentTime?this._currentTime.getTime()+"_"+I:""},T.prototype._changeConvert=function(I){this._convert=I,this._tileSet=[],this._clearState(),this._clearTally();var F=this._cachedTiles;for(var q in F){var re=F[q];this._applyTally(re.features,this._properties)}this._applyState()},T.prototype._changeProperties=function(I){this._properties=I,this._tileSet=[],this._clearState(),this._clearTally();var F=this._cachedTiles;for(var q in F){var re=F[q];this._applyTally(re.features,this._properties)}this._applyState()},T.prototype._applyTally=function(I,F){for(var q=0,re=I.length;q<re;q++){var ne=I[q],se=ne.properties,X=se.validTime,ce={};if(this._convert){var Me=this._convert(ne);typeof Me=="number"&&!isNaN(Me)&&(ce._convertedFunction=Me)}else for(var Be=0,ot=F.length;Be<ot;Be++){var Ue=F[Be];se[Ue]!==void 0&&(ce[Ue]=se[Ue])}var ht=se.admin;if(ht==="country"){var Et=se.twc_adm_0;if(Et.includes(",")&&(Et=Et.split(",")[1]),this._featureMap[X+"_"+Et]===void 0)this._featureMap[X+"_"+Et]={targets:ce,entries:[ne],level:ht};else{var bi=this._featureMap[X+"_"+Et];bi.targets=ce,bi.entries.unshift(ne)}}else if(ht==="state"){var Et=se.twc_adm_0,gt=se.twc_adm_1;if(Et.includes(",")&&(Et=Et.split(",")[1]),this._featureMap[X+"_"+Et]===void 0)this._featureMap[X+"_"+Et]={entries:[ne],level:"country"};else{var bi=this._featureMap[X+"_"+Et];bi.entries.push(ne)}if(this._featureMap[X+"_"+gt]===void 0)this._featureMap[X+"_"+gt]={targets:ce,entries:[ne],level:ht};else{var bi=this._featureMap[X+"_"+gt];bi.targets=ce,bi.entries.unshift(ne)}}else if(ht==="county"){var gt=se.twc_adm_1,Qe=se.twc_adm_2;if(this._featureMap[X+"_"+gt]===void 0)this._featureMap[X+"_"+gt]={entries:[ne],level:"state"};else{var bi=this._featureMap[X+"_"+gt];bi.entries.push(ne)}if(this._featureMap[X+"_"+Qe]===void 0)this._featureMap[X+"_"+Qe]={targets:ce,entries:[ne],level:ht};else{var bi=this._featureMap[X+"_"+Qe];bi.targets=ce,bi.entries.unshift(ne)}}}},T.prototype._applyState=function(){if(!!this._currentTime){var I=this._currentTime.getTime(),F=this._cachedTiles[I];if(F){for(var q=this.map,re=q.engine,ne=this._featureMap,se=[],X=q.zoomLevel,ce=0,Me=this._rules.length;ce<Me;ce++){var Be=this._rules[ce];if(X>=Be.minimumZoom&&X<Be.maximumZoom){var ot=Be.administrativeLevel;se.indexOf(ot)===-1&&se.push(ot)}}for(var Ue in ne)if(Ue.includes(I.toString()))for(var ht=ne[Ue],Et=Ue.split("_")[1],bi=0;bi<se.length;bi++){var gt=se[bi],Qe={id:Et,source:this._id+"_admin"+gt,sourceLayer:"boundaries_adm"+gt},we=re.getFeatureState(Qe);if(!we.target&&ht.targets){var Ae=this._convert?"_convertedFunction":this._target,it={target:ht.targets[Ae]};ht.level&&(it.level=ht.level),ht.entries.length>1&&(it.children=!0),re.setFeatureState(Qe,it)}}}}},T.prototype.inspect=function(I,F,q){return this.map?this._currentTime?m.prototype.inspect.call(this,I,F,q):[]:[]},T.prototype.findLocation=function(I,F){if(!this.map||!this._currentTime)return"";var q="",re=this.map.fromGeoToScreen(I),ne=this.map._mapboxEngine.queryRenderedFeatures([re.x,re.y],{layers:[this.id+"_blankAdmin"+F]});if(ne&&ne.length===1){var se=ne[0],X=this._constructId(se.id),ce=this._featureMap[X];if(ce){var Me=ce.entries[0],Be=Me.properties;Be.location&&(q=q+Be.location+", "),q=q+Be.country}}return q},T.prototype.findFeature=function(I,F){if(!this._currentTime)return null;var q=this._findFeatureMap(I,F);if(q){var re=q.entries[0];return re.hasChildren=q.entries.length>1,re}else return null},T.prototype.findBounds=function(I,F){return!this.map||!this._currentTime?null:m.prototype.findBounds.call(this,I,F)},T.prototype.findCountryCode=function(I){var F=this.map.fromGeoToScreen(I),q=this.map._mapboxEngine.queryRenderedFeatures([F.x,F.y],{layers:[this.id+"_blankAdmin0"]}),re=q.length>0?q[0].properties.key:null;return re},T.prototype.update=function(){var I=this._deriveTime();if(I&&this._currentTime!==I&&(this._currentTime=I,this._clearState(),this._tileSet=[],this._applyState(),!this._cachedTiles[this._currentTime.getTime()])){var F=new z.$(0,0,0,!1);F.time=this._currentTime,this._requestTile(F)}},T.prototype.addFeatures=function(){throw new Error("NotSupportedException: SunChoroplethLayer does not support the 'addFeatures' method")},T.prototype.fetchFeatures=function(){throw new Error("NotSupportedException: SunChoroplethLayer does not support the 'fetchFeatures' method")},T.prototype.clearFeatures=function(){throw new Error("NotSupportedException: SunChoroplethLayer does not support the 'clearFeatures' method")},T.prototype._onInfoLoaded=function(I){var F=this._convertInfo();this._hasMetaData?F&&(this._timeStamp=this.map.clock.time,this.metaDataModified.trigger()):(this._hasMetaData=!0,this.metaDataLoaded.trigger(),this._infoClient.url=this._infoClient.url.replace("&meta=true",""),this.map&&(this._timeStamp=this.map.clock.time)),this.map&&this.map.isEnabled&&(this._isVisible=this.map.zoomLevel>=this.minimumZoom&&this.map.zoomLevel<=this.maximumZoom,this.update())},T.prototype._onTimeChanged=function(I){this.update()},T.prototype._onMapMoving=function(I){for(var F=this.map._calculateTiles(this.map.zoomLevel,512,!1),q=!1,re=0,ne=F.length;re<ne;re++){var se=F[re].toString();this._tileSet[se]||(this._tileSet[se]=!0,q=!0)}q&&this._applyState()},T}(h.C)},64026:(ct,Ye,B)=>{"use strict";B.d(Ye,{K:()=>k});var Q=B(68575),W=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),h=function(A){W(z,A);function z(){var R=A!==null&&A.apply(this,arguments)||this;return R.hasBlurred=!1,R.isolineData={},R.isobandData={},R}return Object.defineProperty(z.prototype,"parent",{get:function(){if(this.z!=0){var R=new z(this.z-1,this.x>>1,this.y>>1);return R}else return null},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"key",{get:function(){var R="";return R+=this.z.toString(),R+="_",R+=this.x.toString(),R+="_",R+=this.y.toString(),R},enumerable:!0,configurable:!0}),z}(Q.n),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(){var R=A!==null&&A.apply(this,arguments)||this;return R.elevation=0,R}return Object.defineProperty(z.prototype,"parent",{get:function(){if(this.z!=0){var R=new z(this.z-1,this.x>>1,this.y>>1,!1);return R.discreteTime=this.discreteTime,R.elevation=this.elevation,R}else return null},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"key",{get:function(){var R="";return R+=this.discreteTime.key,R+="_",R+=this.z.toString(),R+="_",R+=this.x.toString(),R+="_",R+=this.y.toString(),R+="_",R+=this.elevation.toString(),R},enumerable:!0,configurable:!0}),z}(h)},77109:(ct,Ye,B)=>{"use strict";B.d(Ye,{K:()=>K,Q:()=>k});var Q=B(66071),W=B(35992),h=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),K=function(A){h(z,A);function z(R){var C=A.call(this,R)||this;return C.styles=void 0,(0,Q.f0)(C,R),C}return z}(W.M),k=function(A){h(z,A);function z(R){var C=A.call(this,R=R instanceof K?R:new K(R))||this;return C._styles=R.styles||[],C}return z.prototype._load=function(){this._changeLoadState(Q.jd.Loading);for(var R=this.map,C=0,x=0,v=this._styles.length;x<v;x++){var m=this._styles[x],T=R._mapboxEngine.getLayer(m);T&&(!T.metadata||!T.metadata.group)&&(mapboxgl.layerGroups.moveLayerToGroup(this.map._mapboxEngine,this.id,m),R._mapboxEngine.moveLayer(m),C++)}R._styleLength=R._styleLength-C,this.update(),this._changeLoadState(Q.jd.Loaded)},z.prototype._unload=function(){var R=this.map,C=R._originalStyleOrder;if(!R.isStyling)for(var x=0,v=this._styles.length;x<v;x++){var m=this._styles[x],T=R._mapboxEngine.getLayer(m);if(T&&T.metadata&&T.metadata.group===this.id){mapboxgl.layerGroups.removeLayerFromGroup(R._mapboxEngine,this.id,m);for(var I=C.indexOf(m)+1,F=R.styleOrder,q;F.indexOf(C[I])>=R._styleLength;)I++;I>=C.length?q=F[R._styleLength]:q=C[I],R._mapboxEngine.moveLayer(m,q),R._styleLength++}}this._changeLoadState(Q.jd.Unloaded)},z.prototype._unloadMapboxGroup=function(){},z.prototype.update=function(){},z}(W.m)},7842:(ct,Ye,B)=>{"use strict";B.d(Ye,{p:()=>I,h:()=>F});var Q=B(66071),W=B(28360),h=B(73690),K=B(18078),k=B(21574),A=B(15960),z=B(44427),R=B(9654),C=B(50042),x=B(22045),v=B(72503),m=B(93126),T=function(){var q=function(re,ne){return q=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(se,X){se.__proto__=X}||function(se,X){for(var ce in X)X.hasOwnProperty(ce)&&(se[ce]=X[ce])},q(re,ne)};return function(re,ne){q(re,ne);function se(){this.constructor=re}re.prototype=ne===null?Object.create(ne):(se.prototype=ne.prototype,new se)}}(),I=function(q){T(re,q);function re(ne){ne===void 0&&(ne={});var se=q.call(this,ne)||this;return se.isTiled=void 0,se.validity=void 0,se.refreshRate=void 0,se.timeRange=void 0,se.timeMode=void 0,(0,Q.f0)(se,ne),se}return re}(A.L),F=function(q){T(re,q);function re(ne){var se=q.call(this,ne)||this;return se._isTiled=!1,se._dimension=512,se._isTms=!0,se._hasMetaData=!1,se._enableValidity=!0,se._cachedTiles={},se._pendingRequests={},se._pendingTiles={},se._pendingTilesCount=0,se._requestMethod="GET",se._visibleFeatures={},se._timeSystem="timed",se._ranges=[],se._times=[],se._lastRefreshed=performance.now(),se._lastTopLeftScreenPoint=new m.E(0,0),se._lastBottomRightScreenPoint=new m.E(0,0),se._lastTopLeftGeoPoint=R.F.fromRadians(0,0),se._lastBottomRightGeoPoint=R.F.fromRadians(0,0),se._dropped=0,se.metaDataLoaded=new W.j,se.metaDataModified=new W.j,se._isTiled=ne.isTiled,se._refreshRate=ne.refreshRate!==void 0&&ne.refreshRate.totalMilliseconds>=1e3?ne.refreshRate:new v.i(0,60),se._timeRange=ne.timeRange||new K.e,se._timeMode=ne.timeMode,se}return Object.defineProperty(re.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(ne){ne.totalMilliseconds>=1e3&&(this._refreshRate=ne)},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"timeRange",{get:function(){return this._timeRange},set:function(ne){ne!==this._timeRange&&(this._timeRange=ne,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"timeMode",{get:function(){return this._timeMode},set:function(ne){ne in Q.$i||this.map&&(ne=this.map.animator.timeMode),this._timeMode=ne},enumerable:!0,configurable:!0}),Object.defineProperty(re.prototype,"isTiled",{get:function(){return this._isTiled},enumerable:!0,configurable:!0}),re.prototype._retrieveAllFeatures=function(){var ne=[];for(var se in this._cachedTiles)for(var X=this._cachedTiles[se],ce=0,Me=X.features.length;ce<Me;ce++){var Be=X.features[ce];ne.push(Be)}for(var ce=0,ot=this._features.length;ce<ot;ce++){var Be=this._features[ce];ne.push(Be)}return ne},re.prototype._retrieveDedupedFeatures=function(){for(var ne={},se=0,X=this._features.length;se<X;se++){var ce=this._features[se];(!ne.hasOwnProperty(ce.id)||ce._isShown)&&(ne[ce.id]=ce)}for(var Me in this._cachedTiles)for(var Be=this._cachedTiles[Me],se=0,ot=Be.features.length;se<ot;se++){var ce=Be.features[se],Ue=ce.id;ce.validTime&&(Ue=Ue+ce.validTime.toString()),(!ne.hasOwnProperty(Ue)||ce._isShown)&&(ne[Ue]=ce)}var ht=Object.keys(ne).map(function(Et){return ne[Et]});return ht},re.prototype._retrieveValidFeatures=function(){var ne={},se=this.map.clock.time,X=new Date;for(var ce in this._cachedTiles){var Me=this._cachedTiles[ce];if(Me.z===this._keyZoom||!this._isTiled)for(var Be=0,ot=Me.features.length;Be<ot;Be++){var Ue=Me.features[Be];if(!(Ue.expires&&Ue.expires.getTime()>=X.getTime())&&(!this._enableValidity||this._validateFeature(Ue))){var ht=Ue.id;if(Ue.validTime&&(ht=ht+Ue.validTime.toString()),!ne.hasOwnProperty(ht)||Ue._isShown)ne[ht]=Ue;else if(ne.hasOwnProperty(ht)){var Et=ne[ht];if(Ue.validTime&&Et.validTime){var bi=v.i.fromDates(se,Et.validTime.value,!0),gt=v.i.fromDates(se,Ue.validTime.value,!0);gt.totalMilliseconds<bi.totalMilliseconds&&(ne[ht]=Ue)}}}}}for(var Be=0,Qe=this._features.length;Be<Qe;Be++){var Ue=this._features[Be],ht=Ue.id;Ue.validTime&&(ht=ht+Ue.validTime.toString()),(!ne.hasOwnProperty(ht)||Ue._isShown)&&(ne[ht]=Ue)}var we=Object.keys(ne).map(function(Ae){return ne[Ae]});return we},re.prototype._determineTiles=function(){for(var ne=[],se=[],X=this._deriveTiles(),ce=0,Me=X.length;ce<Me;ce++){var Be=X[ce],ot=Be.key,Ue=this._cachedTiles[ot];Ue?(this._timeSystem==="ranged"||!this._enableValidity||!Ue.time||Ue.time.getTime()===this._currentTime.getTime())&&ne.push(Ue):this._pendingTiles.hasOwnProperty(ot)===!1&&se.push(Be)}return{rendered:ne,missing:se}},re.prototype._render=function(){if(this._isVisible){var ne=this.map,se=this._determineTiles(),X=se.rendered,ce=se.missing;this._requestTiles(ce);var Me;if(!this._isTiled){var Be=ne.bounds,ot=ne.fromGeoToScreen(Be.topLeftGeoPoint,this._lastTopLeftScreenPoint),Ue=ne.fromGeoToScreen(Be.bottomRightGeoPoint,this._lastBottomRightScreenPoint);ot.x-=123,ot.y-=123,Ue.x+=123,Ue.y+=123;var ht=ne.fromScreenToGeo(ot,this._lastTopLeftGeoPoint),Et=ne.fromScreenToGeo(Ue,this._lastBottomRightGeoPoint),bi=Et.longitude.degrees-ht.longitude.degrees>360;if(ht.normalize(),Et.normalize(),bi){var gt=new C.c(ht.latitude,x.o.fromDegrees(-180),Et.latitude,x.o.fromDegrees(180));Me=[gt]}else if(ht.longitude.degrees>Et.longitude.degrees){var Qe=new C.c(ht.latitude,ht.longitude,Et.latitude,x.o.fromDegrees(180)),we=new C.c(ht.latitude,x.o.fromDegrees(-180),Et.latitude,Et.longitude);Me=[Qe,we]}else{var gt=new C.c(ht.latitude,ht.longitude,Et.latitude,Et.longitude);Me=[gt]}}var Ae=this._visibleFeatures,it=ne.clock.time,Lt=Date.now();if(this._enableValidity&&!this.timeRange.inRange(it))return;for(var ei=0,Si=X.length;ei<Si;ei++)for(var ui=X[ei],ni=0,Bi=ui.features.length;ni<Bi;ni++){var Ci=ui.features[ni];if(Ci.expires){var xt=Ci.expires.getTime()*1e3;if(xt<Lt){this._dropped++;continue}}var ze=this._validateFeature(Ci,Me);if(ze){var oe=Ci.id;if(Ci.validTime&&(oe=oe+Ci.validTime.toString()),!Ae.hasOwnProperty(oe))Ae[oe]=Ci;else{var de=Ae[oe];if(Ci.validTime&&de.validTime){var Re=v.i.fromDates(it,de.validTime.value,!0),He=v.i.fromDates(it,Ci.validTime.value,!0);He.totalMilliseconds<Re.totalMilliseconds&&(Ae[oe]=Ci)}}}}var mt=Object.keys(Ae).map(function(Gt){return Ae[Gt]});if(mt.length>0){var Ft=this._options.filter(mt);this._showFeatures(Ft)}}},re.prototype._validateFeature=function(ne,se){if(se){for(var X=!1,ce=0,Me=se.length;ce<Me;ce++)if(se[ce].intersects(ne.overlay.bounds)){X=!0;break}if(!X)return!1}if(!this._enableValidity)return this._timeRange&&ne.validTime?this._timeRange.inRange(ne.validTime.value):!0;var Be;if(this._options.validity?Be=this._options.validity:ne.properties.validity?Be=new v.i(ne.properties.validity):this._validity&&(Be=this._validity),ne.properties&&Be&&ne.validTime){var ot=ne.validTime.value.getTime(),Ue=ot-0,ht=ot+Be.totalMilliseconds,Et=this._timeStamp.getTime(),bi=Et>Ue&&Et<ht&&this._timeRange.inRange(Ue);if(!bi)return!1}return!0},re.prototype._requestTiles=function(ne){for(var se=0,X=ne.length;se<X;se++){var ce=ne[se];this._requestTile(ce)}},re.prototype._requestTile=function(ne){var se=this;if(!this._pendingTiles.hasOwnProperty(ne.key)){var X=this._deriveUrl(ne);if(X===null)return;this.loadState!=Q.jd.Loading&&this._changeLoadState(Q.jd.Loading);var ce="";if(this._requestMethod.toUpperCase()==="POST"){var Me=X.split("POST");Me.length===2&&(X=Me[0],ce=Me[1])}var Be=h.U.createCorsRequest(this._requestMethod,X,!0,!1);Be.onerror=function(){se._registerTile(ne)},Be.timeout=function(){se._registerTile(ne)},Be.onabort=function(){se._registerTile(ne)},Be.onprogress=function(){},Be.onload=function(){se._registerTile(ne),se._formatTile(Be.responseText,ne),ne.features.length>0&&se.update()},this._pendingTiles[ne.key]=ne,this._pendingRequests[ne.key]=Be,this._pendingTilesCount++,Be.send(ce)}},re.prototype._registerTile=function(ne){var se=ne.key;this._pendingTiles[se]&&(this._pendingTilesCount--,delete this._pendingTiles[se]),this._pendingRequests[se]&&delete this._pendingRequests[se],this._pendingTilesCount<=0&&this.loadState!=Q.jd.Loaded&&(this._pendingTilesCount=0,this._changeLoadState(Q.jd.Loaded))},re.prototype._formatTile=function(ne,se){if(!!this.map.isEnabled){var X=se.key;if(!this._cachedTiles[X]){this._cachedTiles[X]=se;var ce=void 0;if(typeof ne=="string"?ce=this._parse(ne):ce=(0,z.x)(ne),ce){se.features=ce;for(var Me=0,Be=ce.length;Me<Be;Me++){var ot=ce[Me];ot.id||(ot.id=(0,Q.cm)()),ot._tile=se,ot._layer=this,this._applyFeatureProperties(ot),ot.computed=this._options.compute(ot),this._styleFeatures([ot])}}}}},re.prototype._applyFeatureProperties=function(ne){},re.prototype._deriveTiles=function(){var ne=this,se;return this._isTiled?se=this.map._calculateTiles(this._keyZoom,this._dimension,this._isTms,function(X,ce,Me){return new k.$(X,ce,Me,ne._isTms,ne._dimension)}):se=[new k.$(0,0,0)],se},re.prototype._deriveKeyZoomLevel=function(ne){for(var se=0,X=0,ce=this._pyramidPolicy.length;X<ce;X++){var Me=this._pyramidPolicy[X];if(Me.start>ne)break;se=Me.data}return se},re.prototype._load=function(){this.timeMode===void 0&&(this._timeMode=this.map.animator.timeMode),this.map.clock.timeChanged.addListener(this._onTimeChanged,this)},re.prototype._unload=function(){q.prototype._unload.call(this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this),this._cachedTiles={},this._visibleFeatures={},this._pendingTiles={},this._pendingTilesCount=0;for(var ne in this._pendingRequests){var se=this._pendingRequests[ne];se.abort(),delete this._pendingRequests[ne]}},re.prototype.update=function(){var ne=this;if(!!this.map&&(this._lastRefreshed=performance.now(),this._hasMetaData)){var se=Object.keys(this._visibleFeatures).map(function(X){return ne._visibleFeatures[X]});se.length>0&&(this._hideFeatures(se),this._visibleFeatures={}),this.redraw(),this.updated.trigger({id:this.id})}},re.prototype.restyle=function(){this._hasMetaData&&(this._visibleFeatures={},q.prototype.restyle.call(this))},re.prototype._onMapMoving=function(ne){this._isTiled&&(this._keyZoom=this._deriveKeyZoomLevel(this.map.zoomLevel)),this._toggleVisibility(),this.update()},re.prototype._onMapMoved=function(ne){this._isTiled&&(this._keyZoom=this._deriveKeyZoomLevel(this.map.zoomLevel)),this._toggleVisibility(),this.update()},re.prototype._onTimeChanged=function(ne){if(this._timeMode===Q.$i.Relative)this._timeRange._increment();else if(this._timeMode===Q.$i.Absolute){var se=ne.time;this._timeRange.inRange(se)!==this._timeRange.inRange(se.getTime()-1e3)&&this.update()}var X=performance.now(),ce=X-this._lastRefreshed;ce>this._refreshRate.totalMilliseconds&&(this._timeStamp=this.map.clock.time,this.update())},re}(A.a)},15960:(ct,Ye,B)=>{"use strict";B.d(Ye,{a:()=>bi,L:()=>Et});var Q=B(66071),W=B(56278),h=B(41626),K=B(61955),k=function(){var gt=function(Qe,we){return gt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ae,it){Ae.__proto__=it}||function(Ae,it){for(var Lt in it)it.hasOwnProperty(Lt)&&(Ae[Lt]=it[Lt])},gt(Qe,we)};return function(Qe,we){gt(Qe,we);function Ae(){this.constructor=Qe}Qe.prototype=we===null?Object.create(we):(Ae.prototype=we.prototype,new Ae)}}(),A=function(gt){k(Qe,gt);function Qe(we,Ae){var it=gt.call(this,[],Ae)||this;it._geoPoints=we,it._dashArray=Ae.dashArray,it._enableFill=Ae.enableFill!==void 0?Ae.enableFill:!0,it._enableStroke=Ae.enableStroke!==void 0?Ae.enableStroke:!0,it._fillColor=Ae.fillColor||"rgba(0, 0, 255, 1)",it._fillOpacity=Ae.fillOpacity!==void 0?Ae.fillOpacity:.2,it._fillRule=Ae.fillRule,it._radius=Ae.radius!==void 0?Ae.radius:10,it._strokeColor=Ae.strokeColor||"rgba(0, 0, 255, 1)",it._strokeOpacity=Ae.strokeOpacity!==void 0?Ae.strokeOpacity:1,it._strokeWidth=Ae.strokeWidth!==void 0?Ae.strokeWidth:1;for(var Lt=[],ei=0,Si=we.length;ei<Si;ei++){var ui=we[ei],ni=new h.c(ui,Ae);ni._group=it,Lt.push(ni)}return it._overlays=Lt,it}return Object.defineProperty(Qe.prototype,"dashArray",{get:function(){return this._dashArray},set:function(we){if(this._dashArray!==we){this._dashArray=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.dashArray=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"enableFill",{get:function(){return this._enableFill},set:function(we){if(this._enableFill!==we){(0,Q.le)(we)&&(we=!0),this._enableFill=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.enableFill=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"enableStroke",{get:function(){return this._enableStroke},set:function(we){if(this._enableStroke!==we){(0,Q.le)(we)&&(we=!0),this._enableStroke=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.enableStroke=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"fillColor",{get:function(){return this._fillColor},set:function(we){if(this._fillColor!==we){(0,Q.le)(we)&&(we="rgba(0, 0, 255, 1)"),this._fillColor=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.fillColor=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(we){if(this._fillOpacity!==we){(0,Q.le)(we)&&(we=.2),this._fillOpacity=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.fillOpacity=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"fillRule",{get:function(){return this._fillRule},set:function(we){if(this._fillRule!==we){(0,Q.le)(we)&&(we=void 0),this._fillRule=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.fillRule=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"radius",{get:function(){return this._radius},set:function(we){if(this._radius!==we){(0,Q.le)(we)&&(we=10),this._radius=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.radius=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(we){if(this._strokeColor!==we){(0,Q.le)(we)&&(we="rgba(0, 0, 255, 1)"),this._strokeColor=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeColor=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(we){if(this._strokeOpacity!==we){(0,Q.le)(we)&&(we=1),this._strokeOpacity=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeOpacity=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(we){if(this._strokeWidth!==we){(0,Q.le)(we)&&(we=1),this._strokeWidth=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeWidth=we}}},enumerable:!0,configurable:!0}),Qe}(K.Q),z=B(14740),R=B(81797),C=B(51959),x=function(){var gt=function(Qe,we){return gt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ae,it){Ae.__proto__=it}||function(Ae,it){for(var Lt in it)it.hasOwnProperty(Lt)&&(Ae[Lt]=it[Lt])},gt(Qe,we)};return function(Qe,we){gt(Qe,we);function Ae(){this.constructor=Qe}Qe.prototype=we===null?Object.create(we):(Ae.prototype=we.prototype,new Ae)}}(),v=function(gt){x(Qe,gt);function Qe(we,Ae){var it=gt.call(this,[],Ae)||this;it._isNormalized=Ae.isNormalized!==void 0?Ae.isNormalized:!1,it._options=Ae,it._dashArray=Ae.dashArray,it._isClipped=Ae.isClipped,it._smoothFactor=Ae.smoothFactor!==void 0?Ae.smoothFactor:1,it._strokeColor=Ae.strokeColor!==void 0?Ae.strokeColor:"rgba(0, 0, 255, 1)",it._strokeOpacity=Ae.strokeOpacity!==void 0?Ae.strokeOpacity:1,it._strokeWidth=Ae.strokeWidth!==void 0?Ae.strokeWidth:1,it._lineCap=Ae.lineCap,it._lineJoin=Ae.lineJoin;for(var Lt=[],ei=0,Si=we.length;ei<Si;ei++){var ui=we[ei],ni=new C.E(ui,Ae);ni._group=it,Lt.push(ni)}return it._overlays=Lt,it}return Object.defineProperty(Qe.prototype,"isNormalized",{get:function(){return this._isNormalized},set:function(we){if(this._isNormalized!==we){(0,Q.le)(we)&&(we=!1),this._isNormalized=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.isNormalized=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"dashArray",{get:function(){return this._dashArray},set:function(we){if(this._dashArray!==we){(0,Q.le)(we)&&(we=void 0),this._dashArray=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.dashArray=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"isClipped",{get:function(){return this._isClipped},set:function(we){if(this._isClipped!==we){(0,Q.le)(we)&&(we=!0),this._isClipped=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.isClipped=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"lineCap",{get:function(){return this._lineCap},set:function(we){if(this._lineCap!==we){(0,Q.le)(we)&&(we=void 0),this._lineCap=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.lineCap=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(we){if(this._lineJoin!==we){(0,Q.le)(we)&&(we=void 0),this._lineJoin=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.lineJoin=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"smoothFactor",{get:function(){return this._smoothFactor},set:function(we){if(this._smoothFactor!==we){(0,Q.le)(we)&&(we=1),this._smoothFactor=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.smoothFactor=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(we){if(this._strokeColor!==we){(0,Q.le)(we)&&(we="rgba(0, 0, 255, 1)"),this._strokeColor=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeColor=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(we){if(this._strokeOpacity!==we){(0,Q.le)(we)&&(we=1),this._strokeOpacity=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeOpacity=we}}},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(we){if(this._strokeWidth!==we){(0,Q.le)(we)&&(we=1),this._strokeWidth=we;for(var Ae=0,it=this._overlays.length;Ae<it;Ae++){var Lt=this._overlays[Ae];Lt.strokeWidth=we}}},enumerable:!0,configurable:!0}),Qe}(K.Q),m=B(86330),T=B(7388),I=B(14734),F=B(54071),q=B(3660),re=B(81891),ne=B(40355),se=B(9654),X=B(50042),ce=B(1068),Me=B(93126),Be=B(22236),ot=function(){function gt(Qe,we){this._isBoundsDirty=!0,this._isLengthDirty=!0,this._features={},this._length=0,this._id=we&&!(0,Q.le)(we.id)?we.id:(0,Q.cm)(),this._origin=Qe}return Object.defineProperty(gt.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"features",{get:function(){var Qe=this;return Object.keys(this._features).map(function(we){return Qe._features[we]})},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"overlay",{get:function(){return this._overlay},set:function(Qe){this._overlay=Qe},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"length",{get:function(){return this._isLengthDirty&&(this._length=Object.keys(this._features).length,this._isLengthDirty=!1),this._length},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"bounds",{get:function(){if(this._isBoundsDirty){var Qe=new X.c;for(var we in this._features){var Ae=this._features[we];Ae instanceof I.t?Qe.expand(Ae.point):Qe.add(Ae.bounds)}this._bounds=Qe,this._isBoundsDirty=!1}return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(gt.prototype,"center",{get:function(){return this.bounds.centerPoint},enumerable:!0,configurable:!0}),gt.prototype._addFeature=function(Qe){Qe.id||(Qe.id=(0,Q.cm)()),Qe._cluster=this.id,this._features[Qe.id]=Qe,this._isBoundsDirty=!0,this._isLengthDirty=!0},gt.prototype._removeFeature=function(Qe){Qe._cluster=void 0,delete this._features[Qe.id],this._isBoundsDirty=!0,this._isLengthDirty=!0},gt}(),Ue=B(69011),ht=function(){var gt=function(Qe,we){return gt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Ae,it){Ae.__proto__=it}||function(Ae,it){for(var Lt in it)it.hasOwnProperty(Lt)&&(Ae[Lt]=it[Lt])},gt(Qe,we)};return function(Qe,we){gt(Qe,we);function Ae(){this.constructor=Qe}Qe.prototype=we===null?Object.create(we):(Ae.prototype=we.prototype,new Ae)}}(),Et=function(gt){ht(Qe,gt);function Qe(we){we===void 0&&(we={});var Ae=gt.call(this,we)||this;return Ae.clusterEnabled=void 0,Ae.clusterSpread=void 0,(0,Q.f0)(Ae,we),Ae}return Qe.prototype.compute=function(we){return{}},Qe.prototype.filter=function(we){return we},Qe.prototype.sort=function(we){return we},Qe.prototype.style=function(we){return bi.style(we)},Qe.prototype.cluster=function(we){return bi.cluster(we)},Qe}(W.w),bi=function(gt){ht(Qe,gt);function Qe(we){var Ae=gt.call(this,we=we instanceof Et?we:new Et(we))||this;return Ae._clusters=[],Ae._features=[],Ae._lastScreenPoint=new Me.E(0,0),Ae._lastNorthWest=se.F.fromRadians(0,0),Ae._lastSouthEast=se.F.fromRadians(0,0),Ae._lastSearchBounds=new X.c,Ae._clusterEnabled=we.clusterEnabled!==void 0?we.clusterEnabled:!1,Ae._clusterSpread=we.clusterSpread!==void 0?we.clusterSpread:32,Ae}return Object.defineProperty(Qe.prototype,"overlays",{get:function(){for(var we=this._overlays.slice(),Ae=this.features,it=0,Lt=Ae.length;it<Lt;it++){var ei=Ae[it];ei.overlay&&we.push(ei.overlay)}return we},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"features",{get:function(){return this._retrieveDedupedFeatures()},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"clusters",{get:function(){return this._clusters},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"clusterEnabled",{get:function(){return this._clusterEnabled},set:function(we){this._clusterEnabled!==we&&(this._clusterEnabled=we,this.redraw())},enumerable:!0,configurable:!0}),Object.defineProperty(Qe.prototype,"clusterSpread",{get:function(){return this._clusterSpread},set:function(we){this._clusterSpread!==we&&(this._clusterSpread=we,this.redraw())},enumerable:!0,configurable:!0}),Qe.prototype._load=function(){gt.prototype._load.call(this),this.map.moving.addListener(this._onMapMoving,this),this.map.moved.addListener(this._onMapMoved,this)},Qe.prototype._unload=function(){gt.prototype._unload.call(this),this.map.moving.removeListener(this._onMapMoving,this),this.map.moved.removeListener(this._onMapMoved,this)},Qe.prototype._render=function(){if(this._isVisible){var we=this._options.filter(this.features);this._showFeatures(we)}},Qe.prototype._showFeatures=function(we){var Ae=this._options.sort(we),it=Ae,Lt=[],ei=[];if(this._clusterEnabled){var Si=this._clusterFeatures(Ae);it=Si.rendered,Lt=Si.clustered;for(var ui=this._clusters,ni=0,Bi=ui.length;ni<Bi;ni++){var Ci=ui[ni],xt=Ci.overlay;xt.cluster=null,xt.hide(),xt._removeFromlayer(this),delete this._index[Ci.id]}ui=[];for(var ze in Lt){var oe=Lt[ze],de=this._options.cluster(oe);de===void 0&&(de=Qe.cluster(oe)),de!==null&&this.map&&(oe.overlay=de,de.cluster=oe,de._addToLayer(this),this._index[de.id]=de,ui.push(oe),ei.push(de))}this._clusters=ui}for(var Re=this._overlays.slice(),He=0,mt=it.length;He<mt;He++){var Ft=it[He];if(Ft._isShown=!0,Ft.overlay)if(Ft.overlay instanceof K.Q){for(var Gt=Ft.overlay,Bt=Gt.overlays.length,Kt=0,qt=0;qt<Bt;qt++){var fi=Gt.overlays[qt];fi._zIndex=He+Kt,Kt=Kt+.1}Re.push(Ft.overlay)}else Ft.overlay._zIndex=He,Re.push(Ft.overlay)}var Ii=this._clusterEnabled?Re.concat(ei):Re;this._showOverlays(Ii)},Qe.prototype._showOverlays=function(we){for(var Ae=0,it=we.length;Ae<it;Ae++){var Lt=we[Ae];Lt.show()}switch(this.map.renderer){case Ue.Renderer.WebGL:this._updateMapboxData(!0);break}},Qe.prototype._hideFeatures=function(we){for(var Ae=[],it=0,Lt=we.length;it<Lt;it++){var ei=we[it];ei._isShown=!1,ei.overlay&&Ae.push(ei.overlay)}this._hideOverlays(Ae)},Qe.prototype._clusterFeatures=function(we){for(var Ae={},it=[],Lt=new ce.P,ei=0,Si=we.length;ei<Si;ei++){var ui=we[ei];ui._cluster=void 0,Lt.insert(ui)}for(var ni,Bi=this._map,Ci=this._clusterSpread,ei=0,Si=we.length;ei<Si;ei++){var xt=we[ei];if(xt instanceof I.t&&!xt._cluster){var ze=xt,oe=Bi.fromGeoToScreen(xt.point,this._lastScreenPoint),de=new Me.E(oe.x-Ci,oe.y-Ci),Re=new Me.E(oe.x+Ci,oe.y+Ci),He=this._map.fromScreenToGeo(de,this._lastNorthWest),mt=this._map.fromScreenToGeo(Re,this._lastSouthEast),Ft=this._lastSearchBounds;Ft.north.radians=He.latitude.radians,Ft.west.radians=He.longitude.radians,Ft.south.radians=mt.latitude.radians,Ft.east.radians=mt.longitude.radians;var Gt=[];if(Lt.retrieve(Ft,Gt),Gt.length>1){ni=new ot(ze.point);for(var Bt=0,Kt=Gt.length;Bt<Kt;Bt++){var qt=Gt[Bt];if(!qt._cluster)ni._addFeature(qt);else{var fi=Ae[qt._cluster],Ii=Be.r.fromPoints(qt.point,fi._origin),zi=Be.r.fromPoints(qt.point,ni._origin);zi.meters<Ii.meters&&(fi._removeFeature(qt),ni._addFeature(qt))}}ni.length>1?Ae[ni.id]=ni:(ze._cluster=void 0,it.push(ze))}else ze._cluster||it.push(ze)}else xt._cluster||it.push(xt)}for(var Yt in Ae){var ur=Ae[Yt];if(ur.length===1){var yi=ur.features[0];ur._removeFeature(yi),it.push(yi),delete Ae[Yt]}}return{rendered:it,clustered:Ae}},Qe.prototype._retrieveAllOverlays=function(){for(var we=this._overlays.slice(),Ae=this._retrieveAllFeatures(),it=0,Lt=Ae.length;it<Lt;it++){var ei=Ae[it];ei.overlay&&we.push(ei.overlay)}return we},Qe.prototype._retrieveAllFeatures=function(){return this._features},Qe.prototype._retrieveDedupedFeatures=function(){for(var we={},Ae=0,it=this._features.length;Ae<it;Ae++){var Lt=this._features[Ae];(!we.hasOwnProperty(Lt.id)||Lt._isShown)&&(we[Lt.id]=Lt)}var ei=Object.keys(we).map(function(Si){return we[Si]});return ei},Qe.prototype._retrieveValidFeatures=function(){return this._retrieveDedupedFeatures()},Qe.prototype._styleFeatures=function(we){for(var Ae=0,it=we.length;Ae<it;Ae++){var Lt=we[Ae],ei=Lt.overlay;ei||(ei=this._options.style(Lt),ei===void 0&&(ei=Qe.style(Lt)),Lt.overlay=ei),ei!==null&&(Lt.overlay.feature=Lt,this._index[Lt.overlay.id]=Lt.overlay,this.map&&ei._addToLayer(this))}},Qe.style=function(we){var Ae=null;if(we instanceof I.t||we instanceof z.f){var it=new h.v;if(it.strokeColor="rgb(0, 0, 255)",it.strokeWidth=1,it.strokeOpacity=1,it.fillColor="rgb(0, 0, 255)",it.fillOpacity=.2,it.enableFill=!0,it.radius=5,we instanceof I.t){var Lt=we;Ae=new h.c(Lt.point,it)}else if(we instanceof z.f){var ei=we;Ae=new A(ei.points,it)}}else if(we instanceof F.P||we instanceof R.m){var Si=new C.C;if(Si.strokeColor="rgb(0, 0, 255)",Si.strokeWidth=1,Si.strokeOpacity=1,we instanceof F.P){var ui=we;Ae=new C.E(ui.polyline,Si)}else if(we instanceof R.m){var ni=we;Ae=new v(ni.polylines,Si)}}else if(we instanceof q.L||we instanceof m.f){var Bi=new re.V;if(Bi.strokeColor="rgb(0, 0, 255)",Bi.strokeWidth=1,Bi.strokeOpacity=1,Bi.fillColor="rgb(0, 0, 255)",Bi.fillOpacity=.2,Bi.enableFill=!0,we instanceof q.L){var Ci=we;Ae=new re.n(Ci.polygon,Bi)}else if(we instanceof m.f){var xt=we;Ae=new T.H(xt.polygons,Bi)}}return Ae},Qe.cluster=function(we){var Ae=we.length,it=we.center,Lt;Ae>99999?Lt=Ae.toExponential(0).replace("+",""):Ae>9999?Lt=Math.floor(Ae/1e3)+"k":Ae>999?Lt=(Ae/1e3).toFixed(1)+"k":Lt=Ae.toString();var ei=new h.v;ei.strokeColor="rgb(0, 0, 255)",ei.strokeWidth=1,ei.strokeOpacity=1,ei.fillColor="rgb(0, 0, 255)",ei.fillOpacity=.5,ei.enableFill=!0,ei.radius=14;var Si=new h.c(it,ei),ui=new ne.u;ui.fontColor="rgb(255, 255, 255)";var ni=new ne.N(it,Lt,ui),Bi=new K.Q([Si,ni]);return Bi},Qe.prototype.addFeature=function(we){this.addFeatures([we])},Qe.prototype.addFeatures=function(we){for(var Ae=0,it=we.length;Ae<it;Ae++){var Lt=we[Ae];this._features.push(Lt),Lt._layer=this,Lt.computed=this._options.compute(Lt),this._styleFeatures([Lt])}this.map&&this._isVisible&&this._showFeatures(we)},Qe.prototype.removeFeature=function(we){this.removeFeatures([we])},Qe.prototype.removeFeatures=function(we){for(var Ae=[],it=[],Lt=this.features,ei=0,Si=Lt.length;ei<Si;ei++){for(var ui=Lt[ei],ni=!1,Bi=0,Ci=we.length;Bi<Ci;Bi++){var xt=we[Bi];if(ui===xt){ni=!0;break}}ni?it.push(ui):Ae.push(ui)}var ze=it.map(function(oe){return oe.overlay});this._unloadOverlays(ze),this._features=Ae},Qe.prototype.clearFeatures=function(){this.removeFeatures(this.features),this._features=[]},Qe.prototype.restyle=function(){if(this.map&&this.map.isEnabled){for(var we=this._retrieveAllFeatures(),Ae=0,it=we.length;Ae<it;Ae++){var Lt=we[Ae];Lt.overlay&&(Lt.overlay.hide(),Lt.overlay._removeFromlayer(this),Lt.overlay=void 0)}this._styleFeatures(we),this.redraw()}},Qe.prototype.redraw=function(){var we=this._retrieveAllFeatures();this._hideFeatures(we),this._render()},Qe.prototype._onMapMoving=function(we){this._toggleVisibility(),this.update()},Qe.prototype._onMapMoved=function(we){this._toggleVisibility(),this.update()},Qe}(W.s)},21574:(ct,Ye,B)=>{"use strict";B.d(Ye,{$:()=>h});var Q=B(68575),W=function(){var K=function(k,A){return K=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(z,R){z.__proto__=R}||function(z,R){for(var C in R)R.hasOwnProperty(C)&&(z[C]=R[C])},K(k,A)};return function(k,A){K(k,A);function z(){this.constructor=k}k.prototype=A===null?Object.create(A):(z.prototype=A.prototype,new z)}}(),h=function(K){W(k,K);function k(){var A=K!==null&&K.apply(this,arguments)||this;return A.features=[],A.query="",A}return Object.defineProperty(k.prototype,"key",{get:function(){var A="";return this.range?(A+=this.range.toEpochString(),A+="_"):this.time&&(A+=this.time.getTime().toString(),A+="_"),A+=this.z.toString(),A+="_",A+=this.x.toString(),A+="_",A+=this.y.toString(),A},enumerable:!0,configurable:!0}),k}(Q.n)},56278:(ct,Ye,B)=>{"use strict";B.d(Ye,{w:()=>z,s:()=>R});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(35992),k=B(69011),A=function(){var C=function(x,v){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var I in T)T.hasOwnProperty(I)&&(m[I]=T[I])},C(x,v)};return function(x,v){C(x,v);function m(){this.constructor=x}x.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}}(),z=function(C){A(x,C);function x(v){v===void 0&&(v={});var m=C.call(this,v)||this;return m.allowTextCollision=void 0,m.allowImageCollision=void 0,m.textPadding=void 0,m.imagePadding=void 0,(0,h.f0)(m,v),m}return x}(K.M),R=function(C){A(x,C);function x(v){var m=C.call(this,v=v instanceof z?v:new z(v))||this;return m._styleOrder=["polygon","polyline","circle","image","text"],m._overlays=[],m._isVisible=!1,m._index={},m._throttle=30,m._mapboxIsQueued=!1,m._mapboxIsLoading=!1,m._mapboxIsPending=!1,m._mapboxData={type:"FeatureCollection",features:[]},m._mapboxFeatures={},m._mapboxCircleMarkerLayer={id:m.id+"_circle",type:"circle",source:m.id,filter:["==","type","CircleMarker"],paint:{"circle-radius-transition":x.TRANSITION,"circle-color-transition":x.TRANSITION,"circle-opacity-transition":x.TRANSITION,"circle-stroke-color-transition":x.TRANSITION,"circle-stroke-width-transition":x.TRANSITION,"circle-stroke-opacity-transition":x.TRANSITION,"circle-radius":{property:"circle-radius",type:"identity"},"circle-color":{property:"circle-color",type:"identity"},"circle-opacity":{property:"circle-opacity",type:"identity"},"circle-stroke-color":{property:"circle-stroke-color",type:"identity"},"circle-stroke-width":{property:"circle-stroke-width",type:"identity"},"circle-stroke-opacity":{property:"circle-stroke-opacity",type:"identity"}},layout:{}},m._mapboxCirclePathFillLayer={id:m.id+"_circlePath",type:"fill",source:m.id,filter:["==","type","CirclePath"],paint:{"fill-opacity-transition":x.TRANSITION,"fill-color-transition":x.TRANSITION,"fill-opacity":{property:"fill-opacity",type:"identity"},"fill-color":{property:"fill-color",type:"identity"},"fill-antialias":!1},layout:{}},m._mapboxCirclePathLineLayer={id:m.id+"_circlePathLine",type:"line",source:m._id,filter:["==","type","CirclePath"],paint:{"line-width-transition":x.TRANSITION,"line-color-transition":x.TRANSITION,"line-opacity-transition":x.TRANSITION,"line-width":{property:"line-width",type:"identity"},"line-color":{property:"line-color",type:"identity"},"line-opacity":{property:"line-opacity",type:"identity"}},layout:{"line-join":"round","line-cap":"round"}},m._mapboxFillLayer={id:m.id+"_fill",type:"fill",source:m.id,filter:["==","type","PolygonPath"],paint:{"fill-opacity-transition":x.TRANSITION,"fill-color-transition":x.TRANSITION,"fill-opacity":{property:"fill-opacity",type:"identity"},"fill-color":{property:"fill-color",type:"identity"},"fill-antialias":!1},layout:{}},m._mapboxFillLineLayer={id:m.id+"_fillLine",type:"line",source:m._id,filter:["==","type","PolygonPath"],paint:{"line-width-transition":x.TRANSITION,"line-color-transition":x.TRANSITION,"line-opacity-transition":x.TRANSITION,"line-width":{property:"line-width",type:"identity"},"line-color":{property:"line-color",type:"identity"},"line-opacity":{property:"line-opacity",type:"identity"}},layout:{"line-join":"round","line-cap":"round"}},m._mapboxLineLayer={id:m.id+"_line",type:"line",source:m._id,filter:["==","type","PolylinePath"],paint:{"line-width-transition":x.TRANSITION,"line-color-transition":x.TRANSITION,"line-opacity-transition":x.TRANSITION,"line-width":{property:"line-width",type:"identity"},"line-color":{property:"line-color",type:"identity"},"line-opacity":{property:"line-opacity",type:"identity"}},layout:{"line-join":"round","line-cap":"round"}},m._mapboxTextLayer={id:m.id+"_text",type:"symbol",source:m._id,filter:["==","type","TextMarker"],layout:{"symbol-z-order":"source","symbol-sort-key":["get","zIndex"],"text-padding":.5,"text-allow-overlap":!0,"text-anchor":{property:"text-anchor",type:"identity"},"text-max-width":{property:"text-max-width",type:"identity"},"text-letter-spacing":{property:"text-letter-spacing",type:"identity"},"text-justify":{property:"text-justify",type:"identity"},"text-field":["string",["get","text-field"]],"text-size":{property:"text-size",type:"identity"},"text-offset":{property:"text-offset",type:"identity"},"text-rotate":{property:"text-rotate",type:"identity"},"text-font":{property:"text-font",type:"categorical",stops:[["IBM Plex Mono normal normal",["IBM Plex Mono Regular"]],["IBM Plex Mono bold normal",["IBM Plex Mono Bold"]],["IBM Plex Mono 100 normal",["IBM Plex Mono Thin"]],["IBM Plex Mono 200 normal",["IBM Plex Mono ExtraLight"]],["IBM Plex Mono 300 normal",["IBM Plex Mono Light"]],["IBM Plex Mono 400 normal",["IBM Plex Mono Regular"]],["IBM Plex Mono 500 normal",["IBM Plex Mono Text"]],["IBM Plex Mono 600 normal",["IBM Plex Mono Medium"]],["IBM Plex Mono 700 normal",["IBM Plex Mono SemiBold"]],["IBM Plex Mono 800 normal",["IBM Plex Mono Bold"]],["IBM Plex Mono 900 normal",["IBM Plex Mono Bold"]],["IBM Plex Mono normal italic",["IBM Plex Mono Italic"]],["IBM Plex Mono bold italic",["IBM Plex Mono SemiBold Italic"]],["IBM Plex Mono 100 italic",["IBM Plex Mono Thin Italic"]],["IBM Plex Mono 200 italic",["IBM Plex Mono ExtraLight Italic"]],["IBM Plex Mono 300 italic",["IBM Plex Mono Light Italic"]],["IBM Plex Mono 400 italic",["IBM Plex Mono Italic"]],["IBM Plex Mono 500 italic",["IBM Plex Mono Text Italic"]],["IBM Plex Mono 600 italic",["IBM Plex Mono Medium Italic"]],["IBM Plex Mono 700 italic",["IBM Plex Mono SemiBold Italic"]],["IBM Plex Mono 800 italic",["IBM Plex Mono Bold Italic"]],["IBM Plex Mono 900 italic",["IBM Plex Mono Bold Italic"]],["IBM Plex Sans normal normal",["IBM Plex Sans Regular"]],["IBM Plex Sans bold normal",["IBM Plex Sans SemiBold"]],["IBM Plex Sans 100 normal",["IBM Plex Sans Thin"]],["IBM Plex Sans 200 normal",["IBM Plex Sans ExtraLight"]],["IBM Plex Sans 300 normal",["IBM Plex Sans Light"]],["IBM Plex Sans 400 normal",["IBM Plex Sans Regular"]],["IBM Plex Sans 500 normal",["IBM Plex Sans Text"]],["IBM Plex Sans 600 normal",["IBM Plex Sans Medium"]],["IBM Plex Sans 700 normal",["IBM Plex Sans SemiBold"]],["IBM Plex Sans 800 normal",["IBM Plex Sans Bold"]],["IBM Plex Sans 900 normal",["IBM Plex Sans Bold"]],["IBM Plex Sans normal italic",["IBM Plex Sans Italic"]],["IBM Plex Sans bold italic",["IBM Plex Sans SemiBold Italic"]],["IBM Plex Sans 100 italic",["IBM Plex Sans Thin Italic"]],["IBM Plex Sans 200 italic",["IBM Plex Sans ExtraLight Italic"]],["IBM Plex Sans 300 italic",["IBM Plex Sans Light Italic"]],["IBM Plex Sans 400 italic",["IBM Plex Sans Italic"]],["IBM Plex Sans 500 italic",["IBM Plex Sans Text Italic"]],["IBM Plex Sans 600 italic",["IBM Plex Sans Medium Italic"]],["IBM Plex Sans 700 italic",["IBM Plex Sans SemiBold Italic"]],["IBM Plex Sans 800 italic",["IBM Plex Sans Bold Italic"]],["IBM Plex Sans 900 italic",["IBM Plex Sans Bold Italic"]],["IBM Plex Sans Condensed normal normal",["IBM Plex Sans Condensed Regular"]],["IBM Plex Sans Condensed bold normal",["IBM Plex Sans Condensed SemiBold"]],["IBM Plex Sans Condensed 100 normal",["IBM Plex Sans Condensed Thin"]],["IBM Plex Sans Condensed 200 normal",["IBM Plex Sans Condensed ExtraLight"]],["IBM Plex Sans Condensed 300 normal",["IBM Plex Sans Condensed Light"]],["IBM Plex Sans Condensed 400 normal",["IBM Plex Sans Condensed Regular"]],["IBM Plex Sans Condensed 500 normal",["IBM Plex Sans Condensed Text"]],["IBM Plex Sans Condensed 600 normal",["IBM Plex Sans Condensed Medium"]],["IBM Plex Sans Condensed 700 normal",["IBM Plex Sans Condensed SemiBold"]],["IBM Plex Sans Condensed 800 normal",["IBM Plex Sans Condensed Bold"]],["IBM Plex Sans Condensed 900 normal",["IBM Plex Sans Condensed Bold"]],["IBM Plex Sans Condensed normal italic",["IBM Plex Sans Condensed Italic"]],["IBM Plex Sans Condensed bold italic",["IBM Plex Sans Condensed SemiBold Italic"]],["IBM Plex Sans Condensed 100 italic",["IBM Plex Sans Condensed Thin Italic"]],["IBM Plex Sans Condensed 200 italic",["IBM Plex Sans Condensed ExtraLight Italic"]],["IBM Plex Sans Condensed 300 italic",["IBM Plex Sans Condensed Light Italic"]],["IBM Plex Sans Condensed 400 italic",["IBM Plex Sans Condensed Italic"]],["IBM Plex Sans Condensed 500 italic",["IBM Plex Sans Condensed Text Italic"]],["IBM Plex Sans Condensed 600 italic",["IBM Plex Sans Condensed Medium Italic"]],["IBM Plex Sans Condensed 700 italic",["IBM Plex Sans Condensed SemiBold Italic"]],["IBM Plex Sans Condensed 800 italic",["IBM Plex Sans Condensed Bold Italic"]],["IBM Plex Sans Condensed 900 italic",["IBM Plex Sans Condensed Bold Italic"]],["IBM Plex Serif normal normal",["IBM Plex Serif Regular"]],["IBM Plex Serif bold normal",["IBM Plex Serif Bold"]],["IBM Plex Serif 100 normal",["IBM Plex Serif Thin"]],["IBM Plex Serif 200 normal",["IBM Plex Serif ExtraLight"]],["IBM Plex Serif 300 normal",["IBM Plex Serif Light"]],["IBM Plex Serif 400 normal",["IBM Plex Serif Regular"]],["IBM Plex Serif 500 normal",["IBM Plex Serif Text"]],["IBM Plex Serif 600 normal",["IBM Plex Serif Medium"]],["IBM Plex Serif 700 normal",["IBM Plex Serif SemiBold"]],["IBM Plex Serif 800 normal",["IBM Plex Serif Bold"]],["IBM Plex Serif 900 normal",["IBM Plex Serif Bold"]],["IBM Plex Serif normal italic",["IBM Plex Serif Italic"]],["IBM Plex Serif bold italic",["IBM Plex Serif Bold Italic"]],["IBM Plex Serif 100 italic",["IBM Plex Serif Thin Italic"]],["IBM Plex Serif 200 italic",["IBM Plex Serif ExtraLight Italic"]],["IBM Plex Serif 300 italic",["IBM Plex Serif Light Italic"]],["IBM Plex Serif 400 italic",["IBM Plex Serif Italic"]],["IBM Plex Serif 500 italic",["IBM Plex Serif Text Italic"]],["IBM Plex Serif 600 italic",["IBM Plex Serif Medium Italic"]],["IBM Plex Serif 700 italic",["IBM Plex Serif SemiBold Italic"]],["IBM Plex Serif 800 italic",["IBM Plex Serif Bold Italic"]],["IBM Plex Serif 900 italic",["IBM Plex Serif Bold Italic"]],["Roboto normal normal",["Roboto Regular"]],["Roboto bold normal",["Roboto Bold"]],["Roboto 100 normal",["Roboto Thin"]],["Roboto 200 normal",["Roboto Thin"]],["Roboto 300 normal",["Roboto Light"]],["Roboto 400 normal",["Roboto Regular"]],["Roboto 500 normal",["Roboto Medium"]],["Roboto 600 normal",["Roboto Bold"]],["Roboto 700 normal",["Roboto Bold"]],["Roboto 800 normal",["Roboto Black"]],["Roboto 900 normal",["Roboto Black"]],["Roboto normal italic",["Roboto Italic"]],["Roboto bold italic",["Roboto Bold Italic"]],["Roboto 100 italic",["Roboto Thin Italic"]],["Roboto 200 italic",["Roboto Thin Italic"]],["Roboto 300 italic",["Roboto Light Italic"]],["Roboto 400 italic",["Roboto Italic"]],["Roboto 500 italic",["Roboto Medium Italic"]],["Roboto 600 italic",["Roboto Bold Italic"]],["Roboto 700 italic",["Roboto Bold Italic"]],["Roboto 800 italic",["Roboto Black Italic"]],["Roboto 900 italic",["Roboto Black Italic"]],["Open Sans normal normal",["Open Sans Regular"]],["Open Sans bold normal",["Open Sans Bold"]],["Open Sans 100 normal",["Open Sans Light"]],["Open Sans 200 normal",["Open Sans Light"]],["Open Sans 300 normal",["Open Sans Light"]],["Open Sans 400 normal",["Open Sans Regular"]],["Open Sans 500 normal",["Open Sans Regular"]],["Open Sans 600 normal",["Open Sans SemiBold"]],["Open Sans 700 normal",["Open Sans Bold"]],["Open Sans 800 normal",["Open Sans ExtraBold"]],["Open Sans 900 normal",["Open Sans ExtraBold"]],["Open Sans normal italic",["Open Sans Italic"]],["Open Sans bold italic",["Open Sans Bold Italic"]],["Open Sans 100 italic",["Open Sans Light Italic"]],["Open Sans 200 italic",["Open Sans Light Italic"]],["Open Sans 300 italic",["Open Sans Light Italic"]],["Open Sans 400 italic",["Open Sans Italic"]],["Open Sans 500 italic",["Open Sans Italic"]],["Open Sans 600 italic",["Open Sans Semibold Italic"]],["Open Sans 700 italic",["Open Sans Bold Italic"]],["Open Sans 800 italic",["Open Sans ExtraBold Italic"]],["Open Sans 900 italic",["Open Sans ExtraBold Italic"]],["Source Code Pro normal normal",["Source Code Pro Regular"]],["Source Code Pro bold normal",["Source Code Pro Bold"]],["Source Code Pro 100 normal",["Source Code Pro ExtraLight"]],["Source Code Pro 200 normal",["Source Code Pro ExtraLight"]],["Source Code Pro 300 normal",["Source Code Pro Light"]],["Source Code Pro 400 normal",["Source Code Pro Regular"]],["Source Code Pro 500 normal",["Source Code Pro Regular"]],["Source Code Pro 600 normal",["Source Code Pro Semibold"]],["Source Code Pro 700 normal",["Source Code Pro Bold"]],["Source Code Pro 800 normal",["Source Code Pro Black"]],["Source Code Pro 900 normal",["Source Code Pro Black"]],["Source Code Pro normal italic",["Source Code Pro Regular"]],["Source Code Pro bold italic",["Source Code Pro Bold"]],["Source Code Pro 100 italic",["Source Code Pro ExtraLight"]],["Source Code Pro 200 italic",["Source Code Pro ExtraLight"]],["Source Code Pro 300 italic",["Source Code Pro Light"]],["Source Code Pro 400 italic",["Source Code Pro Regular"]],["Source Code Pro 500 italic",["Source Code Pro Regular"]],["Source Code Pro 600 italic",["Source Code Pro Semibold"]],["Source Code Pro 700 italic",["Source Code Pro Bold"]],["Source Code Pro 800 italic",["Source Code Pro Black"]],["Source Code Pro 900 italic",["Source Code Pro Black"]],["DIN Offc Pro normal normal",["DIN Offc Pro Regular"]],["DIN Offc Pro bold normal",["DIN Offc Pro Bold"]],["DIN Offc Pro 100 normal",["DIN Offc Pro Light"]],["DIN Offc Pro 200 normal",["DIN Offc Pro Light"]],["DIN Offc Pro 300 normal",["DIN Offc Pro Light"]],["DIN Offc Pro 400 normal",["DIN Offc Pro Regular"]],["DIN Offc Pro 500 normal",["DIN Offc Pro Medium"]],["DIN Offc Pro 600 normal",["DIN Offc Pro Bold"]],["DIN Offc Pro 700 normal",["DIN Offc Pro Bold"]],["DIN Offc Pro 800 normal",["DIN Offc Pro Black"]],["DIN Offc Pro 900 normal",["DIN Offc Pro Black"]],["DIN Offc Pro normal italic",["DIN Offc Pro Italic"]],["DIN Offc Pro bold italic",["DIN Offc Pro Bold Italic"]],["DIN Offc Pro 100 italic",["DIN Offc Pro Light Italic"]],["DIN Offc Pro 200 italic",["DIN Offc Pro Light Italic"]],["DIN Offc Pro 300 italic",["DIN Offc Pro Light Italic"]],["DIN Offc Pro 400 italic",["DIN Offc Pro Italic"]],["DIN Offc Pro 500 italic",["DIN Offc Pro Medium Italic"]],["DIN Offc Pro 600 italic",["DIN Offc Pro Bold Italic"]],["DIN Offc Pro 700 italic",["DIN Offc Pro Bold Italic"]],["DIN Offc Pro 800 italic",["DIN Offc Pro Black Italic"]],["DIN Offc Pro 900 italic",["DIN Offc Pro Black Italic"]],["DIN Offc Pro Cond normal normal",["DIN Offc Pro Cond Regular"]],["DIN Offc Pro Cond bold normal",["DIN Offc Pro Cond Bold"]],["DIN Offc Pro Cond 100 normal",["DIN Offc Pro Cond Light"]],["DIN Offc Pro Cond 200 normal",["DIN Offc Pro Cond Light"]],["DIN Offc Pro Cond 300 normal",["DIN Offc Pro Cond Light"]],["DIN Offc Pro Cond 400 normal",["DIN Offc Pro Cond Regular"]],["DIN Offc Pro Cond 500 normal",["DIN Offc Pro Cond Medium"]],["DIN Offc Pro Cond 600 normal",["DIN Offc Pro Cond Bold"]],["DIN Offc Pro Cond 700 normal",["DIN Offc Pro Cond Bold"]],["DIN Offc Pro Cond 800 normal",["DIN Offc Pro Cond Black"]],["DIN Offc Pro Cond 900 normal",["DIN Offc Pro Cond Black"]],["DIN Offc Pro Cond normal italic",["DIN Offc Pro Cond Italic"]],["DIN Offc Pro Cond bold italic",["DIN Offc Pro Cond Bold Italic"]],["DIN Offc Pro Cond 100 italic",["DIN Offc Pro Cond Light Italic"]],["DIN Offc Pro Cond 200 italic",["DIN Offc Pro Cond Light Italic"]],["DIN Offc Pro Cond 300 italic",["DIN Offc Pro Cond Light Italic"]],["DIN Offc Pro Cond 400 italic",["DIN Offc Pro Cond Italic"]],["DIN Offc Pro Cond 500 italic",["DIN Offc Pro Cond Medium Italic"]],["DIN Offc Pro Cond 600 italic",["DIN Offc Pro Cond Bold Italic"]],["DIN Offc Pro Cond 700 italic",["DIN Offc Pro Cond Bold Italic"]],["DIN Offc Pro Cond 800 italic",["DIN Offc Pro Cond Black Italic"]],["DIN Offc Pro Cond 900 italic",["DIN Offc Pro Cond Black Italic"]],["Ubuntu normal normal",["Ubuntu Regular"]],["Ubuntu bold normal",["Ubuntu Bold"]],["Ubuntu 100 normal",["Ubuntu Light"]],["Ubuntu 200 normal",["Ubuntu Light"]],["Ubuntu 300 normal",["Ubuntu Light"]],["Ubuntu 400 normal",["Ubuntu Regular"]],["Ubuntu 500 normal",["Ubuntu Medium"]],["Ubuntu 600 normal",["Ubuntu Bold"]],["Ubuntu 700 normal",["Ubuntu Bold"]],["Ubuntu 800 normal",["Ubuntu Bold"]],["Ubuntu 900 normal",["Ubuntu Bold"]],["Ubuntu normal italic",["Ubuntu Italic"]],["Ubuntu bold italic",["Ubuntu Bold Italic"]],["Ubuntu 100 italic",["Ubuntu Light Italic"]],["Ubuntu 200 italic",["Ubuntu Light Italic"]],["Ubuntu 300 italic",["Ubuntu Light Italic"]],["Ubuntu 400 italic",["Ubuntu Italic"]],["Ubuntu 500 italic",["Ubuntu Medium Italic"]],["Ubuntu 600 italic",["Ubuntu Bold Italic"]],["Ubuntu 700 italic",["Ubuntu Bold Italic"]],["Ubuntu 800 italic",["Ubuntu Bold Italic"]],["Ubuntu 900 italic",["Ubuntu Bold Italic"]]]}},paint:{"text-color-transition":x.TRANSITION,"text-opacity-transition":x.TRANSITION,"text-halo-color-transition":x.TRANSITION,"text-halo-width-transition":x.TRANSITION,"text-color":{property:"text-color",type:"identity"},"text-opacity":{property:"text-opacity",type:"identity"},"text-halo-color":{property:"text-halo-color",type:"identity"},"text-halo-width":{property:"text-halo-width",type:"identity"}}},m._mapboxImageLayer={id:m.id+"_image",type:"symbol",source:m._id,filter:["==","type","ImageMarker"],layout:{"symbol-z-order":"source","symbol-sort-key":["get","zIndex"],"icon-ignore-placement":!0,"icon-padding":.5,"icon-allow-overlap":!0,"icon-rotation-alignment":"map","icon-size":{property:"icon-size",type:"identity"},"icon-image":{property:"icon-image",type:"identity"},"icon-offset":{property:"icon-offset",type:"identity"},"icon-rotate":{property:"icon-rotate",type:"identity"},"icon-anchor":{property:"icon-anchor",type:"identity"}},paint:{"icon-opacity":{property:"icon-opacity",type:"identity"},"icon-opacity-transition":{duration:0,delay:0}}},m._mapboxImageLayer.layout["icon-allow-overlap"]=v.allowImageCollision!==void 0?v.allowImageCollision:!0,m._mapboxImageLayer.layout["icon-ignore-placement"]=v.allowImageCollision!==void 0?v.allowImageCollision:!0,m._mapboxImageLayer.layout["icon-padding"]=v.imagePadding!==void 0?v.imagePadding:0,m._mapboxTextLayer.layout["text-allow-overlap"]=v.allowTextCollision!==void 0?v.allowTextCollision:!0,m._mapboxTextLayer.layout["text-padding"]=v.textPadding!==void 0?v.textPadding:0,m}return Object.defineProperty(x.prototype,"overlays",{get:function(){return this._overlays},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"styleOrder",{get:function(){return this._styleOrder},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"allowImageCollision",{get:function(){return this._mapboxImageLayer.layout["icon-allow-overlap"]},set:function(v){v!==this._mapboxImageLayer.layout["icon-allow-overlap"]&&(this._mapboxImageLayer.layout["icon-allow-overlap"]=v,this._map._mapboxEngine.setLayoutProperty(this.id+"_image","icon-allow-overlap",v),this._map._mapboxEngine.setLayoutProperty(this.id+"_image","icon-ignore-placement",v))},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"imagePadding",{get:function(){return this._mapboxImageLayer.layout["icon-padding"]},set:function(v){v!==this._mapboxImageLayer.layout["icon-padding"]&&(this._mapboxImageLayer.layout["icon-padding"]=v,this.allowImageCollision&&this._map._mapboxEngine.setLayoutProperty(this.id+"_image","icon-padding",v))},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"allowTextCollision",{get:function(){return this._mapboxTextLayer.layout["text-allow-overlap"]},set:function(v){v!==this._mapboxTextLayer.layout["text-allow-overlap"]&&(this._mapboxTextLayer.layout["text-allow-overlap"]=v,this._map._mapboxEngine.setLayoutProperty(this.id+"_text","text-allow-overlap",v))},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"textPadding",{get:function(){return this._mapboxTextLayer.layout["text-padding"]},set:function(v){v!==this._mapboxTextLayer.layout["text-padding"]&&(this._mapboxTextLayer.layout["text-padding"]=v,this.allowTextCollision&&this._map._mapboxEngine.setLayoutProperty(this.id+"_text","text-padding",v))},enumerable:!0,configurable:!0}),x.prototype._load=function(){switch(this._changeLoadState(h.jd.Loading),this.map.renderer){case k.Renderer.WebDOM:this._loadLeaflet();break;case k.Renderer.WebGL:this._loadMapbox();break}this.overlays.length>0&&this._loadOverlays(this.overlays),this._toggleVisibility(),this.map.zoomed.addListener(this._onMapZoomed,this),this._changeLoadState(h.jd.Loaded)},x.prototype._unload=function(){switch(this.map.zoomed.removeListener(this._onMapZoomed,this),this.clearOverlays(),this.map.renderer){case k.Renderer.WebDOM:this._unloadLeaflet();break;case k.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(h.jd.Unloaded)},x.prototype._show=function(){this._isVisible||(this._isVisible=!0,this._render())},x.prototype._hide=function(){this._isVisible&&(this._hideOverlays(this.overlays),this._isVisible=!1)},x.prototype._render=function(){this._isVisible&&this._showOverlays(this.overlays)},x.prototype._toggleVisibility=function(){var v=this.map.zoomLevel;v<this.minimumZoom||v>this.maximumZoom?this._hide():v>=this.minimumZoom&&v<=this.maximumZoom&&this._show()},x.prototype._loadOverlays=function(v){if(this.map)for(var m=0,T=v.length;m<T;m++){var I=v[m];I._addToLayer(this)}},x.prototype._retrieveAllOverlays=function(){return this._overlays},x.prototype._unloadOverlays=function(v){if(this.map){for(var m=0,T=v.length;m<T;m++){var I=v[m];I.hide(),I._removeFromlayer(this),delete this._index[I.id]}switch(this.map.renderer){case k.Renderer.WebGL:this._updateMapboxData(!0);break}}},x.prototype._showOverlays=function(v){for(var m=0,T=v.length;m<T;m++){var I=v[m];I._zIndex=m,I.show()}switch(this.map.renderer){case k.Renderer.WebGL:this._updateMapboxData(!0);break}},x.prototype._hideOverlays=function(v){for(var m=0,T=v.length;m<T;m++){var I=v[m];I.hide()}switch(this.map.renderer){case k.Renderer.WebGL:this._updateMapboxData(!0);break}},x.prototype._changeOpacity=function(v){if(!(0,h.le)(v)&&v!=this._opacity){var m=this._opacity;if(this._opacity=v,this.map)switch(this.map.renderer){case k.Renderer.WebDOM:this._leafletPane.style.opacity=v;break;case k.Renderer.WebGL:this._setMapboxOpacity();break}this.opacityChanged.trigger({old:m,new:v})}},x.prototype.update=function(){this._hideOverlays(this.overlays),this._render(),this.updated.trigger({id:this.id})},x.prototype.addOverlay=function(v){this.addOverlays([v])},x.prototype.addOverlays=function(v){for(var m=0,T=v.length;m<T;m++){var I=v[m];this._index[I._id]=I,this._overlays.push(I)}this._map&&(this._loadOverlays(v),this._isVisible&&this._showOverlays(v)),this.updated.trigger({id:this.id})},x.prototype.removeOverlay=function(v){this.removeOverlays([v])},x.prototype.removeOverlays=function(v){for(var m=[],T=[],I=this._retrieveAllOverlays(),F=0,q=I.length;F<q;F++){for(var re=I[F],ne=!1,se=0,X=v.length;se<X;se++){var ce=v[se];if(re===ce){ne=!0;break}}ne?T.push(re):m.push(re)}this._unloadOverlays(T),this._overlays=m,this.updated.trigger({id:this.id})},x.prototype.clearOverlays=function(){var v=this._retrieveAllOverlays();this._unloadOverlays(v),this._index={},this._overlays=[],this.updated.trigger({id:this.id})},x.prototype.arrangeStyle=function(v,m){switch(v){case"fill":v="polygon";break;case"line":v="polyline";break}if(!(this._styleOrder.indexOf(v)<0)){m>this._styleOrder.length-1?m=this._styleOrder.length-1:m<0&&(m=0);var T=this._styleOrder.indexOf(v);switch(this._styleOrder.splice(T,1),this._styleOrder.splice(m,0,v),this.map.renderer){case k.Renderer.WebGL:this._unloadMapboxGroup(),this._sortMapboxGroup(),this._loadMapboxGroup();break;case k.Renderer.WebDOM:this._sortLeaflet();break}}},x.prototype.arrangeStyleDown=function(v){switch(v){case"fill":v="polygon";break;case"line":v="polyline";break}if(!(this._styleOrder.indexOf(v)<0)){var m=this._styleOrder.indexOf(v);if(!(m<1)){var T=m-1;this.arrangeStyle(v,T)}}},x.prototype.arrangeStyleUp=function(v){switch(v){case"fill":v="polygon";break;case"line":v="polyline";break}if(!(this._styleOrder.indexOf(v)<0)){var m=this._styleOrder.indexOf(v);if(m!==this._styleOrder.length-1){var T=m+1;this.arrangeStyle(v,T)}}},x.prototype._loadLeaflet=function(){var v=this.map._leafletEngine;this._leafletPane=v.createPane(this.id),this._leafletRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletRenderer.options.pane=this._leafletPane,this._leafletLayer=new(W()).FeatureGroup([]),this.map._leafletEngine.addLayer(this._leafletLayer),this._leafletPolylinePane=v.createPane(this.id+"_polylines"),this._leafletPolylineRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletPolylineRenderer.options.pane=this._leafletPolylinePane,this._leafletPane.appendChild(this._leafletPolylinePane),this._leafletPolygonPane=v.createPane(this.id+"_polygons"),this._leafletPolygonRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletPolygonRenderer.options.pane=this._leafletPolygonPane,this._leafletPane.appendChild(this._leafletPolygonPane),this._leafletCirclePane=v.createPane(this.id+"_circles"),this._leafletCircleRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletCircleRenderer.options.pane=this._leafletCirclePane,this._leafletPane.appendChild(this._leafletCirclePane),this._leafletTextPane=v.createPane(this.id+"_text"),this._leafletTextRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletTextRenderer.options.pane=this._leafletTextPane,this._leafletPane.appendChild(this._leafletTextPane),this._leafletImagePane=v.createPane(this.id+"_image"),this._leafletImageRenderer=W().SVG&&W().svg()||W().Canvas&&W().canvas(),this._leafletImageRenderer.options.pane=this._leafletImagePane,this._leafletPane.appendChild(this._leafletImagePane),this._sortLeaflet(),this.map.zoomed.addListener(this._onLeafletMapZoomed,this),this.map.moved.addListener(this._onLeafletMapMoved,this)},x.prototype._unloadLeaflet=function(){this.map.zoomed.removeListener(this._onLeafletMapZoomed,this),this.map.moved.removeListener(this._onLeafletMapMoved,this),this.map._leafletEngine.removeLayer(this._leafletLayer),this._leafletPane.parentNode.removeChild(this._leafletPane),this._leafletLayer=void 0,this._leafletPane=void 0,this._leafletRenderer=void 0,this._leafletPolylineRenderer=void 0,this._leafletPolygonRenderer=void 0,this._leafletCircleRenderer=void 0},x.prototype._sortLeaflet=function(){for(var v=this._styleOrder,m=0,T=this._styleOrder.length;m<T;m++){var I=v[m];switch(I){case"circle":this._leafletCirclePane.style.zIndex=m;break;case"polyline":this._leafletPolylinePane.style.zIndex=m;break;case"polygon":this._leafletPolygonPane.style.zIndex=m;break;case"text":this._leafletTextPane.style.zIndex=m;break;case"image":this._leafletImagePane.style.zIndex=m;break}}},x.prototype._loadMapbox=function(){var v={type:"geojson",data:this._mapboxData};this.map.engine.addSource(this.id,v),this.map.engine.on("sourcedata",this._onSourceData.bind(this)),this._sortMapboxGroup()},x.prototype._unloadMapbox=function(){this.map.engine.off("sourcedata",this._onSourceData),this._unloadMapboxGroup(),this.map.engine.removeSource(this.id),this._mapboxGroup=[],this._zIndex=void 0},x.prototype._sortMapboxGroup=function(){for(var v=[],m=0,T=this._styleOrder.length;m<T;m++){var I=this._styleOrder[m];switch(I.toUpperCase()){case"CIRCLE":v.push(this._mapboxCircleMarkerLayer),v.push(this._mapboxCirclePathFillLayer),v.push(this._mapboxCirclePathLineLayer);break;case"POLYLINE":v.push(this._mapboxLineLayer);break;case"POLYGON":v.push(this._mapboxFillLayer),v.push(this._mapboxFillLineLayer);break;case"TEXT":v.push(this._mapboxTextLayer);break;case"IMAGE":v.push(this._mapboxImageLayer);break}}this._mapboxGroup=v},x.prototype._updateMapboxData=function(v){var m=this;if(v===void 0&&(v=!1),!this._mapboxIsLoading||v){this._mapboxIsLoading=!0,this._mapboxIsPending=!1;var T=Object.keys(this._mapboxFeatures).map(function(F){return m._mapboxFeatures[F]});T.sort(function(F,q){return F.properties.zIndex-q.properties.zIndex}),this._mapboxData.features=T;var I=this.map._mapboxEngine.getSource(this.id);I.setData(this._mapboxData)}else this._mapboxIsPending||(this._mapboxIsPending=!0)},x.prototype._setMapboxOpacity=function(){for(var v=this.overlays,m=0,T=v.length;m<T;m++){var I=v[m];I._applyMapboxOpacity()}this._updateMapboxData()},x.prototype._onLeafletMapZoomed=function(v){for(var m=this.overlays,T=0,I=m.length;T<I;T++){var F=m[T];F.isVisible&&F._showLeaflet()}},x.prototype._onLeafletMapMoved=function(v){for(var m=this.overlays,T=0,I=m.length;T<I;T++){var F=m[T];F.isVisible&&F._showLeaflet()}},x.prototype._onMapZooming=function(v){},x.prototype._onMapZoomed=function(v){this._toggleVisibility()},x.prototype._onSourceData=function(v){if(this.map&&v.source&&v.sourceId&&v.sourceId===this.id){var m=this.map.engine,T=m.style.sourceCaches[v.sourceId];if(T){var I=T.loaded();I&&(this._mapboxIsLoading=!1,this._mapboxIsPending&&this._updateMapboxData())}}},x.TRANSITION={delay:0,duration:0},x}(K.m)},22559:(ct,Ye,B)=>{"use strict";B.d(Ye,{t:()=>v,A:()=>m});var Q=B(66071),W=B(73690),h=B(69011),K=B(18078),k=B(72503),A=B(50042),z=B(7842),R=B(21574),C=B(44427),x=function(){var T=function(I,F){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,re){q.__proto__=re}||function(q,re){for(var ne in re)re.hasOwnProperty(ne)&&(q[ne]=re[ne])},T(I,F)};return function(I,F){T(I,F);function q(){this.constructor=I}I.prototype=F===null?Object.create(F):(q.prototype=F.prototype,new q)}}(),v=function(T){x(I,T);function I(F){F===void 0&&(F={});var q=T.call(this,F)||this;return q.isDecluttered=void 0,q.productKey=void 0,q.infoUrl=void 0,q.featuresUrl=void 0,q.detailsUrl=void 0,q.infoPollingInterval=void 0,q.infoPollingTimeout=void 0,q.query=void 0,q.apiKey=void 0,q.enableValidity=void 0,(0,Q.f0)(q,F),q}return I}(z.p),m=function(T){x(I,T);function I(F){var q=T.call(this,F=F instanceof v?F:new v(F))||this;return q._isAnimate=!1,q._isListening=!1,q._subdomains=[],q._args={},q._coverage=[],q._properties=[],q._isDataDirty=!0,q._pendingAggregateTiles={},q._pendingAggregateTilesCount=0,q._isTms=!1,q._productKey=F.productKey,q._infoUrl=F.infoUrl,q._featuresUrl=F.featuresUrl,q._detailsUrl=F.detailsUrl,q._validity=F.validity,q._infoPollingInterval=F.infoPollingInterval||new k.i(6e4),q._infoPollingTimeout=F.infoPollingTimeout||new k.i(5e3),q._apiKey=F.apiKey,q._enableValidity=F.enableValidity,q._isDecluttered=F.isDecluttered!==void 0?F.isDecluttered:!0,q}return Object.defineProperty(I.prototype,"productKey",{get:function(){return this._productKey},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"isDecluttered",{get:function(){return this._isDecluttered},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"enableValidity",{get:function(){return this._enableValidity},set:function(F){this._enableValidity!==F&&(this._enableValidity=F,(this._times.length>0||this._ranges.length>0)&&this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"query",{get:function(){return this._query},set:function(F){this._query=F,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"times",{get:function(){return this._times},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"ranges",{get:function(){return this._ranges},enumerable:!0,configurable:!0}),I.prototype._load=function(){switch(this._timeStamp=this.map.clock.time,this.map.renderer){case h.Renderer.WebDOM:this._loadLeaflet();break;case h.Renderer.WebGL:this._loadMapbox();break}T.prototype._load.call(this),this.map.moved.addListener(this._onMapMoved,this),this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this._infoClient?this._hasMetaData&&(this._isAnimate&&!this._isListening&&this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this._timeSystem!=="ranged"&&(this._currentTime=this._deriveTime()),this.update()):(this._startService(),this._changeLoadState(Q.jd.Loading))},I.prototype._startService=function(F,q){if(!this._infoClient){var re=q||this._apiKey||this.map.sunApiKey,ne=F||this._infoUrl||this.map.sunFeatureUrl;ne=ne+"&tile-size=512",ne=ne+"&meta=true",ne=ne.replace("{productKey}",this._productKey),ne=ne.replace("{apiKey}",re),this._infoClient=new W.U(ne),this._infoClient.timeout=this._infoPollingTimeout.totalMilliseconds,this._infoClient.pollingInterval=this._infoPollingInterval.totalMilliseconds,this._infoClient.modified.addListener(this._onInfoLoaded,this),this._infoClient.startPolling()}},I.prototype._stopService=function(){this._infoClient&&(this._infoClient.stopPolling(),this._infoClient.modified.removeListener(this._onInfoLoaded,this),delete this._infoClient)},I.prototype._parse=function(F){var q=JSON.parse(F),re=q.message?[]:(0,C.x)(q);return re},I.prototype._deriveUrl=function(F){var q=F.z||0,re=F.x||0,ne=F.y||0,se=(re+ne)%this._subdomains.length,X=this._subdomains[se]||"0",ce="";if(!this._isAnimate)if(this._timeSystem==="ranged")ce="time="+F.range.toEpochString();else if(F.time!==void 0){var Me=F.time.getTime().toString();this._modelRunTime&&(Me=this._modelRunTime+"/"+Me),ce="time="+Me}else return null;var Be=null;return(ce&&ce!="NaN"||F.query.indexOf("time="))&&(Be=this._featuresUrl,Be=Be.replace("{subdomain}",X).replace("time={time}",ce).replace("{productKey}",this._productKey).replace("{apiKey}",this._apiKey||this.map.sunApiKey).replace("{lod}",q.toString()).replace("{x}",re.toString()).replace("{y}",ne.toString()).replace("&tile-size=512",""),Be=Be+"&tile-size=512"),this._isDecluttered||(Be=Be+"&declutter=false"),this._query&&(Be=Be+this._query),F.query&&(Be=Be+F.query),Be=Be.replace("?&","?"),Be},I.prototype._deriveTiles=function(){return this._timeSystem==="ranged"?this._deriveRangedTiles():this._deriveTimedTiles()},I.prototype._deriveTime=function(){for(var F=k.i.max,q=null,re=this.map.clock.time,ne=this._times.length||0,se=0;se<ne;se++){var X=this._times[se],ce=k.i.fromDates(re,X,!0);ce.totalMilliseconds<F.totalMilliseconds&&(F=ce,q=X)}return q},I.prototype._deriveRangedTiles=function(){var F=[],q=this._isAnimate?this._ranges.length:1;if(this._isTiled)for(var re=this.map._calculateTiles(this._keyZoom,this._dimension,this._isTms),ne=0;ne<q;ne++)for(var se=this._ranges[ne],X=0,ce=re.length;X<ce;X++){var Me=re[X],Be=new R.$(Me.z,Me.x,Me.y,this._isTms,this._dimension);Be.range=se,F.push(Be)}else for(var ne=0;ne<q;ne++){var se=this._ranges[ne],ot=new R.$(0,0,0,this._isTms);ot.range=se,F.push(ot)}return F},I.prototype._deriveTimedTiles=function(){var F=[],q=this._isAnimate?this._times.length:1;if(this._isTiled){var re=this.map._calculateTiles(this._keyZoom,this._dimension,this._isTms);if(this._isAnimate)for(var ne=0;ne<q;ne++)for(var se=this._times[ne],X=0,ce=re.length;X<ce;X++){var Me=re[X],Be=new R.$(Me.z,Me.x,Me.y,this._isTms,this._dimension);Be.time=se,F.push(Be)}else for(var ot=this._times[0],X=0,ce=re.length;X<ce;X++){var Me=re[X],Be=new R.$(Me.z,Me.x,Me.y,this._isTms,this._dimension);Be.time=ot,F.push(Be)}}else for(var ne=0;ne<q;ne++){var Ue=this._times[ne],ht=new R.$(0,0,0,this._isTms);ht.time=Ue,F.push(ht)}return F},I.prototype._convertInfo=function(){var F=this._infoClient.objectLiteral,q=F.products[this._productKey];if(this._featuresUrl=this._options.featuresUrl||F.featuresUrl,this._detailsUrl=this._options.detailsUrl||F.detailsUrl,this._subdomains=F.subdomains,q.meta){var re=q.meta;if(re.timeMode&&(this._timeSystem=re.timeMode),re.animate&&(this._isAnimate=re.animate,this.map&&!this._isListening&&(this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this._isListening=!0)),this._enableValidity===void 0&&(this.enableValidity=!!re.animate),re.pyramid){for(var ne=[],se=0,X=re.pyramid.length;se<X;se++){var ce=re.pyramid[se],Me={data:ce,start:ce};ne.push(Me)}var Be=ne.length>1||ne.length===1&&ne[0]!=0;(this._isTiled===!0||this._isTiled===void 0)&&Be?this._isTiled=!0:this._isTiled=!1,this._pyramidPolicy=ne,ne.length>0&&(this.minimumZoom=ne[0].start)}if(re.coverage){for(var ot=[],Ue=0,ht=re.coverage.length;Ue<ht;Ue++){var Et=re.coverage[Ue],bi=A.c.fromDegrees(Et.north,Et.west,Et.south,Et.east);ot.push(bi)}this._coverage=ot}re.args&&(this._args=re.args),this._options.validity?this._validity=this._options.validity:re.defaultValidity&&(this._validity=new k.i(re.defaultValidity)),re.properties&&(this._properties=re.properties),this._options.meta&&(0,Q.f0)(re,this._options.meta),this._meta=re}var gt=!1;if(this._timeSystem==="ranged"){for(var Qe=[],we=q.time.length>0?Math.max(q.time.length,1):0,Ae=q.time.map(function(oe){var de=oe.split(":")[1]||"",Re=oe.substring(0,oe.indexOf(":")).split("-").map(function(mt){return new Date(Number(mt))}),He=new K.e(Re[0],Re[1]);return He.iteration=de,He}),it=0;it<we;it++){var Lt=Ae[it];this._timeRange.intersects(Lt.startTime,Lt.endTime,!1)&&Qe.push(Lt)}Qe.length>0&&(!this._ranges||Qe.length!=this._ranges.length||JSON.stringify(Qe)!=JSON.stringify(this._ranges))&&(gt=!0,this._ranges=Qe,this._isDataDirty=!0,this._purgeRanges()),Qe.length===0&&this._changeLoadState(Q.jd.Loaded)}else{for(var ei=[],we=q.time.length>0?Math.max(q.time.length-1,1):0,Si=void 0,it=0;it<we;it++){var ui=q.time[it],ni=ui.split("/"),Bi=ui.split(":"),Ci=void 0;if(ni[1])if(!Si||Si===parseInt(ni[0]))Ci=parseInt(ni[1]),Si=parseInt(ni[0]);else if(Si>parseInt(ni[0]))ei=[],Ci=parseInt(ni[1]),Si=parseInt(ni[0]);else break;else Ci=parseInt(ni[0]);var xt;if(Bi[1]&&(xt=parseInt(Bi[1])),this._timeRange.inRange(Ci)){var ze=new Date(Ci);ze.__iteration=xt,ei.push(ze)}}(0,Q.le)(Si)||(this._modelRunTime=Si),ei.length>0&&(!this._times||ei.length!=this._times.length||JSON.stringify(ei)!=JSON.stringify(this._times))&&(gt=!0,this._times=ei,this._isDataDirty=!0,this._purgeTimes()),ei.length===0&&this._changeLoadState(Q.jd.Loaded)}return gt},I.prototype._purgeRanges=function(){var F=[],q=this._ranges.length;for(var re in this._cachedTiles){for(var ne=this._cachedTiles[re],se=!1,X=0;X<q;X++){var ce=this._ranges[X];if(ce.toEpochString()===ne.range.toEpochString()){se=!0;break}}se||F.push(ne)}this._purgeTiles(F)},I.prototype._purgeTimes=function(){var F=[],q=this._times.length;for(var re in this._cachedTiles){for(var ne=this._cachedTiles[re],se=!1,X=0;X<q;X++){var ce=this._times[X];if(ce&&ce.getTime()===ne.time.getTime()){se=!0;break}}se||F.push(ne)}this._purgeTiles(F)},I.prototype._purgeTiles=function(F){for(var q=[],re=0,ne=F.length;re<ne;re++){for(var se=F[re],X=0,ce=se.features.length;X<ce;X++){var Me=se.features[X];Me.overlay&&q.push(Me.overlay)}var Be=se.key;delete this._cachedTiles[Be]}this._unloadOverlays(q)},I.prototype._unload=function(){this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this.map.animator.frameChanged.removeListener(this._onAnimatorFrameChanged,this),T.prototype._unload.call(this),this._hasMetaData=!1,this._stopService()},I.prototype._requestTiles=function(F){this._isAnimate?this._requestAggregateTiles(F):T.prototype._requestTiles.call(this,F)},I.prototype._requestAggregateTiles=function(F){for(var q={},re=0,ne=F.length;re<ne;re++){var se=F[re],X=se.key;this._pendingTiles[X]=se,this._pendingTilesCount++;var ce=[se.z,se.x,se.y].join("_");q.hasOwnProperty(ce)||(q[ce]={}),q[ce][se.key]=se}for(var Me in q){var Be=q[Me],ot=null;for(var Ue in Be){var ht=Be[Ue];ot===null&&(ot=new R.$(ht.z,ht.x,ht.y,this._isTms,this._dimension));var Et="";this._timeSystem==="ranged"?Et=ht.range.toEpochString():ht.time!==void 0&&(Et=ht.time.getTime().toString()),Et&&(this._modelRunTime&&(Et=this._modelRunTime+"/"+Et),ot.query+="&time="+Et)}ot.query+="&stepped=true",this._requestAggregateTile(ot)}},I.prototype._requestAggregateTile=function(F){var q=this,re=F.key+"_"+F.query;if(!this._pendingTiles.hasOwnProperty(re)){var ne=this._deriveUrl(F);if(ne===null)return;this.loadState!=Q.jd.Loading&&this._changeLoadState(Q.jd.Loading);var se="";if(this._requestMethod.toUpperCase()==="POST"){var X=ne.split("POST");X.length===2&&(ne=X[0],se=X[1])}var ce=W.U.createCorsRequest(this._requestMethod,ne,!0,!1);ce.onerror=function(){q._processAggregateTile(F)},ce.timeout=function(){q._processAggregateTile(F)},ce.onabort=function(){q._processAggregateTile(F)},ce.onprogress=function(){},ce.onload=function(){q._processAggregateTile(F,ce.responseText)},this._pendingAggregateTiles[re]=F,this._pendingRequests[re]=ce,this._pendingAggregateTilesCount++,ce.send(se)}},I.prototype._processAggregateTile=function(F,q){var re=F.key+"_"+F.query;if(this._pendingAggregateTiles[re]){this._pendingAggregateTilesCount--,delete this._pendingAggregateTiles[re];var ne=void 0;q&&(ne=JSON.parse(q));for(var se=F.query.split("&"),X=0,ce=0,Me=se.length;ce<Me;ce++){var Be=se[ce],ot=Be.split("="),Ue=ot[0];if(Ue==="time"){var ht=ot[1],Et=ht;ht.indexOf("/")!==-1&&(ht=ht.split("/")[1]);var bi=ht+"_"+F.z+"_"+F.x+"_"+F.y,gt=this._pendingTiles[bi];if(gt&&(this._registerTile(gt),ne)){var Qe=ne[Et];Qe&&(this._formatTile(Qe,gt),X+=gt.features.length)}}}X>0&&this.update(),this._pendingAggregateTilesCount<=0&&(this._pendingAggregateTilesCount=0,this._changeLoadState(Q.jd.Loaded))}},I.prototype._applyFeatureProperties=function(F){var q=F.properties;F.weight=q.declutterWeight,q.expireTimeUTC&&(F.expires=new Date(q.expireTimeUTC))},I.prototype.preload=function(F,q){this._infoClient||(this._startService(F,q),this._changeLoadState(Q.jd.Loading))},I.prototype._onInfoLoaded=function(F){var q=this._convertInfo();if(this._hasMetaData?q&&(this._timeStamp=this.map.clock.time,this.metaDataModified.trigger()):(this._hasMetaData=!0,this.metaDataLoaded.trigger(),this._infoClient.url=this._infoClient.url.replace("&meta=true",""),this.map&&(this._timeStamp=this.map.clock.time,this._isTiled&&(this._keyZoom=this._deriveKeyZoomLevel(this.map.zoomLevel)))),this.map&&this.map.isEnabled&&this._isDataDirty){this._isVisible=this.map.zoomLevel>=this.minimumZoom&&this.map.zoomLevel<=this.maximumZoom,this._timeSystem!=="ranged"&&(this._currentTime=this._deriveTime()),this.update();var re=this._determineTiles();this._requestTiles(re.missing),this._isDataDirty=!1}},I.prototype._onMapEnabled=function(F){this._infoClient.startPolling()},I.prototype._onMapDisabled=function(F){this._infoClient.stopPolling()},I.prototype._onAnimatorFrameChanged=function(F){this._timeStamp=this.map.clock.time,this._timeSystem!=="ranged"&&(this._currentTime=this._deriveTime()),this.update()},I}(z.h)},19161:(ct,Ye,B)=>{"use strict";B.d(Ye,{P:()=>Ci,d:()=>Bi});var Q=B(66071),W=B(93126),h=B(35992),K=B(83009),k=B(9654),A=B(72503),z=B(66017),R=B(50042),C=B(28360),x=function(){var xt=function(ze,oe){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(de,Re){de.__proto__=Re}||function(de,Re){for(var He in Re)Re.hasOwnProperty(He)&&(de[He]=Re[He])},xt(ze,oe)};return function(ze,oe){xt(ze,oe);function de(){this.constructor=ze}ze.prototype=oe===null?Object.create(oe):(de.prototype=oe.prototype,new de)}}(),v=function(xt){x(ze,xt);function ze(oe,de){return xt.call(this,oe,de)||this}return Object.defineProperty(ze.prototype,"magnitude",{get:function(){var oe=Math.sqrt(this.x*this.x+this.y*this.y);return oe},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"angle",{get:function(){var oe=Math.atan2(this.y,this.x);return oe},enumerable:!0,configurable:!0}),ze.fromAngle=function(oe,de){return new ze(de*-Math.sin(oe),de*Math.cos(oe))},ze}(W.E),m=function(){function xt(ze,oe){this._lastGeoPoint=k.F.fromRadians(0,0),this.position=k.F.fromRadians(ze.latitude.radians,ze.longitude.radians),this.previousPosition=k.F.fromRadians(ze.latitude.radians,ze.longitude.radians),this.velocity=oe||new v(0,0),this.timeStamp=performance.now()}return xt.prototype.move=function(ze,oe){var de=this.position;this.previousPosition.latitude.radians=de.latitude.radians,this.previousPosition.longitude.radians=de.longitude.radians;var Re=ze.fromScreenToGeo(oe,this._lastGeoPoint);this.position.latitude.radians=Re.latitude.radians,this.position.longitude.radians=Re.longitude.radians},xt}(),T=function(){function xt(ze){ze===void 0&&(ze={}),this.emissionRate=void 0,this.maximum=void 0,this.duration=void 0,this.fadeIn=void 0,this.fadeOut=void 0,this.speedFactor=void 0,this.speedThreshold=void 0,this.fps=void 0,this.determineVelocity=void 0,(0,Q.f0)(this,ze)}return xt}(),I=function(){function xt(ze,oe,de){this._isEmitting=!1,this._particles=[],this._pool=[],this._geoPoint=k.F.fromRadians(0,0),this._screenPoint=new W.E(0,0),this._screenPosition=new W.E(0,0),this._previousPosition=new W.E(0,0),this._topLeft=new W.E(0,0),this._bottomRight=new W.E(0,0),this.systemChanged=new C.j,this._canvas=ze,this._context=ze.getContext("2d"),this._map=oe,this._buffer=document.createElement("canvas"),this._bufferContext=this._buffer.getContext("2d"),this._determineVelocity=de.determineVelocity||this._determineVelocity,this._fadeIn=de.fadeIn||new A.i(0,0,0,0,0),this._fadeOut=de.fadeOut||new A.i(500,0,0,0,0),this._speedFactor=de.speedFactor!=null?de.speedFactor:1,this._speedThreshold=de.speedThreshold!=null?de.speedThreshold:0,this._fps=de.fps!=null?de.fps:240,this._time=0}return Object.defineProperty(xt.prototype,"isEmitting",{get:function(){return this._isEmitting},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"emissionRate",{get:function(){return this._emissionRate},set:function(ze){this._emissionRate=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"maximum",{get:function(){return this._maximum},set:function(ze){this._maximum=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"duration",{get:function(){return this._duration},set:function(ze){this._duration=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"particles",{get:function(){return this._particles},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"fadeIn",{get:function(){return this._fadeIn},set:function(ze){this._fadeIn=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"fadeOut",{get:function(){return this._fadeOut},set:function(ze){this._fadeOut=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"speedFactor",{get:function(){return this._speedFactor},set:function(ze){this._speedFactor=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"speedThreshold",{get:function(){return this._speedThreshold},set:function(ze){this._speedThreshold=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"fps",{get:function(){return this._fps},set:function(ze){this._fps=ze,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),xt.prototype._addParticles=function(){for(var ze=this._map,oe=Math.max(this._maximum-this._particles.length,0),de=this._pool,Re=this._canvas.width,He=this._canvas.height,mt=this._emissionRate/this._fps<oe?this._emissionRate/this._fps:oe,Ft=0;Ft<mt;Ft++){var Gt=this._screenPoint;Gt.x=Math.floor(Math.random()*(Re-0+1)+0),Gt.y=Math.floor(Math.random()*(He-0+1)+0);var Bt=ze.fromScreenToGeo(Gt,this._geoPoint),Kt;de.length>0?(Kt=de.pop(),Kt.position.latitude.radians=Kt.previousPosition.latitude.radians=Bt.latitude.radians,Kt.position.longitude.radians=Kt.previousPosition.longitude.radians=Bt.longitude.radians,Kt.timeStamp=performance.now(),Kt.velocity.x=0,Kt.velocity.y=0):Kt=new m(Bt),this._particles.push(Kt)}},xt.prototype._simulateParticles=function(ze,oe,de){for(var Re=[],He=this._speedThreshold,mt=this._speedFactor,Ft=this._duration,Gt=this._map,Bt=performance.now(),ze=this._particles,Kt=this._pool,qt=0,fi=ze.length;qt<fi;qt++){var Ii=ze[qt],zi=Ii.position,Yt=Gt.fromGeoToScreen(zi,this._screenPoint);if(Yt.x<0||Yt.x>oe||Yt.y<0||Yt.y>de||Bt-Ii.timeStamp>Ft.totalMilliseconds){Kt.push(Ii);continue}this._determineVelocity(Ii,Ii.velocity);var ur=Ii.velocity;ur.magnitude<He||(Yt.x+=ur.x*mt/6,Yt.y+=ur.y*mt/6,Ii.move(Gt,Yt),Re.push(Ii))}this._particles=Re},xt.prototype._determineVelocity=function(ze,oe){var de=Math.floor(Math.random()*360)+0;oe.x=2*-Math.sin(de),oe.y=2*Math.cos(de)},xt.prototype._loop=function(ze){if(this._isEmitting){this._now=performance.now();var oe=this._now-this._then,de=1e3/this._fps;oe>=de&&(this._then=this._now-oe%de,this._blur(),this._update()),this._queue()}},xt.prototype._queue=function(){this._animationFrame=window.requestAnimationFrame(this._loop.bind(this))},xt.prototype._dequeue=function(){window.cancelAnimationFrame(this._animationFrame)},xt.prototype._update=function(){var ze;this._addParticles(),this._simulateParticles(this._particles,this._canvas.width,this._canvas.height),this._drawParticles(this._particles)},xt.prototype.clear=function(){var ze=this._canvas;this._context.clearRect(0,0,ze.width,ze.height)},xt.prototype.start=function(){this._isEmitting||(this._isEmitting=!0,this._then=performance.now(),this._loop())},xt.prototype.stop=function(){this._isEmitting&&(this._isEmitting=!1,window.cancelAnimationFrame(this._animationFrame))},xt}(),F=function(){var xt=function(ze,oe){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(de,Re){de.__proto__=Re}||function(de,Re){for(var He in Re)Re.hasOwnProperty(He)&&(de[He]=Re[He])},xt(ze,oe)};return function(ze,oe){xt(ze,oe);function de(){this.constructor=ze}ze.prototype=oe===null?Object.create(oe):(de.prototype=oe.prototype,new de)}}(),q=function(xt){F(ze,xt);function ze(oe,de,Re){var He=xt.call(this,oe,de,Re)||this;if(He._adjustedBottomRightGeoPoint=k.F.fromRadians(0,0),He._adjustedBottomRightScreenPoint=new W.E(0,0),He._emissionRate=Re.emissionRate!==void 0?Re.emissionRate:1e3,He._maximum=Re.maximum!==void 0?Re.maximum:5e3,He._duration=Re.duration!==void 0?Re.duration:new A.i(0,5,0,0,0),He._width=Re.width!==void 0?Re.width:1,He._color=Re.color!==void 0?Re.color:"rgba(255, 255, 255, 255)",Re.palette){var mt=Re.palette instanceof z.Y;mt?He._palette=Re.palette:He._palette=new z.Y(Re.palette.colors,Re.palette)}return He._determineColor=Re.determineColor||He._determineColor,He._blurPercent=Re.blur!==void 0?1-(Re.blur>1?1:Re.blur<0?0:Re.blur):.94,He}return Object.defineProperty(ze.prototype,"width",{get:function(){return this._width},set:function(oe){this._width=oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"color",{get:function(){return this._color},set:function(oe){this._color=oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"palette",{get:function(){return this._palette},set:function(oe){this._palette=oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"blur",{get:function(){var oe=1-this._blurPercent;return oe},set:function(oe){this._blurPercent=1-oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),ze.prototype._determineColor=function(oe){return this._color},ze.prototype._drawParticles=function(oe){var de=this._context,Re=oe.length,He=this._width,mt=this._duration.totalMilliseconds,Ft=this._map,Gt=performance.now(),Bt=this.fadeIn.totalMilliseconds,Kt=this.fadeOut.totalMilliseconds,qt=this._screenPosition;if(de.lineWidth=He,this._palette)for(var fi=0;fi<Re;fi++){var Ii=oe[fi],zi=Ii.timeStamp,Yt=zi+mt;if(!(Gt>Yt)){var ur=Ii.position,yi=Ft.fromGeoToScreen(ur,this._screenPosition),hr=Ii.previousPosition,ir=Ft.fromGeoToScreen(hr,this._previousPosition);de.beginPath(),Gt-zi<Bt?de.globalAlpha=(Gt-zi)/Bt:Gt>Yt-Kt&&Gt<Yt?de.globalAlpha=1-(Gt-(Yt-Kt))/Kt:de.globalAlpha=1,de.strokeStyle=this._determineColor(Ii),de.moveTo(yi.x,yi.y),de.lineTo(ir.x,ir.y),de.stroke()}}else{de.strokeStyle=this._color,de.beginPath();for(var fi=0;fi<Re;fi++){var Ii=oe[fi],zi=Ii.timeStamp,Yt=zi+mt;if(!(Gt>Yt)){var ur=Ii.position,yi=Ft.fromGeoToScreen(ur,this._screenPosition),hr=Ii.previousPosition,ir=Ft.fromGeoToScreen(hr,this._previousPosition);Gt-zi<Bt?de.globalAlpha=(Gt-zi)/Bt:Gt>Yt-Kt&&Gt<Yt?de.globalAlpha=1-(Gt-(Yt-Kt))/Kt:de.globalAlpha=1,de.moveTo(yi.x,yi.y),de.lineTo(ir.x,ir.y)}}de.stroke()}},ze.prototype._blur=function(){var oe=this._map,de=this._map.contextualBounds,Re=this._adjustedBottomRightScreenPoint,He=this._adjustedBottomRightGeoPoint;if(Re.x=oe.width,Re.y=oe.height,!this._bounds){this._bounds=R.c.fromDegrees(de.north.degrees,de.west.degrees,de.south.degrees,de.east.degrees),oe.fromScreenToGeo(Re,He);return}var mt=this._canvas,Ft=this._context,Gt=this._buffer,Bt=Gt.getContext("2d");Gt.height=mt.height,Gt.width=mt.width,Bt.globalAlpha=this._blurPercent,Bt.drawImage(mt,0,0),Ft.clearRect(0,0,mt.width,mt.height);var Kt=this._bounds;if(de.intersects(Kt)){var qt=oe.fromGeoToScreen(Kt.topLeftGeoPoint,this._topLeft),fi=oe.fromGeoToScreen(He,this._bottomRight),Ii=fi.y-qt.y,zi=fi.x-qt.x;Ii+=2,zi+=2,Ft.drawImage(Gt,qt.x,qt.y,zi,Ii)}Kt.north.radians=de.north.radians,Kt.west.radians=de.west.radians,Kt.south.radians=de.south.radians,Kt.east.radians=de.east.radians,oe.fromScreenToGeo(Re,He)},ze}(I),re=function(xt){F(ze,xt);function ze(oe){oe===void 0&&(oe={});var de=xt.call(this,oe)||this;return de.width=void 0,de.color=void 0,de.palette=void 0,de.blur=void 0,de.determineColor=void 0,(0,Q.f0)(de,oe),de}return ze}(T),ne=function(){var xt=function(ze,oe){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(de,Re){de.__proto__=Re}||function(de,Re){for(var He in Re)Re.hasOwnProperty(He)&&(de[He]=Re[He])},xt(ze,oe)};return function(ze,oe){xt(ze,oe);function de(){this.constructor=ze}ze.prototype=oe===null?Object.create(oe):(de.prototype=oe.prototype,new de)}}(),se=function(xt){ne(ze,xt);function ze(oe){oe===void 0&&(oe={});var de=xt.call(this,oe)||this;return de.source=void 0,de.rotation=void 0,de.size=void 0,de.determineSprite=void 0,(0,Q.f0)(de,oe),de}return ze}(T),X=function(xt){ne(ze,xt);function ze(oe,de,Re){var He=xt.call(this,oe,de,Re)||this;He._emissionRate=Re.emissionRate!==void 0?Re.emissionRate:200,He._maximum=Re.maximum!==void 0?Re.maximum:1e3,He._duration=Re.duration!==void 0?Re.duration:new A.i(0,5,0,0,0);var mt=new Image;return mt.src=Re.source||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAMIGlDQ1BEaXNwbGF5AABIiZVXZ1QUhxb+puwuZVmqCAiySAdRijSR3gUB6RDbsrvAwrIss7uo2I0hCsYuFiwRjYoYNRZQYkHU2Ahi7z7QYInEYO/yfuyCiS/nvfPuOTNzzzffvfe7d+bMmQvouwvkcilpABTJlExydBg/Myubz+kAGwOgCwtYCoQKeWhSUjwA9F7/bq+ugACAi24CuVz6n/f/qxmKxAohQCQByBEphEUAsRegzYRyRgmwWgDYTlTKlQCrG4AJk5mVDbBpACZ5at8MgEmO2h8MwIRJTQ4H2CGAFlcgYPIAXjwAfqkwTwnwpADcZSKJDOCtARAkzBeIAN4tAIOLiopFgL4WAKecv+TJ+1vOnL6cAkFen6/uBQCgFSFRyKWCyf/nOP63FUlVvTUGAeDmMzHJAEwAYmthcVwyAC5AHJTlJCQCMAKIUxIRoPFv5Kti0jT8LqEiPBuAKUBCJIiIA2AJkKaqwrRQje8pYAA1n0yQKGNTNX4OU5ysyU+WyqQJ8Zo8c/PFsb3+OrEiMqWXkyuJigVgAJB7y/JTM9Q6yeOlkvQEADyAbFMUpsRpYu+U5Ycn9HIYVXIaADuAfJHLRCWrOZRZkaK3L2qIUBCZAsAMoEKU+akx6lgqU6zIjO/VIBJHRKo1UCKxLE2jjVLKlWHJmthyuTRJw6fWiaXRyeo5U7sUpSm9sReUTKpm5tTdAsHIJE2tV3JlUqpaG00iHuGIAB8q8JGDYhRA0trV0AW+5k4UBGCQBzHcNEhvRAYEYCCDACkowx+QQQxFX1wYBGAgRilk+NiHqs9uyIUADEohhgKFuA8GRbQFHUQH0PF0EB1CB9GetB/t3xvH1++tyo5kR7Bj2FFs5z4dQhRDimIwkPwDFgcpxFCBgRiy3h4+52PdZ51n3WVdZrWzriMdv4GBpJc1XjKb+UI5H6PQDpVmKmLk/LU72oH2pL3pMDqQDqL9wadNaQu40cNoPzqUDqYDaG/a/28KVX3aPs/yy3piyP7WjwbnufC8NSpy+p5MeB/ryyzhf5mRCMWI+5JJzaX2UCepo9Rp6iDVAD51hNpPtVCHqIa/vAm/gUFeX7VkiCFDIaSQ9HLc69wfuX/4orZAU5+BGAqleJISAMKL5ZMZSV6+kh8ql0vF/FiZcMhgvqe7hy+QmZXNV386npuCAECYnvmMlTQB/hUAkfcZE9gCB+4Dxq8+Y7bPAO4i4FCbUMWUqjEaAFjQgT5MYI6BsIUT3OAJHwQgBJEYiUSkIgvjIEQ+isBgIqZiFspRiUVYjtVYj43Yih+xGw04iKP4BWfRhsu4iXZ04jG68QrvCYLgEHqEMWFOWBP2hCvhSfgRQUQkEU8kE1nEBCKPkBEqYirxNVFJLCFWExuIWuIn4gBxlDhNnCeuEx3EI+IZ8Y6kSC5pQlqRDuRQ0o8MJePIVHIsmUeWkGXkHHIBuZKsIbeT9eRR8ix5mWwnH5MvKVC6lCllQ7lRflQ4lUhlU7kUQ02nKqgqqobaQTVSJ6mLVDvVRb2l2bQxzafd6AA6hk6jhXQJPZ2eT6+mt9L19HH6It1Bd9OfWHosS5YrazgrlpXJymNNZJWzqlibWftYJ1iXWZ2sV2w225TtyPZlx7Cz2AXsKez57LXsnewm9nn2PfZLDodjznHlBHISOQKOklPOWcXZzjnCucDp5LzR0tWy1vLUitLK1pJpzdaq0tqmdVjrgtYDrffaBtr22sO1E7VF2pO1F2pv0m7UPqfdqf1ex1DHUSdQJ1WnQGeWzkqdHTondG7pPNfV1R2k6687WleiO1N3pe4u3VO6HbpvuUZcF244dwxXxV3A3cJt4l7nPtfT03PQC9HL1lPqLdCr1Tumd0fvDc+YN4QXyxPxZvCqefW8C7wn+tr69vqh+uP0y/Sr9Pfon9PvMtA2cDAINxAYTDeoNjhgcNXgpaGxoYdhomGR4XzDbYanDR8acYwcjCKNREZzjDYaHTO6Z0wZ2xqHGwuNvzbeZHzCuNOEbeJoEmtSYFJp8qNJq0l3P6N+w/ql95vUr7rfoX7tppSpg2msqdR0oelu0yum7/pb9Q/tL+4/r/+O/hf6vzYbYBZiJjarMNtpdtnsnTnfPNK80HyxeYP5bQvawsVitMVEi3UWJyy6BpgMCBggHFAxYPeAG5akpYtlsuUUy42WLZYvrQZaRVvJrVZZHbPqGmg6MGRgwcBlAw8PfGRtbB1kLbFeZn3E+nd+P34oX8pfyT/O77axtImxUdlssGm1eT/IcVDaoNmDdg66batj62eba7vMttm2287abpTdVLs6uxv22vZ+9vn2K+xP2r92cHTIcPjWocHhoaOZY6xjmWOd4y0nPadgpxKnGqdLzmxnP+dC57XObS6ki7dLvku1yzlX0tXHVeK61vX8YNZg/8GywTWDr7px3ULdSt3q3DqGmA6JHzJ7SMOQJ0PthmYPXTz05NBP7t7uUvdN7jc9jDxGesz2aPR45uniKfSs9rzkpecV5TXDa7/X02Guw8TD1g275m3sPcr7W+9m748+vj6Mzw6fR752vhN81/he9TPxS/Kb73fKn+Uf5j/D/6D/2+E+w5XDdw//M8AtoDBgW8DDEY4jxCM2jbgXOChQELghsD2IHzQh6Pug9mCbYEFwTfDdENsQUcjmkAehzqEFodtDn4S5hzFh+8Jehw8PnxbeFEFFREdURLRGGkWmRa6OvBM1KCovqi6qO9o7ekp0UwwrJi5mcczVWKtYYWxtbPdI35HTRh6P48alxK2OuxvvEs/EN44iR40ctXTUrQT7BFlCQyISYxOXJt5OckwqSfp5NHt00ujq0feTPZKnJp9MMU4Zn7It5VVqWOrC1JtpTmmqtOZ0/fQx6bXprzMiMpZktGcOzZyWeTbLIkuStT+bk52evTn75VeRXy3/qnOM95jyMVfGOo6dNPb0OItx0nGHxuuPF4zfM4E1IWPCtgkfBImCGsHLnNicNTndwnDhCuFjUYhomeiROFC8RPwgNzB3Se7DvMC8pXmP8oPzq/K7JOGS1ZKnBTEF6wteFyYWbinskWZIdxZpFU0oOiAzkhXKjhcPLJ5UfF7uKi+Xt5cML1le0s3EMZsVhGKsYr/SRClXtqicVN+oOkqDSqtL30xMn7hnkuEk2aSWyS6T501+UBZV9sMUeopwSvNUm6mzpnZMC522YToxPWd68wzbGXNmdM6Mnrl1ls6swlm/znafvWT2i68zvm6cYzVn5px730R/U1fOK2fKr34b8O36ufRcydzWeV7zVs37VCGqOFPpXllV+WG+cP6Z7zy+W/ldz4LcBa0LfRauW8ReJFt0ZXHw4q1LDJeULbm3dNTS+mX8ZRXLXiwfv/x01bCq9St0VqhWtK+MX7l/ld2qRas+rM5ffbk6rHrnGss189a8Xitae2FdyLod663WV65/973k+2sbojfU1zjUVG1kbyzdeH9T+qaTP/j9ULvZYnPl5o9bZFvatyZvPV7rW1u7zXLbwjqyTlX3aPuY7W0/Rvy4f4fbjg07TXdW7sIu1a7ff5rw05Xdcbub9/jt2bHXfu+afcb7KuqJ+sn13Q35De37s/afPzDyQHNjQOO+n4f8vOWgzcHqQ/0OLTysc3jO4Z4jZUdeNsmbuo7mHb3XPL755rHMY5eOjz7eeiLuxKlfon45djL05JFTgacOnh5++sAZvzMNZ33O1rd4t+z71fvXfa0+rfXnfM/tb/Nvazw/4vzhC8EXjl6MuPjLpdhLZy8nXD5/Je3KtatjrrZfE117eF16/emN0hvvb868xbpVcdvgdtUdyzs1/3L+1852n/ZDHREdLXdT7t68J7z3+DfFbx8659zXu1/1wPpB7UPPhwcfRT1q+/2r3zsfyx+/7yr/w/CPNU+cnuz9M+TPlu7M7s6nzNOeZ/Ofmz/f8mLYi+aXSS/vvCp69f51xRvzN1vf+r09+S7j3YP3Ez9wPqz86Pyx8VPcp1s9RT09cgEjAABQAMjcXODZFkAvCzBuA3R46t0LAECo90VA/Q/yz756PwMA+ABbQoC0mUB8E7CuCbCfCXCbgCQAqSEgvbz6Do0pcr081bm4DMB609Pz3ArgNAIfmZ6e92t7ej5uAqjrQFOJeucDALYB8L05ALRcNZiKL+zfyfdsmxpLbScAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAUMaVRYdFhNTDpjb20uYWRvYmUueG1wAAAAAAA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdEV2dD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlRXZlbnQjIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAoTWFjaW50b3NoKSIgeG1wOkNyZWF0ZURhdGU9IjIwMTgtMDUtMjNUMTU6MjU6MTEtMDQ6MDAiIHhtcDpNb2RpZnlEYXRlPSIyMDE4LTA1LTIzVDE1OjI1OjM1LTA0OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDE4LTA1LTIzVDE1OjI1OjM1LTA0OjAwIiBkYzpmb3JtYXQ9ImltYWdlL3BuZyIgcGhvdG9zaG9wOkNvbG9yTW9kZT0iMyIgcGhvdG9zaG9wOklDQ1Byb2ZpbGU9IkRpc3BsYXkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZDZhMDc2NTYtOWI4Mi00NDQwLWI3OWUtNGRjMGYyMzMwYzRkIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOmQ2YTA3NjU2LTliODItNDQ0MC1iNzllLTRkYzBmMjMzMGM0ZCIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmQ2YTA3NjU2LTliODItNDQ0MC1iNzllLTRkYzBmMjMzMGM0ZCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDZhMDc2NTYtOWI4Mi00NDQwLWI3OWUtNGRjMGYyMzMwYzRkIiBzdEV2dDp3aGVuPSIyMDE4LTA1LTIzVDE1OjI1OjExLTA0OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgKE1hY2ludG9zaCkiLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+eLuDIgAAAEBJREFUKJFj/P//PwMpgAWZg6b1PwMDAyOMA2Mw4TDoPxoNB9g0oCtC4aNrwOUhuDgLmgQjugIkMZxOwgtGpAYA7ooMFOh0XowAAAAASUVORK5CYII=",He._image=mt,He._source=mt.src,He._rotation=Re.rotation!==void 0?Re.rotation:0,He._size=Re.size,He._fps=Re.fps!=null?Re.fps:100,He._determineSprite=Re.determineSprite||He._determineSprite,He}return Object.defineProperty(ze.prototype,"image",{get:function(){return this._image},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"source",{get:function(){return this._source},set:function(oe){if(oe!==this._source){var de=new Image;de.src=oe,this._source=oe,this._image=de,this.systemChanged.trigger()}},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"rotation",{get:function(){return this._rotation},set:function(oe){this._rotation=oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"size",{get:function(){return this._size},set:function(oe){this._size=oe,this.systemChanged.trigger()},enumerable:!0,configurable:!0}),ze.prototype._determineSprite=function(oe){return{image:this._image}},ze.prototype._drawParticles=function(oe){for(var de=this._context,Re=oe.length,He=(this._rotation+90)%360,mt=performance.now(),Ft=this.fadeIn.totalMilliseconds,Gt=this.fadeOut.totalMilliseconds,Bt,Kt,qt=this._size,fi=this._duration,Ii=this._map,zi=0;zi<Re;zi++){var Yt=oe[zi],ur=Yt.position,yi=this._determineSprite(Yt);if(!!yi){var hr=yi.image;yi.size?(Bt=yi.size.width,Kt=yi.size.height):qt?(Bt=qt.width,Kt=qt.height):(Bt=hr.width,Kt=hr.height);var ir=Bt/2,zr=Kt/2,rn=Ii.fromGeoToScreen(ur,this._screenPoint),Br=rn.x,nn=rn.y,wn=Yt.timeStamp,Pn=wn+fi.totalMilliseconds;if(!(mt>Pn)){var An=yi.rotation?yi.rotation:0,Ni=yi.scale?yi.scale:1,wr=Yt.velocity.angle+(He+An)*Math.PI/180;de.save(),de.translate(Br,nn),de.scale(Ni,Ni),de.rotate(wr),mt-wn<Ft?de.globalAlpha=(mt-wn)/Ft:mt>Pn-Gt&&mt<Pn&&(de.globalAlpha=1-(mt-(Pn-Gt))/Gt),de.drawImage(hr,-ir,-zr,Bt,Kt),de.restore()}}}},ze.prototype._blur=function(){this.clear()},ze}(I),ce=B(69011),Me=B(74776),Be=function(){var xt=function(ze,oe){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(de,Re){de.__proto__=Re}||function(de,Re){for(var He in Re)Re.hasOwnProperty(He)&&(de[He]=Re[He])},xt(ze,oe)};return function(ze,oe){xt(ze,oe);function de(){this.constructor=ze}ze.prototype=oe===null?Object.create(oe):(de.prototype=oe.prototype,new de)}}(),ot;(function(xt){xt[xt.UV=0]="UV",xt[xt.SpeedDirection=1]="SpeedDirection"})(ot||(ot={}));var Ue=function(xt){Be(ze,xt);function ze(oe){oe===void 0&&(oe={});var de=xt.call(this,oe)||this;return de.speedUnit=void 0,de.directionUnit=void 0,de.lines=void 0,de.linesEnabled=void 0,de.sprites=void 0,de.spritesEnabled=void 0,(0,Q.f0)(de,oe),de}return ze}(h.M),ht=function(xt){Be(ze,xt);function ze(oe){var de=xt.call(this,oe=oe instanceof Ue?oe:new Ue(oe))||this;if(de._isVisible=!1,de._isLoaded=!1,de._topLeftGeoPoint=k.F.fromRadians(0,0),de._bottomRightGeoPoint=k.F.fromRadians(0,0),de._mapboxBounds=R.c.fromDegrees(0,0,0,0),de._isFirefox=!1,de._isFirefoxLinesStopped=!1,de._isFirefoxSpritesStopped=!1,de._options=oe,oe.lines){var Re=oe.lines instanceof re?oe.lines:new re(oe.lines);oe.lines=Re}else oe.lines=new re;if(oe.sprites){var He=oe.sprites instanceof se?oe.sprites:new se(oe.sprites);oe.sprites=He}else oe.sprites=new se;return de._linesEnabled=oe.linesEnabled!==void 0?oe.linesEnabled:!0,de._spritesEnabled=oe.spritesEnabled!==void 0?oe.spritesEnabled:!1,de._speedUnit=oe.speedUnit!==void 0?oe.speedUnit:Me.qC.MetersPerSecond,de._directionUnit=oe.directionUnit!==void 0?oe.directionUnit:Me.TW.Degrees,de._paletteSource=oe.paletteSource!==void 0?oe.paletteSource:Me.Yh.PaletteData,de._isFirefox=typeof InstallTrigger!="undefined",de}return Object.defineProperty(ze.prototype,"speedUnit",{get:function(){return this._speedUnit},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"directionUnit",{get:function(){return this._directionUnit},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"lines",{get:function(){return this._lines},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"linesEnabled",{get:function(){return this._linesEnabled},set:function(oe){this._linesEnabled=oe,this._viewParticleSystems()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"sprites",{get:function(){return this._sprites},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"spritesEnabled",{get:function(){return this._spritesEnabled},set:function(oe){this._spritesEnabled=oe,this._viewParticleSystems()},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"paletteSource",{get:function(){return this._paletteSource},set:function(oe){this._paletteSource=oe},enumerable:!0,configurable:!0}),ze.prototype._load=function(oe){if(!this._isLoaded){switch(this.map.renderer){case ce.Renderer.WebDOM:this._loadLeaflet();break;case ce.Renderer.WebGL:this._loadMapbox();break}this._toggleVisibility(),this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this.map.zooming.addListener(this._onMapZooming,this),this.map.panning.addListener(this._onMapPanning,this),this.map.panned.addListener(this._onMapPanned,this),this.map.moved.addListener(this._onMapMoved,this),this.map.moving.addListener(this._onMapMoving,this),this.map.resized.addListener(this._onMapResized,this),this._loadParticleSystems(),this._viewParticleSystems(),this._resize(this.map.width+2,this.map.height+2),this._isLoaded=!0}},ze.prototype._loadParticleSystems=function(){var oe=this._options.lines;this._lines||(oe.determineColor=this._determineColor.bind(this),oe.determineVelocity=this._determineVelocity.bind(this),this._lines=new q(this._linesCanvas,this.map,oe)),this._linesEnabled&&(this._lines.clear(),this._lines.start());var de=this._options.sprites;this._sprites||(de.determineVelocity=this._determineVelocity.bind(this),this._sprites=new X(this._spritesCanvas,this.map,de)),this._spritesEnabled&&(this._sprites.clear(),this._sprites.start())},ze.prototype._changeOpacity=function(oe){if(!(0,Q.le)(oe)&&oe!=this._opacity){var de=this._opacity;if(this._opacity=oe,this.map)switch(this.map.renderer){case ce.Renderer.WebDOM:this._leafletLinesLayer&&(this._leafletLinesLayer.canvas.style.opacity=oe),this._leafletSpritesLayer&&(this._leafletSpritesLayer.canvas.style.opacity=oe);break;case ce.Renderer.WebGL:this._mapboxLinesLayer&&(this._mapboxLinesLayer.paint["raster-opacity"]=oe,this.linesEnabled&&this.map._mapboxEngine.setPaintProperty(this.id+"_lines","raster-opacity",oe)),this._mapboxSpritesLayer&&(this._mapboxSpritesLayer.paint["raster-opacity"]=oe,this.spritesEnabled&&this.map._mapboxEngine.setPaintProperty(this.id+"_sprites","raster-opacity",oe));break}this.opacityChanged.trigger({old:de,new:oe})}},ze.prototype._unload=function(){if(this._isLoaded){switch(this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this.map.zooming.removeListener(this._onMapZooming,this),this.map.panning.removeListener(this._onMapPanning,this),this.map.panned.removeListener(this._onMapPanned,this),this.map.moved.removeListener(this._onMapMoved,this),this.map.moving.removeListener(this._onMapMoving,this),this.map.resized.removeListener(this._onMapResized,this),this.map.renderer){case ce.Renderer.WebGL:this._unloadMapbox();break;case ce.Renderer.WebDOM:this._unloadLeaflet();break}this._lines&&(this._lines.stop(),this._lines=null),this._sprites&&(this._sprites.stop(),this._sprites=null),this._isLoaded=!1}},ze.prototype._resize=function(oe,de){var Re=oe||this.map.width,He=de||this.map.height;this._linesCanvas.width=Re,this._linesCanvas.height=He,this._spritesCanvas.width=Re,this._spritesCanvas.height=He,this._render()},ze.prototype._toggleVisibility=function(){var oe=this.map.zoomLevel;oe<this.minimumZoom||oe>this.maximumZoom?this._isVisible=!1:oe>=this.minimumZoom&&oe<=this.maximumZoom&&(this._isVisible=!0)},ze.prototype._render=function(){var oe=this.map;if(oe)switch(oe.renderer){case ce.Renderer.WebGL:this._adjustMapbox();break}},ze.prototype._clearSurface=function(){var oe=this.map.width+2,de=this.map.height+2;switch(this._linesContext.clearRect(0,0,oe,de),this._spritesContext.clearRect(0,0,oe,de),this.map.renderer){case ce.Renderer.WebGL:this._adjustMapbox();break}},ze.prototype._determineColor=function(oe){return this._lines.color},ze.prototype._determineVelocity=function(oe,de){return oe.velocity},ze.prototype._viewParticleSystems=function(){switch(this.map.renderer){case ce.Renderer.WebDOM:this._viewLeafletParticleSystems();break;case ce.Renderer.WebGL:this._viewMapboxParticleSystems();break}},ze.prototype._loadLeaflet=function(){this._loadLeafletPane(),this._leafletLinesLayer=new K.g(this._leafletPane),this._linesCanvas=this._leafletLinesLayer.canvas,this._linesCanvas.style["pointer-events"]="none",this._linesCanvas.style.background="none !important",this._linesCanvas.style.filter="Alpha(opacity=0)",this._linesCanvas.style.opacity=this._opacity.toString(),this._linesContext=this._linesCanvas.getContext("2d"),this._leafletSpritesLayer=new K.g(this._leafletPane),this._spritesCanvas=this._leafletSpritesLayer.canvas,this._spritesCanvas.style["pointer-events"]="none",this._spritesCanvas.style.background="none !important",this._spritesCanvas.style.filter="Alpha(opacity=0)",this._spritesCanvas.style.opacity=this._opacity.toString(),this._spritesContext=this._spritesCanvas.getContext("2d")},ze.prototype._viewLeafletParticleSystems=function(){var oe=this.map.engine,de={};de.pane=this._leafletPane,this._linesEnabled?(this._lines.start(),oe.addLayer(this._leafletLinesLayer,de)):(this._lines.stop(),oe.removeLayer(this._leafletLinesLayer)),this._spritesEnabled?(this._sprites.start(),oe.addLayer(this._leafletSpritesLayer,de)):(this._sprites.stop(),oe.removeLayer(this._leafletSpritesLayer))},ze.prototype._unloadLeaflet=function(){var oe=this.map.engine;oe.hasLayer(this._leafletLinesLayer)&&oe.removeLayer(this._leafletLinesLayer),this._leafletLinesLayer=void 0,this._linesCanvas=void 0,this._linesContext=void 0,oe.hasLayer(this._leafletSpritesLayer)&&oe.removeLayer(this._leafletSpritesLayer),this._leafletSpritesLayer=void 0,this._spritesCanvas=void 0,this._spritesContext=void 0},ze.prototype._loadMapbox=function(){this.map.styled.addListener(this._onMapStyled,this);var oe=this.map,de=oe._mapboxEngine,Re=this._deriveMapboxCoordinates(),He=this._createMapboxCanvas("lines");this._linesCanvas=He,this._linesContext=He.getContext("2d"),this.map.element.appendChild(this._linesCanvas);var mt=this.id+"_lines";this._mapboxLinesSource=this._createMapboxSource(He.id,Re),this._mapboxLinesLayer=this._createMapboxLayer(mt),de.addSource(mt,this._mapboxLinesSource);var Ft=this._createMapboxCanvas("sprites");this._spritesCanvas=Ft,this._spritesContext=Ft.getContext("2d"),this.map.element.appendChild(this._spritesCanvas);var Gt=this.id+"_sprites";this._mapboxSpritesSource=this._createMapboxSource(Ft.id,Re),this._mapboxSpritesLayer=this._createMapboxLayer(Gt),de.addSource(Gt,this._mapboxSpritesSource)},ze.prototype._viewMapboxParticleSystems=function(){this._mapboxGroup=[],this._linesEnabled?(this._mapboxGroup.push(this._mapboxLinesLayer),this._lines.start()):this._lines.stop(),this._spritesEnabled?(this._mapboxGroup.push(this._mapboxSpritesLayer),this._sprites.start()):this._sprites.stop(),this._unloadMapboxGroup(),this.map._arrangeLayers(),this._adjustMapbox()},ze.prototype._createMapboxCanvas=function(oe){var de=document.createElement("canvas");return de.id="__"+this.map.elementId+"_"+this.id+"_"+oe,de.style.display="none",de.style["pointer-events"]="none",de.style.background="none !important",de.style.filter="Alpha(opacity=0)",de},ze.prototype._createMapboxSource=function(oe,de){var Re={type:"canvas",canvas:oe,animate:!0,coordinates:de};return Re},ze.prototype._createMapboxLayer=function(oe){var de={id:oe,type:"raster",source:oe,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,transition:{duration:0,delay:0},paint:{"raster-opacity":this._opacity,"raster-fade-duration":0,"raster-opacity-transition":{duration:0,delay:0}}};return de},ze.prototype._adjustMapbox=function(){var oe=this.map,de=this._deriveMapboxCoordinates();if(this._lines.isEmitting){var Re=this.id+"_lines",He=oe._mapboxEngine.getSource(Re);He.setCoordinates(de)}if(this._sprites.isEmitting){var mt=this.id+"_sprites",Ft=oe._mapboxEngine.getSource(mt);Ft.setCoordinates(de)}},ze.prototype._deriveMapboxCoordinates=function(){var oe=this.map._mapboxEngine,de=oe.getBounds(),Re=de._ne,He=de._sw,mt=[[He.lng,Re.lat],[Re.lng,Re.lat],[Re.lng,He.lat],[He.lng,He.lat]];return mt},ze.prototype._unloadMapbox=function(){this.map.styled.removeListener(this._onMapStyled,this);var oe=this.map._mapboxEngine;this._linesCanvas.parentNode.removeChild(this._linesCanvas),this._linesCanvas=void 0,this._linesContext=void 0,this._mapboxLinesLayer=void 0,this._mapboxLinesSource=void 0;var de=this.id+"_lines";oe.getLayer(de)&&oe.removeLayer(de),oe.getSource(de)&&oe.removeSource(de),this._spritesCanvas.parentNode.removeChild(this._spritesCanvas),this._spritesCanvas=void 0,this._spritesContext=void 0,this._mapboxSpritesLayer=void 0,this._mapboxSpritesSource=void 0;var Re=this.id+"_sprites";oe.getLayer(Re)&&oe.removeLayer(Re),oe.getSource(Re)&&oe.removeSource(Re),this._mapboxGroup=[]},ze.prototype._onMapZooming=function(oe){this._toggleVisibility(),this._render()},ze.prototype._onMapZoomed=function(oe){this._toggleVisibility(),this._render()},ze.prototype._onMapPanning=function(oe){this._lines.stop(),this._render()},ze.prototype._onMapPanned=function(oe){this._render(),this._lines.start()},ze.prototype._onMapMoving=function(oe){this._lines.stop(),this._render()},ze.prototype._onMapMoved=function(oe){this._render(),this._lines.start()},ze.prototype._onMapResized=function(oe){this._resize(this.map.width+2,this.map.height+2)},ze.prototype._onMapEnabled=function(oe){this.update()},ze.prototype._onMapDisabled=function(oe){},ze.prototype._onMapStyled=function(oe){this._resize(this.map.width+2,this.map.height+2)},ze}(h.m),Et=B(73690),bi=B(59687),gt=B(69548),Qe=B(38433),we=B(18078),Ae=B(68575),it=B(64026),Lt=B(9606),ei=B(55117),Si=function(){function xt(ze){this._meta={},this._maxNativeZoom=13,this._elevations=[],this._key=ze;var oe=this._timeManager=new ei.l;oe._validBackward=A.i.min,oe._validForward=A.i.max}return Object.defineProperty(xt.prototype,"key",{get:function(){return this._key},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"meta",{get:function(){return this._meta},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"validTimes",{get:function(){return this._timeManager._validTimes},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"modelRuns",{get:function(){return this._timeManager._modelRuns},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"currentDiscreteTime",{get:function(){return this._timeManager._currentDiscreteTime},enumerable:!0,configurable:!0}),Object.defineProperty(xt.prototype,"elevations",{get:function(){return this._elevations},enumerable:!0,configurable:!0}),xt}(),ui=function(){function xt(){}return xt}(),ni=function(){var xt=function(ze,oe){return xt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(de,Re){de.__proto__=Re}||function(de,Re){for(var He in Re)Re.hasOwnProperty(He)&&(de[He]=Re[He])},xt(ze,oe)};return function(ze,oe){xt(ze,oe);function de(){this.constructor=ze}ze.prototype=oe===null?Object.create(oe):(de.prototype=oe.prototype,new de)}}(),Bi=function(xt){ni(ze,xt);function ze(oe){oe===void 0&&(oe={});var de=xt.call(this,oe)||this;return de.uProductKey=void 0,de.vProductKey=void 0,de.speedProductKey=void 0,de.directionProductKey=void 0,de.paletteProductKey=void 0,de.apiKey=void 0,de.particleUrl=void 0,de.infoPollingInterval=void 0,de.infoPollingTimeout=void 0,de.cacheLimit=void 0,de.pruneInterval=void 0,de.pruneAutomatically=void 0,de.timeRange=void 0,de.timeMode=void 0,(0,Q.f0)(de,oe),de}return ze}(Ue),Ci=function(xt){ni(ze,xt);function ze(oe){var de=xt.call(this,oe instanceof Bi?oe:new Bi(oe))||this;if(de._hasMetaData=!1,de._pendingTiles={},de._pendingTilesCount=0,de._pendingRequests={},de._isAnimate=!1,de._maxNativeZoom=13,de._dimension=256,de._cachedTiles={},de._lastInspectionPoint=new W.E(0,0),de._lastInspectionGeoPoint=k.F.fromRadians(0,0),de.metaDataLoaded=new C.j,de.metaDataModified=new C.j,de._timeRange=oe.timeRange||new we.e,de._timeMode=oe.timeMode,oe.uProductKey&&oe.vProductKey)de._uProduct=new Si(oe.uProductKey),de._vProduct=new Si(oe.vProductKey),de._uProduct._timeManager._timeRange=de._timeRange,de._vProduct._timeManager._timeRange=de._timeRange,de._dataType=ot.UV;else if(oe.speedProductKey&&oe.directionProductKey)de._speedProduct=new Si(oe.speedProductKey),de._directionProduct=new Si(oe.directionProductKey),de._speedProduct._timeManager._timeRange=de._timeRange,de._directionProduct._timeManager._timeRange=de._timeRange,de._dataType=ot.SpeedDirection;else throw new Error("InvalidArgumentException: uProductKey+vProductKey or speedProductKey+directionProductKey combination required");return oe.paletteProductKey&&(de._paletteProduct=new Si(oe.paletteProductKey),de._paletteProduct._timeManager._timeRange=de._timeRange),de._apiKey=oe.apiKey,de._infoPollingInterval=oe.infoPollingInterval||new A.i(6e4),de._infoPollingTimeout=oe.infoPollingTimeout||new A.i(1e4),de._cacheLimit=oe.cacheLimit||5e3,de._pruneInterval=oe.pruneInterval||new A.i(1e4),de._pruneAutomatically=(0,Q.le)(oe.pruneAutomatically)?!0:oe.pruneAutomatically,de._pruneAutomatically&&(de._pruneTimer=setInterval(function(){return de._pruneTiles()},de._pruneInterval.totalMilliseconds)),de}return Object.defineProperty(ze.prototype,"uProduct",{get:function(){return this._uProduct},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"vProduct",{get:function(){return this._vProduct},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"speedProduct",{get:function(){return this._speedProduct},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"directionProduct",{get:function(){return this._directionProduct},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"paletteProduct",{get:function(){return this._paletteProduct},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"hasMetaData",{get:function(){return this._hasMetaData},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"pruneInterval",{get:function(){return this._pruneInterval},set:function(oe){var de=this;(0,Q.le)(oe)||oe.equals(this._pruneInterval)||(clearInterval(this._pruneTimer),this._pruneInterval=oe,this._pruneTimer=setInterval(function(){return de._pruneTiles()},this._pruneInterval.totalMilliseconds))},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"cacheLimit",{get:function(){return this._cacheLimit},set:function(oe){var de=this;(0,Q.le)(oe)||oe===this._cacheLimit||(oe<this._cacheLimit&&this._pruneTiles(oe),this._cacheLimit=oe,clearInterval(this._pruneTimer),this._pruneTimer=setInterval(function(){return de._pruneTiles()},this._pruneInterval.totalMilliseconds))},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"pruneAutomatically",{get:function(){return this._pruneAutomatically},set:function(oe){var de=this;(0,Q.le)(oe)||oe===this._pruneAutomatically||(this._pruneAutomatically=oe,this._pruneAutomatically?this._pruneTimer=setInterval(function(){return de._pruneTiles()},this._pruneInterval.totalMilliseconds):clearInterval(this._pruneTimer))},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"timeRange",{get:function(){return this._timeRange},set:function(oe){oe!==this._timeRange&&(this._timeRange=oe,this._convertInfo()&&this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(ze.prototype,"timeMode",{get:function(){return this._timeMode},set:function(oe){oe in Q.$i||this.map&&(oe=this.map.animator.timeMode),this._timeMode=oe},enumerable:!0,configurable:!0}),ze.prototype._load=function(oe){xt.prototype._load.call(this,oe),this.timeMode===void 0&&(this._timeMode=this.map.animator.timeMode),this._infoClient?this._hasMetaData&&this.update():this._startService()},ze.prototype._unload=function(){switch(this._hasMetaData=!1,this._stopService(),this._isAnimate&&(this.map.animator.frameChanging.removeListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.removeListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this)),this._dataType){case ot.UV:this.uProduct._timeManager._unload(),this.vProduct._timeManager._unload();break;case ot.SpeedDirection:this.speedProduct._timeManager._unload(),this.directionProduct._timeManager._unload();break}this.paletteProduct&&this.paletteProduct._timeManager._unload(),xt.prototype._unload.call(this)},ze.prototype._startService=function(oe,de){var Re="";switch(this._dataType){case ot.UV:Re+=this._uProduct.key+","+this._vProduct.key;break;case ot.SpeedDirection:Re+=this._speedProduct.key+","+this._directionProduct.key}if(this._paletteProduct&&(Re+=","+this._paletteProduct.key),!this._infoClient){var He=de||this._apiKey||this.map.sunApiKey,mt=oe||this._particleUrl||this.map.sunParticleUrl;mt=mt+"&meta=true",mt=mt.replace("{productKey}",Re),mt=mt.replace("{apiKey}",He),this._infoClient=new Et.U(mt),this._infoClient.timeout=this._infoPollingTimeout.totalMilliseconds,this._infoClient.pollingInterval=this._infoPollingInterval.totalMilliseconds,this._infoClient.modified.addListener(this._onInfoLoaded,this),this._infoClient.startPolling()}},ze.prototype._stopService=function(){this._infoClient&&(this._infoClient.stopPolling(),this._infoClient.modified.removeListener(this._onInfoLoaded,this),delete this._infoClient)},ze.prototype._convertInfo=function(){var oe=!1;switch(this._dataType){case ot.UV:this._convertProduct(this._uProduct)&&(oe=!0),this._convertProduct(this._vProduct)&&(oe=!0),this._isAnimate=this._uProduct._isAnimate&&this._vProduct._isAnimate;break;case ot.SpeedDirection:this._convertProduct(this._speedProduct)&&(oe=!0),this._convertProduct(this._directionProduct)&&(oe=!0),this._isAnimate=this._speedProduct._isAnimate&&this._directionProduct._isAnimate;break}return this._paletteProduct&&this._convertProduct(this._paletteProduct)&&(oe=!0),oe},ze.prototype._convertProduct=function(oe){var de=this._infoClient.objectLiteral,Re=oe.key.split(":"),He=de.layers[Re[0]][Re[1]],mt=oe._timeManager;if(He.meta){if(oe._meta=He.meta,He.meta.ttl){var Ft=He.meta.ttl*1e3*2.5;mt._validForward=new A.i(Ft)}for(var Gt=this._maxNativeZoom=0,Bt=He.meta.tileset["Web Mercator"].tiles,Kt=0,qt=Bt.length;Kt<qt;Kt++){var fi=Bt[Kt];fi.lod>Gt&&(Gt=fi.lod)}oe._maxNativeZoom=Gt,oe._maxNativeZoom>this._maxNativeZoom&&(this._maxNativeZoom=oe._maxNativeZoom)}for(var Ii=[],zi=[],Yt=[],ur=He.dimensions.length>0?Math.max(He.dimensions.length-1,1):0,Kt=0;Kt<ur;Kt++){var yi=He.dimensions[Kt];if(yi.z&&(Ii=yi.z),yi.rt){for(var hr=parseInt(yi.rt),ir=new Date(hr),zr=new gt.o(ir),rn=0,Br=yi.t.length;rn<Br;rn++){var nn=yi.t[rn],wn=parseInt(nn);if(this._timeRange.inRange(wn)){var Pn=new Date(wn),An=new bi.T(Pn);zr.validTimes.push(An)}}Yt.push(zr)}else{var Ni=parseInt(yi.t[0]);if(this._timeRange.inRange(Ni)){var wr=new Date(Ni),An=new bi.T(wr);zi.push(An)}}}var mn=!1;if(mt._validTimes&&mt._validTimes.length>0||zi.length>0){var ho=JSON.stringify(mt._validTimes),Cr=JSON.stringify(zi);if(mn=ho!==Cr,mn){var Po=oe.validTimes.filter(function(co){for(var Fr in zi)if(JSON.stringify(zi[Fr])===JSON.stringify(co))return!1;return!0});this._purge(Po)}}else if(mt._modelRuns&&mt._modelRuns.length>0||Yt.length>0){var Gn=JSON.stringify(mt._modelRuns),Xr=JSON.stringify(Yt);if(mn=Gn!==Xr,mn){var ln=mt._modelRuns.filter(function(co){return Yt.indexOf(co)===-1});this._purge(ln)}}return oe._elevations=Ii,mt._modelRuns=Yt.length>0?Yt:null,mt._validTimes=zi.length>0?zi:null,oe._isAnimate=Yt.length>0||zi.length>0,mn},ze.prototype._loadTiles=function(oe,de){var Re=this._map;if(!(!Re||!Re.isEnabled)&&!(Re.animator.isPaused&&Re.animator.isPlaying)){oe||(oe=this._loadProductGroup());var He=!1;de&&(He=!0);var mt=oe.a.product,Ft=oe.b.product,Gt=oe.c.product,Bt=oe.a.discreteTime,Kt=oe.b.discreteTime,qt=oe.c.discreteTime,fi=mt._elevations.length>0?mt._elevations[0]:"-1",Ii=Ft._elevations.length>0?Ft._elevations[0]:"-1",zi=Gt&&Gt._elevations.length>0?Gt._elevations[0]:"-1",Yt=mt.key,ur=Ft.key,yi=Gt?Gt.key:void 0;if(this.opacity===0||!Bt||!Bt.validTime||!Kt||!Kt.validTime||Gt&&(!qt||!qt.validTime)){this._clearSurface();return}if(!this._timeRange.inRange(this.map.clock.time)){this._clearSurface();return}if(this._isVisible){for(var hr=Re.zoomLevel<this._maxNativeZoom?Re.zoomLevel:this._maxNativeZoom,de=de||Re._calculateTiles(hr,256,!1),ir={},zr=0,rn=de.length;zr<rn;zr++){var Br=de[zr],nn=Br.z+"_"+Br.x+"_"+Br.y;this._aggregateTile(Br,nn,Yt,Bt,fi,ir),this._aggregateTile(Br,nn,ur,Kt,Ii,ir),Gt&&this._aggregateTile(Br,nn,yi,qt,zi,ir)}var wn=this._pendingRequests,Pn=this._pendingTiles;if(!He)for(var An in wn){var Ni=wn[An];if(!Ni.isPreserved){for(var wr=!1,mn=0;mn<length;mn++){var ho=de[mn],nn=Bt.key+"_"+ho.z+"_"+ho.x+"_"+ho.y;if(nn===An){wr=!0;break}}if(!wr){Ni.abort();for(var Cr in Pn)Cr.indexOf("key")!==0&&(delete Pn[Cr],this._pendingTilesCount--)}}}this._requestAggregateTiles(ir,He)}}},ze.prototype._calculateWorldTiles=function(){if(this.minimumZoom<2)for(var oe=[],de=0;de<2;de++)for(var Re=0;Re<2;Re++)oe.push(new Ae.n(1,de,Re));return oe},ze.prototype._aggregateTile=function(oe,de,Re,He,mt,Ft){var Gt=Re+"_"+He.key+"_"+de+"_"+mt,Bt=oe.z,Kt=oe.x,qt=oe.y;if(this._cachedTiles.hasOwnProperty(Gt)){this._cachedTiles[Gt].lastAccessed=performance.now();return}if(!this._pendingTiles.hasOwnProperty(Gt)){var fi=new it.K(Bt,Kt,qt);fi.elevation=mt,fi.discreteTime=He,Ft[de]=Ft[de]||{},Ft[de][Re]=fi}},ze.prototype._requestAggregateTiles=function(oe,de){de===void 0&&(de=!1);var Re=this._apiKey||this.map.sunApiKey;for(var He in oe){var mt=oe[He],Ft=[],Gt=[],Bt=[],Kt=[],qt=[],fi=[],Ii=[];for(var zi in mt){var Yt=mt[zi];Ft.push(zi),Bt.push(Yt.x),Kt.push(Yt.y),qt.push(Yt.elevation),Gt.push(Yt.z),fi.push(Yt.discreteTime.validTime.value.getTime()),Yt.discreteTime.modelRun?Ii.push(Yt.discreteTime.modelRun.value.getTime()):Ii.push("-1"),this._pendingTiles[zi+"_"+Yt.key]=Yt,this._pendingTilesCount++}var ur=Yt.discreteTime.key+"_"+He,yi=this._particleUrl||this.map.sunParticleUrl;yi=yi.replace("v2/tiler/info","v2/tiler/data-aggregate"),yi=yi+"&rt={rt}&t={t}&lod={lod}&x={x}&y={y}",yi=yi.replace("{apiKey}",Re),yi=yi.replace("{productKey}",Ft.join(",")),yi=yi.replace("{lod}",Gt.join(",")),yi=yi.replace("{x}",Bt.join(",")),yi=yi.replace("{y}",Kt.join(",")),yi=yi.replace("{z}",qt.join(",")),yi=yi.replace("{t}",fi.join(",")),Ii.length>0?yi=yi.replace("{rt}",Ii.join(",")):yi=yi.replace("&rt={rt}",""),this._requestAggregateTile(yi,mt,ur,de)}},ze.prototype._requestAggregateTile=function(oe,de,Re,He){var mt=this;this.loadState!=Q.jd.Loading&&this._changeLoadState(Q.jd.Loading);var Ft=Et.U.createCorsRequest("GET",oe,!0,!1);Ft.onerror=function(){mt._registerAggregateTile(de),delete mt._pendingRequests[Re]},Ft.timeout=function(){mt._registerAggregateTile(de),delete mt._pendingRequests[Re]},Ft.onabort=function(){mt._registerAggregateTile(de),delete mt._pendingRequests[Re]},Ft.onprogress=function(){},Ft.onload=function(){mt._registerAggregateTile(de),mt._formatAggregateTile(Ft.response,de),delete mt._pendingRequests[Re]},this._pendingRequests[Re]=Ft,Ft.isPreserved=He,Ft.responseType="arraybuffer",Ft.send()},ze.prototype._registerAggregateTile=function(oe){for(var de in oe){var Re=oe[de],He=de+"_"+Re.key;this._pendingTiles[He]&&(this._pendingTilesCount--,delete this._pendingTiles[He])}this._pendingTilesCount<=0&&this.loadState!=Q.jd.Loaded&&(this._pendingTilesCount=0,this._changeLoadState(Q.jd.Loaded))},ze.prototype._formatAggregateTile=function(oe,de){var Re=new DataView(oe);if(Re.byteLength!==0){var He=0,mt=0,Ft=Math.pow(this._dimension,2),Gt=Ft*4;for(var Bt in de){var Kt=de[Bt],qt=Re.getFloat32(He);if(qt!==0){var fi=new Float32Array(Ft),Ii=0;for(He+=4,mt=He+Gt;He<mt;He+=4)fi[Ii]=Re.getFloat32(He),Ii++;Kt.data=fi}else He+=4,mt=He,Kt.data=[];var zi=Bt+"_"+Kt.key;this._cachedTiles[zi]=Kt}}},ze.prototype._purge=function(oe){var de=oe&&oe.length>0,Re;if(de)oe[0].validTimes?Re=!0:Re=!1;else return;var He=[];for(var mt in this._cachedTiles){var Ft=!1,Gt=this._cachedTiles[mt],Bt=(0,Qe.RQ)(Gt.discreteTime.validTime.value),Kt=void 0;if(Re)for(var qt=0,fi=oe.length;qt<fi;qt++)for(var Ii=oe[qt],zi=Ii.validTimes,Yt=0,ur=zi.length;Yt<ur;Yt++){var yi=zi[Yt];if(Kt=(0,Qe.RQ)(Ii.value)+"_"+(0,Qe.RQ)(yi.value),Bt===Kt){Ft=!0;break}}else for(var Yt=0,ur=oe.length;Yt<ur;Yt++){var yi=oe[Yt];if(Kt=(0,Qe.RQ)(yi.value),Bt===Kt){Ft=!0;break}}Ft&&He.push(mt)}for(var qt=0,hr=He.length;qt<hr;qt++){var ir=He[qt];delete this._cachedTiles[ir]}},ze.prototype._pruneTiles=function(oe){var de=this,Re=Object.keys(this._cachedTiles),He=(0,Q.le)(oe)?this._cacheLimit:oe;if(Re.length>He)for(var mt=Re.sort(function(qt,fi){return de._cachedTiles[fi].lastAccessed-de._cachedTiles[qt].lastAccessed}),Ft=mt.slice(He),Gt=0,Bt=Ft.length;Gt<Bt;Gt++){var Kt=Ft[Gt];delete this._cachedTiles[Kt]}},ze.prototype._updateProduct=function(oe){var de=this.map.clock.time,Re=oe._timeManager,He=Re._deriveDiscreteTime(de);return!Re._currentDiscreteTime||!Re._currentDiscreteTime.equals(He)?(Re._currentDiscreteTime=He,!0):!1},ze.prototype._determineVelocity=function(oe,de){var Re=oe.position,He=oe.tileIndex=this._determineTileIndex(Re);switch(this._dataType){case ot.SpeedDirection:var mt=this.inspect(this.speedProduct,Re,He),Ft=this.inspect(this.directionProduct,Re,He);if((0,Q.le)(mt)||(0,Q.le)(Ft))return null;var Gt;switch(this._speedUnit){case Me.qC.MilesPerHour:Gt=mt*.44704;break;case Me.qC.KilometersPerHour:Gt=mt*.27777778;break;case Me.qC.Knots:Gt=mt*.51444444;break;case Me.qC.FeetPerSecond:Gt=mt*.3048;break;case Me.qC.CentimetersPerSecond:Gt=mt*100;break;case Me.qC.MetersPerSecond:default:Gt=mt;break}var Bt;switch(this._directionUnit){case Me.TW.Radians:Bt=mt;break;case Me.TW.Degrees:default:Bt=Ft*.017453292519943295;break}de.x=Gt*-Math.sin(Bt),de.y=Gt*Math.cos(Bt);break;case ot.UV:var Kt=this.inspect(this.uProduct,Re,He),qt=this.inspect(this.vProduct,Re,He);if((0,Q.le)(Kt)||(0,Q.le)(qt))return null;de.x=Kt,de.y=qt;break}},ze.prototype._determineColor=function(oe){var de=this._lines.palette,Re=oe.position,He;if(de){switch(this._paletteSource){case Me.Yh.SpeedData:He=oe.velocity.magnitude;break;case Me.Yh.DirectionData:He=oe.velocity.angle;break;case Me.Yh.PaletteData:this.paletteProduct&&(He=this.inspect(this.paletteProduct,Re,oe.tileIndex));break}if(!He)return"rgba(0, 0, 0, 0)";var mt=de.apply(He),Ft="rgba("+mt[0]+","+mt[1]+","+mt[2]+","+mt[3]+")";return Ft}else return this._lines.color},ze.prototype._determineTileIndex=function(oe){var de=this._dimension,Re=Math.min(Math.floor(this._map.zoomLevel),this._maxNativeZoom),He=Lt.x.convertGeoToPixel(oe,Re,this._lastInspectionPoint),mt=(0,Q.oY)(de/256,2),Ft=Math.pow(2,Re-mt),Gt=(Math.floor(He.x/de)+Ft)%Ft,Bt=Math.floor(He.y/de);He.x=(He.x+Ft*de)%(Ft*de);var Kt=Math.floor(He.x)-Gt*de,qt=Math.floor(He.y)-Bt*de,fi=qt*de+Kt;return{index:fi,z:Re,x:Gt,y:Bt}},ze.prototype.inspect=function(oe,de,Re){var He=null,mt=oe._timeManager;if(mt._currentDiscreteTime&&this._timeRange.inRange(this.map.clock.time)){var Ft=this._lastInspectionPoint,Gt,Bt=this._dimension,Kt=(0,Q.oY)(Bt/256,2),qt=this._cachedTiles,fi=oe.key+"_"+mt._currentDiscreteTime.key,Ii,zi,Yt;if(Re){Ii=Re.x,zi=Re.y,Yt=Re.z;var ir=fi+"_"+Yt+"_"+Ii+"_"+zi+"_-1",hr=qt[ir];if(hr)return He=hr.data[Re.index],He}var ur;if(de instanceof W.E?ur=this.map.fromScreenToGeo(de,this._lastInspectionGeoPoint):ur=de,Ii===void 0||zi===void 0||Yt===void 0){var yi=Math.min(Math.floor(this._map.zoomLevel),this._maxNativeZoom);Lt.x.convertGeoToPixel(ur,yi,this._lastInspectionPoint),Gt=Math.pow(2,yi-Kt),Yt=yi,Ii=(Math.floor(Ft.x/Bt)+Gt)%Gt,zi=Math.floor(Ft.y/Bt)}var hr=qt[ir],ir=fi+"_"+Yt+"_"+Ii+"_"+zi;if(!hr){Yt=Yt-1,Ii=Ii>>1,zi=zi>>1;for(var zr=fi+"_"+Yt+"_"+Ii+"_"+zi;Yt>0;){if(qt.hasOwnProperty(zr)){hr=qt[zr];break}Yt=Yt-1,Ii=Ii>>1,zi=zi>>1,zr=fi+"_"+Yt+"_"+Ii+"_"+zi}}if(hr){Lt.x.convertGeoToPixel(ur,Yt,this._lastInspectionPoint),Gt=Math.pow(2,Yt-Kt),Ft.x=(Ft.x+Gt*Bt)%(Gt*Bt);var rn=Math.floor(Ft.x)-hr.x*Bt,Br=Math.floor(Ft.y)-hr.y*Bt,nn=Br*Bt+rn;He=hr.data[nn]}}return isNaN(He)&&(He=null),He},ze.prototype.update=function(){if(this._hasMetaData){var oe,de,Re,He=!1;switch(this._dataType){case ot.UV:oe=this.uProduct,this._updateProduct(this.uProduct)&&(He=!0),de=this.vProduct,this._updateProduct(this.vProduct)&&(He=!0);break;case ot.SpeedDirection:oe=this.speedProduct,this._updateProduct(this.speedProduct)&&(He=!0),de=this.directionProduct,this._updateProduct(this.directionProduct)&&(He=!0);break}if(this.paletteProduct&&(Re=this.paletteProduct,this._updateProduct(this.paletteProduct)&&(He=!0)),He){var mt={a:{product:oe,discreteTime:oe._timeManager._currentDiscreteTime},b:{product:de,discreteTime:de._timeManager._currentDiscreteTime},c:{product:Re,discreteTime:Re?Re._timeManager._currentDiscreteTime:void 0}};this._loadTiles(mt,this._calculateWorldTiles()),this._loadTiles(mt),this._render(),this.updated.trigger({id:this.id})}return He}},ze.prototype._loadProductGroup=function(oe){var de,Re,He,mt,Ft,Gt;switch(this._dataType){case ot.UV:de=this.uProduct,mt=oe?this.uProduct._timeManager._deriveDiscreteTime(oe):this.uProduct._timeManager._currentDiscreteTime,Re=this.vProduct,Ft=oe?this.vProduct._timeManager._deriveDiscreteTime(oe):this.vProduct._timeManager._currentDiscreteTime;break;case ot.SpeedDirection:de=this.speedProduct,mt=oe?this.speedProduct._timeManager._deriveDiscreteTime(oe):this.speedProduct._timeManager._currentDiscreteTime,Re=this.directionProduct,Ft=oe?this.directionProduct._timeManager._deriveDiscreteTime(oe):this.directionProduct._timeManager._currentDiscreteTime;break}this.paletteProduct&&(He=this.paletteProduct,Gt=oe?this.paletteProduct._timeManager._deriveDiscreteTime(oe):this.paletteProduct._timeManager._currentDiscreteTime);var Bt={a:{product:de,discreteTime:mt},b:{product:Re,discreteTime:Ft},c:{product:He,discreteTime:Gt}};return Bt},ze.prototype._onInfoLoaded=function(oe){var de=this._convertInfo();this._hasMetaData?de&&(this.metaDataModified.trigger(),this.map&&this.map.isEnabled&&this.update()):(this._hasMetaData=!0,this._infoClient.url=this._infoClient.url.replace("&meta=true",""),this.map&&this.map.isEnabled&&(this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this)),this.metaDataLoaded.trigger(),this.update()))},ze.prototype._onAnimatorFrameChanging=function(oe){if(this.map&&this.map.isEnabled){var de=oe.time,Re=this._loadProductGroup(de);this._loadTiles(Re)}},ze.prototype._onAnimatorFrameChanged=function(oe){this.map&&this.map.isEnabled&&this.update()},ze.prototype._onTimeChanged=function(oe){this._timeMode===Q.$i.Relative&&this._timeRange._increment(),this.map&&this.map.isEnabled&&this.update()},ze.prototype._onMapEnabled=function(oe){this._infoClient.startPolling(),this._spritesEnabled&&this._sprites.start(),this._linesEnabled&&this._lines.start()},ze.prototype._onMapDisabled=function(oe){switch(this._spritesEnabled&&this._sprites.stop(),this._linesEnabled&&this._lines.stop(),this._infoClient.stopPolling(),this._hasMetaData=!1,this._cachedTiles={},this._dataType){case ot.UV:this.uProduct._timeManager._unload(),this.vProduct._timeManager._unload();break;case ot.SpeedDirection:this.speedProduct._timeManager._unload(),this.directionProduct._timeManager._unload();break}this.paletteProduct&&this.paletteProduct._timeManager._unload()},ze.prototype._onMapPanning=function(oe){},ze.prototype._onMapPanned=function(oe){},ze.prototype._onMapZooming=function(oe){this._toggleVisibility(),this._loadTiles(),this._render(),this._isFirefox&&this.map.renderer===ce.Renderer.WebGL&&(this._linesEnabled&&(this._lines.clear(),this._lines.stop(),this._isFirefoxLinesStopped=!0),this._spritesEnabled&&(this._sprites.clear(),this._sprites.stop(),this._isFirefoxSpritesStopped=!0))},ze.prototype._onMapZoomed=function(oe){this._toggleVisibility(),this._loadTiles(),this._isFirefox&&this.map.renderer===ce.Renderer.WebGL&&(this._isFirefoxLinesStopped&&(this._lines.start(),this._isFirefoxLinesStopped=!1),this._isFirefoxSpritesStopped&&(this._sprites.start(),this._isFirefoxSpritesStopped=!1)),this._render()},ze.prototype._onMapMoving=function(oe){this._loadTiles(),this._lines.isEmitting&&(this._lines._dequeue(),this._lines._blur(),this._lines._update(),this._lines._queue()),this._sprites.isEmitting&&(this._sprites._dequeue(),this._sprites.clear(),this._sprites._update(),this._sprites._queue()),this._isFirefox&&this.map.renderer===ce.Renderer.WebGL&&(this._linesEnabled&&(this._lines.stop(),this._isFirefoxLinesStopped=!0),this._spritesEnabled&&(this._sprites.stop(),this._isFirefoxSpritesStopped=!0)),this._render()},ze.prototype._onMapMoved=function(oe){this._loadTiles(),this._isFirefox&&this.map.renderer===ce.Renderer.WebGL&&(this._isFirefoxLinesStopped&&(this._lines.clear(),this._lines.start(),this._isFirefoxLinesStopped=!1),this._isFirefoxSpritesStopped&&(this._sprites.clear(),this._sprites.start(),this._isFirefoxSpritesStopped=!1)),this._render()},ze}(ht)},20512:(ct,Ye,B)=>{"use strict";B.d(Ye,{J:()=>q,p:()=>re});var Q=B(84922),W=B.n(Q),h=B(96302),K=B.n(h),k=B(66071),A=B(28360),z=B(50042),R=B(66389),C=B(38433),x=B(72503),v=B(5860),m=B(69011),T=B(55117),I=B(18078),F=function(){var ne=function(se,X){return ne=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ce,Me){ce.__proto__=Me}||function(ce,Me){for(var Be in Me)Me.hasOwnProperty(Be)&&(ce[Be]=Me[Be])},ne(se,X)};return function(se,X){ne(se,X);function ce(){this.constructor=se}se.prototype=X===null?Object.create(X):(ce.prototype=X.prototype,new ce)}}(),q=function(ne){F(se,ne);function se(X){X===void 0&&(X={});var ce=ne.call(this,X)||this;return ce.validBackward=void 0,ce.validForward=void 0,ce.timeRange=void 0,ce.timeMode=void 0,(0,k.f0)(ce,X),ce}return se}(R.z),re=function(ne){F(se,ne);function se(X){var ce=ne.call(this,X=X instanceof q?X:new q(X))||this;ce._frames={},ce._isAnimate=!1,ce._hasMetaData=!1,ce._pendingFrameTimer=-1,ce._isHidden=!0,ce.metaDataLoaded=new A.j,ce.metaDataModified=new A.j,ce.modelRunChanged=new A.j,ce.validTimeChanged=new A.j;var Me=ce._timeManager=new T.l;return Me._validBackward=X.validBackward||x.i.min,Me._validForward=X.validForward||x.i.max,ce._timeRange=X.timeRange||new I.e,ce._timeMode=X.timeMode,Me._timeRange=ce._timeRange,ce._maximumNativeZoom=ce._maximumZoom,ce}return Object.defineProperty(se.prototype,"hasMetaData",{get:function(){return this._hasMetaData},enumerable:!0,configurable:!0}),Object.defineProperty(se.prototype,"currentDiscreteTime",{get:function(){return this._timeManager._currentDiscreteTime},enumerable:!0,configurable:!0}),Object.defineProperty(se.prototype,"modelRuns",{get:function(){return this._timeManager._modelRuns},enumerable:!0,configurable:!0}),Object.defineProperty(se.prototype,"validTimes",{get:function(){return this._timeManager._validTimes},enumerable:!0,configurable:!0}),Object.defineProperty(se.prototype,"timeRange",{get:function(){return this._timeRange},set:function(X){X!==this._timeRange&&(this._timeRange=X,this._timeManager._timeRange=X)},enumerable:!0,configurable:!0}),Object.defineProperty(se.prototype,"timeMode",{get:function(){return this._timeMode},set:function(X){X in k.$i||this.map&&(X=this.map.animator.timeMode),this._timeMode=X},enumerable:!0,configurable:!0}),se.prototype._load=function(){switch(this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this.map.animator.stopped.addListener(this._onAnimatorStopped,this),this.timeMode===void 0&&(this._timeMode=this.map.animator.timeMode),this.map.renderer){case m.Renderer.WebDOM:this._loadLeaflet();break;case m.Renderer.WebGL:this._loadMapbox();break}},se.prototype._unload=function(){switch(this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this.map.animator.stopped.removeListener(this._onAnimatorStopped,this),this._timeManager._unload(),this._clearFrames(),this.map.renderer){case m.Renderer.WebDOM:this._unloadLeaflet();break;case m.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(k.jd.Unloaded)},se.prototype._changeOpacity=function(X){if(!(0,k.le)(X)&&X!=this._opacity){var ce=this._opacity;if(this._opacity=X,this.map)switch(this.map.renderer){case m.Renderer.WebDOM:for(var Me in this._frames){var Be=this._frames[Me];Be.setOpacity(X)}break;case m.Renderer.WebGL:this._currentFrame&&(this._currentFrame.layer.paint["raster-opacity"]=X,this.map._mapboxEngine.setPaintProperty(this._currentFrame.layer.id,"raster-opacity",X));break}this.opacityChanged.trigger({old:ce,new:X})}},se.prototype._preloadFrame=function(X){switch(this.map.renderer){case m.Renderer.WebDOM:return this._preloadLeafletFrame(X);case m.Renderer.WebGL:return this._preloadMapboxFrame(X)}},se.prototype._addFrame=function(X,ce){switch(ce===void 0&&(ce=!1),this.map.renderer){case m.Renderer.WebDOM:return this._addLeafletFrame(X,ce);case m.Renderer.WebGL:return this._addMapboxFrame(X,ce)}},se.prototype._changeFrame=function(X){switch(this.map.renderer){case m.Renderer.WebDOM:this._changeLeafletFrame(X);break;case m.Renderer.WebGL:this._changeMapboxFrame(X);break}},se.prototype._updateFrames=function(){var X=this.currentDiscreteTime.modelRun,ce=X?X.validTimes:this.validTimes;if(this.modelRuns&&this.modelRuns.length>0)for(var Me in this._frames){for(var Be=!1,ot=0,Ue=this.modelRuns.length;ot<Ue;ot++)for(var ht=this.modelRuns[ot],Et=0,bi=ht.validTimes.length;Et<bi;Et++){var gt=ht.validTimes[Et];if(gt.value&&this._timeRange.inRange(gt.value)){var Qe=(0,C.RQ)(ht.value)+"_"+(0,C.RQ)(gt.value);if(Me===Qe){Be=!0;break}}}Be||this._removeFrame(Me)}else if(this.validTimes&&this.validTimes.length>0)for(var Me in this._frames){for(var Be=!1,Et=0,bi=this.validTimes.length;Et<bi;Et++){var gt=this.validTimes[Et];if(gt.value&&this._timeRange.inRange(gt.value)){var Qe=(0,C.RQ)(gt.value);if(Me===Qe){Be=!0;break}}}Be||this._removeFrame(Me)}},se.prototype._removeFrame=function(X){switch(this.map.renderer){case m.Renderer.WebDOM:this._removeLeafletFrame(X);break;case m.Renderer.WebGL:this._removeMapboxFrame(X);break}X===this._currentFrameKey&&(this._isHidden=!0)},se.prototype._clearFrames=function(){for(var X in this._frames)this._removeFrame(X);this._frames={}},se.prototype.update=function(){if(this._hasMetaData){var X=this._timeManager,ce=this.map.clock.time;if(X._timeRange.inRange(ce)){var Me=X._deriveDiscreteTime(ce);(this._isHidden||!X._currentDiscreteTime||!X._currentDiscreteTime.equals(Me))&&(X._currentDiscreteTime=Me,this._changeFrame(Me),this._isHidden=!1,this.updated.trigger({id:this.id}))}else this._isHidden||(this._changeFrame(new v.d),this._isHidden=!0)}},se.prototype.changeModelRun=function(X){this._timeManager._providedModelRun=X,this.update()},se.prototype._loadLeaflet=function(){this._loadLeafletPane()},se.prototype._unloadLeaflet=function(){this._leafletPane&&(K().DomUtil.remove(this._leafletPane),this._leafletPane=void 0)},se.prototype._preloadLeafletFrame=function(X){if(X.validTime&&this._timeRange.inRange(X.validTime.value)){var ce=X.key,Me=this._frames[ce]||this._addFrame(X,!0);return Me.options.bounds=this._bounds?this._bounds.toLeaflet():this.map._maxBounds.toLeaflet(),Me._resetView(),Me}return null},se.prototype._addLeafletFrame=function(X,ce){var Me=X.key,Be=this._deriveUrlTemplate(X),ot=this._deriveLeafletOptions(),Ue=new(K()).TileLayer(Be,ot);Ue._key=Me,Ue._loadState=k.jd.Unloaded,Ue._isPreloading=ce,Ue.on("loading",this._onFrameLoading,this),Ue.on("load",this._onFrameLoaded,this),this._frames[Me]=Ue,this.map._leafletEngine.addLayer(Ue),Ue._isVisible=!1;var ht=Ue.getContainer();return ht.style.visibility="hidden",ht.style.display="none",Ue.options.bounds=z.c.minimum.toLeaflet(),Ue},se.prototype._changeLeafletFrame=function(X){if(this.map&&this.map.enabled&&this.map._leafletEngine){var ce=X.key;if(X.validTime){var Me=this._frames[ce]||this._addFrame(X);Me.options.bounds=this._bounds?this._bounds.toLeaflet():this.map._maxBounds.toLeaflet(),Me._resetView();var Be=Me.getContainer();Be.style.visibility="visible",Be.style.display="block",Me._loadState!=this._loadState&&this._changeLoadState(Me._loadState),Me._isVisible=!0,Me._isPreloading=!1,this._currentFrame=Me,this._currentFrameKey=ce}for(var ot in this._frames)if(ot!=ce){var Ue=this._frames[ot];if(Ue._isVisible){Ue._isVisible=!1,Ue._isPreloading=!1;var Be=Ue.getContainer();Be.style.visibility="hidden",Be.style.display="none",this._map.animator.isPlaying||(Ue.options.bounds=z.c.minimum.toLeaflet(),Ue._resetView())}}}},se.prototype._removeLeafletFrame=function(X){var ce=this._frames[X];ce.on("loading",this._onFrameLoading,this),ce.on("load",this._onFrameLoaded,this),this.map.engine.removeLayer(ce),delete this._frames[X]},se.prototype._loadMapbox=function(){var X=this.map._mapboxEngine;X.on("sourcedataloading",this._onFrameLoading.bind(this)),X.on("sourcedata",this._onFrameLoaded.bind(this))},se.prototype._unloadMapbox=function(){this.map._mapboxEngine.off("sourcedataloading",this._onFrameLoading.bind(this)),this.map._mapboxEngine.off("sourcedata",this._onFrameLoaded.bind(this))},se.prototype._preloadMapboxFrame=function(X){if(X.validTime&&this._timeRange.inRange(X.validTime.value)){var ce=X.key,Me=this._frames[ce]||this._addFrame(X,!0);if(!this.map.animator.isPlaying&&X.toString()!==this.currentDiscreteTime.toString()){var Be=this.map.engine.style.sourceCaches[Me.id];Be.hide()}return Me}return null},se.prototype._addMapboxFrame=function(X,ce){var Me=X.key,Be=this._id+"_"+Me,ot=this._deriveUrlTemplate(X),Ue=this.map._mapboxEngine,ht=this._bounds||z.c.world,Et=[],bi=this._subdomains;if(bi)for(var gt=0,Qe=bi.length;gt<Qe;gt++){var we=bi[gt],Ae=ot.replace("{s}",we);Et.push(Ae)}else ot=ot.replace("{s}",""),Et.push(ot);var it={};it.source={type:"raster",tileSize:256,tiles:Et,key:Me,maxzoom:this._maximumNativeZoom,scheme:this._isTms?"tms":"xyz",bounds:[ht.west.degrees,ht.south.degrees,ht.east.degrees,ht.north.degrees]},it.layer={id:Be,type:"raster",source:Be,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,paint:{"raster-fade-duration":0,"raster-opacity":0,"raster-opacity-transition":{duration:0,delay:0}},layout:{}},it.id=Be,it._key=Me,it._loadState=k.jd.Unloaded,it._isPreloading=ce,this._frames[Me]=it,Ue.addSource(Be,it.source),this._mapboxGroup.push(it.layer);var Lt=W().layerGroups.getGroupFirstLayerIndex(Ue,this.id)>=0;if(Lt){var ei=W().layerGroups.getGroupFirstLayer(Ue,this.id);W().layerGroups.addLayerToGroup(Ue,this.id,it.layer,ei),this._map._arrangeLayers()}else this._unloadMapboxGroup(),this._loadMapboxGroup();return it},se.prototype._changeMapboxFrame=function(X){var ce=this;if(clearTimeout(this._pendingFrameTimer),this.map&&this.map.enabled&&this.map._mapboxEngine){var Me=X.key,Be=this.map._mapboxEngine,ot=Be.style,Ue=this.opacity;if(X.validTime){var ht=this._frames[Me]||this._addFrame(X),Et=ht.id,bi=ot.sourceCaches[Et],gt=bi&&bi.loaded();if(!gt){this._pendingFrameTimer=setTimeout(function(){ce._changeMapboxFrame(X)},30);return}bi.show(),ht.layer.paint["raster-opacity"]=Ue,Be.setPaintProperty(Et,"raster-opacity",Ue),ht._isVisible=!0,ht._isPreloading=!1,this._currentFrame=ht,this._currentFrameKey=Me}for(var Qe in this._frames)if(Qe!=Me){var we=this._frames[Qe];if(we._isVisible){we._isVisible=!1,we._isPreloading=!1,we.layer.paint["raster-opacity"]=0,Be.setPaintProperty(we.id,"raster-opacity",0);var Ae=ot.sourceCaches[we.id];Ae.hide()}}}},se.prototype._removeMapboxFrame=function(X){var ce=this._frames[X],Me=ce.id,Be=this.map._mapboxEngine;Be.getLayer(Me)&&Be.removeLayer(Me),Be.getSource(Me)&&Be.removeSource(Me);for(var ot=-1,Ue=this._mapboxGroup,ht=0,Et=Ue.length;ht<Et;ht++){var bi=Ue[ht];if(bi.id===ce.layer.id){ot=ht;break}}ot>=0&&(Ue.splice(ot,1),this._unloadMapboxGroup(),this._loadMapboxGroup()),delete this._frames[X]},se.prototype._onAnimatorFrameChanging=function(X){if(this.map&&this.map.isEnabled){var ce=this._timeManager._deriveDiscreteTime(X.time);ce.validTime&&this._preloadFrame(ce)}},se.prototype._onAnimatorFrameChanged=function(X){this.map&&this.map.isEnabled&&this.update()},se.prototype._onAnimatorStopped=function(X){if(this.map&&this.map.isEnabled){var ce=this._currentFrameKey;switch(this.map.renderer){case m.Renderer.WebDOM:for(var Me in this._frames)if(Me!=ce){var Be=this._frames[Me];Be.options.bounds=z.c.minimum.toLeaflet(),Be._resetView()}break;case m.Renderer.WebGL:for(var Me in this._frames)if(Me!=ce){var Be=this._frames[Me],ot=this.map.engine.style.sourceCaches[Be.id];ot&&ot.hide()}break}}},se.prototype._onTimeChanged=function(X){if(this._timeMode===k.$i.Relative&&this._timeRange._increment(),this.map&&this.map.isEnabled&&this.update(),this.loadState===k.jd.Loading&&this.map.renderer===m.Renderer.WebGL){var ce=this._frames[this.currentDiscreteTime.key];if(ce){var Me=this.map.engine.style.sourceCaches[ce.id];Me&&Me.loaded()&&this._changeLoadState(k.jd.Loaded)}}},se.prototype._onFrameLoading=function(X){if(this.map&&this.map.isEnabled){var ce=void 0;switch(this.map.renderer){case m.Renderer.WebDOM:ce=X.target;break;case m.Renderer.WebGL:if(X.sourceId&&X.sourceId.indexOf(this.id)===0){var Me=this.map.engine,Be=Me.style.sourceCaches[X.sourceId];Be&&!Be.loaded()&&(ce=this._frames[X.source.key])}break}ce&&ce._loadState!=k.jd.Loading&&(ce._loadState=k.jd.Loading,this.loadState!=k.jd.Loading&&(!this._currentFrameKey||ce._key===this._currentFrameKey||ce._isPreloading)&&this._changeLoadState(k.jd.Loading))}},se.prototype._onFrameLoaded=function(X){if(this.map&&this.map.isEnabled){var ce=void 0;switch(this.map.renderer){case m.Renderer.WebDOM:ce=X.target;break;case m.Renderer.WebGL:if(X.sourceId&&X.sourceId.indexOf(this.id)===0){var Me=this.map.engine,Be=Me.style.sourceCaches[X.sourceId];Be&&Be.loaded()&&(ce=this._frames[X.source.key])}break}if(ce&&(ce._loadState!=k.jd.Loaded||this._loadState!==k.jd.Loaded)){if(ce._loadState=k.jd.Loaded,ce._isPreloading=!1,this.map.renderer===m.Renderer.WebGL){if(this.loadState!=k.jd.Loaded&&this.currentDiscreteTime){var ot=this._frames[this.currentDiscreteTime.key];if(ot){var Ue=this.map.engine.style.sourceCaches[ot.id];Ue&&Ue.loaded()&&this._changeLoadState(k.jd.Loaded)}}}else if(this.loadState!=k.jd.Loaded&&this.currentDiscreteTime){var ot=this._frames[this.currentDiscreteTime.key];if(ot){var ht=ot&&ot._loadState===k.jd.Loading;ht||this._changeLoadState(k.jd.Loaded)}}}}},se.prototype._onMapEnabled=function(X){var ce=this._bounds||this.map.maximumBounds,Me=[ce.west.degrees,ce.south.degrees,ce.east.degrees,ce.north.degrees];if(this._currentFrameKey){var Be=this._frames[this._currentFrameKey];switch(this.map.renderer){case m.Renderer.WebDOM:Be.options.bounds=ce.toLeaflet(),Be._resetView();break;case m.Renderer.WebGL:var ot=this.map.engine.style.sourceCaches[Be.id];ot.resume(),ot.show();break}}this.update()},se.prototype._onMapDisabled=function(X){var ce=z.c.minimum;for(var Me in this._frames){var Be=this._frames[Me];switch(this.map.renderer){case m.Renderer.WebDOM:Be.options.bounds=ce.toLeaflet(),Be._resetView();break;case m.Renderer.WebGL:var ot=this.map.engine.style.sourceCaches[Be.id];ot.hide();break}}},se}(R.I)},85491:(ct,Ye,B)=>{"use strict";B.d(Ye,{x:()=>v,e:()=>m});var Q=B(66071),W=B(73690),h=B(69548),K=B(59687),k=B(50042),A=B(9506),z=B(22045),R=B(72503),C=B(20512),x=function(){var T=function(I,F){return T=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(q,re){q.__proto__=re}||function(q,re){for(var ne in re)re.hasOwnProperty(ne)&&(q[ne]=re[ne])},T(I,F)};return function(I,F){T(I,F);function q(){this.constructor=I}I.prototype=F===null?Object.create(F):(q.prototype=F.prototype,new q)}}(),v=function(T){x(I,T);function I(F){F===void 0&&(F={});var q=T.call(this,F)||this;return q.productKey=void 0,q.productSet=void 0,q.tileUrl=void 0,q.seriesUrl=void 0,q.seriesPollingInterval=void 0,q.seriesPollingTimeout=void 0,q.apiKey=void 0,(0,Q.f0)(q,F),q}return I}(C.J),m=function(T){x(I,T);function I(F){var q=T.call(this,F=F instanceof v?F:new v(F))||this;return q._enableUpdating=!0,q._subdomains=F.subdomains||["0","1","2","3"],q._productKey=F.productKey,q._productSet=F.productSet,q._tileUrl=F.tileUrl,q._seriesUrl=F.seriesUrl,q._seriesPollingInterval=F.seriesPollingInterval||new R.i(6e4),q._seriesPollingTimeout=F.seriesPollingTimeout||new R.i(1e4),q._apiKey=F.apiKey,q}return Object.defineProperty(I.prototype,"enableUpdating",{get:function(){return this._enableUpdating},set:function(F){this._enableUpdating=F,F&&!this._seriesClient.isPolling?this._seriesClient.startPolling():!F&&this._seriesClient.isPolling&&this._seriesClient.stopPolling()},enumerable:!0,configurable:!0}),I.prototype._convertSeries=function(F){for(var q=this._timeManager,re=F?JSON.parse(F):this._seriesClient.objectLiteral,ne=this._productKey,se=re.series?re:re.seriesInfo[ne],X=[],ce=[],Me=se.series.length>0?Math.max(se.series.length-1,1):0,Be=0;Be<Me;Be++){var ot=se.series[Be];if(ot.fts&&ot.fts.length>0){for(var Ue=new Date(ot.ts*1e3),ht=new h.o(Ue),Et=0,bi=ot.fts.length;Et<bi;Et++){var gt=new Date(ot.fts[Et]*1e3),Qe=new K.T(gt);Qe.epoch=ot.fts[Et],ht.validTimes.push(Qe)}ht.epoch=ot.ts,X.push(ht)}else{var gt=new Date(ot.ts*1e3),Qe=new K.T(gt);Qe.epoch=ot.ts,ce.push(Qe)}}if(se.bb){var we=se.bb;if(we.br.lat==="-90.05"&&we.br.lng==="180.05"&&we.tl.lat==="90.05"&&we.tl.lng==="-180.05")this.map?this._bounds=this.map._maxBounds:this._bounds=k.c.fromDegrees(85.05113,-3600,-85.05113,3600);else{var Ae=A.K.fromDegrees(parseFloat(we.tl.lat)),it=z.o.fromDegrees(parseFloat(we.tl.lng)),Lt=A.K.fromDegrees(parseFloat(we.br.lat)),ei=z.o.fromDegrees(parseFloat(we.br.lng)),Si=new k.c(Ae,it,Lt,ei);this._bounds=Si}}var ui=this._maximumNativeZoom;se.maxZoom&&ui>se.maxZoom&&(ui=se.maxZoom),this._maximumNativeZoom=ui,this._isAnimate=X.length>0||ce.length>0;var ni=!1;if(q._modelRuns&&q._modelRuns.length>0||X.length>0){var Bi=JSON.stringify(q._modelRuns),Ci=JSON.stringify(X);ni=Bi!==Ci}if(q._modelRuns=X.length>0?X:null,!ni&&(q._validTimes&&q._validTimes.length>0||ce.length>0)){var xt=JSON.stringify(q._validTimes),ze=JSON.stringify(ce);ni=xt!==ze}return q._validTimes=ce.length>0?ce:null,ni},I.prototype._deriveLeafletOptions=function(){var F=T.prototype._deriveLeafletOptions.call(this);return F.tms=!1,F},I.prototype._deriveUrlTemplate=function(F){var q=this._tileUrl||this.map.sunTileUrl;if(!q||!F.validTime)return this._errorTileUrl;var re=this._apiKey||this.map.sunApiKey;return q=q.replace("{apiKey}",re),q=q.replace("{productKey}",this._productKey),F.modelRun?(q=q.replace("{ts}",F.modelRun.epoch),q=q.replace("{fts}",F.validTime.epoch)):(q=q.replace("&fts={fts}",""),q=q.replace("{ts}",F.validTime.epoch)),q},I.prototype._load=function(){T.prototype._load.call(this),this._seriesClient?this._hasMetaData&&this.update():this._startService()},I.prototype._startService=function(F,q){if(!this._seriesClient){var re=q||this._apiKey||this.map.sunApiKey,ne=F||this._seriesUrl||this.map.sunSeriesUrl;this._productSet?(ne=ne.replace("{productSet}",this._productSet),this._productKey&&(ne+="&filter="+this._productKey)):(ne=ne.replace("/productSet/{productSet}",""),this._productKey&&(ne=ne.replace("{productKey}",this._productKey))),this._productKey||(ne=ne.replace("/product/{productKey}","")),ne=ne.replace("{apiKey}",re),this._seriesClient=new W.U(ne),this._seriesClient.pollingInterval=this._seriesPollingInterval.totalMilliseconds,this._seriesClient.timeout=this._seriesPollingTimeout.totalMilliseconds,this._seriesClient.modified.addListener(this._onSeriesLoaded,this),this.enableUpdating?this._seriesClient.startPolling():this._seriesClient.sendRequest()}},I.prototype._stopService=function(){this._seriesClient&&(this._seriesClient.stopPolling(),this._seriesClient.modified.removeListener(this._onSeriesLoaded,this),this._seriesClient=void 0)},I.prototype._unload=function(){this._isAnimate&&(this.map.animator.frameChanging.removeListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.removeListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this)),this._stopService(),this._hasMetaData=!1,T.prototype._unload.call(this)},I.prototype.preload=function(F,q){this._seriesClient||this._startService(F,q)},I.prototype._onSeriesLoaded=function(F){var q=this._convertSeries();this._hasMetaData?q?(this._updateFrames(),this.map&&this.map.isEnabled&&this.update(),this.metaDataModified.trigger()):this._updateFrames():(this._hasMetaData=!0,this.map&&(this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this)),this.map.isEnabled&&this.update()),this.metaDataLoaded.trigger())},I.prototype._onMapEnabled=function(F){this.enableUpdating&&this._seriesClient.startPolling(),T.prototype._onMapEnabled.call(this,F)},I.prototype._onMapDisabled=function(F){this._seriesClient.stopPolling(),T.prototype._onMapDisabled.call(this,F)},I}(C.p)},66389:(ct,Ye,B)=>{"use strict";B.d(Ye,{z:()=>R,I:()=>C});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(19501),k=B(35992),A=B(69011),z=function(){var x=function(v,m){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,I){T.__proto__=I}||function(T,I){for(var F in I)I.hasOwnProperty(F)&&(T[F]=I[F])},x(v,m)};return function(v,m){x(v,m);function T(){this.constructor=v}v.prototype=m===null?Object.create(m):(T.prototype=m.prototype,new T)}}(),R=function(x){z(v,x);function v(m){m===void 0&&(m={});var T=x.call(this,m)||this;return T.errorTileUrl=void 0,T.isTms=void 0,T.isZoomReversed=void 0,T.maximumNativeZoom=void 0,T.subdomains=void 0,T.tileSize=void 0,T.urlTemplate=void 0,T.zoomOffset=void 0,(0,h.f0)(T,m),T}return v}(k.M),C=function(x){z(v,x);function v(m){var T=x.call(this,m=m instanceof R?m:new R(m))||this;return T._errorTileUrl=m.errorTileUrl||"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNgYAAAAAMAASsJTYQAAAAASUVORK5CYII=",T._maximumNativeZoom=m.maximumNativeZoom,T._isTms=m.isTms!=null?m.isTms:!1,T._isZoomReversed=m.isZoomReversed!=null?m.isZoomReversed:!1,T._subdomains=m.subdomains,T._tileSize=m.tileSize||new K.$(256,256),T._urlTemplate=m.urlTemplate,T._zoomOffset=m.zoomOffset||0,T}return v.prototype._load=function(){switch(this._changeLoadState(h.jd.Loading),this.map.renderer){case A.Renderer.WebDOM:this._loadLeaflet();break;case A.Renderer.WebGL:this._loadMapbox();break}},v.prototype._unload=function(){switch(this.map.renderer){case A.Renderer.WebDOM:this._unloadLeaflet();break;case A.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(h.jd.Unloaded)},v.prototype._changeOpacity=function(m){if(!(0,h.le)(m)&&m!=this._opacity){var T=this._opacity;if(this._opacity=m,this.map)switch(this.map.renderer){case A.Renderer.WebDOM:this._leafletLayer&&this._leafletLayer.setOpacity(m);break;case A.Renderer.WebGL:this._mapboxLayer&&(this._mapboxLayer.paint["raster-opacity"]=m,this.map._mapboxEngine.setPaintProperty(this.id,"raster-opacity",m));break}this.opacityChanged.trigger({old:T,new:m})}},v.prototype._loadLeaflet=function(){this._loadLeafletPane(),this._loadLeafletLayer()},v.prototype._loadLeafletLayer=function(){var m=this._deriveLeafletOptions(),T=new(W()).TileLayer(this._urlTemplate,m);T.on("loading",this._onLeafletLayerLoading,this),T.on("load",this._onLeafletLayerLoaded,this),T.setOpacity(this.opacity),this.map._leafletEngine.addLayer(T),this._leafletLayer=T},v.prototype._unloadLeaflet=function(){var m=this._leafletLayer;m&&(this.map.engine.removeLayer(m),m.off("loading",this._onLeafletLayerLoading,this),m.off("load",this._onLeafletLayerLoaded,this)),this._leafletLayer=void 0,W().DomUtil.remove(this._leafletPane),this._leafletPane=void 0},v.prototype._deriveLeafletOptions=function(){var m={};return m.reuseTiles=!0,m.pane=this._leafletPane,m.zoomReverse=this._isZoomReversed,m.tms=this._isTms,m.opacity=this._opacity,m.errorTileUrl=this._errorTileUrl,m.maxZoom=this._maximumZoom,m.minimumZoom=this._minimumZoom,m.tileSize=this._tileSize.height,m.zoomOffest=this._zoomOffset,m.maxNativeZoom=this._maximumNativeZoom<this._maximumZoom?this._maximumNativeZoom:this._maximumZoom,m.bounds=this._bounds?this._bounds.toLeaflet():this.map._maxBounds.toLeaflet(),m.noWrap=!1,this._subdomains&&(m.subdomains=this._subdomains),m},v.prototype._loadMapbox=function(){var m=[];if(this._subdomains)for(var T=0,I=this._subdomains.length;T<I;T++){var F=this._subdomains[T],q=this._urlTemplate.replace("{s}",F);m.push(q)}else m.push(this._urlTemplate);var re={type:"raster",tileSize:256,tiles:m,scheme:"xyz",maxzoom:this._maximumNativeZoom<this._maximumZoom?this._maximumNativeZoom:this._maximumZoom};this._bounds&&(re.bounds=[this._bounds.west.degrees,this._bounds.south.degrees,this._bounds.east.degrees,this._bounds.north.degrees]),this._mapboxSource=re,this.map.engine.addSource(this.id,re);var ne={id:this.id,type:"raster",source:this.id,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,paint:{"raster-fade-duration":0,"raster-opacity":this.opacity,"raster-opacity-transition":{duration:0,delay:0}},layout:{}};this._mapboxLayer=ne,this._mapboxGroup.push(ne);var se=this.map._mapboxEngine;se.on("sourcedataloading",this._onMapboxLayerLoading.bind(this)),se.on("sourcedata",this._onMapboxLayerLoaded.bind(this))},v.prototype._unloadMapbox=function(){var m=this.map._mapboxEngine;m.off("sourcedataloading",this._onMapboxLayerLoading.bind(this)),m.off("sourcedata",this._onMapboxLayerLoaded.bind(this)),m.removeLayer(this.id),m.removeSource(this.id),this._mapboxLayer=void 0,this._mapboxGroup=[]},v.prototype._onLeafletLayerLoading=function(m){this._changeLoadState(h.jd.Loading)},v.prototype._onLeafletLayerLoaded=function(m){this._changeLoadState(h.jd.Loaded)},v.prototype._onMapboxLayerLoading=function(m){m.sourceId&&m.sourceId.indexOf(this.id)===0&&this._changeLoadState(h.jd.Loading)},v.prototype._onMapboxLayerLoaded=function(m){m.sourceId&&m.sourceId.indexOf(this.id)===0&&this._changeLoadState(h.jd.Loaded)},v}(k.m)},83965:(ct,Ye,B)=>{"use strict";B.d(Ye,{Z:()=>ko});var Q=B(69011),W=B(28360),h=function(){function O(l){this._resumeEnabled=!1,this._isEnabled=!0,this.disabled=new W.j,this.enabled=new W.j,this._map=l,l.disabled.addListener(this._onMapDisabled,this),l.enabled.addListener(this._onMapEnabled,this)}return Object.defineProperty(O.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),O.prototype._onMapDisabled=function(l){this._resumeEnabled=this._isEnabled,this.disable()},O.prototype._onMapEnabled=function(l){this._resumeEnabled&&this.enable()},O}(),K=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),k=function(O){K(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.boxZoom.disable();break;default:this.map._mapboxEngine.boxZoom.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.boxZoom.enable();break;default:this.map._mapboxEngine.boxZoom.enable();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),A=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),z=function(O){A(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.doubleClickZoom.disable();break;default:this.map._mapboxEngine.doubleClickZoom.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.doubleClickZoom.enable();break;default:this.map._mapboxEngine.doubleClickZoom.enable();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),R=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),C=function(O){R(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.dragging.disable(),this.map._leafletEngine.options.tap=!1;break;default:this.map._mapboxEngine.dragPan.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.dragging.enable(),this.map._leafletEngine.options.tap=!0;break;default:this.map._mapboxEngine.dragPan.enable();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),x=B(66071),v=B(9654),m=B(19501),T=B(93126),I=B(50042),F=B(74776),q=B(83009),re=B(35992),ne=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),se=function(O){ne(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.bounds=void 0,s.size=void 0,s.isViewportBound=void 0,s.mode=void 0,s.contextType="2d",(0,x.f0)(s,i),s}return l.prototype.render=function(i,s,_,b){},l.prototype.init=function(i,s){},l}(re.M),X=function(O){ne(l,O);function l(i){var s=O.call(this,i=i instanceof se?i:new se(i))||this;return s._lastTopLeftGeoPoint=new v.F,s._lastBottomRightGeoPoint=new v.F,s._bounds=i.bounds||I.c.minimum,s._size=i.size,s._mode=i.mode||F.JH.Immediate,s._isViewportBound=i.isViewportBound!=null?i.isViewportBound:!0,s._contextType=i.contextType||"2d",s}return Object.defineProperty(l.prototype,"canvas",{get:function(){return this._canvas},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"bounds",{get:function(){return this._bounds||this.map.bounds},set:function(i){this._bounds=i,this.render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"size",{get:function(){var i=this._canvas.height,s=this._canvas.width,_=new m.$(s,i);return _},set:function(i){this._size=i,this.resize(i.width,i.height),this.render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isViewportBound",{get:function(){return this._isViewportBound},set:function(i){this._isViewportBound!=i&&(this._isViewportBound=i,i?(this.map.resized.addListener(this._onMapResized,this),this.resize(this.map.width+2,this.map.height+2)):this.map.resized.removeListener(this._onMapResized,this))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"mode",{get:function(){return this._mode},set:function(i){this._mode!=i&&(this._mode=i,i===F.JH.Immediate?this.map.moving.addListener(this._onMapMoving,this):this.map.moving.removeListener(this._onMapMoving,this))},enumerable:!0,configurable:!0}),l.prototype._load=function(){switch(this._changeLoadState(x.jd.Loading),this._isViewportBound&&this.map.resized.addListener(this._onMapResized,this),this._mode===F.JH.Immediate&&this.map.moving.addListener(this._onMapMoving,this),this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}this.isViewportBound?this.resize(this.map.width+2,this.map.height+2):this.resize(this._size.width,this._size.height),this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){switch(this._isViewportBound&&this.map.resized.removeListener(this._onMapResized,this),this._mode===F.JH.Immediate&&this.map.moving.removeListener(this._onMapMoving,this),this.map.renderer){case Q.Renderer.WebDOM:this._unloadLeaflet();break;case Q.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(x.jd.Unloaded)},l.prototype.update=function(){this.clear(),this.render()},l.prototype.resize=function(i,s){i&&s&&(this._size=new m.$(i,s));var _=i||this._size?this._size.width:this.map.width,b=s||this._size?this._size.height:this.map.height;this._canvas.width=_,this._canvas.height=b,this.update()},l.prototype.render=function(){this._map._mapboxEngine?this._renderMapbox():this._map._leafletEngine&&this._renderLeaflet()},l.prototype.clear=function(){switch(this._contextType.toUpperCase()){case"WEBGL":var i=this._context;i.clearColor(0,0,0,0),i.enable(i.DEPTH_TEST),i.depthFunc(i.LEQUAL),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT);break;case"2D":default:var s=this._context;s.clearRect(0,0,this.map.width+2,this.map.height+2);break}},l.prototype._deriveMapboxCoordinates=function(i){var s=[[i.topLeftGeoPoint.longitude.degrees,i.topLeftGeoPoint.latitude.degrees],[i.topRightGeoPoint.longitude.degrees,i.topRightGeoPoint.latitude.degrees],[i.bottomRightGeoPoint.longitude.degrees,i.bottomRightGeoPoint.latitude.degrees],[i.bottomLeftGeoPoint.longitude.degrees,i.bottomLeftGeoPoint.latitude.degrees]];return s},l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)&&i!=this._opacity){var s=this._opacity;if(this._opacity=i,this.map)switch(this.map.renderer){case Q.Renderer.WebDOM:this._leafletLayer&&(this._leafletLayer.canvas.style.opacity=i);break;case Q.Renderer.WebGL:this._mapboxLayer&&(this._mapboxLayer.paint["raster-opacity"]=i,this.map._mapboxEngine.setPaintProperty(this.id,"raster-opacity",i));break}this.opacityChanged.trigger({old:s,new:i})}},l.prototype._loadLeaflet=function(){switch(this._loadLeafletPane(),this._leafletLayer=new q.g(this._leafletPane),this._canvas=this._leafletLayer.canvas,this._canvas.style["pointer-events"]="none",this._canvas.style.background="none !important",this._canvas.style.filter="Alpha(opacity=0)",this._contextType.toUpperCase()){case"WEBGL":this._context=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl");break;case"2D":default:this._context=this._canvas.getContext("2d");break}var i={};i.pane=this._leafletPane,this.map.engine.addLayer(this._leafletLayer,i),this._options.init(this.context,this.size)},l.prototype._unloadLeaflet=function(){this.map.engine.removeLayer(this._leafletLayer),this._leafletLayer=void 0},l.prototype._renderLeaflet=function(){var i=this.isViewportBound?this.map.bounds:this.bounds;this._options.render(this.context,this.size,i,this.map.zoomLevel)},l.prototype._loadMapbox=function(){this.map.styled.addListener(this._onMapStyled,this);var i=document.createElement("canvas");switch(i.id="__"+this.map.elementId+"_"+this.id,i.style.display="none",i.style["pointer-events"]="none",i.style.background="none !important",i.style.filter="Alpha(opacity=0)",this._canvas=i,this._contextType.toUpperCase()){case"WEBGL":this._context=this._canvas.getContext("webgl")||this._canvas.getContext("experimental-webgl");break;case"2D":default:this._context=this._canvas.getContext("2d");break}this.map.element.appendChild(i);var s=this.map._mapboxEngine,_=this.isViewportBound?this.map.bounds:this.bounds,b=this._deriveMapboxCoordinates(_),D={type:"canvas",canvas:this._canvas.id,animate:!0,coordinates:b};this._mapboxSource=D,s.addSource(this.id,D),this._mapboxLayer={id:this.id,type:"raster",source:this.id,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,transition:{duration:0,delay:0},paint:{"raster-opacity":this._opacity,"raster-fade-duration":0,"raster-opacity-transition":{duration:0,delay:0}}},this._mapboxGroup=[this._mapboxLayer],this._options.init(this.context,this.size)},l.prototype._renderMapbox=function(){var i=this.map._mapboxEngine.getSource(this.id),s=this.map,_;if(this.isViewportBound){var b=new T.E(-1,-1),D=new T.E(s.width+1,s.height+1),G=s.fromScreenToGeo(b,this._lastTopLeftGeoPoint),Z=s.fromScreenToGeo(D,this._lastBottomRightGeoPoint);_=new I.c,_.expand(G),_.expand(Z)}else _=this.bounds;var te=this._deriveMapboxCoordinates(_);i.setCoordinates(te),this._options.render(this.context,this.size,_,this.map.zoomLevel)},l.prototype._unloadMapbox=function(){this.map.styled.removeListener(this._onMapStyled,this),this.map._mapboxEngine.removeLayer(this.id),this.map._mapboxEngine.removeSource(this.id),this._canvas.parentNode.removeChild(this._canvas),this._canvas=void 0,this._context=void 0,this._mapboxGroup=void 0,this._mapboxLayer=void 0,this._mapboxSource=void 0},l.prototype._onMapResized=function(i){this.isViewportBound&&this.resize(this.map.width+2,this.map.height+2)},l.prototype._onMapMoving=function(i){this.map.zoomLevel>=this.minimumZoom&&this.map.zoomLevel<=this.maximumZoom?this.update():this.clear()},l.prototype._onMapStyled=function(i){this.resize(this.map.width+2,this.map.height+2)},l}(re.m),ce=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Me=function(O){ce(l,O);function l(i){var s=O.call(this,i=i instanceof se?i:new se(i))||this;return s._color=i.meta.color||"#999999",s._lineWidth=i.meta.lineWidth||1,s}return Object.defineProperty(l.prototype,"color",{get:function(){return this._color},set:function(i){this._color=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(i){this._lineWidth=i,this.update()},enumerable:!0,configurable:!0}),l.prototype._resize=function(){this._canvas.width=this.map.width,this._canvas.height=this.map.height},l.prototype._clear=function(){this._context.clearRect(0,0,this.map.width,this.map.height)},l.prototype._drawLine=function(i,s){this._context.beginPath(),this._context.moveTo(i.x+.5,i.y+.5),this._context.lineTo(s.x+.5,s.y+.5),this._context.stroke()},l.prototype._load=function(){this._changeLoadState(x.jd.Loading),O.prototype._load.call(this),this.map.moved.addListener(this._onMoved,this),this.map.zoomed.addListener(this._onZoomed,this),this.map.resized.addListener(this._onResized,this),this._resize(),this.update(),this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){this.map.moved.removeListener(this._onMoved,this),this.map.zoomed.removeListener(this._onZoomed,this),this.map.resized.removeListener(this._onResized,this),this._clear(),O.prototype._unload.call(this)},l.prototype.update=function(){if(!!this.map){this.map.renderer===Q.Renderer.WebGL&&this._renderMapbox(),this._clear(),this._context.lineWidth=this._lineWidth,this._context.strokeStyle=this._color;var i=this.map.bounds,s=this.map.zoomLevel,_;s<3?_=20:s<6?_=10:s<9?_=5:_=3;var b=Math.round(Math.round(i.west.degrees-_)/_)*_,D=Math.round(Math.round(i.east.degrees+_)/_)*_,G=Math.round(Math.round(i.south.degrees-_)/_)*_,Z=Math.round(Math.round(i.north.degrees+_)/_)*_;G<-85&&(G=-85.05113),Z>85&&(Z=85.05113);for(var te=b;te<D;te+=_){var ae=v.F.fromDegrees(G,te),Pe=this.map.fromGeoToScreen(ae),ve=v.F.fromDegrees(Z,te),pe=this.map.fromGeoToScreen(ve);this._drawLine(Pe,pe)}for(var Fe=G;Fe<Z;Fe+=_){var ke=v.F.fromDegrees(Fe,b),Ze=this.map.fromGeoToScreen(ke),at=v.F.fromDegrees(Fe,D),Ve=this.map.fromGeoToScreen(at);this._drawLine(Ze,Ve)}this.updated.trigger({id:this.id})}},l.prototype._renderMapbox=function(){var i=this.map._mapboxEngine.getSource(this.id),s=this.isViewportBound?this.map.bounds:this.bounds,_=this._deriveMapboxCoordinates(s);i.setCoordinates(_)},l.prototype._onMoved=function(i){this.update()},l.prototype._onResized=function(i){this._resize(),this.update()},l.prototype._onZoomed=function(i){this.update()},l}(X),Be=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),ot=function(O){Be(l,O);function l(i){var s=O.call(this,i)||this;return s._id="Graticule",s._isEnabled=!1,s}return Object.defineProperty(l.prototype,"color",{get:function(){return this._color},set:function(i){this._color=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(i){this._lineWidth=i,this.update()},enumerable:!0,configurable:!0}),l.prototype._loadLayer=function(){var i=new se;i.id=this._id,i.meta.color=this._color||"#999999",i.meta.lineWidth=this._lineWidth||1,i.size=this.map.size,i.bounds=this.map.bounds,this._layer=new Me(i)},l.prototype.disable=function(){this._isEnabled&&(this.map.removeLayer(this._id),this._isEnabled=!1,this.disabled.trigger())},l.prototype.enable=function(){!this._isEnabled&&this.map.isEnabled&&(this._loadLayer(),this._layer&&(this.map.addLayer(this._layer),this._isEnabled=!0,this.enabled.trigger()))},l.prototype.update=function(){this._isEnabled&&(this._layer.color=this._color,this._layer.lineWidth=this._lineWidth,this._layer.update())},l}(h),Ue=B(72503),ht=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Et=function(O){ht(l,O);function l(i){var s=O.call(this,i)||this;return s._isHovering=!1,s._delay=new Ue.i(1e3),s._tolerance=0,s._interval=new Ue.i(250),s._lastMouseMoved=null,s._lastMousePoint=null,s._isEnabled=!1,s}return Object.defineProperty(l.prototype,"delay",{get:function(){return this._delay},set:function(i){if(i.totalMilliseconds<this._interval.totalMilliseconds)throw new Error("InvalidArgumentException: delay cannot be shorter than interval");this._delay=i},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"interval",{get:function(){return this._interval},set:function(i){if(i.totalMilliseconds>this._delay.totalMilliseconds)throw new Error("InvalidArgumentException: interval cannot be longer than delay");this._interval=i},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isHovering",{get:function(){return this._isHovering},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"tolerance",{get:function(){return this._tolerance},set:function(i){this._tolerance=i},enumerable:!0,configurable:!0}),l.prototype._captureMouse=function(){this._lastMouseMoved=new Date;var i=this.map.mouse.screenPoint;this._lastMousePoint?(this._lastMousePoint.x=i.x,this._lastMousePoint.y=i.y):this._lastMousePoint=new T.E(i.x,i.y)},l.prototype._clearMouse=function(){this._lastMouseMoved=null,this._lastMousePoint=null},l.prototype._detectHover=function(){if(this.map.mouse.isOver&&!this._isHovering){var i=new Date,s=Ue.i.fromDates(this._lastMouseMoved,i);if(s.totalMilliseconds>this._delay.totalMilliseconds){this._isHovering=!0;var _={x:this.map.mouse.screenPoint.x,y:this.map.mouse.screenPoint.y,longitude:this.map.mouse.geoPoint.longitude.degrees,latitude:this.map.mouse.geoPoint.latitude.degrees};this.map.hovered.trigger(_)}}},l.prototype.disable=function(){this._isEnabled&&(clearInterval(this._timer),this._clearMouse(),this.map.mouseMove.removeListener(this._onMouseMove,this),this._isEnabled=!1,this._isHovering=!1,this.disabled.trigger())},l.prototype.enable=function(){var i=this;!this._isEnabled&&this.map.isEnabled&&(this.map.mouseMove.addListener(this._onMouseMove,this),this._captureMouse(),this._timer=window.setInterval(function(){i._detectHover()},this._interval.totalMilliseconds),this._isEnabled=!0,this.enabled.trigger())},l.prototype._onMouseMove=function(i){if(this._lastMousePoint===null)this._isHovering=!1,this._captureMouse();else{var s=Math.abs(this._lastMousePoint.x-i.x),_=Math.abs(this._lastMousePoint.y-i.y);(s>this.tolerance||_>this.tolerance)&&(this._isHovering=!1,this._captureMouse())}},l}(h),bi=B(96302),gt=B.n(bi),Qe=B(96002),we=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Ae=function(O){we(l,O);function l(i){var s=O.call(this,i=i instanceof re.M?i:new re.M(i))||this;return s._mapboxIsLoading=!1,s._mapboxIsPending=!1,s._mapboxGroup=[],s._mapboxFeatures={},s._mapboxData={type:"FeatureCollection",features:[]},s._mapboxLineLayer={id:s.id+"_line",type:"line",source:s._id,paint:{"line-width-transition":{delay:0,duration:0},"line-color-transition":{delay:0,duration:0},"line-opacity-transition":{delay:0,duration:0},"line-width":{property:"line-width",type:"identity"},"line-color":{property:"line-color",type:"identity"},"line-opacity":1},layout:{"line-join":"round","line-cap":"round"}},s._color=s._meta.color||"#999999",s._lineWidth=s._meta.lineWidth||1,s}return Object.defineProperty(l.prototype,"color",{get:function(){return this._color},set:function(i){this._color=i,this._reload()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(i){this._lineWidth=i,this._reload()},enumerable:!0,configurable:!0}),l.prototype._reload=function(){this._unload(),this._load()},l.prototype._render=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._renderLeaflet();break;case Q.Renderer.WebGL:this._renderMapbox();break}},l.prototype._load=function(){switch(this._changeLoadState(x.jd.Loading),this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}this.map.moved.addListener(this._onMoved,this),this.update(),this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){switch(this.map.moved.removeListener(this._onMoved,this),this.map.renderer){case Q.Renderer.WebDOM:this._unloadLeaflet();break;case Q.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(x.jd.Unloaded)},l.prototype.update=function(){this._render(),this.updated.trigger({id:this.id})},l.prototype._loadLeaflet=function(){this._loadLeafletPane(),this._leafletLayer=new(gt()).Polyline([],{color:this._color,weight:this._lineWidth}),this.map.engine.addLayer(this._leafletLayer)},l.prototype._unloadLeaflet=function(){this._leafletLayer&&this.map.engine.removeLayer(this._leafletLayer),this._leafletLayer=void 0},l.prototype._renderLeaflet=function(){if(this.map.isIdlVisible){var i=this.map.bounds,s=Qe.rm*Math.round(i.east.radians/Qe.rm),_=v.F.fromRadians(0,-Qe.rm/2+s),b=new(gt()).LatLng(85.05113,_.longitude.degrees),D=new(gt()).LatLng(-85.05113,_.longitude.degrees);this._leafletLayer&&this._leafletLayer.setLatLngs([b,D])}},l.prototype._loadMapbox=function(){this._mapboxData.features=[{type:"Feature",properties:{type:"PolylinePath","line-color":this._color,"line-opacity":1,"line-width":this._lineWidth},geometry:{type:"LineString",coordinates:[[180,85.05113],[180,-85.05113]]}}];var i={type:"geojson",data:this._mapboxData};this.map.engine.addSource(this.id,i),this._sortMapboxGroup()},l.prototype._unloadMapbox=function(){this._unloadMapboxGroup(),this.map.engine.removeSource(this.id),this._mapboxGroup=[]},l.prototype._sortMapboxGroup=function(){this._mapboxGroup=[this._mapboxLineLayer]},l.prototype._updateMapboxData=function(i){var s=this;if(i===void 0&&(i=!1),!this._mapboxIsLoading||i){this._mapboxIsLoading=!0,this._mapboxIsPending=!1,this._mapboxData.features=Object.keys(this._mapboxFeatures).map(function(b){return s._mapboxFeatures[b]});var _=this.map._mapboxEngine.getSource(this.id);_.setData(this._mapboxData)}else this._mapboxIsPending||(this._mapboxIsPending=!0)},l.prototype._renderMapbox=function(){},l.prototype._onMoved=function(i){this._render()},l}(re.m),it=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Lt=function(O){it(l,O);function l(i){var s=O.call(this,i)||this;return s._id="IDL",s._layer=null,s._isEnabled=!1,s}return l.prototype._loadLayer=function(){var i=new re.M;i.id=this._id,i.meta.color="#999999",i.meta.lineWidth=1,this._layer=new Ae(i)},l.prototype.disable=function(){this._isEnabled&&(this.map.removeLayer(this._id),this._isEnabled=!1,this.disabled.trigger())},l.prototype.enable=function(){!this._isEnabled&&this.map.isEnabled&&(this._loadLayer(),this._layer&&(this.map.addLayer(this._layer),this._isEnabled=!0,this.enabled.trigger()))},l.prototype.update=function(){this._isEnabled&&(this._layer.color=this._color,this._layer.lineWidth=this._lineWidth,this._layer.update())},l}(h),ei=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Si=function(O){ei(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.keyboard.disable();break;default:this.map._mapboxEngine.keyboard.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.keyboard.enable();break;default:this.map._mapboxEngine.keyboard.enable();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),ui=function(){function O(){}return Object.defineProperty(O,"agent",{get:function(){return navigator.userAgent},enumerable:!0,configurable:!0}),Object.defineProperty(O,"hasCanvas",{get:function(){return O._hasCanvas},enumerable:!0,configurable:!0}),Object.defineProperty(O,"hasCors",{get:function(){return O._hasCors},enumerable:!0,configurable:!0}),Object.defineProperty(O,"hasWebGL",{get:function(){return O._hasWebGL},enumerable:!0,configurable:!0}),Object.defineProperty(O,"hasWebSockets",{get:function(){return O._hasWebSockets},enumerable:!0,configurable:!0}),Object.defineProperty(O,"isFirefox",{get:function(){return O._isFirefox},enumerable:!0,configurable:!0}),O.findPosition=function(l){var i,s;if(i=s=0,l.offsetParent){do i+=l.offsetLeft,s+=l.offsetTop;while(l=l.offsetParent);return new T.E(i,s)}},O.injectCss=function(l){var i="__WxMap_Style",s=document.getElementsByTagName("head")[0],_,b,D;(b=document.getElementById(i))&&b?(b.styleSheet?(D=b.styleSheet.cssText,b.styleSheet.cssText=""):(D=b.innerHTML,b.innerHTML=""),l=D+l,_=document.createTextNode(l)):(b=document.createElement("style"),_=document.createTextNode(l),b.setAttribute("type","text/css"),b.setAttribute("id",i),s.insertBefore(b,s.firstChild)),b.styleSheet?b.styleSheet.cssText=_.nodeValue:b.appendChild(_)},O.injectHtml=function(l,i){var s=document.getElementById(i);s&&(s.innerHTML=l)},O.injectJavaScript=function(l){var i=document.createElement("script");i.async=!0,i.src=l,document.getElementsByTagName("body")[0].appendChild(i)},O._ctor=function(){if(!XMLHttpRequest)O._hasCors=!1;else{var l=new XMLHttpRequest;"withCredentials"in l?O._hasCors=!0:O._hasCors=typeof XDomainRequest!="undefined"}O._isFirefox=typeof InstallTrigger!="undefined";var i=document.createElement("canvas");return O._hasCanvas=!!(i.getContext&&i.getContext("2d")),O._hasWebGL=function(){var s="probablySupportsContext"in i?"probablySupportsContext":"supportsContext";return s in i?i[s]("webgl")||i[s]("experimental-webgl"):"WebGLRenderingContext"in window}(),O._hasWebSockets="WebSocket"in window&&window.WebSocket.CLOSING===2,i=null,null}(),O}(),ni;(function(O){O[O.Mouse=0]="Mouse",O[O.Keyboard=1]="Keyboard",O[O.Touch=2]="Touch"})(ni||(ni={}));var Bi=B(56278),Ci=B(15960),xt=function(){function O(l){this._isSliding=!0,this._isTicking=!0,this._tickingInterval=1e3,this.tick=new W.j,this.timeChanged=new W.j,this._time=l||new Date,this._lastUpdated=new Date,this.time=this.lastUpdated,this._advance()}return O.prototype._setIsSliding=function(l){l&&!this._isSliding?this._isSliding=l:!l&&this._isSliding&&(this._isSliding=l)},O.prototype._setIsTicking=function(l){l&&!this._isTicking?(this._isTicking=l,this._startTicking()):!l&&this._isTicking&&(this._isTicking=l,this._stopTicking())},Object.defineProperty(O.prototype,"interval",{get:function(){return this._tickingInterval},set:function(l){this._stopTicking(),this._tickingInterval=l,this._startTicking()},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isSliding",{get:function(){return this._isSliding},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isTicking",{get:function(){return this._isTicking},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"lastUpdated",{get:function(){return this._lastUpdated},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"time",{get:function(){return this._time},set:function(l){this._time=l;var i={time:this._time};this.timeChanged.trigger(i)},enumerable:!0,configurable:!0}),O.prototype._advance=function(){this._stopTicking();var l=new Date,i=this.lastUpdated;this._lastUpdated=l;var s=Ue.i.fromDates(i,l);if(this._isSliding){var _=this.time,b=new Date(_.getFullYear(),_.getMonth(),_.getDate(),_.getHours(),_.getMinutes(),_.getSeconds(),_.getMilliseconds()),D=b.getMilliseconds()+s.totalMilliseconds;b.setMilliseconds(D),this.time=b}var G={time:this.lastUpdated,elapsed:s};this.tick.trigger(G),this._startTicking()},O.prototype._startTicking=function(){var l=this;this._isTicking?this._timer=window.setTimeout(function(){l._advance()},this._tickingInterval):this._stopTicking()},O.prototype._stopTicking=function(){clearTimeout(this._timer)},O.prototype.startSliding=function(){this._setIsSliding(!0)},O.prototype.startTicking=function(){this._setIsTicking(!0)},O.prototype.stopSliding=function(){this._setIsSliding(!1)},O.prototype.stopTicking=function(){this._setIsTicking(!1)},O}(),ze=function(){function O(l){this._unloadedFrames={},this._animator=l;for(var i=this.animator.frameCount,s=1;s<=i;s++)this._unloadedFrames[s]=!1}return Object.defineProperty(O.prototype,"animator",{get:function(){return this._animator},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"count",{get:function(){var l=0;for(var i in this._unloadedFrames)this._unloadedFrames.hasOwnProperty(i)&&l++;return l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"unloadedFrames",{get:function(){return this._unloadedFrames},enumerable:!0,configurable:!0}),O}(),oe=function(){function O(l){l===void 0&&(l={}),this.dwell=void 0,this.enableLooping=void 0,this.endTime=void 0,this.frame=void 0,this.frameCount=void 0,this.timeMode=void 0,this.playRate=void 0,this.startTime=void 0,(0,x.f0)(this,l)}return O}(),de=function(){function O(l,i){this._animationTimer=null,this._clock=null,this._frame=13,this._dwellInterval=new Ue.i(500,0,0,0,0),this._dwellTimer=null,this._enableLooping=!0,this._endTime=null,this._isFirstLoopStarted=!1,this._isLoading=!1,this._isPlaying=!1,this._isPaused=!1,this._timeMode=x.$i.Relative,this._isStarting=!1,this._loadedFrames=null,this._periodPerFrame=new Ue.i(0,300,0,0,0),this._playRate=new Ue.i(300,0,0,0,0),this._startTime=null,this._frameCount=13,this._pauseDuration=new Ue.i(0,3,0,0,0),this._pauseElapsed=new Ue.i(0,0,0,0,0),this._pauseInterval=new Ue.i(100,0,0,0,0),this._isChangingFrame=!1,this.dwellChanged=new W.j,this.enableLoopingChanged=new W.j,this.endTimeChanged=new W.j,this.frameChanging=new W.j,this.frameChanged=new W.j,this.frameCountChanged=new W.j,this.loaded=new W.j,this.loading=new W.j,this.isPlayingChanged=new W.j,this.timeModeChanged=new W.j,this.periodPerFrameChanged=new W.j,this.playRateChanged=new W.j,this.started=new W.j,this.starting=new W.j,this.startTimeChanged=new W.j,this.stopped=new W.j,this.stopping=new W.j,i=i instanceof oe?i:new oe(i),this._clock=l||new xt,this._clock.tick.addListener(this._onTick,this),this._loadedFrames=new ze(this),this._endTime=this._clock.time,this._startTime=new Date(this._endTime.getFullYear(),this._endTime.getMonth(),this._endTime.getDate(),this._endTime.getHours()-1,this._endTime.getMinutes(),this._endTime.getSeconds(),this._endTime.getMilliseconds()),this.change(i)}return Object.defineProperty(O.prototype,"dwell",{get:function(){return this._dwellInterval},set:function(l){this._dwellInterval=l;var i={dwell:this._dwellInterval.totalMilliseconds};this.dwellChanged.trigger(i)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"enableLooping",{get:function(){return this._enableLooping},set:function(l){this._enableLooping=l;var i={enableLooping:this._enableLooping};this.enableLoopingChanged.trigger(i)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"endTime",{get:function(){return this._endTime},set:function(l){if(l<=this._startTime)throw new Error("InvalidArgumentException: EndTime must exceed the value of StartTime");this._endTime=l;var i=this._clock.time,s=Ue.i.fromDates(i,this._endTime);Math.abs(s.totalMilliseconds)<1e3&&(this._endTime=this._clock.time);var _=this._frameCount;this._syncFrames(_);var b={endTime:this._endTime};this.endTimeChanged.trigger(b)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"frame",{get:function(){return this._frame},set:function(l){this.skipToFrame(l)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"frameCount",{get:function(){return this._frameCount},set:function(l){this._frameCount=l,this._syncFrames(l);var i={frames:this._frameCount,frameCount:this._frameCount,periodPerFrame:this._periodPerFrame};this.frameCountChanged.trigger(i);var s={frameCount:this._frameCount,frames:this._frameCount,periodPerFrame:this._periodPerFrame};this.periodPerFrameChanged.trigger(s)},enumerable:!0,configurable:!0}),O.prototype._syncFrames=function(l){var i=Ue.i.fromDates(this._startTime,this._endTime,!1),s=i.totalMilliseconds/(this._frameCount-1),_=Math.floor(s);this._periodPerFrame=new Ue.i(_,0,0,0,0),this._isPlaying?(this._clock.time<this._startTime&&(this._clock.time=this._startTime),this._clock.time>this._endTime&&(this._clock.time=this._endTime),this.skipToTime(this._clock.time)):this.frame>l&&(this.frame=l)},Object.defineProperty(O.prototype,"isLoading",{get:function(){return this._isLoading},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isPlaying",{get:function(){return this._isPlaying},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isPaused",{get:function(){return this._isPaused},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"timeMode",{get:function(){return this._timeMode},set:function(l){l===x.$i.Relative&&this._timeMode!=x.$i.Relative?this._clock.tick.addListener(this._onTick,this):l===x.$i.Absolute&&this._timeMode!=x.$i.Absolute&&this._clock.tick.removeListener(this._onTick,this),this._timeMode=l;var i={timeMode:this._timeMode};this.timeModeChanged.trigger(i)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"loadedFrameCount",{get:function(){return this._isLoading?this._frameCount-this._loadedFrames.count:this._frameCount},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"loadedFramePercent",{get:function(){if(this._isLoading){var l=this._frameCount-this._loadedFrames.count,i=l/this._frameCount,s=i*100;return Math.round(s)}else return 100},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"periodPerFrame",{get:function(){return this._periodPerFrame},set:function(l){this._periodPerFrame=l;var i=Ue.i.fromDates(this._startTime,this._endTime,!1),s=i.totalMilliseconds/this._periodPerFrame.totalMilliseconds;this._frameCount=Math.ceil(s);var _={frames:this._frameCount,frameCount:this._frameCount,periodPerFrame:this._periodPerFrame};this.periodPerFrameChanged.trigger(_);var b={frames:this._frameCount,frameCount:this._frameCount,periodPerFrame:this._periodPerFrame};this.frameCountChanged.trigger(b)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"playRate",{get:function(){return this._playRate},set:function(l){this._playRate=l;var i={playRate:this._playRate.totalMilliseconds};this.playRateChanged.trigger(i)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"startTime",{get:function(){return this._startTime},set:function(l){if(l>=this._endTime)throw new Error("InvalidArgumentException: StartTime cannot exceed the value of EndTime");this._startTime=l;var i=this._clock.time,s=Ue.i.fromDates(i,this._startTime);Math.abs(s.totalMilliseconds)<1e3&&(this._startTime=this._clock.time);var _=this._frameCount;this._syncFrames(_);var b={startTime:this._startTime};this.startTimeChanged.trigger(b)},enumerable:!0,configurable:!0}),O.prototype._startDwelling=function(){var l=this;this._dwellTimer=window.setTimeout(function(){l._dwell()},this._dwellInterval.totalMilliseconds)},O.prototype._stopDwelling=function(){clearTimeout(this._dwellTimer)},O.prototype._startAnimating=function(){var l=this;this._animationTimer=window.setTimeout(function(){l._animate()},this._playRate.totalMilliseconds)},O.prototype._stopAnimating=function(){clearTimeout(this._animationTimer)},O.prototype._animate=function(){this._stopAnimating(),this._isPlaying&&this._isLoading&&(delete this._loadedFrames.unloadedFrames[this._frame],this._loadedFrames.count===0&&this._raiseLoaded()),this.forward(),this._startAnimating()},O.prototype._slide=function(l){var i=new Date,s=this._endTime.valueOf()+l.totalMilliseconds;i.setTime(s),this._endTime=i;var _={endTime:this._endTime};this.endTimeChanged.trigger(_);var b=new Date,D=this._startTime.valueOf()+l.totalMilliseconds;b.setTime(D),this._startTime=b;var G={startTime:this._startTime};this.startTimeChanged.trigger(G)},O.prototype._dwell=function(){this._stopAnimating(),this._isPlaying&&(this._stopDwelling(),this._frame===this._frameCount&&this.skipToStart(),this._startAnimating(),this._isStarting=!1,this._isFirstLoopStarted=!0)},O.prototype._raiseLoading=function(){this._loadedFrames=new ze(this),this._isLoading||(this._isLoading=!0,this.loading.trigger())},O.prototype._cancelLoading=function(){this._isLoading=!1},O.prototype._raiseLoaded=function(){this._isLoading&&(this._isLoading=!1,this.loaded.trigger())},O.prototype._changeFrame=function(l){if(!this._isChangingFrame){var i=this;this._isChangingFrame=!0;var s=function(){!i._isPaused||i._pauseElapsed.totalMilliseconds>=i._pauseDuration.totalMilliseconds?(clearTimeout(i._pauseTimer),i._pauseElapsed=new Ue.i(0,0,0,0,0),i._frame=l,i._clock.time=b,i._isChangingFrame=!1,i.frameChanged.trigger(G)):(i._pauseElapsed.add(i._pauseInterval),clearTimeout(i._pauseTimer),i._pauseTimer=window.setTimeout(s,i._pauseInterval.totalMilliseconds))},_=this._periodPerFrame.totalMilliseconds*(l-1),b=new Date,D=this._startTime.valueOf()+_;b.setTime(D);var G={previousFrame:this._frame,time:b,frame:l};this.frameChanging.trigger(G),s()}},O.prototype.change=function(l){var i=this;if(l.endTime!==void 0&&l.startTime!==void 0&&l.startTime>l.endTime)throw new Error("InvalidArgumentException: endTime must exceed the value of startTime");if(l.endTime!==void 0&&l.startTime===void 0&&l.endTime<this._startTime||l.startTime!==void 0&&l.endTime===void 0&&l.startTime>this._endTime)throw new Error("InvalidArgumentException: endTime must exceed the value of startTime");if(l.frameCount!==void 0&&l.frame!==void 0&&l.frame>l.frameCount)throw new Error("InvalidArgumentException: frameCount must match or exceed the value of frame");if(l.frameCount!==void 0&&l.frame===void 0&&l.frameCount<this._frame||l.frame!==void 0&&l.frameCount===void 0&&l.frame>this._frameCount)throw new Error("InvalidArgumentException: frameCount must match or exceed the value of frame");var s=!1;if(l.startTime!==void 0&&l.startTime!==this._startTime){this._startTime=l.startTime;var _=this._clock.time,b=Ue.i.fromDates(_,this._startTime);Math.abs(b.totalMilliseconds)<1e3&&(this._startTime=this._clock.time),s=!0,this.startTimeChanged.trigger({startTime:l.startTime})}var D=!1;if(l.endTime!==void 0&&l.endTime!==this._endTime){this._endTime=l.endTime;var _=this._clock.time,b=Ue.i.fromDates(_,this._endTime);Math.abs(b.totalMilliseconds)<1e3&&(this._endTime=this._clock.time),D=!0,this.endTimeChanged.trigger({endTime:l.endTime})}l.dwell!==void 0&&l.dwell.totalMilliseconds!==this._dwellInterval.totalMilliseconds&&(this.dwell=l.dwell),l.enableLooping!==void 0&&l.enableLooping!==this._enableLooping&&(this.enableLooping=l.enableLooping),l.timeMode!==void 0&&l.timeMode!==this._timeMode&&(this.timeMode=l.timeMode),l.playRate!==void 0&&l.playRate!==this._playRate&&(this.playRate=l.playRate);var G=!1;if(l.frameCount!==void 0&&l.frameCount!==this._frameCount&&(this._frameCount=l.frameCount,G=!0),s||D||G){var Z=Ue.i.fromDates(this._startTime,this._endTime,!1),te=Z.totalMilliseconds/(this._frameCount-1),ae=Math.floor(te);this._periodPerFrame=new Ue.i(ae,0,0,0,0),this.periodPerFrameChanged.trigger({frameCount:this._frameCount,frames:this._frameCount,periodPerFrame:this._periodPerFrame}),G&&this.frameCountChanged.trigger({frames:this._frameCount,frameCount:this._frameCount,periodPerFrame:this._periodPerFrame})}var Pe=function(){clearTimeout(i._pauseTimer),i._isChangingFrame=!1,i._pauseElapsed=new Ue.i(0,0,0,0,0),i.resume()};l.frame!==void 0&&l.frame!==this._frame?(Pe(),this.frame=l.frame):l.frameCount&&this.frame>l.frameCount&&(this._isPlaying?(this._clock.time<this._startTime&&(this._clock.time=this._startTime),this._clock.time>this._endTime&&(this._clock.time=this._endTime),Pe(),this.skipToTime(this._clock.time)):this.frame>l.frameCount&&(Pe(),this.frame=l.frameCount))},O.prototype.backward=function(){if(this._frame>1){var l=this._frame-1;this._changeFrame(l)}},O.prototype.forward=function(){if(this._frame<this._frameCount){var l=this._frame+1;this._changeFrame(l)}else this._enableLooping||!this._isFirstLoopStarted?(this._stopAnimating(),this._startDwelling()):this.stop()},O.prototype.modifyRange=function(l,i){if(l===null||!l)throw new Error("ArgumentNullException: startTime cannot be null or undefined");if(i===null||!i)throw new Error("ArgumentNullException: endTime cannot be null or undefined");if(l>=i)throw new Error("InvalidArgumentException: endTime must exceed the value of startTime");var s,_;this._startTime=l,_=this._clock.time,s=Ue.i.fromDates(_,this._startTime),Math.abs(s.totalMilliseconds)<1e3&&(this._startTime=this._clock.time),this._endTime=i,_=this._clock.time,s=Ue.i.fromDates(_,this._endTime),Math.abs(s.totalMilliseconds)<1e3&&(this._endTime=this._clock.time);var b=this._frameCount;this._syncFrames(b);var D={startTime:this._startTime};this.startTimeChanged.trigger(D);var G={endTime:this._endTime};this.endTimeChanged.trigger(G)},O.prototype.pause=function(l){this._pauseDuration=l,this._pauseElapsed=new Ue.i(0,0,0,0,0),this._isPaused=!0},O.prototype.resume=function(){this._isPaused=!1},O.prototype.unpause=function(){this.resume()},O.prototype.play=function(){this._frame<this._frameCount?this._isFirstLoopStarted=!0:this._isFirstLoopStarted=!1,this._clock.stopSliding(),this._isStarting=!0,this.starting.trigger(this),this._raiseLoading(),this._animate(),this._isPlaying=!0,this.isPlayingChanged.trigger({isPlaying:this._isPlaying}),this._isStarting=!1,this.started.trigger()},O.prototype.skipBackward=function(l){if(l<0)throw new Error("InvalidArgumentException: numberOfFrames must be positive");var i=this._frame-l;i>1?this._changeFrame(i):this.skipToStart()},O.prototype.skipForward=function(l){if(l<0)throw new Error("InvalidArgumentException: numberOfFrames must be positive");var i=this._frame+l;i<this._frameCount?this._changeFrame(i):this.skipToEnd()},O.prototype.skipToEnd=function(){this._changeFrame(this._frameCount)},O.prototype.skipToFrame=function(l){var i;if(l>this._frameCount||l<0)throw new Error("InvalidOperationException: The frame is outside the bounds of the animation");l>this._frame?(i=l-this._frame,this.skipForward(i)):l<this._frame&&(i=this._frame-l,this.skipBackward(i))},O.prototype.skipToNow=function(){this.skipToTime(new Date)},O.prototype.skipToStart=function(){this._changeFrame(1)},O.prototype.skipToTime=function(l){l<this._startTime&&(l=this._startTime),l>this._endTime&&(l=this._endTime);var i=Ue.i.fromDates(this._startTime,l,!1),s=i.totalMilliseconds/this._periodPerFrame.totalMilliseconds,_=Math.floor(s)+1;this._clock.time=l,this._frame!=_&&this._changeFrame(_)},O.prototype.stop=function(){this._cancelLoading(),this.stopping.trigger(),this._stopAnimating(),this._clock.startSliding(),this._isPlaying=!1,this.isPlayingChanged.trigger({isPlaying:this._isPlaying}),this.stopped.trigger()},O.prototype._onTick=function(l){this._slide(l.elapsed)},O}(),Re=B(58326),He=B(22045),mt=B(9506),Ft=B(29227),Gt=B(4225),Bt=B(9606),Kt=B(68575),qt=function(){function O(){this._isDown=!1,this._lastClicked=null}return Object.defineProperty(O.prototype,"isDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"lastClicked",{get:function(){return this._lastClicked},enumerable:!0,configurable:!0}),O}(),fi=function(){function O(){this._lastDownScreenPoint=new T.E(0,0),this._downScreenPoint=null,this._geoPoint=null,this._isDown=!1,this._isOver=!1,this._screenPoint=null,this._tmsTile=null,this._wmtsTile=null}return Object.defineProperty(O.prototype,"downScreenPoint",{get:function(){return this._downScreenPoint},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"geoPoint",{get:function(){return this._geoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isDown",{get:function(){return this._isDown},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isOver",{get:function(){return this._isOver},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"screenPoint",{get:function(){return this._screenPoint},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tmsTile",{get:function(){return this._tmsTile},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"wmtsTile",{get:function(){return this._wmtsTile},enumerable:!0,configurable:!0}),O}(),Ii=function(){function O(){this._geoPoint=null,this._screenPoint=null,this._tmsTile=null,this._wmtsTile=null}return Object.defineProperty(O.prototype,"geoPoint",{get:function(){return this._geoPoint},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"screenPoint",{get:function(){return this._screenPoint},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tmsTile",{get:function(){return this._tmsTile},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"wmtsTile",{get:function(){return this._wmtsTile},enumerable:!0,configurable:!0}),O}(),zi=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Yt=function(O){zi(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.isInteractive=void 0,s.subdomains=void 0,s.urlTemplate=void 0,s.requestFrequency=void 0,s.requestTimeout=void 0,(0,x.f0)(s,i),s}return l}(re.M),ur=function(O){zi(l,O);function l(i){var s=O.call(this,i=i instanceof Yt?i:new Yt(i))||this;return s._hasImage=!1,s._mapboxSources={},s._mapboxSourceIterator=0,s._bounds=i.bounds,s._isInteractive=i.isInteractive!=null?i.isInteractive:!1,s._subdomains=i.subdomains||[],s._urlTemplate=i.urlTemplate,s._requestFrequency=i.requestFrequency||6e4,s._requestTimeout=i.requestTimeout||5e3,s}return l.prototype._load=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}},l.prototype._unload=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._unloadLeaflet();break;case Q.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(x.jd.Unloaded)},l.prototype._render=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._renderLeaflet();break;case Q.Renderer.WebGL:this._renderMapbox();break}},l.prototype._deriveUrl=function(){var i=this._urlTemplate,s=this._bounds||this.map.bounds,_=this.map.size,b=Math.floor(new Date().getTime()/6e4);return i=i.replace("{north}",s.north.degrees.toString()),i=i.replace("{east}",s.east.degrees.toString()),i=i.replace("{south}",s.south.degrees.toString()),i=i.replace("{west}",s.west.degrees.toString()),i=i.replace("{width}",_.width.toString()),i=i.replace("{height}",_.height.toString()),i=i.replace("{cache}",b.toString()),i},l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)&&i!=this._opacity){var s=this._opacity;if(this._opacity=i,this.map){var _=this.opacity;this._leafletLayer&&this._leafletLayer.setOpacity(i),this._mapboxLayer&&this.map._mapboxEngine.setPaintProperty(this.id,"raster-opacity",i)}this.opacityChanged.trigger({old:s,new:i})}},l.prototype.update=function(){var i=this;clearInterval(this._timer),this._render(),this.updated.trigger({id:this.id}),this._requestFrequency&&(this._timer=window.setInterval(function(){i.update()},this._requestFrequency))},l.prototype._loadLeaflet=function(){if(this.loadState===x.jd.Unloaded){this._changeLoadState(x.jd.Loading);var i=this.map.engine.createPane(this.id),s={};this.opacity!=null&&(s.opacity=this.opacity),this._isInteractive?s.interactive=!0:(i.style["pointer-events"]="none",i.style.background="none !important",i.style.filter="Alpha(opacity=0)"),this._leafletPane=i;var _=this._bounds?this._bounds.toLeaflet():this.map.bounds.toLeaflet(),b=new(gt()).ImageOverlay(this._urlTemplate,_,s);b.options.renderer=this._leafletRenderer,b.options.pane=this._leafletPane,b.on("loading",this._onImageLoading,this),b.on("load",this._onImageLoaded,this),b.setBounds(_),this.map.engine.addLayer(b),this._leafletLayer=b,this.map.zoomed.addListener(this._onMapZoomed,this),this.map.moved.addListener(this._onMapMoved,this),this.update(),this._changeLoadState(x.jd.Loaded)}},l.prototype._unloadLeaflet=function(){this._leafletLayer.off("loading",this._onImageLoading,this),this._leafletLayer.off("load",this._onImageLoaded,this),this.map.engine.removeLayer(this._leafletLayer),this._leafletPane=void 0,this._leafletLayer=void 0,this._changeLoadState(x.jd.Unloaded)},l.prototype._renderLeaflet=function(){if(!this._bounds||!this._hasImage){var i=this._deriveUrl();this._leafletLayer.bringToBack(),this._leafletLayer.setUrl(i),this._leafletLayer.bringToFront()}},l.prototype._loadMapbox=function(){this._changeLoadState(x.jd.Loading),this.map.zoomed.addListener(this._onMapZoomed,this),this.map.moved.addListener(this._onMapMoved,this),this.map._mapboxEngine.on("sourcedata",this._onMapboxSourceLoaded.bind(this)),this.update(),this._changeLoadState(x.jd.Loaded)},l.prototype._unloadMapbox=function(){this.map.zoomed.removeListener(this._onMapZoomed,this),this.map.moved.removeListener(this._onMapMoved,this),this.map._mapboxEngine.off("sourcedata",this._onMapboxSourceLoaded),this.map._mapboxEngine.removeLayer(this.id);for(var i in this._mapboxSources)this.map._mapboxEngine.removeSource(i);this._mapboxLayer=null,this._mapboxSources=void 0,this._changeLoadState(x.jd.Unloaded)},l.prototype._renderMapbox=function(){var i=this._bounds||this.map.bounds,s=[i.topLeftGeoPoint.longitude.degrees,i.topLeftGeoPoint.latitude.degrees],_=[i.topRightGeoPoint.longitude.degrees,i.topRightGeoPoint.latitude.degrees],b=[i.bottomRightGeoPoint.longitude.degrees,i.bottomRightGeoPoint.latitude.degrees],D=[i.bottomLeftGeoPoint.longitude.degrees,i.bottomLeftGeoPoint.latitude.degrees],G=[s,_,b,D],Z=this._deriveUrl(),te=this.id+"_"+this._mapboxSourceIterator;this.map.engine.addSource(te,{type:"image",url:Z,coordinates:G}),this._mapboxSourceIterator++},l.prototype._renderMapboxLayer=function(i){if(this._zIndex){var s=this.map._mapboxEngine,_=s.getLayer(this.id);_&&s.removeLayer(this.id);for(var b in this._mapboxSources)b!=i&&(s.removeSource(b),delete this._mapboxSources[b]);this._mapboxLayer={id:this.id,type:"raster",source:i,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,transition:{duration:0,delay:0},paint:{"raster-fade-duration":0,"raster-opacity-transition":{duration:0,delay:0}}},this._mapboxGroup=[this._mapboxLayer],this._loadMapboxGroup()}},l.prototype._onMapMoved=function(i){this._render()},l.prototype._onMapZoomed=function(i){this._render()},l.prototype._onSurfaceLoading=function(i){this._changeLoadState(x.jd.Loading)},l.prototype._onSurfaceLoaded=function(i){this._changeLoadState(x.jd.Loaded)},l.prototype._onImageLoading=function(i){},l.prototype._onImageLoaded=function(i){if(!this._bounds){var s=this._bounds?this._bounds.toLeaflet():this.map.bounds.toLeaflet();this._leafletLayer.setBounds(this.map.bounds.toLeaflet())}},l.prototype._onMapboxSourceLoaded=function(i){if(this.map&&i.source&&i.sourceId&&i.sourceId.indexOf(this.id)===0){var s=this.map._mapboxEngine.style.sourceCaches,_=s[i.sourceId];_&&_.loaded()&&(this._mapboxSources[i.sourceId]=i.source,this._renderMapboxLayer(i.sourceId))}},l}(re.m),yi=B(66389),hr=function(){function O(l,i){this.id="",this.source=void 0,this.id=l,this.source=i}return O.addSourceToMap=function(l,i){l._mapboxEngine.getSource(i.id)||l._mapboxEngine.addSource(i.id,i.source)},O.removeSourceFromMap=function(l,i){l._mapboxEngine.getSource(i.id)&&l._mapboxEngine.removeSource(i.id)},O.fromUrl=function(l,i){var s=new O;return s.id=l,s.source={type:"vector",url:i},s},O.fromTileJSON=function(l,i,s,_){s===void 0&&(s=0),_===void 0&&(_=22);var b=new O;return b.id=l,b.source={type:"vector",tiles:i,minzoom:s,maxzoom:_},b},O}(),ir=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),zr=function(O){ir(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.styles=void 0,s.sources=void 0,s._allowCoercion=!0,(0,x.f0)(s,i),s}return l}(re.M),rn=function(O){ir(l,O);function l(i){var s=O.call(this,i=i instanceof zr?i:new zr(i))||this;if(s._isValid=!0,s._mapboxGroup=i.styles,i._allowCoercion&&i.styles&&i.styles.length>0)for(var _=0,b=i.styles.length;_<b;_++){var D=i.styles[_];if(D.id||(D.id=(0,x.cm)()),!D.source)if(i.source)D.source=i.source;else{console.log("deprecated or invalid layers"),s._isValid=!1;break}if(!D["source-layer"])if(D.sourceLayer)D["source-layer"]=D.sourceLayer;else{console.log("deprecated or invalid layers"),s._isValid=!1;break}}return s}return l.prototype._loadMapboxGroup=function(){this._isValid&&O.prototype._loadMapboxGroup.call(this)},l.prototype._unloadMapboxGroup=function(){this._isValid&&O.prototype._unloadMapboxGroup.call(this)},l.prototype._render=function(){this._isValid&&(this._unloadMapboxGroup(),this._loadMapboxGroup())},l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)&&i!=this._opacity){var s=this._opacity;if(this._opacity=i,this.map&&this._mapboxGroup)for(var _=0,b=this._mapboxGroup.length;_<b;_++){var D=this._mapboxGroup[_],G=D.id,Z=D.type;this.applyPaintProperty(G,Z+"-opacity",i)}this.opacityChanged.trigger({old:s,new:i})}},l.prototype._load=function(){if(this._changeLoadState(x.jd.Loading),this._options.sources&&this._isValid)for(var i=this.map,s=0,_=this._options.sources.length;s<_;s++){var b=this._options.sources[s];hr.addSourceToMap(i,b)}this.update(),this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){if(this._unloadMapboxGroup(),this._mapboxGroup=[],this._options.sources&&this._isValid)for(var i=this.map,s=0,_=this._options.sources.length;s<_;s++){var b=this._options.sources[s];hr.removeSourceFromMap(i,b)}this._zIndex=void 0,this._changeLoadState(x.jd.Unloaded)},l.prototype.update=function(){this._render(),this.updated.trigger({id:this.id})},l.prototype.applyPaintProperty=function(i,s,_){var b=this.map._mapboxEngine;b.setPaintProperty(i,s,_)},l.prototype.applyLayoutProperty=function(i,s,_){var b=this.map._mapboxEngine;b.setLayoutProperty(i,s,_)},l.prototype._onSurfaceLoading=function(i){this._changeLoadState(x.jd.Loading)},l.prototype._onSurfaceLoaded=function(i){this._changeLoadState(x.jd.Loaded)},l}(re.m),Br=B(73690),nn=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),wn=function(O){nn(l,O);function l(i,s){return O.call(this,i,s)||this}return l.prototype.deriveQuadKey=function(i,s,_){for(var b=[],D=_;D>0;D--){var G="0",Z=1<<D-1;(i&Z)!=0&&G++,(s&Z)!=0&&(G++,G++),b.push(G)}return b.join("")},l.prototype.getTileUrl=function(i){var s=this;return gt().Util.template(s._url,{s:s._getSubdomain(i),q:s.deriveQuadKey(i.x,i.y,s._getZoomForUrl())})},l}(gt().TileLayer),Pn=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),An=function(O){Pn(l,O);function l(i,s){return O.call(this,i,s)||this}return l.prototype.getTileUrl=function(i){var s=this,_=s._getZoomForUrl();if(_>s.options.maxZoom||_<s.options.minZoom)return"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";var b="1",D="1,2,3";switch(_){case 1:b="1",D="1,2,3";break;case 2:b="2",D="1,2,3";break;case 3:b="3",D="1,2,3";break;case 4:b="4",D="1,2,3";break;case 5:b="5",D="1,2,3";break;case 6:b="6",D="1,2,3";break;case 7:b="6",D="1,2";break;case 8:b="6",D="1";break;case 9:b="7",D="1,2";break;case 10:b="8",D="1,2";break;case 11:b="8",D="1,2,3";break;case 12:b="8",D="1,2,3";break;case 13:b="8",D="1,2,3,4";break;case 14:b="8",D="1,2,3,4,5";break;case 15:b="8",D="1,2,3,4,5,6";break;case 16:b="8",D="1,2,3,4,5,6,7";break}return L.Util.template(s._url,{f:D,p:b,q:s.deriveQuadKey(i.x,i.y,_)})},l}(wn),Ni=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),wr=function(O){Ni(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.updateFrequency=void 0,(0,x.f0)(s,i),s}return l}(yi.z),mn=function(O){Ni(l,O);function l(i){var s=O.call(this,i=i instanceof wr?i:new wr(i))||this;return s._minimumZoom=6,s._updateFrequency=i.updateFrequency||3e5,s}return l.prototype._deriveUrlTemplate=function(){var i=this._urlTemplate,s=this._deriveParams();return i=i.replace(/penWidth=[0-9]/gi,"penWidth="+s.penWidth),i=i.replace(/frcLevel=[0-9,]+/gi,"frcLevel="+s.frcLevel),i=i.replace("{token}",this._token),i},l.prototype._deriveParams=function(){var i=Math.round(this.map.zoomLevel),s="1",_="1,2,3";switch(i){case 1:s="1",_="1,2,3";break;case 2:s="2",_="1,2,3";break;case 3:s="3",_="1,2,3";break;case 4:s="4",_="1,2,3";break;case 5:s="5",_="1,2,3";break;case 6:s="6",_="1,2,3";break;case 7:s="6",_="1,2";break;case 8:s="6",_="1";break;case 9:s="7",_="1,2";break;case 10:s="8",_="1,2";break;case 11:s="8",_="1,2,3";break;case 12:s="8",_="1,2,3";break;case 13:s="8",_="1,2,3,4";break;case 14:s="8",_="1,2,3,4,5";break;case 15:s="8",_="1,2,3,4,5,6";break;case 16:s="8",_="1,2,3,4,5,6,7";break}var b={penWidth:s,frcLevel:_};return b},l.prototype._load=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}var i=this.map.inrixUrl;i=i.replace("{vendorId}",this.map.inrixVendorId),i=i.replace("{consumerId}",this.map.inrixConsumerId),this._service=new Br.U(i),this._service.pollingInterval=this._updateFrequency,this._service.modified.addListener(this._onCapabilitiesLoaded,this),this._service.startPolling(),this.map.zoomed.addListener(this._onMapZoomed,this)},l.prototype._unload=function(){this._service.stopPolling(),this._service.modified.removeListener(this._onCapabilitiesLoaded,this),this.map.zoomed.removeListener(this._onMapZoomed,this),O.prototype._unload.call(this)},l.prototype._render=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._renderLeaflet();break;case Q.Renderer.WebGL:this._renderMapbox();break}},l.prototype.update=function(){this._render(),this.updated.trigger({id:this.id})},l.prototype._loadLeaflet=function(){this._loadLeafletPane()},l.prototype._loadLeafletLayer=function(){var i=this._deriveUrlTemplate(),s=this._deriveLeafletOptions(),_=new An(i,s);_.on("loading",this._onLeafletLayerLoading,this),_.on("load",this._onLeafletLayerLoaded,this),_.setOpacity(this.opacity),this.map._leafletEngine.addLayer(_),this._leafletLayer=_},l.prototype._renderLeaflet=function(){if(this._leafletLayer){var i=this._deriveUrlTemplate();this._leafletLayer.setUrl(i)}else this._loadLeafletLayer()},l.prototype._loadMapbox=function(){},l.prototype._unloadMapbox=function(){O.prototype._unloadMapbox.call(this)},l.prototype._renderMapbox=function(){this._unloadMapboxGroup();var i=this.map._mapboxEngine;i.getSource(this.id)&&i.removeSource(this.id);var s=this._deriveUrlTemplate();this._mapboxSource={type:"raster",tileSize:256,scheme:"xyz",tiles:[s]},i.addSource(this.id,this._mapboxSource),this._mapboxLayer||(this._mapboxLayer={id:this.id,type:"raster",source:this.id,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,paint:{"raster-opacity":this.opacity},layout:{}}),this._mapboxGroup=[this._mapboxLayer],this._loadMapboxGroup()},l.prototype._onCapabilitiesLoaded=function(i){var s=this._service.xmlDocument,_=s.getElementsByTagName("AuthToken"),b=_[0];this._token=b.innerHTML;for(var D=s.getElementsByTagName("ServerPath"),G=this._map.renderer===Q.Renderer.WebGL?"{quadkey}":"{q}",Z=this._deriveParams(),te=0,ae=D.length;te<ae;te++){var Pe=D[te],ve=Pe.getAttribute("region"),pe=Pe.getAttribute("type");if(ve==="NA"&&pe==="TTS"){this._urlTemplate=Pe.innerHTML+"?Action=GetMapTile&token={token}&coverage=255&format=png&layers=T&penWidth="+Z.penWidth+"&frcLevel="+Z.frcLevel+"&Quadkey="+G;break}}this.update()},l.prototype._onMapZoomed=function(i){this.update()},l}(yi.I),ho=B(84922),Cr=B.n(ho),Po=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Gn=function(O){Po(l,O);function l(i,s){var _=O.call(this,s)||this;return gt().TileLayer.prototype.initialize.call(_,void 0,s),_._tilejson={},_._loadTileJSON(i),_}return l.prototype.idUrl=function(i,s){i.indexOf("/")===-1?s.loadID(i):s.loadURL(i)},l.prototype.log=function(i){typeof console=="object"&&typeof console.error=="function"&&console.error(i)},l.prototype.strict=function(i,s){if(typeof i!==s)throw new Error("Invalid argument: "+s+" expected")},l.prototype.strict_instance=function(i,s,_){if(!(i instanceof s))throw new Error("Invalid argument: "+_+" expected")},l.contains=function(i,s){var _=s.length;if(!s||!_)return!1;for(var b=0;b<_;b++)if(s[b]===i)return!0;return!1},l.prototype.strict_oneof=function(i,s){if(!l.contains(i,s))throw new Error("Invalid argument: "+i+" given, valid values are "+s.join(", "))},l.prototype.strip_tags=function(i){return i.replace(/<[^<]+>/g,"")},l.prototype.lbounds=function(i){return new(gt()).LatLngBounds([[i[1],i[0]],[i[3],i[2]]])},l.prototype.setFormat=function(i){return this.options.format=i,O.prototype.redraw.call(this),this},l.prototype.getTileJSON=function(){return this._tilejson},l.prototype._setTileJSON=function(i){return this.options.format=this.options.format||i.tiles[0].match(l._formatPattern)[1],gt().Util.extend(this.options,{tiles:i.tiles,minZoom:i.minzoom||0,maxZoom:i.maxzoom||18,tms:i.scheme==="tms"}),this._tilejson=i,gt().TileLayer.prototype.redraw.call(this),this},l.prototype.getTileUrl=function(i){var s=this.options.tiles,_=Math.floor(Math.abs(i.x+i.y)%s.length),b=s[_],D=gt().Util.template(b,i);return D&&D.replace(l._formatPattern,(gt().Browser.retina?l._scalePrefix:".")+this.options.format)},l.prototype._update=function(){this.options.tiles&&gt().TileLayer.prototype._update.call(this)},l.prototype.format_url=function(i,s){s=s||Cr().accessToken;var _="3";if(!s&&l.config.REQUIRE_ACCESS_TOKEN)throw new Error("An API access token is required to use Mapbox.js. See https://www.mapbox.com/mapbox.js/api/v"+_+"/api-access-tokens/");var b=document.location.protocol==="https:"||l.config.FORCE_HTTPS?l.config.HTTPS_URL:l.config.HTTP_URL;if(b=b.replace(/\/v4$/,""),b+=i,l.config.REQUIRE_ACCESS_TOKEN){if(s[0]==="s")throw new Error("Use a public access token (pk.*) with Mapbox.js, not a secret access token (sk.*). See https://www.mapbox.com/mapbox.js/api/v"+_+"/api-access-tokens/");b+=b.indexOf("?")!==-1?"&access_token=":"?access_token=",b+=s}return b},l.prototype.format_tileJSON=function(i,s){if(i.indexOf("mapbox://styles")===0)throw new Error("Styles created with Mapbox Studio need to be used with L.mapbox.styleLayer, not L.mapbox.tileLayer");if(i.indexOf("/")!==-1)return i;var _=this.format_url("/v4/"+i+".json",s);return _.indexOf("https")===0&&(_+="&secure"),_},l.prototype._loadTileJSON=function(i){var s=this;if(typeof i=="string"){i=this.format_tileJSON(i,this.options&&this.options.accessToken);var _=Br.U.createCorsRequest("GET",i);_.onload=function(){var b=JSON.parse(_.responseText);s._setTileJSON(b),gt().TileLayer.prototype.fire.call(s,"ready")},_.send()}else i&&typeof i=="object"&&this._setTileJSON(i)},l._formatPattern=/\.((?:png|jpg)\d*)(?=$|\?)/,l._formats=["png","jpg","png32","png64","png128","png256","jpg70","jpg80","jpg90"],l._scalePrefix="@2x.",l.config={HTTP_URL:"http://a.tiles.mapbox.com/v4",HTTPS_URL:"https://a.tiles.mapbox.com/v4",FORCE_HTTPS:!1,REQUIRE_ACCESS_TOKEN:!0},l}(gt().TileLayer),Xr=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),ln=function(O){Xr(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.mapboxAccessToken=void 0,s.mapboxId=void 0,s.tileJson=void 0,s.url=void 0,(0,x.f0)(s,i),s}return l}(yi.z),co=function(O){Xr(l,O);function l(i){var s=O.call(this,i=i instanceof ln?i:new ln(i))||this;return s._mapboxAccessToken=i.mapboxAccessToken||i.mapBoxAccessToken,s._mapboxId=i.mapboxId||i.mapBoxId,s._tileJson=i.tileJson,s._url=i.url,s}return l.prototype._deriveLeafletOptions=function(){var i=O.prototype._deriveLeafletOptions.call(this);return i.accessToken=this._mapboxAccessToken||this.map.mapboxAccessToken,i},l.prototype._loadLeafletLayer=function(){var i=this._deriveLeafletOptions(),s=new Gn(this._mapboxId,i);s.on("loading",this._onLeafletLayerLoading,this),s.on("load",this._onLeafletLayerLoaded,this),s.setOpacity(this.opacity),this.map._leafletEngine.addLayer(s),this._leafletLayer=s},l.prototype._loadMapbox=function(){var i={type:"raster",url:"mapbox://"+this._mapboxId,tileSize:256};this._mapboxSource=i,this.map.engine.addSource(this.id,i);var s={id:this.id,type:"raster",source:this.id,paint:{},layout:{}};this._mapboxLayer=s,this._mapboxGroup.push(s)},l}(yi.I),Fr=B(77109),$=B(22559),le=B(85491),ue=B(18078),be=B(55117),Oe=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),je=function(O){Oe(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.productKey=void 0,s.infoUrl=void 0,s.infoPollingInterval=void 0,s.infoPollingTimeout=void 0,s.vectorsUrl=void 0,s.withCredentials=void 0,s.maximumNativeZoom=void 0,s.apiKey=void 0,s._allowCoercion=!1,(0,x.f0)(s,i),s}return l}(zr),xe=function(O){Oe(l,O);function l(i){var s=O.call(this,i=i instanceof je?i:new je(i))||this;s._subdomains=[],s._isDataDirty=!1,s._isAnimate=!1,s._ranges=[],s._coverage=[],s._properties=[],s._args={},s._hasMetaData=!1,s._sources={},s._zOffset=-1,s._timeMode="timed",s._hasBound=!1,s._times=[],s.metaDataLoaded=new W.j,s.metaDataModified=new W.j,s._productKey=i.productKey,s._infoUrl=i.infoUrl,s._vectorsUrl=i.vectorsUrl,s._infoPollingInterval=i.infoPollingInterval!=null?i.infoPollingInterval:6e4,s._infoPollingTimeout=i.infoPollingTimeout!=null?i.infoPollingTimeout:5e3,s._apiKey=i.apiKey,s._withCredentials=i.withCredentials!==void 0?i.withCredentials:!1,s._opacity=i.opacity!==void 0?i.opacity:1;var _=s._timeManager=new be.l;if(_._validBackward=Ue.i.min,_._validForward=Ue.i.max,i.styles){for(var b=0,D=i.styles.length;b<D;b++){var G=i.styles[b];G.sourceLayer="source-layer"}s._styles=i.styles}return s._mapboxGroup=[],s}return Object.defineProperty(l.prototype,"times",{get:function(){return this._times},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"ranges",{get:function(){return this._ranges},enumerable:!0,configurable:!0}),l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)){var s=this._opacity;if(this._opacity=i,this.map&&this._mapboxGroup)for(var _=this.map.engine,b=0,D=this._mapboxGroup.length;b<D;b++){var G=this._mapboxGroup[b],Z=G.type;switch(Z){case"raster":var te=G.paint["raster-opacity"];te===void 0&&(te=1);var ae=te*i;_.setPaintProperty(G.id,"raster-opacity",ae);break;case"fill":var Pe=G.paint["fill-opacity"];Pe===void 0&&(Pe=1);var ve=Pe*i;_.setPaintProperty(G.id,"fill-opacity",ve);break;case"line":var pe=G.paint["line-opacity"];pe===void 0&&(pe=1);var Fe=pe*i;_.setPaintProperty(G.id,"line-opacity",Fe);break;case"circle":var ke=G.paint["circle-opacity"];ke===void 0&&(ke=1);var Ze=ke*i;_.setPaintProperty(G.id,"circle-opacity",Ze);var at=G.paint["circle-stroke-opacity"];at===void 0&&(at=1);var Ve=at*i;_.setPaintProperty(G.id,"circle-stroke-opacity",Ve);break;case"symbol":var st=G.paint["icon-opacity"];st===void 0&&(st=1);var Pt=st*i;_.setPaintProperty(G.id,"icon-opacity",Pt);var $e=G.paint["text-opacity"];$e===void 0&&($e=1);var Ct=$e*i;_.setPaintProperty(G.id,"text-opacity",Ct);break}}this.opacityChanged.trigger({old:s,new:i})}},Object.defineProperty(l.prototype,"hasMetaData",{get:function(){return this._hasMetaData},enumerable:!0,configurable:!0}),l.prototype._deriveRanges=function(i){if(!i)return[];var s=[];if(this._validity)for(var _=new Date(i.getTime()-this._validity.totalMilliseconds),b=new Date(i.getTime()+this._validity.totalMilliseconds),D=new ue.e(_,b),G=0,Z=this._ranges.length;G<Z;G++){var te=this._ranges[G];(te.startTime>D.startTime||te.endTime<D.endTime)&&s.push(te)}else s.push;return s},l.prototype._render=function(){this._hasMetaData&&(this._bindStyles(),this._unloadMapboxGroup(),this._loadMapboxGroup(),this._changeOpacity(this._opacity))},l.prototype._convertInfo=function(){var i=this._infoClient.objectLiteral,s=i.products[this._productKey],_=this._timeManager;if(this._vectorsUrl=this._options.vectorsUrl||i.featuresUrl,this._subdomains=i.subdomains,s.meta){var b=s.meta;if(b.timeMode&&(this._timeMode=b.timeMode),b.pyramid&&b.pyramid.length>0){var D=b.pyramid[0],G=b.pyramid[b.pyramid.length-1];this.options.minimumZoom&&this.options.minimumZoom>D&&(D=this.options.minimumZoom),this._options.maximumNativeZoom&&this._options.maximumNativeZoom<G&&(G=this._options.maximumNativeZoom),this._minimumZoom=D,this._maximumNativeZoom=G}b.animate&&(this._isAnimate=b.animate),b.args&&(this._args=b.args),b.defaultValidity&&(this._validity=new Ue.i(b.defaultValidity)),b.properties&&(this._properties=b.properties)}if(this._timeMode!=="timed"){for(var Z=[],te=s.time.length>0?Math.max(s.time.length-1,1):0,ae=0;ae<te;ae++){var Pe=s.time[ae],ve=Pe.split(":")[1]?Pe.split(":")[1]:"",pe=Pe.split(":")[0],Fe=pe.split("-"),ke=parseInt(Fe[0],10),Ze=new Date(ke),at=parseInt(Fe[1],10),Ve=new Date(at);ve=Number(ve);var st=new ue.e(Ze,Ve);st.iteration=ve,Z.push(st)}this._ranges=Z,Z.length===0&&this._changeLoadState(x.jd.Loaded)}else{var Pt=parseInt(s.time[0]);(!this._lastUpdated||this._lastUpdated.getTime()!==Pt)&&(this._isDataDirty=!0,this._lastUpdated=new Date(Pt),isNaN(Pt)&&this._changeLoadState(x.jd.Loaded));for(var $e=[],Ct=0,At=s.time.length;Ct<At;Ct++){var qe=parseInt(s.time[Ct]),nt=new Date(qe);$e.push(nt)}this._times=$e}},l.prototype._startService=function(i,s){if(!this._infoClient){var _=s||this._apiKey||this.map.sunApiKey,b=i||this._infoUrl||this.map.sunVectorUrl;b=b+"&meta=true",b=b.replace("{productKey}",this._productKey),b=b.replace("{apiKey}",_),this._infoClient=new Br.U(b),this._infoClient.timeout=this._infoPollingTimeout,this._infoClient.pollingInterval=this._infoPollingInterval,this._infoClient.modified.addListener(this._onInfoLoaded,this),this._infoClient.errored.addListener(this._onInfoErrored,this),this._infoClient.timedOut.addListener(this._onInfoTimedOut,this),this._infoClient.startPolling()}},l.prototype._stopService=function(){this._infoClient&&(this._infoClient.stopPolling(),this._infoClient.modified.removeListener(this._onInfoLoaded,this),this._infoClient.errored.removeListener(this._onInfoErrored,this),this._infoClient.timedOut.removeListener(this._onInfoTimedOut,this),this._infoClient=void 0)},l.prototype._load=function(){var i=this.map._mapboxEngine;this._withCredentials,this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),i.on("sourcedataloading",this._onMapboxLayerLoading.bind(this)),i.on("sourcedata",this._onMapboxLayerLoaded.bind(this)),this._infoClient?this._hasMetaData&&this.update():this._startService()},l.prototype._unload=function(){this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this._stopService(),O.prototype._unload.call(this);var i=this.map._mapboxEngine;i.off("sourcedataloading",this._onMapboxLayerLoading.bind(this)),i.off("sourcedata",this._onMapboxLayerLoaded.bind(this));for(var s in this._sources)i.removeSource(s);this._mapboxGroup=[],this._zIndex=void 0,this._hasMetaData=!1,this._ranges=void 0,this._currentRanges=void 0,this._isDataDirty=!0},l.prototype._bindStyles=function(){var i=[];for(var s in this._sources){var _=this._sources[s];_.layers=[];for(var b=0,D=this._styles.length;b<D;b++){var G=this._styles[b],Z={};(0,x.f0)(Z,G);var te=G.id||(0,x.cm)();Z.id=_._key+"_"+te,Z.source=_._key,Z["source-layer"]=G.sourceLayer,_.maxzoom=this._maximumZoom,_.minzoom=this._minimumZoom,Z.type==="symbol"&&(Z.layout&&Z.layout["text-field"]&&(Z.layout["text-allow-overlap"]===void 0&&(Z.layout["text-allow-overlap"]=!0),Z.layout["text-padding"]===void 0&&(Z.layout["text-padding"]=0)),Z.layout&&Z.layout["icon-image"]&&(Z.layout["icon-allow-overlap"]===void 0&&(Z.layout["icon-allow-overlap"]=!0),Z.layout["icon-padding"]===void 0&&(Z.layout["icon-padding"]=0))),i.push(Z),_.layers.push(Z)}}this._hasBound=!0,this._mapboxGroup=i},l.prototype._addSource=function(i){if(i&&i!="NaN"){var s=this.map._mapboxEngine,_={type:"vector"},b="https:"+this._vectorsUrl;b=b.replace("/features?time=","/features?format=mvt&time=").replace("{time}",i).replace("{productKey}",this._productKey).replace("{lod}","{z}").replace("{apiKey}",this._apiKey||this.map.sunApiKey);var D=[];if(this._subdomains&&this._subdomains.length>0)for(var G=0,Z=this._subdomains.length;G<Z;G++){var te=this._subdomains[G],ae=b.replace("{subdomain}",te);D.push(ae)}else D.push(b);_.tiles=D,_.maxzoom=this._maximumNativeZoom;var Pe=this.id+"_"+i;_._time=i,_._key=Pe,this._sources[Pe]=_,s.addSource(Pe,_)}},l.prototype._bindSources=function(){var i=this.map.engine;this._unloadMapboxGroup();for(var s in this._sources)i.getSource(s)&&i.removeSource(s);if(this._sources={},this._timeMode==="timed"){var _=this._lastUpdated.getTime().toString();this._addSource(_)}else for(var b=0,D=this._currentRanges.length;b<D;b++){var G=this._currentRanges[b],_=G.toEpochString();this._addSource(_)}this._render()},l.prototype.update=function(){if(this._hasMetaData)if(this._timeMode==="timed")this._isDataDirty&&(this._bindSources(),O.prototype.update.call(this),this._isDataDirty=!1);else{var i=this._deriveRanges(this.map.clock.time);if(!this._currentRanges)this._currentRanges=i,this._bindSources(),O.prototype.update.call(this);else{var s=!1;if(i.length!==this._currentRanges.length)s=!0;else{var _=JSON.stringify(i),b=JSON.stringify(this._currentRanges);_!==b&&(s=!0)}s&&(this._currentRanges=i,this._bindSources(),O.prototype.update.call(this))}}},l.prototype.preload=function(i,s){this._infoClient||this._startService(i,s)},l.prototype.applyPaintProperty=function(i,s,_){for(var b,D=this._styles,G=0,Z=D.length;G<Z&&(b=D[G],b.id!==i);G++);b&&(b.paint[s]=_);for(var te in this._sources){var ae=this._sources[te],Pe=this.map._mapboxEngine,ve=ae._key+"_"+i;Pe.setPaintProperty(ve,s,_)}},l.prototype.applyLayoutProperty=function(i,s,_){for(var b in this._sources){var D=this._sources[b],G=this.map._mapboxEngine,Z=D._key+"_"+i;G.setLayoutProperty(Z,s,_)}},l.prototype._onInfoLoaded=function(i){this._convertInfo(),this._hasMetaData||(this._hasMetaData=!0,this.metaDataLoaded.trigger(),this._infoClient.url=this._infoClient.url.replace("&meta=true","")),this.map&&this.map.isEnabled&&(this.update(),this.metaDataModified.trigger())},l.prototype._onInfoErrored=function(i){},l.prototype._onInfoTimedOut=function(i){},l.prototype._onMapEnabled=function(i){this._infoClient.startPolling();for(var s in this._sources)if(this.map._mapboxEngine){var _=this.map.engine.style.sourceCaches[s];_.resume()}this.update()},l.prototype._onMapDisabled=function(i){this._infoClient.stopPolling();for(var s in this._sources)if(this.map._mapboxEngine){var _=this.map.engine.style.sourceCaches[s];_.pause()}},l.prototype._onMapboxLayerLoading=function(i){i.sourceId&&i.sourceId.indexOf(this.id)===0&&this._changeLoadState(x.jd.Loading)},l.prototype._onMapboxLayerLoaded=function(i){i.sourceId&&i.sourceId.indexOf(this.id)===0&&this._changeLoadState(x.jd.Loaded)},l}(rn),Le=B(38433),tt=B(5860),rt=B(69548),Mt=B(59687),Wt=B(24940),ft=B(7842),Dt=B(14734),ai=B(3660),dt=B(54071),Zt=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),ii=function(O){Zt(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.capabilitiesPollingFrequency=void 0,s.capabilitiesTimeout=void 0,s.layerKey=void 0,s.query=void 0,s.tesseraUrl=void 0,s.capabilitiesUrl=void 0,(0,x.f0)(s,i),s}return l}(ft.p),ri=function(O){Zt(l,O);function l(i){var s=O.call(this,i=i instanceof ii?i:new ii(i))||this;return s._cacheModifiers=["1","2","3","4","5","6","8","9","10","11","12","13","14","15","16"],s._validForward=Ue.i.max,s._validBackward=Ue.i.min,s._validTimes=null,s._modelRuns=null,s._isDataDirty=!0,s._query=i.query||"",s._capabilitiesPollingFrequency=i.capabilitiesPollingFrequency||6e4,s._capabilitiesTimeout=i.capabilitiesTimeout||5e3,s._layerKey=i.layerKey,s._tesseraUrl=i.tesseraUrl,s._capabilitiesUrl=i.capabilitiesUrl,s}return Object.defineProperty(l.prototype,"currentDiscreteTime",{get:function(){return this._currentDiscreteTime},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"modelRuns",{get:function(){return this._modelRuns},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"query",{get:function(){return this._query},set:function(i){this._query=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"validTimes",{get:function(){return this._validTimes},enumerable:!0,configurable:!0}),l.prototype._parse=function(i){var s=[],_=/\S/g,b;try{if(DOMParser){var D=new DOMParser;b=D.parseFromString(i,"text/xml")}else b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(i)}catch(Fi){b=new ActiveXObject("Microsoft.XMLDOM"),b.async=!1,b.loadXML(i)}for(var G=b.childNodes[0],Z=G.getElementsByTagNameNS!==void 0?G.getElementsByTagNameNS(l.GML_NAMESPACE,"featureMember"):b.getElementsByTagName("gml:featureMember"),te=0,ae=Z.length;te<ae;te++){var Pe=null,ve=Z[te],pe=void 0,Fe=void 0,ke=ve.childNodes.length;if(ke>1){for(var Ze=0;Ze<ke;Ze++)if(ve.childNodes[Ze].nodeType!==3){var at=ve.childNodes[Ze];if(at.localName==="FeatureID"?Fe=at.innerHTML:pe=at,pe&&Fe)break}}else pe=ve.childNodes[0];if(!(pe.nodeType===3&&!_.test(pe.nodeValue))){if(pe===null)throw{name:"InvalidDocumentException",message:"Feature Node Structure Invalid"};var Ve={};if(pe.attributes!=null)for(var st=0,Pt=pe.attributes.length;st<Pt;st++){var $e=pe.attributes[st];Ve[$e.name]=$e.value}var Ct={FeatureID:Fe};if(pe.childNodes!=null)for(var At=0,qe=pe.childNodes.length;At<qe;At++){var nt=pe.childNodes[At];if(!(nt.nodeType===3&&!_.test(nt.nodeValue)))if(nt.namespaceURI===l.GML_NAMESPACE){var Xe=nt.localName||nt.baseName;switch(Xe.toUpperCase()){case"POINTPROPERTY":var It=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"Point")[0]:nt.getElementsByTagName("gml:Point")[0],kt=It.getElementsByTagNameNS!==void 0?It.getElementsByTagNameNS(l.GML_NAMESPACE,"coord")[0]:It.getElementsByTagName("gml:coord")[0],Nt=kt.getElementsByTagNameNS!==void 0?parseFloat(kt.getElementsByTagNameNS(l.GML_NAMESPACE,"X")[0].textContent):parseFloat(kt.getElementsByTagName("gml:X")[0].text),Rt=kt.getElementsByTagNameNS!==void 0?parseFloat(kt.getElementsByTagNameNS(l.GML_NAMESPACE,"Y")[0].textContent):parseFloat(kt.getElementsByTagName("gml:Y")[0].text),Qt=v.F.fromDegrees(Rt,Nt);Pe=new Dt.t(Qt);break;case"LINESTRINGPROPERTY":for(var Jt=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"LineString")[0]:nt.getElementsByTagName("gml:LineString")[0],pi=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"coordinates")[0].textContent:nt.getElementsByTagName("gml:coordinates")[0].text,vi=pi.trim().split(" "),gi=new Ft.A,jt=0,$t=vi.length;jt<$t;jt++){var It=vi[jt].split(","),Nt=parseFloat(It[0]),Rt=parseFloat(It[1]);if(Nt&&Rt){var Qt=v.F.fromDegrees(Rt,Nt);gi.add(Qt)}}Pe=new dt.P(gi);break;case"POLYGONPROPERTY":for(var Oi=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"Polygon")[0]:nt.getElementsByTagName("gml:Polygon")[0],Ui=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"outerBoundaryIs")[0]:nt.getElementsByTagName("gml:outerBoundaryIs")[0],xi=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"LinearRing")[0]:nt.getElementsByTagName("gml:LinearRing")[0],pi=nt.getElementsByTagNameNS!==void 0?nt.getElementsByTagNameNS(l.GML_NAMESPACE,"coordinates")[0].textContent:nt.getElementsByTagName("gml:coordinates")[0].text,vi=pi.trim().split(" "),gi=new Ft.A,jt=0,$t=vi.length;jt<$t;jt++){var It=vi[jt].split(","),Nt=parseFloat(It[0]),Rt=parseFloat(It[1]);if(Nt&&Rt){var Qt=v.F.fromDegrees(Rt,Nt);gi.add(Qt)}}var li=new Wt.h;li.polylines=[gi],Pe=new ai.L(li);break}}else Ct[nt.tagName]=nt.textContent||nt.text}Pe!==null&&(Pe.properties=Ct,Pe.source=pe,s.push(Pe))}}return s},l.prototype._deriveUrl=function(i,s){var _=i.z||0,b=i.x||0,D=i.y||0;if(!s)if(this.currentDiscreteTime!=null&&this.currentDiscreteTime.validTime!=null)s=this.currentDiscreteTime;else return null;var G=(b+D)%this._cacheModifiers.length,Z=this._cacheModifiers[G]||"0",te=s.modelRun?(0,Le.RQ)(s.modelRun.value):"0",ae=(0,Le.RQ)(s.validTime.value),Pe=s.validTime.cipher;if(!this._href||ae===null||ae===void 0)return null;var ve=this._href.replace("{s}",Z).replace("{l}","en-US").replace("{c}",Pe).replace("{m}",te).replace("{v}",ae).replace("{i}","1").replace("{n}",this._layerKey).replace("{z}",_.toString()).replace("{x}",b.toString()).replace("{y}",D.toString()).replace("{e}","gml");return this._query&&(ve=ve+"?"+this._query),this._isSSL&&(ve=ve.replace(/http(s)?/gi,"https")),ve},l.prototype._deriveModelRun=function(){var i=null;return this.modelRuns!=null&&this.modelRuns.length>0&&(i=this.modelRuns.length>1?this.modelRuns[1]:this.modelRuns[0]),i},l.prototype._deriveValidTimes=function(){var i=this._deriveModelRun(),s=i!=null?i.validTimes:this.validTimes;return s},l.prototype._convertToModelRuns=function(i){var s=[];for(var _ in i){var b=i[_],D=(0,Le.g7)(b.t),G=new rt.o(D);G.validTimes=this._convertToValidTimes(b.v),s.push(G)}return s},l.prototype._convertToValidTimes=function(i){var s=[];for(var _ in i){var b=i[_],D=(0,Le.g7)(b.t),G=new Mt.T(D,b.c);s.push(G)}return s},l.prototype._deriveDiscreteTime=function(i){i||(i=new Date);var s=this._deriveModelRun(),_=this._deriveValidTimes(),b=Ue.i.max,D=null;if(_!=null)for(var G=0,Z=_.length;G<Z;++G){var te=_[G],ae=i>te.value?Ue.i.fromDates(te.value,i):Ue.i.fromDates(i,te.value);if(ae.totalMilliseconds<b.totalMilliseconds){var Pe=this._validateValidTime(te,i);Pe&&(b=ae,D=te)}}var ve=new tt.d(s,D);return ve},l.prototype._validateValidTime=function(i,s){if(i.value<s){var _=Ue.i.fromDates(i.value,s),b=_.totalMilliseconds;return!(b>this._validBackward.totalMilliseconds)}else if(i.value>s){var D=Ue.i.fromDates(s,i.value),G=D.totalMilliseconds;return!(G>this._validForward.totalMilliseconds)}else return!0},l.prototype._convertCapabilities=function(){var i=this._capabilityClient.objectLiteral,s=i.layers[0];this._hasMetaData||(s.max&&this.maximumZoom>s.max&&(this.maximumZoom=s.max),s.min&&this.minimumZoom<s.min&&(this.minimumZoom=s.min),s.forward&&(this._validForward=new Ue.i(s.forward)),s.pyramid?((this._isTiled===!0||this._isTiled===void 0)&&(this._isTiled=!0),this._pyramidPolicy=s.pyramid):this._isTiled=!1,s.backward&&(this._validBackward=new Ue.i(s.backward)),i.href?this._href=i.href:i.uri&&(this._href=i.uri),i.s&&(this._cacheModifiers=i.s));var _=!1;if(s.hasOwnProperty("m")){var b=this._convertToModelRuns(s.m);(!this._modelRuns||JSON.stringify(b)!==JSON.stringify(this._modelRuns))&&(this._modelRuns=b,_=!0,this._purgeTiles(),this._isDataDirty=!0)}else if(s.hasOwnProperty("v")){var D=this._convertToValidTimes(s.v);(!this._validTimes||JSON.stringify(D)!==JSON.stringify(this._validTimes))&&(this._validTimes=D,_=!0,this._purgeTiles(),this._isDataDirty=!0)}return _},l.prototype._load=function(){switch(this._timeStamp=this.map.clock.time,this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}this.map.moved.addListener(this._onMapMoved,this),this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this._capabilityClient?this._hasMetaData&&this.update():this._startService()},l.prototype._unload=function(){this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this._hasMetaData=!1,O.prototype._unload.call(this),this._stopService()},l.prototype._startService=function(i){if(!this._capabilityClient){var s,_,b;s=i||this._capabilitiesUrl||this._tesseraUrl||this.map.tesseraUrl,_=this.map.tesseraMemberKey,b=this.map.tesseraMapKey,this._isSSL=/https/gi.test(s),s=s+"&meta=1",s=s.replace("{memberKey}",_),s=s.replace("{mapKey}",b),s=s.replace("{layerKey}",this._layerKey),this._capabilityClient=new Br.U(s),this._capabilityClient.timeout=this._capabilitiesTimeout,this._capabilityClient.pollingInterval=this._capabilitiesPollingFrequency,this._capabilityClient.modified.addListener(this._onCapabilitiesLoaded,this),this._capabilityClient.errored.addListener(this._onCapabilitiesErrored,this),this._capabilityClient.timedOut.addListener(this._onCapabilitiesTimedOut,this),this._capabilityClient.startPolling()}},l.prototype._stopService=function(){this._capabilityClient&&(this._capabilityClient.stopPolling(),this._capabilityClient.modified.removeListener(this._onCapabilitiesLoaded,this),this._capabilityClient.errored.removeListener(this._onCapabilitiesErrored,this),this._capabilityClient.timedOut.removeListener(this._onCapabilitiesTimedOut,this),delete this._capabilityClient)},l.prototype._purgeTiles=function(){var i=[];for(var s in this._cachedTiles){for(var _=this._cachedTiles[s],b=0,D=_.features.length;b<D;b++){var G=_.features[b];G.overlay&&i.push(G.overlay)}delete this._cachedTiles[s]}this._unloadOverlays(i)},l.prototype.preload=function(i){this._capabilityClient||this._startService(i)},l.prototype._onCapabilitiesLoaded=function(i){var s=this._convertCapabilities();if(this._hasMetaData?s&&this.metaDataModified.trigger():(this._hasMetaData=!0,this.metaDataLoaded.trigger(),this._capabilityClient.url=this._capabilityClient.url.replace(/&meta=1/gi,""),this._isTiled&&(this._keyZoom=this._deriveKeyZoomLevel(this.map.zoomLevel))),this.map&&this.map.isEnabled&&this._isDataDirty){this._isVisible=this.map.zoomLevel>=this.minimumZoom&&this.map.zoomLevel<=this.maximumZoom;var _=this._deriveDiscreteTime();(!this._currentDiscreteTime||!this._currentDiscreteTime.equals(_))&&(this._currentDiscreteTime=_);var b=this._determineTiles();this._requestTiles(b.missing),this._isDataDirty=!1}},l.prototype._onMapEnabled=function(i){this._capabilityClient.startPolling()},l.prototype._onMapDisabled=function(i){this._capabilityClient.stopPolling()},l.prototype._onCapabilitiesErrored=function(i){},l.prototype._onCapabilitiesTimedOut=function(i){},l.GML_NAMESPACE="http://www.opengis.net/gml",l}(ft.h),ki=B(20512),si=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Gi=function(O){si(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.capabilitiesPollingFrequency=void 0,s.capabilitiesTimeout=void 0,s.capabilitiesUrl=void 0,s.tesseraUrl=void 0,s.layerKey=void 0,s.enableUpdating=void 0,(0,x.f0)(s,i),s}return l}(ki.J),$i=function(O){si(l,O);function l(i){var s=O.call(this,i=i instanceof Gi?i:new Gi(i))||this;return s._extension="png",s._enableUpdating=!0,s.metaDataLoaded=new W.j,s._subdomains=i.subdomains,s._capabilitiesPollingFrequency=i.capabilitiesPollingFrequency||6e4,s._capabilitiesTimeout=i.capabilitiesTimeout||5e3,s._layerKey=i.layerKey,s._isTms=!0,s._enableUpdating=i.enableUpdating!=null?i.enableUpdating:!0,s._timeManager._validBackward=i.validBackward||Ue.i.max,s._timeManager._validForward=i.validForward||Ue.i.max,s}return Object.defineProperty(l.prototype,"enableUpdating",{get:function(){return this._enableUpdating},set:function(i){this._enableUpdating=i,i&&!this._capabilitiesClient.isPolling?this._capabilitiesClient.startPolling():!i&&this._capabilitiesClient.isPolling&&this._capabilitiesClient.stopPolling()},enumerable:!0,configurable:!0}),l.prototype._convertJsonCapabilities=function(i){var s=this._timeManager,_=i?JSON.parse(i):this._capabilitiesClient.objectLiteral,b=_.layers[0];b.anim&&(this._isAnimate=b.anim),b.ext&&(this._extension=b.ext);var D=this._maximumNativeZoom;b.max&&D>b.max&&(D=b.max),this._maximumNativeZoom=D,b.min&&this._minimumZoom<b.min&&(this.minimumZoom=b.min),!this._options.validForward&&b.forward&&(s._validForward=new Ue.i(b.forward)),!this._options.validBackward&&b.backward&&(s._validBackward=new Ue.i(b.backward)),_.href&&(this._urlTemplate=_.href),_.s&&!this._subdomains&&(this._subdomains=_.s);var G=!1;if(b.hasOwnProperty("m")){var Z=this._convertJsonModelRuns(b.m);if(s._modelRuns&&s._modelRuns.length>0||Z.length>0){var te=JSON.stringify(s._modelRuns),ae=JSON.stringify(Z);G=te===ae}s._modelRuns=Z}else if(b.hasOwnProperty("v")){var Pe=this._convertJsonValidTimes(b.v);if(s._validTimes&&s._validTimes.length>0||Pe.length>0){var ve=JSON.stringify(s._validTimes),pe=JSON.stringify(Pe);G=ve!==pe}s._validTimes=Pe}return G},l.prototype._convertJsonModelRuns=function(i){var s=[];for(var _ in i){var b=i[_],D=(0,Le.g7)(b.t),G=new rt.o(D);G.validTimes=this._convertJsonValidTimes(b.v),s.push(G)}return s},l.prototype._convertJsonValidTimes=function(i){var s=[];for(var _ in i){var b=i[_],D=(0,Le.g7)(b.t),G=new Mt.T(D,b.c);s.push(G)}return s},l.prototype._convertTmsCapabilities=function(i){var s=i||this._capabilitiesClient.text,_=this._timeManager,b=/\S/g,D;try{if(DOMParser){var G=new DOMParser;D=G.parseFromString(s,"text/xml")}else D=new ActiveXObject("Microsoft.XMLDOM"),D.async=!1,D.loadXML(s)}catch(qe){D=new ActiveXObject("Microsoft.XMLDOM"),D.async=!1,D.loadXML(s)}for(var Z=D.childNodes[0],te=Z.getElementsByTagName("TileMap"),ae=[],Pe=!1,ve=0,pe=te.length;ve<pe;ve++){var Fe=te[ve],ke=Fe.attributes;if(ke.title.value===this._layerKey){var Ze="",at=ke.href.value,Ve=at.indexOf("/Layer/")-16;Ve>0&&(Ze=at.substr(Ve,16));var st=(0,Le.g7)(ke.version.value),Pt=new Mt.T(st,Ze);Pt.chrono=ke.version.value,ae.push(Pt),!this._hasMetaData&&!Pe&&(at=at.replace(Ze,"{c}"),at=at.replace("{0}","{z}/{x}/{y}.{e}"),at=at.replace(ke.version.value,"{v}"),this._capabilitiesClient=at,ke.maxZoom&&ke.maxZoom.value&&(this._maximumNativeZoom&&this._maximumNativeZoom>ke.maxZoom.value?this._maximumNativeZoom=ke.maxZoom.value:this._maximumZoom>ke.maxZoom.value&&(this._maximumZoom=ke.maxZoom.value)),this._extension=ke.imageFormat.value,Pe=!0)}}ae.length>1?(this._isAnimate=!0,this.map.clock.timeChanged.addListener(this._onTimeChanged,this)):this._isAnimate=!1;var $e=!1;if(_._validTimes&&_._validTimes.length>0||ae.length>0){var Ct=JSON.stringify(_._validTimes),At=JSON.stringify(ae);$e=Ct!==At}return _._validTimes=ae,$e},l.prototype._deriveLeafletOptions=function(){var i=O.prototype._deriveLeafletOptions.call(this);return i.subdomains=this._subdomains,i.tms=!0,i},l.prototype._deriveUrlTemplate=function(i){var s=this._urlTemplate;if(i||(i=this._timeManager._currentDiscreteTime),!s||!i.validTime)return this._errorTileUrl;if(s=s.replace("{n}",this._layerKey),s=s.replace("{l}","en-US"),i.modelRun){var _=(0,Le.RQ)(i.modelRun.value);s=s.replace("{m}",_)}else s=s.replace("{m}","0");var b=(0,Le.RQ)(i.validTime.value);return s=s.replace("{v}",b),s=s.replace("{i}","1"),s=s.replace("{c}",i.validTime.cipher),s=s.replace("{e}",this._extension),s},l.prototype._load=function(){O.prototype._load.call(this),this._capabilitiesClient?this._hasMetaData&&this.update():this._startService()},l.prototype._unload=function(){this._isAnimate&&(this.map.animator.frameChanging.removeListener(this._onAnimatorFrameChanging,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this)),this._stopService(),this._hasMetaData=!1,O.prototype._unload.call(this)},l.prototype._startService=function(i){if(!this._capabilitiesClient){var s=this.options,_=void 0,b=void 0,D=void 0;_=i||s.capabilitiesUrl||s.tesseraUrl||this.map.tesseraUrl,b=this.map.tesseraMemberKey,D=this.map.tesseraMapKey,_=_+"&meta=1",_=_.replace("{memberKey}",b),_=_.replace("{mapKey}",D),_=_.replace("{layerKey}",this._layerKey);var G=new Br.U(_);G.timeout=5e3,G.pollingInterval=6e4,G.modified.addListener(this._onJsonCapabilitiesLoaded,this),G.errored.addListener(this._onCapabilitiesErrored,this),G.timedOut.addListener(this._onCapabilitiesTimedOut,this),this._capabilitiesClient=G,G.startPolling()}},l.prototype._stopService=function(){this._capabilitiesClient&&(this._capabilitiesClient.stopPolling(),this._capabilitiesClient.modified.removeListener(this._onJsonCapabilitiesLoaded,this),this._capabilitiesClient.errored.removeListener(this._onCapabilitiesErrored,this),this._capabilitiesClient.timedOut.removeListener(this._onCapabilitiesTimedOut,this),this._capabilitiesClient=void 0)},l.prototype.preload=function(i){this._capabilitiesClient||this._startService(i)},l.prototype._onTmsCapabilitiesLoaded=function(i){var s=this._convertTmsCapabilities();this._hasMetaData?s&&(this._updateFrames(),this.metaDataModified.trigger()):(this._hasMetaData=!0,this.metaDataLoaded.trigger(),this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this))),this.map&&this.map.isEnabled&&this.update()},l.prototype._onJsonCapabilitiesLoaded=function(i){var s=this._convertJsonCapabilities();if(!this._hasMetaData)this._hasMetaData=!0,this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this)),this.map&&this.map.isEnabled&&this.update(),this.metaDataLoaded.trigger();else if(s){var _=this._updateFrames();this.map&&this.map.isEnabled&&this.update(),this.metaDataModified.trigger()}},l.prototype._onCapabilitiesErrored=function(i){},l.prototype._onCapabilitiesTimedOut=function(i){},l.prototype._onMapEnabled=function(i){this.enableUpdating&&this._capabilitiesClient.startPolling(),O.prototype._onMapEnabled.call(this,i)},l.prototype._onMapDisabled=function(i){this._capabilitiesClient.stopPolling(),O.prototype._onMapDisabled.call(this,i)},l}(ki.p),dr=B(44427),Vi=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Ki=function(O){Vi(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.layerKey=void 0,s.requestFrequency=void 0,s.requestTimeout=void 0,s.sourceUrl=void 0,s.auth=void 0,s.configuration=void 0,(0,x.f0)(s,i),s}return l}(ft.p),un=function(O){Vi(l,O);function l(i){var s=O.call(this,i=i instanceof Ki?i:new Ki(i))||this;switch(s._isTicking=!1,s._lastGeoBounds=new I.c,s._configuration=i.configuration||{},s._layerKey=i.layerKey,s._requestFrequency=i.requestFrequency||6e4,s._requestTimeout=i.requestTimeout,s._sourceUrl=i.sourceUrl,s._auth=i.auth,s._hasMetaData=!0,i.layerKey.toUpperCase()){case"STORMSURGE":case"STORMREPORTS":case"TORNADO":s._requestMethod="POST";break}switch(i.layerKey.toUpperCase()){case"HURRICANECURRENT":case"HURRICANEPAST":s._isTiled=!1;break;default:s._pyramidPolicy=[{data:0,start:0},{data:1,start:1},{data:3,start:3},{data:4,start:4},{data:5,start:5},{data:6,start:6},{data:7,start:7},{data:8,start:8},{data:9,start:9},{data:10,start:10},{data:11,start:11},{data:12,start:12}],s._isTiled===void 0&&(s._isTiled=!0);break}return s}return Object.defineProperty(l.prototype,"configuration",{get:function(){return this._configuration},enumerable:!0,configurable:!0}),l.prototype._parse=function(i){switch(this._layerKey.toUpperCase()){case"CROWD":return this._parseCrowds(i);case"HURRICANECURRENT":return this._parseHurricaneCurrent(i);case"HURRICANEPAST":return this._parseHurricanePast(i);case"LIGHTNING":return this._parseLightning(i);case"PWS":return this._parsePws(i);case"STORMREPORTS":return this._parseStormReports(i);case"STORMSURGE":return this._parseStormSurge(i);case"TORNADO":return this._parseTornado(i);case"WEBCAM":return this._parseWebCams(i);default:return[]}},l.prototype._parseCrowds=function(i){for(var s=[],_=JSON.parse(i),b=_.CrowdSourceObservations,D=0,G=b.length;D<G;D++){var Z=b[D],te=v.F.fromDegrees(Z.Latitude,Z.Longitude),ae=new Dt.t(te),Pe={};for(var ve in Z)Pe[ve]=Z[ve];ae.properties=Pe,s.push(ae)}return s},l.prototype._parseLightning=function(i){var s=[],_=JSON.parse(i),b=_.ICONS;for(var D in b){var G=b[D],Z=v.F.fromDegrees(parseFloat(G.lat),parseFloat(G.lon)),te=new Dt.t(Z);te.properties=G,s.push(te)}return s},l.prototype._parsePws=function(i){var s=[],_=JSON.parse(i);for(var b in _.conds){var D=_.conds[b],G=parseFloat(D.lat),Z=parseFloat(D.lon),te=v.F.fromDegrees(G,Z),ae=new Dt.t(te),Pe={};for(var ve in D)Pe[ve]=D[ve];ae.properties=Pe,s.push(ae)}return s},l.prototype._parseStormReports=function(i){var s=(0,dr.p)(i);return s},l.prototype._parseStormSurge=function(i){var s=(0,dr.p)(i);return s},l.prototype._parseTornado=function(i){var s=(0,dr.p)(i);return s},l.prototype._parseWebCams=function(i){var s=[],_=JSON.parse(i),b=_.ICONS;for(var D in b){var G=b[D],Z=v.F.fromDegrees(parseFloat(G.lat),parseFloat(G.lon)),te=new Dt.t(Z);te.properties=G,s.push(te)}return s},l.prototype._parseHurricaneCurrent=function(i){for(var s=[],_=JSON.parse(i),b=_.currenthurricane,D=0,G=b.length;D<G;D++){var Z=b[D],te=Z.stormInfo,ae=Z.Current,Pe=v.F.fromDegrees(ae.lat,ae.lon),ve=ae;ve.stormName=te.stormName;var pe=new Dt.t(Pe,ve);s.push(pe);for(var Fe=0,ke=Z.forecast.length;Fe<ke;Fe++){var Ze=Z.forecast[Fe],at=v.F.fromDegrees(Ze.lat,Ze.lon),Ve=Ze;Ve.stormName=te.stormName;var st=new Dt.t(at,Ve);s.push(st)}for(var Pt=[],Fe=0,$e=Z.track.length;Fe<$e;Fe++){var Ct=Z.track[Fe],At=v.F.fromDegrees(Ct.lat,Ct.lon);Pt.push(At);var qe=Ct;qe.stormName=te.stormName;var nt=new Dt.t(At,qe);s.push(nt)}var Xe=new Ft.A(Pt),It=new dt.P(Xe,te);s.push(It)}return s},l.prototype._parseHurricanePast=function(i){for(var s=[],_=JSON.parse(i),b=_.hurricane,D=0,G=b.length;D<G;D++){for(var Z=b[D],te=Z.stormInfo,ae=Z.track,Pe=[],ve=0,pe=ae.length;ve<pe;ve++){var Fe=ae[ve],ke=v.F.fromDegrees(Fe.lat,Fe.lon);Pe.push(ke);var Ze=Fe;Ze.stormName=te.stormName;var at=new Dt.t(ke,Ze);s.push(at)}var Ve=new Ft.A(Pe),st=new dt.P(Ve,Z.storm);s.push(st)}return s},l.prototype._deriveUrl=function(i){var s=i.z,_=i.x,b=i.y;switch(this._layerKey.toUpperCase()){case"CROWD":return this._deriveUrlCrowds(s,_,b);case"HURRICANECURRENT":return this._deriveUrlHurricaneCurrent(s,_,b);case"HURRICANEPAST":return this._deriveUrlHurricanePast(s,_,b);case"LIGHTNING":return this._deriveUrlLightning(s,_,b);case"PWS":return this._deriveUrlPws(s,_,b);case"STORMREPORTS":return this._deriveUrlStormReports(s,_,b);case"STORMSURGE":return this._deriveUrlStormSurge(s,_,b);case"TORNADO":return this._deriveUrlTornado(s,_,b);case"WEBCAM":return this._deriveUrlWebcams(s,_,b);default:return null}},l.prototype._deriveUrlCrowds=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G=this._sourceUrl||l._crowdUrl;return G=G.replace("{maxlat}",D.north.degrees.toString()),G=G.replace("{minlon}",D.west.degrees.toString()),G=G.replace("{minlat}",D.south.degrees.toString()),G=G.replace("{maxlon}",D.east.degrees.toString()),G},l.prototype._deriveUrlLightning=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G="proj=me&extension=js&key=lightning&cors=1";G+="&minlat="+D.south.degrees,G+="&minlon="+D.west.degrees,G+="&maxlat="+D.north.degrees,G+="&maxlon="+D.east.degrees;var Z=this._sourceUrl||l._iconblastCgiUrl;return Z=Z.replace("{params}",G),Z},l.prototype._deriveUrlPws=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G="iconsize={iconSize}&width=512&height=512&maxage=3600&format=json&maxstations=100&rf_filter=1&station={stations}";G+="&minlat="+D.south.degrees,G+="&minlon="+D.west.degrees,G+="&maxlat="+D.north.degrees,G+="&maxlon="+D.east.degrees;var Z=this._sourceUrl||l._stationDataUrl;Z=Z.replace("{params}",G);var te=this.configuration.iconSize?this.configuration.iconSize:16;Z=Z.replace("{iconSize}",te);var ae=[];if(this.configuration.stations)ae=this.configuration.stations;else for(var Pe=0,ve=this._features.length;Pe<ve;Pe++){var pe=this._features[Pe];ae.push(pe.properties.id)}return ae.length>0?Z=Z.replace("{stations}",ae.join(",")):Z=Z.replace("&station={stations}",""),Z},l.prototype._deriveUrlStormReports=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G='service=stormreportPOST{"cors":"1"';G+=',"auth":"'+this._auth+'"',G+=',"minLat":"'+D.south.degrees+'"',G+=',"minLon":"'+D.west.degrees+'"',G+=',"maxLat":"'+D.north.degrees+'"',G+=',"maxLon":"'+D.east.degrees+'"',G+="}";var Z=this._sourceUrl||l._iconblastUrl;return Z=Z.replace("{params}",G),Z},l.prototype._deriveUrlStormSurge=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G='service=stormsurgePOST{"cors":"1"';G+=',"auth":"'+this._auth+'"',G+=',"minLat":"'+D.south.degrees+'"',G+=',"minLon":"'+D.west.degrees+'"',G+=',"maxLat":"'+D.north.degrees+'"',G+=',"maxLon":"'+D.east.degrees+'"',G+="}";var Z=this._sourceUrl||l._iconblastUrl;return Z=Z.replace("{params}",G),Z},l.prototype._deriveUrlTornado=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G='service=tornadoPOST{"cors":"1"';G+=',"auth":"'+this._auth+'"',G+=',"minLat":"'+D.south.degrees+'"',G+=',"minLon":"'+D.west.degrees+'"',G+=',"maxLat":"'+D.north.degrees+'"',G+=',"maxLon":"'+D.east.degrees+'"',G+="}";var Z=this._sourceUrl||l._iconblastUrl;return Z=Z.replace("{params}",G),Z},l.prototype._deriveUrlWebcams=function(i,s,_){var b=new Kt.n(i-1,s,_),D=Bt.x.convertTileToGeo(b,256,this._lastGeoBounds),G="proj=me&extension=js&key=webcams&cors=1";G+="&minlat="+D.south.degrees,G+="&minlon="+D.west.degrees,G+="&maxlat="+D.north.degrees,G+="&maxlon="+D.east.degrees;var Z=this._sourceUrl||l._iconblastCgiUrl;return Z=Z.replace("{params}",G),Z},l.prototype._deriveUrlHurricaneCurrent=function(i,s,_){var b=this._sourceUrl||l._hurricaneCurrentUrl;return b=b.replace("{apiKey}",this._auth),b},l.prototype._deriveUrlHurricanePast=function(i,s,_){var b=this._sourceUrl||l._hurricanePastUrl;return b=b.replace("{apiKey}",this._auth),b=b.replace("{product}","hurricane"),b=b.replace("{zone}",this.configuration.zone),b=b.replace("{year}",this.configuration.year),b},l.prototype._load=function(){switch(this._timeStamp=this.map.clock.time,this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}this.map.moved.addListener(this._onMapMoved,this),this._isVisible=this.map.zoomLevel>=this.minimumZoom&&this.map.zoomLevel<=this.maximumZoom,this._requestFrequency>0&&this.startTimer(),this.update()},l.prototype._unload=function(){this.stopTimer(),O.prototype._unload.call(this)},l.prototype.resetTimer=function(){this._isTicking||(this.stopTimer(),this.startTimer())},l.prototype.startTimer=function(i){var s=this;i||(i=this._requestFrequency),this._isTicking||(this._isTicking=!0,i>0&&(this._delay=window.setTimeout(function(){s._timer=window.setInterval(function(){s.update()},i)})))},l.prototype.stopTimer=function(){this._isTicking&&(this._isTicking=!1,clearTimeout(this._delay),clearInterval(this._timer))},l.prototype.configure=function(i){for(var s in i)this._configuration[s]=i[s];this.update()},l.prototype._onMapZoomed=function(i){},l.prototype._onMapMoved=function(i){this.update(),this._toggleVisibility()},l._crowdUrl="//api.weather.com/obs/crowdsource/v2/en_US/{maxlat}/{minlon}/{minlat}/{maxlon}.json?reportType=SkyReport,HazardReport&apiKey=6532d6454b8aa370768e63d6ba5a832e",l._stationDataUrl="//stationdata.wunderground.com/cgi-bin/stationdata?{params}",l._iconblastCgiUrl="https://www.wunderground.com/cgi-bin/ICONBLAST?{params}",l._iconblastUrl="https://www.wunderground.com/iconblast?{params}",l._hurricanePastUrl="https://api-ak.wunderground.com/api/{apiKey}/{product}_{zone}{year}/view.json",l._hurricaneCurrentUrl="https://api-ak.wunderground.com/api/{apiKey}/currenthurricane/view.json",l}(ft.h),_r=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),hn=function(O){_r(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.validBackward=void 0,s.validForward=void 0,s.timeRange=void 0,s.timeMode=void 0,(0,x.f0)(s,i),s}return l}(Yt),jr=function(O){_r(l,O);function l(i){var s=O.call(this,i=i instanceof hn?i:new hn(i))||this;s._frames={},s._isAnimate=!1,s._hasFrame=!1,s._hasMetaData=!1,s._pendingFrameTimer=-1;var _=s._timeManager=new be.l;return _._validBackward=i.validBackward||Ue.i.min,_._validForward=i.validForward||Ue.i.max,s._timeRange=i.timeRange||new ue.e,s._timeMode=i.timeMode,_._timeRange=s._timeRange,s}return l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)&&i!=this._opacity){var s=this._opacity;if(this._opacity=i,this.map)switch(this.map.renderer){case Q.Renderer.WebDOM:for(var _ in this._frames){var b=this._frames[_];b.setOpacity(i)}break;case Q.Renderer.WebGL:this._currentFrame&&(this._currentFrame.layer.paint["raster-opacity"]=i,this.map._mapboxEngine.setPaintProperty(this._currentFrame.layer.id,"raster-opacity",i));break}this.opacityChanged.trigger({old:s,new:i})}},Object.defineProperty(l.prototype,"currentDiscreteTime",{get:function(){return this._timeManager._currentDiscreteTime},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"modelRuns",{get:function(){return this._timeManager._modelRuns},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"validTimes",{get:function(){return this._timeManager._validTimes},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeRange",{get:function(){return this._timeRange},set:function(i){i!==this._timeRange&&(this._timeRange=i,this._timeManager._timeRange=i)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeMode",{get:function(){return this._timeMode},set:function(i){i in x.$i||this.map&&(i=this.map.animator.timeMode),this._timeMode=i},enumerable:!0,configurable:!0}),l.prototype._load=function(){switch(this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this.map.zoomed.addListener(this._onMapZoomed,this),this.map.moved.addListener(this._onMapMoved,this),this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}},l.prototype._unload=function(){switch(this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this.map.zoomed.removeListener(this._onMapZoomed,this),this.map.moved.removeListener(this._onMapMoved,this),this._isAnimate&&(this.map.animator.frameChanging.removeListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this)),this._timeManager._unload(),this._clearFrames(),this.map.renderer){case Q.Renderer.WebDOM:this._unloadLeaflet();break;case Q.Renderer.WebGL:this._unloadMapbox();break}this._changeLoadState(x.jd.Unloaded)},l.prototype._render=function(){switch(this.map.renderer){case Q.Renderer.WebDOM:this._renderLeaflet();break;case Q.Renderer.WebGL:this._renderMapbox();break}},l.prototype._addFrame=function(i,s){switch(s===void 0&&(s=!1),this.map.renderer){case Q.Renderer.WebDOM:return this._addLeafletFrame(i,s);case Q.Renderer.WebGL:return this._addMapboxFrame(i,s)}},l.prototype._changeFrame=function(i){switch(this.map.renderer){case Q.Renderer.WebDOM:this._changeLeafletFrame(i);break;case Q.Renderer.WebGL:this._changeMapboxFrame(i);break}},l.prototype._preloadFrame=function(i){switch(this.map.renderer){case Q.Renderer.WebDOM:return this._preloadLeafletFrame(i);case Q.Renderer.WebGL:return this._preloadMapboxFrame(i)}},l.prototype._removeFrame=function(i){switch(this.map.renderer){case Q.Renderer.WebDOM:this._removeLeafletFrame(i);break;case Q.Renderer.WebGL:this._removeMapboxFrame(i);break}},l.prototype._clearFrames=function(){for(var i in this._frames)this._removeFrame(i);this._frames={}},l.prototype.update=function(){if(this._hasMetaData){var i=this._timeManager,s=this.map.clock.time,_=this._timeManager._deriveDiscreteTime(s);i._timeRange.inRange(s)?(!i._currentDiscreteTime||!i._currentDiscreteTime.equals(_))&&(i._currentDiscreteTime=_,this._changeFrame(_),this.updated.trigger({id:this.id})):this._changeFrame(new tt.d)}},l.prototype.changeModelRun=function(i){this._timeManager._providedModelRun=i,this.update()},l.prototype._loadLeaflet=function(){this._loadLeafletPane()},l.prototype._renderLeaflet=function(){for(var i in this._frames){var s=this._frames[i];if(this.map.animator.isPlaying||s._isVisible){var _=s._discreteTime,b=this._deriveFrameUrl(_);s.setUrl(b)}else s._isDirty=!0}},l.prototype._addLeafletFrame=function(i,s){var _=i.key,b=this._deriveFrameUrl(i),D=this._deriveLeafletOptions(),G=this.map.bounds.toLeaflet(),Z=new(gt()).ImageOverlay(b,G,D);return Z._discreteTime=i,Z._loadState=x.jd.Unloaded,Z._isPreloading=s,Z.on("loading",this._onImageLoading,this),Z.on("load",this._onImageLoaded,this),Z._isDirty=!1,Z._key=_,this._frames[_]=Z,this.map.engine.addLayer(Z),Z._isVisible=!1,Z.setOpacity(0),Z},l.prototype._changeLeafletFrame=function(i){var s=i.key;for(var _ in this._frames)if(_!=s){var b=this._frames[_];b._isVisible&&(b._isVisible=!1,b.setBounds(I.c.minimum.toLeaflet()),b.setOpacity(0))}if(i.validTime&&this._timeRange.inRange(i.validTime.value)){var D=this._frames[s]||this._addFrame(i);D._isVisible=!0,D.setOpacity(this.opacity),D.setBounds(this.map.bounds.toLeaflet()),D._loadState!=this._loadState&&this._changeLoadState(D._loadState),this._currentFrame=D,this._currentFrameKey=s}},l.prototype._removeLeafletFrame=function(i){var s=this._frames[i];s.off("loading",this._onImageLoading,this),s.off("load",this._onImageLoaded,this),this.map.engine.removeLayer(s),delete this._frames[i]},l.prototype._preloadLeafletFrame=function(i){if(i.validTime&&this._timeRange.inRange(i.validTime.value)){var s=i.key,_=this._frames[s];if(!_)this._addFrame(i,!0);else if(_._isDirty){var b=this._deriveFrameUrl(i);_.setUrl(b)}return _}return null},l.prototype._deriveLeafletOptions=function(){var i={};return this._isInteractive&&(i.interactive=this._isInteractive),i},l.prototype._unloadLeafletPane=function(){this._map._leafletEngine&&(gt().DomUtil.remove(this._leafletPane),this._leafletPane=null)},l.prototype._loadMapbox=function(){var i=this.map._mapboxEngine;i.on("sourcedataloading",this._onImageLoading.bind(this)),i.on("sourcedata",this._onImageLoaded.bind(this))},l.prototype._unloadMapbox=function(){this.map._mapboxEngine.off("sourcedataloading",this._onImageLoading.bind(this)),this.map._mapboxEngine.off("sourcedata",this._onImageLoaded.bind(this))},l.prototype._renderMapbox=function(){var i=this.map.engine,s=this._bounds||this.map.bounds,_=this._deriveMapboxBounds(s);for(var b in this._frames){var D=this._frames[b];if(this.map.animator.isPlaying||D._isVisible){var G=D.layer.source,Z=D._discreteTime,te=this._deriveFrameUrl(Z),ae=i.getSource(G);ae.setUrl?(ae.setCoordinates(_),ae.setUrl(te)):(i.style.removeSource(G,!0),i.addSource(G,{type:"image",url:te,coordinates:_}))}}},l.prototype._addMapboxFrame=function(i,s){var _=i.key,b=this.id+"_"+_,D=this._bounds||this.map.bounds,G=this._deriveMapboxBounds(D),Z=this.map.engine,te=this._deriveFrameUrl(i);te=te.replace("{s}","");var ae={};return ae.source={type:"image",url:te,coordinates:G},ae.layer={id:b,type:"raster",source:b,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,paint:{"raster-fade-duration":0,"raster-opacity":this.opacity,"raster-opacity-transition":{duration:0,delay:0}}},ae.id=b,ae._key=_,ae._loadState=x.jd.Unloaded,ae._isPreloading=s,ae._discreteTime=i,this._frames[_]=ae,Z.addSource(b,ae.source),ae},l.prototype._changeMapboxFrame=function(i){var s=this,_=i.key,b=this.map._mapboxEngine,D=b.style,G=this.opacity;if(i.validTime&&this._timeRange.inRange(i.validTime.value)){var Z=this._frames[_]||this._addFrame(i),te=Z.id,ae=D.sourceCaches[te].loaded();if(!ae){this._pendingFrameTimer=setTimeout(function(){return s._changeMapboxFrame(i)},30);return}this._unloadMapboxGroup(),Z._isVisible=!0,Z._isPreloading=!1,this._mapboxGroup=[Z.layer],this._loadMapboxGroup(),this._currentFrame=Z,this._currentFrameKey=_}},l.prototype._removeMapboxFrame=function(i){var s=this._frames[i],_=s.id,b=this.map.engine;b.getLayer(_)&&b.removeLayer(_),b.getSource(_)&&b.removeSource(_);for(var D=-1,G=0,Z=this._mapboxGroup.length;G<Z;G++){var te=this._mapboxGroup[G];if(te.id===s.layer.id){D=G;break}}D>=0&&(this._mapboxGroup.splice(D,1),this._unloadMapboxGroup(),this._loadMapboxGroup()),delete this._frames[i]},l.prototype._preloadMapboxFrame=function(i){var s=i.key,_=this._frames[s]||this._addFrame(i,!0);return _},l.prototype._deriveMapboxBounds=function(i){var s=[i.topLeftGeoPoint.longitude.degrees,i.topLeftGeoPoint.latitude.degrees],_=[i.topRightGeoPoint.longitude.degrees,i.topRightGeoPoint.latitude.degrees],b=[i.bottomRightGeoPoint.longitude.degrees,i.bottomRightGeoPoint.latitude.degrees],D=[i.bottomLeftGeoPoint.longitude.degrees,i.bottomLeftGeoPoint.latitude.degrees],G=[s,_,b,D];return G},l.prototype._onMapEnabled=function(i){},l.prototype._onMapDisabled=function(i){},l.prototype._onAnimatorFrameChanging=function(i){if(this.map&&this.map.isEnabled){var s=this._timeManager._deriveDiscreteTime(i.time);this._preloadFrame(s)}},l.prototype._onAnimatorFrameChanged=function(i){this.map&&this.map.isEnabled&&this.update()},l.prototype._onTimeChanged=function(i){this._timeMode===x.$i.Relative&&this._timeRange._increment(),this.map&&this.map.isEnabled&&this.update()},l.prototype._onImageLoading=function(i){if(this.map&&this.map.isEnabled){var s=void 0;switch(this.map.renderer){case Q.Renderer.WebDOM:s=i.target;break;case Q.Renderer.WebGL:if(i.sourceId&&i.sourceId.indexOf(this.id)===0&&!i.tile){var _=this.map.engine,b=_.style.sourceCaches[i.sourceId];if(b&&!b.loaded()){var D=i.sourceId.replace(this.id+"_","");s=this._frames[D]}}break}s&&s._loadState!=x.jd.Loading&&(s._loadState=x.jd.Loading,this.loadState!=x.jd.Loading&&(!this._currentFrameKey||s._key===this._currentFrameKey||s._isPreloading)&&this._changeLoadState(x.jd.Loading))}},l.prototype._onImageLoaded=function(i){if(this.map&&this.map.isEnabled){var s=void 0;switch(this.map.renderer){case Q.Renderer.WebDOM:s=i.target,s.setBounds(this.map.bounds.toLeaflet());break;case Q.Renderer.WebGL:if(i.sourceId&&i.sourceId.indexOf(this.id)===0&&!i.tile){var _=this.map.engine,b=_.style.sourceCaches[i.sourceId];if(b&&b.loaded()){var D=i.sourceId.replace(this.id+"_","");s=this._frames[D]}}break}if(s&&s._loadState!=x.jd.Loaded&&(s._loadState=x.jd.Loaded,s._isPreloading=!1,this.loadState!=x.jd.Loaded)){var G=this._frames[this.currentDiscreteTime.key],Z=G&&G._loadState===x.jd.Loading;Z||this._changeLoadState(x.jd.Loaded)}}},l}(ur),cr=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Ei=function(O){cr(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return(0,x.f0)(s,i),s}return l}(hn),Dn=function(O){cr(l,O);function l(i){var s=O.call(this,i=i instanceof Ei?i:new Ei(i))||this;return s._configuration=null,s._meta=null,s._layerKey=i.layerKey,s._sourceUrl=i.sourceUrl,s}return Object.defineProperty(l.prototype,"configuration",{get:function(){return this._configuration},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"meta",{get:function(){return this._meta},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),l.prototype._deriveDefaultModelRun=function(){for(var i=null,s=this._timeManager,_=0,b=s._modelRuns.length;_<b;_++){var D=s._modelRuns[_];(i===null||D.value>i.value)&&(i=D)}return i},l.prototype._convertModelCapabilities=function(){var i=this._wuClient.objectLiteral,s,_;switch(this.options.layerKey.toUpperCase()){case"MODELECMWF":s=i.MODEL.ECMWF,_="ECMWF";break;case"MODELGFS":s=i.MODEL.GFS,_="GFS";break}this._meta=s.MAP,this._configuration||(this._configuration={},this._configuration=this._meta.node_0,this._configuration.model=_);var b=[];for(var D in s.modelrun){var G=s.modelrun[D],Z=G.initialization,te=G.finished,ae=G.period,Pe=new Date(parseInt(Z.epoch)*1e3),ve=new rt.o(Pe);ve._initialization=Z,ve._finished=te,ve._period=ae;var pe=[];for(var Fe in ae){var ke=ae[Fe],Ze=new Mt.T(new Date(parseInt(ke.valid)*1e3));Ze._valid=ke.valid,Ze._exists=ke.exists,Ze._period=ke.period,Ze._gribLoc=ke.gribLoc,Ze._ctlLoc=ke.ctlLoc,Ze._hour=ke.hour,pe.push(Ze)}ve.validTimes=pe,b.push(ve)}this._timeManager._modelRuns=b,this._isAnimate=b.length>0||pe.length>0},l.prototype._deriveFrameUrlModelData=function(i){var s=this.map.bounds,_=this.map.size,b="cors=1";b+="&model="+this._configuration.model,b+="&script="+this._configuration.key,b+="&hour="+i.validTime._hour,b+="&modelrun="+i.modelRun._initialization.readable,b+="&minlat="+s.south.degrees,b+="&minlon="+s.west.degrees,b+="&maxlat="+s.north.degrees,b+="&maxlon="+s.east.degrees,b+="&height="+_.height,b+="&width="+_.width;var D=this._sourceUrl||l._modelDataUrl;return D=D.replace("{params}",b),D},l.prototype._deriveFrameUrl=function(i){switch(this._layerKey.toUpperCase()){case"MODELECMWF":case"MODELGFS":return this._deriveFrameUrlModelData(i);default:return null}},l.prototype._load=function(){O.prototype._load.call(this),this._wuClient?this._hasMetaData&&this.update():this._startService()},l.prototype._unload=function(){this._stopService(),this._hasMetaData=!1,O.prototype._unload.call(this)},l.prototype._startService=function(i,s){switch(this._layerKey.toUpperCase()){case"MODELECMWF":case"MODELGFS":this._wuClient=new Br.U(l._modelCapabilitiesUrl),this._wuClient.pollingInterval=this._requestFrequency,this._wuClient.timeout=this._requestTimeout,this._wuClient.modified.addListener(this._onModelCapabilitiesLoaded,this),this._wuClient.errored.addListener(this._onModelCapabilitiesErrored,this),this._wuClient.timedOut.addListener(this._onModelCapabilitiesTimedOut,this),this._wuClient.startPolling();break}},l.prototype._stopService=function(){this._wuClient&&(this._wuClient.stopPolling(),this._wuClient.modified.removeListener(this._onModelCapabilitiesLoaded,this),this._wuClient.errored.removeListener(this._onModelCapabilitiesErrored,this),this._wuClient.timedOut.removeListener(this._onModelCapabilitiesTimedOut,this),this._wuClient=void 0)},l.prototype.preload=function(i,s){this._wuClient||this._startService(i,s)},l.prototype.configure=function(i){(0,x.f0)(this._configuration,i),this._render()},l.prototype._onModelCapabilitiesLoaded=function(i){if(this._convertModelCapabilities(),!this._hasMetaData)this._hasMetaData=!0,this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this));else{var s=this._timeManager,_=this.map.clock.time,b=s._deriveDiscreteTime(_);!this.map.animator.isPlaying&&!s._currentDiscreteTime.equals(b)&&this.update()}this.map&&this.map.isEnabled&&this.update()},l.prototype._onModelCapabilitiesErrored=function(i){},l.prototype._onModelCapabilitiesTimedOut=function(i){},l._modelCapabilitiesUrl="https://www.wunderground.com/stationmaps/gmap_modeldata.asp?cors=1",l._modelDataUrl="https://modelmaps.wunderground.com/php/run.php?{params}",l}(jr),Rn=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Hr=function(O){Rn(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.scrollWheelZoom.disable();break;default:this.map._mapboxEngine.scrollZoom.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(i){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.scrollWheelZoom.enable();break;default:var s;i&&(s={around:"center"}),this.map._mapboxEngine.scrollZoom.enable(s);break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),Ln=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),ja=function(O){Ln(l,O);function l(i){var s=O.call(this,i=i instanceof se?i:new se(i))||this;return s._dimension=new m.$(256,256),s._lastBottomLeftTile=new Kt.n(0,0,0),s._lastTopLeftTile=new Kt.n(0,0,0),s._lastTopRightTile=new Kt.n(0,0,0),s._lastBottomRightTile=new Kt.n(0,0,0),s._color=i.meta.color||"#999999",s._lineWidth=i.meta.lineWidth||1,s}return Object.defineProperty(l.prototype,"dimension",{get:function(){return this._dimension},set:function(i){this._dimension=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"color",{get:function(){return this._color},set:function(i){this._color=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(i){this._lineWidth=i,this.update()},enumerable:!0,configurable:!0}),l.prototype._resize=function(){this._canvas.width=this.map.width,this._canvas.height=this.map.height},l.prototype._clear=function(){this._context.clearRect(0,0,this.map.width,this.map.height)},l.prototype._drawLine=function(i,s){this._context.beginPath(),this._context.moveTo(i.x,i.y+.5),this._context.lineTo(s.x,s.y+.5),this._context.stroke()},l.prototype._drawVerticalLine=function(i,s,_,b){var D=_*256,G=Bt.x.convertPixelToGeo(new T.E(D,0),b),Z=G.longitude,te=new v.F(i.topLeftGeoPoint.latitude,Z),ae=new v.F(i.bottomLeftGeoPoint.latitude,Z);te.latitude.degrees>85.05113&&(te.latitude=mt.K.fromDegrees(85.05113)),ae.latitude.degrees<-85.05113&&(ae.latitude=mt.K.fromDegrees(-85.05113));var Pe=this.map.fromGeoToScreen(te),ve=this.map.fromGeoToScreen(ae);Pe.round(),ve.round(),this._drawLine(Pe,ve)},l.prototype._drawHorizontalLine=function(i,s,_,b){var D=Math.pow(2,b),G=s?_:D-_,Z=G*256,te=new T.E(0,Z),ae=Bt.x.convertPixelToGeo(te,b),Pe=ae.latitude;Pe.degrees>85.05113&&(Pe=mt.K.fromDegrees(85.05113)),Pe.degrees<-85.05113&&(Pe=mt.K.fromDegrees(-85.05113));var ve=new v.F(Pe,i.topLeftGeoPoint.longitude),pe=new v.F(Pe,i.topRightGeoPoint.longitude);ve.longitude.degrees<-180&&(ve.longitude=He.o.fromDegrees(-180)),pe.longitude.degrees>180&&(pe.longitude=He.o.fromDegrees(180));var Fe=this.map.fromGeoToScreen(ve);Fe.x=0;var ke=this.map.fromGeoToScreen(pe);ke.x=this._canvas.width,Fe.round(),ke.round(),this._drawLine(Fe,ke)},l.prototype._drawText=function(i,s){var _=this.map.fromGeoToScreen(i.bounds.topLeftGeoPoint),b=_.x,D=_.y,G=s+","+i.x+","+i.y;this._context.fillText(G,b,D)},l.prototype._load=function(){this._changeLoadState(x.jd.Loading),O.prototype._load.call(this),this.map.moving.addListener(this._onMoving,this),this.map.zoomed.addListener(this._onZoomed,this),this.map.resized.addListener(this._onResized,this),this._resize(),this.update(),this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){this.map.moving.removeListener(this._onMoving,this),this.map.zoomed.removeListener(this._onZoomed,this),this.map.resized.removeListener(this._onResized,this),this._clear(),O.prototype._unload.call(this)},l.prototype.update=function(){if(!!this.map){this.map.renderer===Q.Renderer.WebGL&&this._renderMapbox(),this._clear(),this._context.lineWidth=this._lineWidth,this._context.strokeStyle=this._color;var i=this.map.bounds,s=Math.floor(this.map.zoomLevel),_=-(0,x.oY)(this._dimension.width/256,2),b=s+_,D=Math.pow(2,b)-1,G=i.bottomLeftGeoPoint,Z=Bt.x.convertGeoToTile(G,b,256,this._lastBottomLeftTile);Z.y>D&&(Z.y=0);var te=i.topLeftGeoPoint,ae=Bt.x.convertGeoToTile(te,b,256,this._lastTopLeftTile);ae.y>D&&(ae.y=D);var Pe=i.topRightGeoPoint,ve=Bt.x.convertGeoToTile(Pe,b,256,this._lastTopRightTile);ve.y>D&&(ve.y=D);var pe=i.bottomRightGeoPoint,Fe=Bt.x.convertGeoToTile(pe,b,256,this._lastBottomRightTile);Fe.y>D&&(Fe.y=0);var ke=ae.x>=ve.x,Ze,at,Ve,st;if(ke){for(Ze=ae.x-1;Ze<=D;Ze++)this._drawVerticalLine(i,!0,Ze,b);for(Ze=0,Ve=ve.x;Ze<=Ve;Ze++)this._drawVerticalLine(i,!0,Ze,b)}else for(Ze=ae.x,Ve=ve.x+1;Ze<=Ve;Ze++)this._drawVerticalLine(i,!1,Ze,b);if(ke){for(at=Z.y;at<=D;at++)this._drawHorizontalLine(i,ke,at,b);for(at=0,st=Fe.y;at<=st;at++)this._drawHorizontalLine(i,ke,at,b)}else for(at=Z.y,st=ae.y+1;at<=st;at++)this._drawHorizontalLine(i,ke,at,b);this._context.textBaseline="hanging",this._context.fillStyle=this.color;for(var Pt=this.map._calculateTiles(b,256,!1),$e=0,Ct=Pt.length;$e<Ct;$e++){var At=Pt[$e];this._drawText(At,s)}this.updated.trigger({id:this.id})}},l.prototype._renderMapbox=function(){var i=this.map._mapboxEngine.getSource(this.id),s=this.isViewportBound?this.map.bounds:this.bounds,_=this._deriveMapboxCoordinates(s);i.setCoordinates(_)},l.prototype._onMoving=function(i){this.update()},l.prototype._onResized=function(i){this._resize(),this.update()},l.prototype._onZoomed=function(i){this.update()},l}(X),Ta=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),gr=function(O){Ta(l,O);function l(i,s){var _=O.call(this,i)||this;return _._id="Tile Grid",_._layer=null,_._options=s,_._options.id&&(_._id=_._options.id),_._isEnabled=!1,_}return Object.defineProperty(l.prototype,"color",{get:function(){return this._color},set:function(i){this._color=i,this.update()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(i){this._lineWidth=i,this.update()},enumerable:!0,configurable:!0}),l.prototype._loadLayer=function(){var i=new se;i.id=this._id,i.meta.color="#999999",i.meta.lineWidth=1,i.size=this.map.size,i.bounds=this.map.bounds,this._layer=new ja(i),this._options.dimension&&(this._layer.dimension=this._options.dimension)},l.prototype.disable=function(){this._isEnabled&&(this.map.removeLayer(this._id),this._isEnabled=!1,this.disabled.trigger())},l.prototype.enable=function(){!this._isEnabled&&this.map.isEnabled&&(this._loadLayer(),this._layer&&(this.map.addLayer(this._layer),this._isEnabled=!0,this.enabled.trigger()))},l.prototype.update=function(){this._isEnabled&&(this._layer.color=this._color,this._layer.lineWidth=this._lineWidth,this._layer.update())},l}(h),jo=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),gn=function(O){jo(l,O);function l(i){return O.call(this,i)||this}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.touchZoom.disable();break;default:this.map._mapboxEngine.touchZoomRotate.disable();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebDOM:this.map._leafletEngine.touchZoom.enable();break;default:this.map._mapboxEngine.touchZoomRotate.enable();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),Ur=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),cn=function(O){Ur(l,O);function l(i){var s=O.call(this,i)||this;return s._isEnabled=!1,s}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebGL:this.map._mapboxEngine.dragRotate.disable(),this.map._mapboxEngine.touchZoomRotate.disableRotation(),this.map._mapboxEngine.dragRotate._pitchWithRotate&&this.map.tilting.disabled.trigger();break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebGL:this.map._mapboxEngine.dragRotate.enable(),this.map._mapboxEngine.touchZoomRotate.enableRotation(),this.map._mapboxEngine.dragRotate._pitchWithRotate&&this.map.tilting.enabled.trigger();break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),Ir=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Wn=function(O){Ir(l,O);function l(i){var s=O.call(this,i)||this;return s._isEnabled=!1,s}return l.prototype.disable=function(){if(this._isEnabled){switch(this.map._renderer){case Q.Renderer.WebGL:this.map._mapboxEngine.dragRotate._pitchWithRotate=!1;break}this._isEnabled=!1,this.disabled.trigger()}},l.prototype.enable=function(){if(!this._isEnabled&&this.map.isEnabled){switch(this.map._renderer){case Q.Renderer.WebGL:this.map._mapboxEngine.dragRotate._pitchWithRotate=!0;break}this._isEnabled=!0,this.enabled.trigger()}},l}(h),yn=function(){function O(l){this._id="__wxmap_MapboxAttribution",this._content="<a href='//www.mapbox.com/about/maps/' target='_blank' rel='noopener'>&copy; Mapbox</a> <a href='//www.openstreetmap.org/copyright' target='_blank' rel='noopener'>&copy; OpenStreetMap</a>&nbsp;|&nbsp;<a href='//www.mapbox.com/map-feedback/' target='_blank'  rel='noopener'>Improve this map</a>",this._map=null,this._map=l,this._init(),l.layerAdded.addListener(this._onLayerAdded,this),l.layerRemoved.addListener(this._onLayerRemoved,this),l._mapboxEngine&&l.styled.addListener(this._onStyled,this)}return Object.defineProperty(O.prototype,"content",{get:function(){return this._content},set:function(l){this._content=l,this._element.innerHTML=this._content},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),O.prototype._init=function(){var l="."+this._id;ui.injectCss(l+" {z-index:1010;position:absolute;right:0;bottom:0;padding:0 5px;background-color:rgba(255,255,255,.5);font:400 12px/20px 'Helvetica Neue',Arial,Helvetica,sans-serif;}"),ui.injectCss(l+" > a {display:inline;color:rgb(64,64,64);font:400 12px/20px 'Helvetica Neue',Arial,Helvetica,sans-serif}"),this._element=document.createElement("div"),this._element.classList.add(this._id),this._element.innerHTML=this._content,this._determine()},O.prototype._detectMapbox=function(){var l=!1,i=this._map.layers;if(this._map.renderer===Q.Renderer.WebGL){var s=this._map,_=s.style;_&&_.indexOf("mapbox://")>=0&&(l=!0)}for(var b in i)if(i[b]instanceof co){l=!0;break}return l},O.prototype._determine=function(){if(this._detectMapbox())this._map.element.appendChild(this._element);else try{this._map.element.removeChild(this._element)}catch(l){}},O.prototype._onLayerAdded=function(l){this._determine()},O.prototype._onLayerRemoved=function(l){this._determine()},O.prototype._onStyled=function(){this._determine()},O}(),Sa=function(){function O(){}return Object.defineProperty(O.prototype,"bounds",{get:function(){return this._bounds},set:function(l){this._bounds=l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"left",{get:function(){return this._left},set:function(l){this._left=l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"right",{get:function(){return this._right},set:function(l){this._right=l},enumerable:!0,configurable:!0}),O}(),Zn=function(){function O(){}return Object.defineProperty(O.prototype,"actualGeoPoint",{get:function(){return this._actualGeoPoint},set:function(l){this._actualGeoPoint=l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"containerPoint",{get:function(){return this._containerPoint},set:function(l){this._containerPoint=l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"geoPoint",{get:function(){return this._geoPoint},set:function(l){this._geoPoint=l},enumerable:!0,configurable:!0}),O}(),Ps=B(66017);/* @license
* M4 Library (modified)
* Copyright 2014, Gregg Tavares.
* All rights reserved.
*
*
* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
* "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
* LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
* A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
* OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
* SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
* LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
* DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
* THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/var Yr=function(){function O(){}return O.orthographic=function(l,i,s,_,b,D,G){return G=G||new Float32Array(16),G[0]=2/(i-l),G[1]=0,G[2]=0,G[3]=0,G[4]=0,G[5]=2/(_-s),G[6]=0,G[7]=0,G[8]=0,G[9]=0,G[10]=2/(b-D),G[11]=0,G[12]=(l+i)/(l-i),G[13]=(s+_)/(s-_),G[14]=(b+D)/(b-D),G[15]=1,G},O.scale=function(l,i,s,_,b){return b=b||new Float32Array(16),b[0]=i*l[0*4+0],b[1]=i*l[0*4+1],b[2]=i*l[0*4+2],b[3]=i*l[0*4+3],b[4]=s*l[1*4+0],b[5]=s*l[1*4+1],b[6]=s*l[1*4+2],b[7]=s*l[1*4+3],b[8]=_*l[2*4+0],b[9]=_*l[2*4+1],b[10]=_*l[2*4+2],b[11]=_*l[2*4+3],l!==b&&(b[12]=l[12],b[13]=l[13],b[14]=l[14],b[15]=l[15]),b},O.translate=function(l,i,s,_,b){b=b||new Float32Array(16);var D=l[0],G=l[1],Z=l[2],te=l[3],ae=l[1*4+0],Pe=l[1*4+1],ve=l[1*4+2],pe=l[1*4+3],Fe=l[2*4+0],ke=l[2*4+1],Ze=l[2*4+2],at=l[2*4+3],Ve=l[3*4+0],st=l[3*4+1],Pt=l[3*4+2],$e=l[3*4+3];return l!==b&&(b[0]=D,b[1]=G,b[2]=Z,b[3]=te,b[4]=ae,b[5]=Pe,b[6]=ve,b[7]=pe,b[8]=Fe,b[9]=ke,b[10]=Ze,b[11]=at),b[12]=D*i+ae*s+Fe*_+Ve,b[13]=G*i+Pe*s+ke*_+st,b[14]=Z*i+ve*s+Ze*_+Pt,b[15]=te*i+pe*s+at*_+$e,b},O}(),Qr=function(){function O(l){l===void 0&&(l={}),this.smoothingEnabled=void 0,this.useWebGLContext=void 0,this.clipPaths=void 0,this.spotlight=void 0,(0,x.f0)(this,l)}return O}(),zn=function(){function O(l){if(this.styleChanged=new W.j,l=l||new Qr,this._smoothingEnabled=l.smoothingEnabled!==void 0?l.smoothingEnabled:!0,this._clipPaths=l.clipPaths,this._spotlight=l.spotlight,ui.isFirefox){var i=ui.agent,s=i.indexOf("Firefox/"),_=i.slice(s+8,s+12),b=parseFloat(_)===64;b?this._useWebGLContext=!1:this._useWebGLContext=l.useWebGLContext!==void 0?l.useWebGLContext:!0}else this._useWebGLContext=l.useWebGLContext!==void 0?l.useWebGLContext:!0}return Object.defineProperty(O.prototype,"smoothingEnabled",{get:function(){return this._smoothingEnabled},set:function(l){if(this._smoothingEnabled!==l){this._smoothingEnabled=l;var i={};i.smoothingEnabled=l,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"useWebGLContext",{get:function(){return this._useWebGLContext},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"clipPaths",{get:function(){return this._clipPaths},set:function(l){this._clipPaths=l;var i={};this.styleChanged.trigger(i)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"spotlight",{get:function(){return this._spotlight},set:function(l){this._spotlight=l;var i={spotlight:l};this.styleChanged.trigger(i)},enumerable:!0,configurable:!0}),O}(),on=function(){function O(l){l===void 0&&(l={}),this.fontColor=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontStyle=void 0,this.alignment=void 0,this.baseline=void 0,this.colorByPalette=void 0,this.strokeWidth=void 0,this.strokeColor=void 0,this.spread=void 0,this.staggeredOffset=void 0,this.precision=void 0,this.characterLength=void 0,(0,x.f0)(this,l)}return O}(),Co=function(){function O(l){this.styleChanged=new W.j,l=l||new on,this._fontColor=l.fontColor||"rgba(0,0,0,1)",this._fontSize=l.fontSize||12,this._fontFamily=l.fontFamily,this._fontWeight=l.fontWeight!=null?l.fontWeight.toLowerCase():"normal",this._fontStyle=l.fontStyle!==void 0?l.fontStyle.toLowerCase():"normal",this._alignment=l.alignment!==void 0?l.alignment:x.v2.Center,this._baseline=l.baseline!==void 0?l.baseline:x.HW.Middle,this._colorByPalette=l.colorByPalette!==void 0?l.colorByPalette:!1,this._strokeWidth=l.strokeWidth!==void 0?l.strokeWidth:0,this._strokeColor=l.strokeColor!==void 0?l.strokeColor:"rgba(0,0,0,1)",this._spread=l.spread||new m.$(32,32),this._staggeredOffset=l.staggeredOffset!==void 0?l.staggeredOffset:0,this._precision=l.precision!==void 0?l.precision:0,this._characterLength=l.characterLength!==void 0?l.characterLength:0}return Object.defineProperty(O.prototype,"spread",{get:function(){return this._spread},set:function(l){this._spread!==l&&(this._spread=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"staggeredOffset",{get:function(){return this._staggeredOffset},set:function(l){this._staggeredOffset!==l&&(this._staggeredOffset=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontColor",{get:function(){return this._fontColor},set:function(l){this._fontColor!==l&&(this._fontColor=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontSize",{get:function(){return this._fontSize},set:function(l){this._fontSize!==l&&(this._fontSize=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(l){this._fontFamily!==l&&(this._fontFamily=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(l){this._fontWeight!==l&&(this._fontWeight=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(l){this._fontStyle!==l&&(this._fontStyle=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"alignment",{get:function(){return this._alignment},set:function(l){this._alignment!==l&&(this._alignment=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"baseline",{get:function(){return this._baseline},set:function(l){l!==this._baseline&&(this._baseline=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"colorByPalette",{get:function(){return this._colorByPalette},set:function(l){this._colorByPalette!==l&&(this._colorByPalette=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(l){this._strokeWidth!==l&&(this._strokeWidth=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(l){this._strokeColor!==l&&(this._strokeColor=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"precision",{get:function(){return this._precision},set:function(l){this._precision!==l&&(this._precision=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"characterLength",{get:function(){return this._characterLength},set:function(l){this._characterLength!==l&&(this._characterLength=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),O}(),ca=function(){function O(l){l===void 0&&(l={}),this.text=void 0,this.fontSize=void 0,this.fontFamily=void 0,this.fontColor=void 0,this.fontWeight=void 0,this.fontStyle=void 0,this.strokeWidth=void 0,this.strokeColor=void 0,this.backgroundColor=void 0,this.backgroundPadding=void 0,this.borderColor=void 0,this.borderWidth=void 0,this.borderRadius=void 0,(0,x.f0)(this,l)}return O}(),ao=function(){function O(l){this._text=void 0,this._fontSize=void 0,this._fontColor=void 0,this._fontWeight=void 0,this._fontFamily=void 0,this._fontStyle=void 0,this._strokeWidth=void 0,this._strokeColor=void 0,this._backgroundColor=void 0,this._backgroundPadding=void 0,this._borderColor=void 0,this._borderWidth=void 0,this._borderRadius=void 0,this.propertyChanged=new W.j,l=l||new ca,this._text=l.text||"",this._fontSize=l.fontSize||11,this._fontColor=l.fontColor||"#000000",this._fontFamily=l.fontFamily,this._fontWeight=l.fontWeight!==void 0?l.fontWeight.toLowerCase():"normal",this._fontStyle=l.fontStyle!==void 0?l.fontStyle.toLowerCase():"normal",this._strokeWidth=l.strokeWidth||0,this._strokeColor=l.strokeColor||"#ffffff",this._backgroundColor=l.backgroundColor||"rgba(0,0,0,0)",this._backgroundPadding=l.backgroundPadding||0,this._borderColor=l.borderColor||"#000000",this._borderWidth=l.borderWidth||0,this._borderRadius=l.borderRadius||0}return Object.defineProperty(O.prototype,"text",{get:function(){return this._text},set:function(l){this.text!==l&&(this._text=l,this.propertyChanged.trigger({property:"label-text"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontSize",{get:function(){return this._fontSize},set:function(l){this._fontSize!==l&&(this._fontSize=l,this.propertyChanged.trigger({property:"label-fontSize"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(l){this._fontFamily!==l&&(this._fontFamily=l,this.propertyChanged.trigger({property:"label-fontFamily"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontColor",{get:function(){return this._fontColor},set:function(l){this._fontColor!==l&&(this._fontColor=l,this.propertyChanged.trigger({property:"label-fontColor"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(l){this._fontWeight!==l&&(this._fontWeight=l,this.propertyChanged.trigger({property:"label-fontWeight"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(l){this._fontStyle!==l&&(this._fontStyle=l,this.propertyChanged.trigger({property:"label-fontStyle"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(l){this._strokeWidth!==l&&(this._strokeWidth=l,this.propertyChanged.trigger({property:"label-strokeWidth"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(l){this._strokeColor!==l&&(this._strokeColor=l,this.propertyChanged.trigger({property:"label-strokeColor"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(l){this._backgroundColor!==l&&(this._backgroundColor=l,this.propertyChanged.trigger({property:"label-backgroundColor"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"backgroundPadding",{get:function(){return this._backgroundPadding},set:function(l){this._backgroundPadding!==l&&(this._backgroundPadding=l,this.propertyChanged.trigger({property:"label-backgroundPadding"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"borderColor",{get:function(){return this._borderColor},set:function(l){this._borderColor!==l&&(this._borderColor=l,this.propertyChanged.trigger({property:"label-borderColor"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"borderWidth",{get:function(){return this._borderWidth},set:function(l){this._borderWidth!==l&&(this._borderWidth=l,this.propertyChanged.trigger({property:"label-borderWidth"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"borderRadius",{get:function(){return this._borderRadius},set:function(l){this._borderRadius!==l&&(this._borderRadius=l,this.propertyChanged.trigger({property:"label-borderRadius"}))},enumerable:!0,configurable:!0}),O}(),Ua=function(){function O(l){l===void 0&&(l={}),this.strokeWidth=void 0,this.strokeColor=void 0,this.spread=void 0,this.staggeredOffset=void 0,this.staggeredRotation=void 0,this.circumRadius=void 0,this.rotation=void 0,this.vertices=void 0,this.labels=void 0,this.labelsEnabled=void 0,this.dataType=void 0,this.precision=void 0,this.characterLength=void 0,this.keyZooms=void 0,(0,x.f0)(this,l)}return O}(),as=function(){function O(l){this._isChanging=!1,this._pending=new Ua,this.styleChanged=new W.j,l=l||new Ua,this._strokeWidth=l.strokeWidth||1,this._strokeColor=l.strokeColor||"#FFFFFF",this._spread=l.spread||new m.$(32,32),this._staggeredOffset=l.staggeredOffset||new m.$(0,0),this._staggeredRotation=l.staggeredRotation||new Re.R(0),this._circumRadius=l.circumRadius!==void 0?l.circumRadius>256?256:l.circumRadius<0?.01:l.circumRadius:this._spread.width/2,this._rotation=l.rotation||new Re.R(0),this._vertices=l.vertices===1||l.vertices>2?l.vertices:1,this._shapes=[],this._keyZooms=l.keyZooms||[],this._dataType=l.dataType||"AVG",this._labelsEnabled=l.labelsEnabled?l.labelsEnabled:!1,this._labels=l.labels?new ao(l.labels):new ao,this._labels.propertyChanged.addListener(this._onLabelChanged,this),this._precision=l.precision!==void 0?l.precision:0,this._characterLength=l.characterLength!==void 0?l.characterLength:0}return Object.defineProperty(O.prototype,"keyZooms",{get:function(){return this._keyZooms},set:function(l){this._keyZooms!==l&&(this._keyZooms=l),this.styleChanged.trigger()},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"dataType",{get:function(){return this._dataType},set:function(l){var i=["AVG","MAX","MIN"];l=l.toUpperCase(),this._dataType!==l&&i.indexOf(l)>-1&&(this._dataType=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"vertices",{get:function(){return this._vertices},set:function(l){if(this._isChanging)this._pending.vertices=l;else if(this._vertices!==l&&(l===1||l>2)){this._isChanging=!0,this._vertices=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"circumRadius",{get:function(){return this._circumRadius},set:function(l){if(this._isChanging)this._pending.circumRadius=l;else if(this._circumRadius!==l){this._isChanging=!0,l>256&&(l=256),l<0&&(l=.01),this._circumRadius=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"rotation",{get:function(){return this._rotation},set:function(l){if(this._isChanging)this._pending.rotation=l;else if(!(0,x.le)(l)&&l.notEquals(this._rotation)){this._isChanging=!0,this._rotation=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"spread",{get:function(){return this._spread},set:function(l){if(this._isChanging)this._pending.spread=l;else if(this._spread!==l){this._isChanging=!0,this._spread=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"staggeredOffset",{get:function(){return this._staggeredOffset},set:function(l){if(this._isChanging)this._pending.staggeredOffset=l;else if(this._staggeredOffset!==l){this._isChanging=!0,this._staggeredOffset=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"staggeredRotation",{get:function(){return this._staggeredRotation},set:function(l){if(this._isChanging)this._pending.staggeredRotation=l;else if(!(0,x.le)(l)&&l.notEquals(this._staggeredRotation)){this._isChanging=!0,this._staggeredRotation=l;var i={};i.geometryChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(l){this._strokeWidth!==l&&(this._strokeWidth=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(l){this._strokeColor!==l&&(this._strokeColor=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"labels",{get:function(){return this._labels},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"labelsEnabled",{get:function(){return this._labelsEnabled},set:function(l){if(this._labelsEnabled!==l){this._labelsEnabled=l;var i={};i.labelsChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"precision",{get:function(){return this._precision},set:function(l){this._precision!==l&&(this._precision=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"characterLength",{get:function(){return this._characterLength},set:function(l){this._characterLength!==l&&(this._characterLength=l,this.styleChanged.trigger())},enumerable:!0,configurable:!0}),O.prototype.change=function(l){if(!this._isChanging){l||(l=this._pending);var i={},s=!1;if(l.keyZooms!==void 0&&l.keyZooms!==this._keyZooms&&(this._keyZooms=l.keyZooms,s=!0),l.strokeWidth!==void 0&&l.strokeWidth!==this._strokeWidth&&(this._strokeWidth=l.strokeWidth,s=!0),l.strokeColor!==void 0&&l.strokeColor!==this._strokeColor&&(this._strokeColor=l.strokeColor,s=!0),l.rotation!==void 0&&l.rotation.notEquals(this._rotation)&&(this._isChanging=!0,this._rotation=l.rotation,i.geometryChanged=!0,s=!0),l.spread!==void 0&&l.spread!==this._spread&&(this._isChanging=!0,this._spread=l.spread,i.geometryChanged=!0,s=!0),l.staggeredOffset!==void 0&&l.staggeredOffset!==this._staggeredOffset&&(this._isChanging=!0,this._staggeredOffset=l.staggeredOffset,i.geometryChanged=!0,s=!0),l.staggeredRotation!==void 0&&l.staggeredRotation.notEquals(this._staggeredRotation)&&(this._isChanging=!0,this._staggeredRotation=l.staggeredRotation,i.geometryChanged=!0,s=!0),l.circumRadius!==void 0&&l.circumRadius!==this._circumRadius){this._isChanging=!0;var _=l.circumRadius;_>256&&(_=256),_<0&&(_=.01),this._circumRadius=_,i.geometryChanged=!0,s=!0}if(l.vertices!==void 0&&l.vertices!==this._vertices&&(l.vertices===1||l.vertices>2)&&(this._isChanging=!0,this._vertices=l.vertices,i.geometryChanged=!0,s=!0),l.labels!==void 0&&(this._labels.propertyChanged.removeListener(this._onLabelChanged,this),this._labels=new ao(l.labels),this._labels.propertyChanged.addListener(this._onLabelChanged,this),i.labelsChanged=!0,s=!0),l.labelsEnabled!==void 0&&l.labelsEnabled!==this._labelsEnabled&&(this._labelsEnabled=l.labelsEnabled,i.labelsChanged=!0,s=!0),l.dataType!==void 0){var b=["AVG","MAX","MIN"],D=l.dataType.toUpperCase();D!==this._dataType&&b.indexOf(D)>-1&&(this._dataType=D,s=!0)}l.precision!==void 0&&l.precision!==this._precision&&(this._precision=l.precision,s=!0),l.characterLength!==void 0&&l.characterLength!==this._characterLength&&(this._characterLength=l.characterLength,s=!0),this._pending.keyZooms=void 0,this._pending.strokeWidth=void 0,this._pending.strokeColor=void 0,this._pending.rotation=void 0,this._pending.spread=void 0,this._pending.staggeredOffset=void 0,this._pending.circumRadius=void 0,this._pending.staggeredRotation=void 0,this._pending.vertices=void 0,this._pending.labels=void 0,this._pending.labelsEnabled=void 0,this._pending.dataType=void 0,this._pending.precision=void 0,this._pending.characterLength=void 0,s&&this.styleChanged.trigger(i)}},O.prototype._onLabelChanged=function(l){var i={};l&&l.property&&(i.labelProperty=l.property),this.styleChanged.trigger(i)},O}(),Na=function(){function O(l){l===void 0&&(l={}),this.value=void 0,this.lineColor=void 0,this.lineWidth=void 0,this.labels=void 0,(0,x.f0)(this,l)}return O}(),pa=function(){function O(l){this._pending=new Na,this._isChanging=!1,this.propertyChanged=new W.j,this._value=l.value,this._lineColor=l.lineColor,this._lineWidth=l.lineWidth,this._labels=l.labels?new ao(l.labels):new ao,this._labels&&(this._labels.text||(this._labels.text=this._value.toString()),this._labels.propertyChanged.addListener(this._onLabelChanged,this))}return Object.defineProperty(O.prototype,"value",{get:function(){return this._value},set:function(l){if(this._isChanging)this._pending.value=l;else{var i=this.value;l!==i&&(this._value=l,this._isChanging=!0,this.propertyChanged.trigger({property:"value",isoline:this,old:i,new:l}))}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"lineColor",{get:function(){return this._lineColor},set:function(l){l!==this._lineColor&&(this._lineColor=l,this.propertyChanged.trigger({property:"lineColor"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"lineWidth",{get:function(){return this._lineWidth},set:function(l){l!==this._lineWidth&&(this._lineWidth=l,this.propertyChanged.trigger({property:"lineWidth"}))},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"labels",{get:function(){return this._labels},set:function(l){this._labels!==l&&(this._labels=l,this.propertyChanged.trigger({property:"label"}))},enumerable:!0,configurable:!0}),O.prototype.change=function(l){if(!this._isChanging){l||(l=this._pending);var i={},s=!1;if(l.lineColor!==void 0&&l.lineColor!==this._lineColor&&(this._lineColor=l.lineColor,i.property="lineColor",s=!0),l.lineWidth!==void 0&&l.lineWidth!==this._lineWidth&&(this._lineWidth=l.lineWidth,i.property="lineWidth",s=!0),l.labels!==void 0&&(this._labels=new ao(l.labels),this._labels.propertyChanged.addListener(this._onLabelChanged,this),i.property="label",s=!0),l.value!==void 0&&l.value!==this._value){var _=this._value;this._isChanging=!0,this._value=l.value,i.property="value",i.isoline=this,i.old=_,i.new=this._value,s=!0}this._pending.value=void 0,this._pending.lineColor=void 0,this._pending.lineWidth=void 0,this._pending.labels=void 0,s&&this.propertyChanged.trigger(i)}},O.prototype._onLabelChanged=function(l){var i={};l&&l.property&&(i.labelProperty=l.property),this.propertyChanged.trigger(i)},O}(),Ga=function(){function O(l){l===void 0&&(l={}),this.range=void 0,this.fillColor=void 0,this.labels=void 0,(0,x.f0)(this,l)}return O}(),Wa=function(){function O(l){this._isChanging=!1,this._pending=new Ga,this.propertyChanged=new W.j,this._range=l.range,this._fillColor=l.fillColor!==void 0?l.fillColor:[255,255,255,255],this._labels=l.labels?new ao(l.labels):new ao,this._labels&&(this._labels.text||(this._labels.text=this.range.start+"-"+this.range.end),this._labels.propertyChanged.addListener(this._onLabelChanged,this))}return Object.defineProperty(O.prototype,"range",{get:function(){return this._range},set:function(l){if(this._isChanging)this._pending.range=l;else{var i=this.range.start+"_"+this.range.end;(l.start!==this._range.start||l.end!==this._range.end)&&(this._isChanging=!0,this._range=l,this.propertyChanged.trigger({property:"range",isoband:this,old:i,new:l.start+"_"+l.end}))}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"fillColor",{get:function(){return this._fillColor},set:function(l){if(this._isChanging)this._pending.fillColor=l;else if(l!==this._fillColor){this._isChanging=!0,this._fillColor=l;var i=this.range.start+"_"+this.range.end;this.propertyChanged.trigger({property:"fillColor",isoband:this,old:i,new:i})}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"labels",{get:function(){return this._labels},set:function(l){this._labels!==l&&(this._labels=l,this._labels&&this._labels.propertyChanged.addListener(this._onLabelChanged,this),this.propertyChanged.trigger({property:"label"}))},enumerable:!0,configurable:!0}),O.prototype.change=function(l){if(!this._isChanging){l||(l=this._pending);var i={},s=!1,_=this.range.start+"_"+this.range.end;l.labels!==void 0&&(this._labels=new ao(l.labels),this._labels.propertyChanged.addListener(this._onLabelChanged,this),i.property="label",s=!0),l.fillColor!==void 0&&l.fillColor!==this._fillColor&&(this._fillColor=l.fillColor,i.property="fillColor",i.isoband=this,i.old=_,i.new=_,s=!0),l.range!==void 0&&(l.range.start!==this._range.start||l.range.end!==this._range.end)&&(this._isChanging=!0,this._range=l.range,i.property="range",i.isoband=this,i.old=_,i.new=l.range.start+"_"+l.range.end,s=!0),this._pending.range=void 0,this._pending.fillColor=void 0,this._pending.labels=void 0,s&&this.propertyChanged.trigger(i)}},O.prototype._onLabelChanged=function(l){var i={};l&&l.property&&(i.labelProperty=l.property),this.propertyChanged.trigger(i)},O}(),ia=function(){function O(l){l===void 0&&(l={}),this.isobands=void 0,this.isobandsEnabled=void 0,this.isolines=void 0,this.isolinesEnabled=void 0,this.resolution=void 0,this.declutterLabels=void 0,this.labelsEnabled=void 0,(0,x.f0)(this,l)}return O}(),Uo=function(){function O(l){this.styleChanged=new W.j,l=l||new ia;var i=[],s=[];if(l.isolines)for(var _=0,b=l.isolines.length;_<b;_++){var D=l.isolines[_];D instanceof pa||(D=new pa(D)),i.push(D),D.propertyChanged.addListener(this._onIsolineChanged,this)}if(l.isobands)for(var G=0,Z=l.isobands.length;G<Z;G++){var te=l.isobands[G];te instanceof Wa||(te=new Wa(te)),s.push(te),te.propertyChanged.addListener(this._onIsobandChanged,this)}this._isolines=i,this._isobands=s,this._isolinesEnabled=l.isolinesEnabled!==void 0?l.isolinesEnabled:!0,this._isobandsEnabled=l.isobandsEnabled!==void 0?l.isobandsEnabled:!0,this._resolution=l.resolution!==void 0?l.resolution>1?1:l.resolution<0?0:l.resolution:1,this._labelsEnabled=l.labelsEnabled!==void 0?l.labelsEnabled:!0,this._declutterLabels=l.declutterLabels!==void 0?l.declutterLabels:!1}return Object.defineProperty(O.prototype,"isobands",{get:function(){return this._isobands},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isobandsEnabled",{get:function(){return this._isobandsEnabled},set:function(l){if(this._isobandsEnabled!==l){this._isobandsEnabled=l;var i={};i.isobandsEnabled=l,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isolines",{get:function(){return this._isolines},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isolinesEnabled",{get:function(){return this._isolinesEnabled},set:function(l){if(this._isolinesEnabled!==l){this._isolinesEnabled=l;var i={};i.isolinesEnabled=l,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"resolution",{get:function(){return this._resolution},set:function(l){if(this._resolution!==l){l>1&&(l=1),l<0&&(l=0),this._resolution=l;var i={};i.resolutionChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"declutterLabels",{get:function(){return this._declutterLabels},set:function(l){if(this._declutterLabels!==l){this._declutterLabels=l;var i={};i.declutterChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"labelsEnabled",{get:function(){return this._labelsEnabled},set:function(l){if(this._labelsEnabled!==l){this._labelsEnabled=l;var i={};i.labelsChanged=!0,this.styleChanged.trigger(i)}},enumerable:!0,configurable:!0}),O.prototype.addIsoline=function(l){this.insertIsoline(l)},O.prototype.insertIsoline=function(l,i){i===void 0&&(i=null),l.propertyChanged.addListener(this._onIsolineChanged,this),i!==null?this.isolines.splice(i,0,l):this.isolines.push(l),this.styleChanged.trigger({action:"insert",isoline:l})},O.prototype.removeIsoline=function(l){for(var i=0,s=this.isolines.length;i<s;i++){var _=this.isolines[i];if(_===l){_.propertyChanged.removeListener(this._onIsolineChanged,this),this.isolines.splice(i,1),this.styleChanged.trigger({action:"remove",isoline:l});break}}},O.prototype.clearIsolines=function(){if(this.isolines){for(var l=0,i=this.isolines.length;l<i;l++){var s=this.isolines[l];s.propertyChanged.removeListener(this._onIsolineChanged,this)}this._isolines=[],this.styleChanged.trigger({action:"clearIsolines"})}},O.prototype.addIsoband=function(l){this.insertIsoband(l)},O.prototype.insertIsoband=function(l,i){i===void 0&&(i=null),l.propertyChanged.addListener(this._onIsobandChanged,this),i!==null?this.isobands.splice(i,0,l):this.isobands.push(l),this.styleChanged.trigger({action:"insert",isoband:l})},O.prototype.removeIsoband=function(l){for(var i=0,s=this.isobands.length;i<s;i++){var _=this.isobands[i];if(_===l){_.propertyChanged.removeListener(this._onIsobandChanged,this),this.isobands.splice(i,1),this.styleChanged.trigger({action:"remove",isoband:l});break}}},O.prototype.clearIsobands=function(){if(this.isobands){for(var l=0,i=this.isobands.length;l<i;l++){var s=this.isobands[l];s.propertyChanged.removeListener(this._onIsobandChanged,this)}this._isobands=[],this.styleChanged.trigger()}},O._determineContourLines=function(l,i,s,_,b){for(var D=[],G=0,Z=_-1;G<Z;G++)for(var te=i[G*s],ae=i[(G+1)*s],Pe=void 0,ve=void 0,pe=0,Fe=s-1;pe<Fe;pe++)if(Pe=te,te=i[G*s+pe+1],ve=ae,ae=i[(G+1)*s+pe+1],!(isNaN(Pe)||isNaN(te)||isNaN(ve)||isNaN(ae))&&!(b&&(Pe===b||te===b||ve===b||ae===b)))for(var ke=[Pe,te,ae,ve],Ze=O._determineContourLineType(l,ke),at=O._determineContourLineGeometry(l,Ze,ke),Ve=0,st=at.length;Ve<st;Ve++){var Pt=pe+at[Ve][0][0],$e=G+at[Ve][0][1],Ct=pe+at[Ve][1][0],At=G+at[Ve][1][1],qe=[Pt,$e,Ct,At];D.push(qe)}return D},O._determineContourLineType=function(l,i){var s=0;return i[0]>=l&&s++,s=s<<1,i[1]>=l&&s++,s=s<<1,i[2]>=l&&s++,s=s<<1,i[3]>=l&&s++,s},O._determineContourLineGeometry=function(l,i,s){var _,b,D,G,Z=[];switch(i){case 0:case 15:break;case 1:case 14:_=[0,(l-s[0])/(s[3]-s[0])],b=[(l-s[3])/(s[2]-s[3]),1];break;case 2:case 13:_=[(l-s[3])/(s[2]-s[3]),1],b=[1,(l-s[1])/(s[2]-s[1])];break;case 3:case 12:_=[0,(l-s[0])/(s[3]-s[0])],b=[1,(l-s[1])/(s[2]-s[1])];break;case 4:case 11:_=[(l-s[0])/(s[1]-s[0]),0],b=[1,(l-s[1])/(s[2]-s[1])];break;case 5:case 10:var te=s.reduce(function(ae,Pe){return ae+Pe})/4;i===5&&te>=l||i===10&&te<l?(_=[0,(l-s[0])/(s[3]-s[0])],b=[(l-s[0])/(s[1]-s[0]),0],D=[(l-s[3])/(s[2]-s[3]),1],G=[1,(l-s[1])/(s[2]-s[1])]):(_=[0,(l-s[0])/(s[3]-s[0])],b=[(l-s[3])/(s[2]-s[3]),1],D=[(l-s[0])/(s[1]-s[0]),0],G=[1,(l-s[1])/(s[2]-s[1])]);break;case 6:case 9:_=[(l-s[3])/(s[2]-s[3]),1],b=[(l-s[0])/(s[1]-s[0]),0];break;case 7:case 8:_=[0,(l-s[0])/(s[3]-s[0])],b=[(l-s[0])/(s[1]-s[0]),0];break}return _&&b&&Z.push([_,b]),D&&G&&Z.push([D,G]),Z},O._contourTileTopBoundary=function(l,i,s,_,b){for(var D=s[(_-1)*_],G=i[0],Z,te,ae=0,Pe=_-1;ae<Pe;ae++)if(Z=D,D=s[(_-1)*_+ae+1],te=G,G=i[ae+1],!(isNaN(Z)||isNaN(D)||isNaN(te)||isNaN(G)))for(var ve=[Z,D,G,te],pe=O._determineContourLineType(l,ve),Fe=O._determineContourLineGeometry(l,pe,ve),ke=0,Ze=Fe.length;ke<Ze;ke++){var at=ae+Fe[ke][0][0],Ve=Fe[ke][0][1]-1,st=ae+Fe[ke][1][0],Pt=Fe[ke][1][1]-1,$e=[at,Ve,st,Pt];b.push($e)}},O._contourTileLeftBoundary=function(l,i,s,_,b){for(var D=s[_-1],G=i[0],Z=0,te=_-1;Z<te;Z++){var ae=D,Pe=G;if(D=s[(Z+2)*_-1],G=i[(Z+1)*_],!(isNaN(ae)||isNaN(Pe)||isNaN(D)||isNaN(G)))for(var ve=[ae,Pe,G,D],pe=O._determineContourLineType(l,ve),Fe=O._determineContourLineGeometry(l,pe,ve),ke=0,Ze=Fe.length;ke<Ze;ke++){var at=Fe[ke][0][0]-1,Ve=Z+Fe[ke][0][1],st=Fe[ke][1][0]-1,Pt=Z+Fe[ke][1][1],$e=[at,Ve,st,Pt];b.push($e)}}},O._determineIsobandBitmap=function(l,i,s,_){for(var b=s*_*4,D=new Uint8ClampedArray(b),G=l.range.start,Z=l.range.end,te=l.fillColor,ae=0,Pe=0,ve=0,pe=0,Fe=_;pe<Fe;pe++){for(var ke=-1,Ze=0,at=0,Ve=s;at<Ve;at++){var st=pe*s+at,Pt=i[st];if((Pt-Z)*(Pt-G)<=0){ke===-1&&(ke=at);var $e=st*4;D[$e]=te[0],D[$e+1]=te[1],D[$e+2]=te[2],D[$e+3]=te[3],Ze++}else Ze>ve+10&&(ve=Ze,Pe=pe,ae=ke+Ze/2),Ze=0,ke=-1}Ze>=ve&&Math.abs(Pe-Fe/2)>Math.abs(pe-Fe/2)&&(ve=Ze,Pe=pe,ae=ke+Ze/2)}if(ae!==-1){var Ct=new ImageData(D,s,_);return{bitmap:Ct,labelPoint:[ae,Pe]}}},O.prototype._onIsolineChanged=function(l){var i={};l&&l.property&&(i.isoline=l.isoline,i.isolineProperty=l.property,i.old=l.old,i.new=l.new),this.styleChanged.trigger(i)},O.prototype._onIsobandChanged=function(l){var i={};l&&l.property&&(i.isoband=l.isoband,i.isobandProperty=l.property,i.old=l.old,i.new=l.new),this.styleChanged.trigger(i)},O}(),ra=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),da=function(O){ra(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.palette=void 0,s.filter=void 0,s.depth=void 0,s.contourEnabled=void 0,s.contourStyle=void 0,s.rasterEnabled=void 0,s.rasterStyle=void 0,s.textEnabled=void 0,s.textStyle=void 0,s.shapeEnabled=void 0,s.shapeStyle=void 0,s.invalidDataValue=void 0,s.refreshRate=void 0,s.convert=void 0,s.validity=void 0,s.timeRange=void 0,s.timeMode=void 0,(0,x.f0)(s,i),s}return l}(re.M),fa=function(O){ra(l,O);function l(i){var s=O.call(this,i=i instanceof da?i:new da(i))||this;if(s._isVisible=!1,s._invalidDataValue=void 0,s._data={},s._stack=[],s._contourEnabled=!1,s._rasterEnabled=!0,s._textEnabled=!1,s._shapeEnabled=!1,s._enableValidity=!0,s._lastRefreshed=performance.now(),s._lastInspectionPoint=new T.E(0,0),s._lastInspectionGeoPoint=v.F.fromRadians(0,0),s._lastTopLeftGeoPoint=v.F.fromRadians(0,0),s._lastBottomRightGeoPoint=v.F.fromRadians(0,0),s._lastTopLeftScreenPoint=new T.E(0,0),s._lastBottomRightScreenPoint=new T.E(0,0),s._lastLeftWorld=I.c.fromDegrees(0,0,0,0),s._lastRightWorld=I.c.fromDegrees(0,0,0,0),s._lastD=new T.E(0,0),s._lastClipPoint=new T.E(0,0),s._calculatedHeight=0,s._calculatedWidth=0,s._isPainting=!1,s.paletteChanged=new W.j,i.palette){var _=i.palette instanceof Ps.Y;_?s._palette=i.palette:s._palette=new Ps.Y(i.palette.colors,i.palette),s._palette.changed.addListener(s._onPaletteChanged,s)}return s._rasterEnabled=i.rasterEnabled!==void 0?i.rasterEnabled:!0,s._rasterStyle=i.rasterStyle!==void 0?new zn(i.rasterStyle):new zn,s._rasterStyle.styleChanged.addListener(s._onRasterStyleChanged,s),s._contourEnabled=i.contourEnabled!==void 0?i.contourEnabled:!1,s._contourStyle=i.contourStyle!==void 0?new Uo(i.contourStyle):new Uo,s._contourStyle.styleChanged.addListener(s._onContourStyleChanged,s),s._textEnabled=i.textEnabled!==void 0?i.textEnabled:!1,s._textStyle=i.textStyle!==void 0?new Co(i.textStyle):new Co,s._textStyle.styleChanged.addListener(s._onTextStyleChanged,s),s._shapeEnabled=i.shapeEnabled!==void 0?i.shapeEnabled:!1,s._shapeStyle=i.shapeStyle!==void 0?new as(i.shapeStyle):new as,s._shapeStyle.styleChanged.addListener(s._onShapeStyleChanged,s),s._filter=i.filter||[],s._data={},s._depth=i.depth||0,s._invalidDataValue=i.invalidDataValue,s._refreshRate=i.refreshRate!==void 0&&i.refreshRate.totalMilliseconds>=1e3?i.refreshRate:new Ue.i(0,0,1),s._timeRange=i.timeRange||new ue.e,s._timeMode=i.timeMode,s._id2D=s.id+"_2D",s._idGL=s.id+"_GL",s}Object.defineProperty(l.prototype,"refreshRate",{get:function(){return this._refreshRate},set:function(i){i.totalMilliseconds>=1e3&&(this._refreshRate=i)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeRange",{get:function(){return this._timeRange},set:function(i){i!==this._timeRange&&(this._timeRange=i,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeMode",{get:function(){return this._timeMode},set:function(i){i in x.$i||this.map&&(i=this.map.animator.timeMode),this._timeMode=i},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"enableValidity",{get:function(){return this._enableValidity},set:function(i){this._enableValidity!==i&&(this._enableValidity=i,this.update())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"depth",{get:function(){return this._depth},set:function(i){i!==this._depth&&(this._depth=i,this._render())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),l.prototype.stack=function(){return this._stack},Object.defineProperty(l.prototype,"invalidDataValue",{get:function(){return this._invalidDataValue},set:function(i){i!==this._invalidDataValue&&(this._invalidDataValue=i,this._render())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"palette",{get:function(){return this._palette},set:function(i){this._palette&&this._palette.changed.removeListener(this._onPaletteChanged,this),this._palette=i,this._palette.changed.addListener(this._onPaletteChanged,this),this._contextGL&&(this._palette.gl=this._contextGL,this._palette.changed.trigger()),this.paletteChanged.trigger(),this._clearTextures(),this._render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"rasterEnabled",{get:function(){return this._rasterEnabled},set:function(i){this._rasterEnabled=i,this._render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"rasterStyle",{get:function(){return this._rasterStyle},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"contourEnabled",{get:function(){return this._contourEnabled},set:function(i){this._contourEnabled=i,this._render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"contourStyle",{get:function(){return this._contourStyle},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"textEnabled",{get:function(){return this._textEnabled},set:function(i){this._textEnabled=i,this._render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"textStyle",{get:function(){return this._textStyle},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"shapeEnabled",{get:function(){return this._shapeEnabled},set:function(i){this._shapeEnabled=i,this._render()},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"shapeStyle",{get:function(){return this._shapeStyle},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"filter",{get:function(){return this._filter},set:function(i){if(!this._isPainting){if(this._filter=i,this._contextGL){this._contextGL.useProgram(this._rasterProgram);var s=i.length>0?1:0;this._contextGL.uniform1i(this._tileTextureFilterLocation,s)}this._clearTextures(),this._render()}},enumerable:!0,configurable:!0}),l.prototype._load=function(i){switch(this.map.renderer){case Q.Renderer.WebDOM:this._loadLeaflet();break;case Q.Renderer.WebGL:this._loadMapbox();break}this._toggleVisibility(),this.map.enabled.addListener(this._onMapEnabled,this),this.map.disabled.addListener(this._onMapDisabled,this),this.map.zooming.addListener(this._onMapZooming,this),this.map.zoomed.addListener(this._onMapZoomed,this),this.map.moving.addListener(this._onMapMoving,this),this.map.moved.addListener(this._onMapMoved,this),this.map.resized.addListener(this._onMapResized,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this),this.map.animator.frameChanged.addListener(this._onFrameChanged,this),this._buffer=document.createElement("canvas"),this._buffer.height=256,this._buffer.width=256,this._resize(this.map.width+2,this.map.height+2),this.timeMode===void 0&&(this._timeMode=this.map.animator.timeMode),i||this._changeLoadState(x.jd.Loaded)},l.prototype._unload=function(){switch(this.map.enabled.removeListener(this._onMapEnabled,this),this.map.disabled.removeListener(this._onMapDisabled,this),this.map.zooming.removeListener(this._onMapZooming,this),this.map.zoomed.removeListener(this._onMapZoomed,this),this.map.moving.removeListener(this._onMapMoving,this),this.map.moved.removeListener(this._onMapMoved,this),this.map.resized.removeListener(this._onMapResized,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this),this.map.animator.frameChanged.addListener(this._onFrameChanged,this),this.clearData(),this._clearTextures(),this._clearSurface(),this._clearGL(),this.map.renderer){case Q.Renderer.WebGL:this._unloadMapbox();break;case Q.Renderer.WebDOM:this._unloadLeaflet();break}this.shapeStyle.styleChanged.removeListener(this._onShapeStyleChanged,this),this.contourStyle.styleChanged.removeListener(this._onContourStyleChanged,this),this.textStyle.styleChanged.removeListener(this._onTextStyleChanged,this),this.contourStyle.clearIsolines(),this.contourStyle.clearIsobands(),this._changeLoadState(x.jd.Unloaded)},l.prototype._toggleVisibility=function(){var i=this.map.zoomLevel;i<this.minimumZoom||i>this.maximumZoom?this._isVisible=!1:i>=this.minimumZoom&&i<=this.maximumZoom&&(this._isVisible=!0)},l.prototype._resize=function(i,s){var _=i||this.map.width,b=s||this.map.height;this._canvas2D.width=_,this._canvas2D.height=b,this._canvasGL&&(this._canvasGL.width=_,this._canvasGL.height=b,this._contextGL.viewport(0,0,_,b)),this._render()},l.prototype._clearSurface=function(){if(this.map.renderer===Q.Renderer.WebGL){var i=this.map.contextualBounds,s=this._deriveMapboxCoordinates(i),_=this.map._mapboxEngine.getSource(this._id2D);_&&_.setCoordinates(s);var b=this._contextGL;if(b){b.clear(b.COLOR_BUFFER_BIT);var D=this.map._mapboxEngine.getSource(this._idGL);D&&D.setCoordinates(s)}}this._context2D.clearRect(0,0,this.map.width+2,this.map.height+2)},l.prototype._clearTextures=function(){for(var i in this._data){var s=this._data[i];s._bitmap=void 0,s._texture=void 0}},l.prototype._removeGridIsoline=function(i){for(var s in this._data){var _=this._data[s];_._isolineData&&delete _._isolineData[i]}},l.prototype._removeGridIsoband=function(i){for(var s in this._data){var _=this._data[s];_._isobandData&&delete _._isobandData[i]}},l.prototype._clearGridIsolines=function(){for(var i in this._data){var s=this._data[i];s._isolineData=void 0}},l.prototype._clearGridIsobands=function(){for(var i in this._data){var s=this._data[i];s._isobandData=void 0}},l.prototype._clearGridContours=function(){for(var i in this._data){var s=this._data[i];s._isolineData=void 0,s._isobandData=void 0,s._gaussBlurData=void 0,s._blurTexture=void 0}},l.prototype._removeTileIsoline=function(i){},l.prototype._removeTileIsoband=function(i){},l.prototype._clearTileIsolines=function(){},l.prototype._clearTileIsobands=function(){},l.prototype._clearTileContours=function(){},l.prototype._applyCanvasViewport=function(){var i=this.map,s=i.contextualBounds,_=this._canvas2D,b=i.fromGeoToScreen(s.topLeftGeoPoint,this._lastTopLeftScreenPoint),D=i.fromGeoToScreen(s.bottomRightGeoPoint,this._lastBottomRightScreenPoint),G=D.x-b.x,Z=D.y-b.y;switch(_.width=G,_.height=Z,i.renderer){case Q.Renderer.WebGL:var te=this._deriveMapboxCoordinates(s);if(this._contextGL){var ae=this._canvasGL;ae.width=G,ae.height=Z,this._contextGL.viewport(0,0,G,Z)}try{var Pe=i._mapboxEngine.getSource(this._id2D);Pe&&Pe.setCoordinates(te);var ve=i._mapboxEngine.getSource(this._idGL);ve&&ve.setCoordinates(te)}catch(pe){}break}},l.prototype._render=function(){if(this.map&&this.map.isEnabled){if(!this._timeRange.inRange(this.map.clock.time))return;this._mapboxSource2D&&this._mapboxSource2D.play(),this._mapboxSourceGL&&this._mapboxSourceGL.play(),this._clearSurface(),this._applyCanvasViewport();var i=this._context2D;i.imageSmoothingEnabled=this.rasterStyle.smoothingEnabled,i.webkitImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,i.mozImageSmoothingEnabled=this.rasterStyle.smoothingEnabled;for(var s=this._canvas2D,_=this.map,b=this.map.zoomLevel,D=256*Math.pow(2,b),G=0,Z=this._stack.length;G<Z;G++){var te=this._stack[G],ae=this._data[te];if(this._validateGrid(ae)){for(var Pe=ae.bounds,ve=_.fromGeoToScreen(Pe.topLeftGeoPoint,this._lastTopLeftScreenPoint),pe=ve.x,Fe=_.fromGeoToScreen(Pe.bottomRightGeoPoint,this._lastBottomRightScreenPoint),ke=ve.y,Ze=Fe.x-pe,at=Fe.y-ke;pe<-Ze;)pe+=D;for(;pe>s.width;)pe-=D;if(ae.clipPath){i.save(),i.beginPath();for(var Ve=ae.clipPath.points,st=[],Pt=0,$e=Ve.length;Pt<$e;Pt++){var Ct=Ve[Pt],At=_.fromGeoToScreen(Ct);st.push(At),Pt===0?i.moveTo(At.x,At.y):i.lineTo(At.x,At.y)}if(i.closePath(),i.clip(),this._contextGL){var qe=this._contextGL;qe.enable(qe.STENCIL_TEST),qe.stencilMask(255),qe.clearStencil(0),qe.clear(qe.STENCIL_BUFFER_BIT),qe.colorMask(!1,!1,!1,!1),qe.depthMask(!1),this._paintClipStencil(st,D,pe,ke,Ze,at)}}if(this._rasterEnabled&&(this._contextGL?this._paintRasterGridGL(ae,D,pe,ke,Ze,at):this._paintRasterGrid2D(ae,D,pe,ke,Ze,at)),this._contourEnabled)var nt=this._paintContourGrids(ae,D,pe,ke,Ze,at);if(this._contextGL&&this._contextGL.disable(this._contextGL.STENCIL_TEST),i.restore(),ae.clipPath&&ae.clipWidth){i.beginPath(),i.strokeStyle=ae.clipColor,i.lineWidth=ae.clipWidth;for(var Pt=0,$e=st.length;Pt<$e;Pt++){var Xe=st[Pt];Pt===0?i.moveTo(Xe.x,Xe.y):i.lineTo(Xe.x,Xe.y)}i.closePath(),i.stroke()}this._contourEnabled&&this.contourStyle.labelsEnabled&&this._paintContourLabels(nt)}}this._shapeEnabled&&(this._paintShapeGrids(),this._shapeStyle._isChanging=!1),this._textEnabled&&this._paintTextGrids()}this._mapboxSource2D&&this._mapboxSource2D.pause(),this._mapboxSourceGL&&this._mapboxSourceGL.pause()},l.prototype._validateGrid=function(i){var s=this.map.bounds,_=i.bounds;if(i.isNormalized||(_=I.c.fromDegrees(i.bounds.north.degrees,i.bounds.west.degrees,i.bounds.south.degrees,i.bounds.east.degrees),_.normalize(),s.normalize()),!s.intersects(_)||i.depth!==this._depth)return!1;var b=this._options.validity||i.validity;if(this._enableValidity&&i.validTime&&b){var D=i.validTime.value.getTime(),G=D-0,Z=D+i.validity.totalMilliseconds,te=this.map.clock.time.getTime(),ae=te>G&&te<Z;if(!ae)return!1}return!0},l.prototype._changeOpacity=function(i){if(!(0,x.le)(i)&&i!=this._opacity){var s=this._opacity;if(this._opacity=i,this.map)switch(this.map.renderer){case Q.Renderer.WebDOM:this._leafletLayer&&(this._leafletLayer.canvas.style.opacity=i);break;case Q.Renderer.WebGL:this._mapboxLayer2D&&(this._mapboxLayer2D.paint["raster-opacity"]=i,this.map._mapboxEngine.setPaintProperty(this._id2D,"raster-opacity",i)),this._mapboxLayerGL&&(this._mapboxLayerGL.paint["raster-opacity"]=i,this.map._mapboxEngine.setPaintProperty(this._idGL,"raster-opacity",i));break}this.opacityChanged.trigger({old:s,new:i})}};/* @license
        Permission is hereby granted, free of charge, to any person obtaining a copy
        of this software and associated documentation files (the "Software"), to deal
        in the Software without restriction, including without limitation the rights
        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
        copies of the Software, and to permit persons to whom the Software is
        furnished to do so, subject to the following conditions:

        The above copyright notice and this permission notice shall be included in all
        copies or substantial portions of the Software.

        THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
        SOFTWARE.
    */return l._boxesForGauss=function(i,s){var _=Math.sqrt(12*i*i/s+1),b=Math.floor(_);b%2==0&&b--;for(var D=b+2,G=(12*i*i-s*b*b-4*s*b-3*s)/(-4*b-4),Z=Math.round(G),te=[],ae=0;ae<s;ae++)te.push(ae<Z?b:D);return te},l.gaussBlur_4=function(i,s,_,b){var D=this._boxesForGauss(b,3),G=i.slice(),Z=i.slice();return this._boxBlur_4(G,Z,s,_,(D[0]-1)/2),this._boxBlur_4(Z,G,s,_,(D[1]-1)/2),this._boxBlur_4(G,Z,s,_,(D[2]-1)/2),Z},l._boxBlur_4=function(i,s,_,b,D){for(var G=0,Z=i.length;G<Z;G++)s[G]=i[G];this._boxBlurH_4(s,i,_,b,D),this._boxBlurT_4(i,s,_,b,D)},l._boxBlurH_4=function(i,s,_,b,D){for(var G=1/(D+D+1),Z=0;Z<b;Z++){for(var te=Z*_,ae=te,Pe=te+D,ve=i[te],pe=i[te+_-1],Fe=(D+1)*ve,ke=0;ke<D;ke++)Fe+=i[te+ke];for(var ke=0;ke<=D;ke++)Fe+=i[Pe++]-ve,s[te++]=Fe*G;for(var ke=D+1;ke<_-D;ke++)Fe+=i[Pe++]-i[ae++],s[te++]=Fe*G;for(var ke=_-D;ke<_;ke++)Fe+=pe-i[ae++],s[te++]=Fe*G}},l._boxBlurT_4=function(i,s,_,b,D){for(var G=1/(D+D+1),Z=0;Z<_;Z++){for(var te=Z,ae=te,Pe=te+D*_,ve=i[te],pe=i[te+_*(b-1)],Fe=(D+1)*ve,ke=0;ke<D;ke++)Fe+=i[te+ke*_];for(var ke=0;ke<=D;ke++)Fe+=i[Pe]-ve,s[te]=Fe*G,Pe+=_,te+=_;for(var ke=D+1;ke<b-D;ke++)Fe+=i[Pe]-i[ae],s[te]=Fe*G,ae+=_,Pe+=_,te+=_;for(var ke=b-D;ke<b;ke++)Fe+=pe-i[ae],s[te]=Fe*G,ae+=_,te+=_}},l.prototype._paintRasterGrid2D=function(i,s,_,b,D,G){var Z=this._context2D,te=this._canvas2D,ae=this._buffer,Pe=ae.getContext("2d"),ve=i.bitmap||this._rasterizeGrid(i),pe=ve;ae.height=i.size.height,ae.width=i.size.width,Pe.clearRect(0,0,ae.width,ae.height),Pe.putImageData(pe,0,0),Z.drawImage(ae,_,b,D,G),_+s<te.width&&Z.drawImage(ae,_+s,b,D,G),_-s>-D&&Z.drawImage(ae,_-s,b,D,G),i._lastAccessed=performance.now()},l.prototype._paintRasterGridGL=function(i,s,_,b,D,G){var Z=this._contextGL,te=this._canvasGL;Z.useProgram(this._rasterProgram),Z.bindBuffer(Z.ARRAY_BUFFER,this._positionBuffer),Z.bufferData(Z.ARRAY_BUFFER,new Float32Array(this._positions),Z.STATIC_DRAW),Z.enableVertexAttribArray(this._rasterPositionLocation),Z.vertexAttribPointer(this._rasterPositionLocation,2,Z.FLOAT,!1,0,0),Z.bindBuffer(Z.ARRAY_BUFFER,this._texcoordBuffer),Z.bufferData(Z.ARRAY_BUFFER,new Float32Array(this._texcoords),Z.STATIC_DRAW),Z.enableVertexAttribArray(this._rasterTexcoordLocation),Z.vertexAttribPointer(this._rasterTexcoordLocation,2,Z.FLOAT,!1,0,0),Z.stencilFunc(Z.NOTEQUAL,0,255),Z.stencilMask(0),Z.colorMask(!0,!0,!0,!0);var ae=i.texture||this._textureGrid(i);this._drawImage(Z,ae,D,G,_,b),_+s<te.width&&this._drawImage(Z,ae,D,G,_+s,b),_-s>-D&&this._drawImage(Z,ae,D,G,_-s,b),i._lastAccessed=performance.now()},l.prototype._paintClipStencil=function(i,s,_,b,D,G){var Z=this._contextGL,te=this._canvasGL;Z.useProgram(this._stencilProgram);for(var ae=[],Pe=0,ve=i.length;Pe<ve;Pe++){var pe=i[Pe];ae.push((pe.x-_)/D),ae.push((pe.y-b)/G)}Z.disableVertexAttribArray(this._rasterTexcoordLocation),Z.disableVertexAttribArray(this._rasterPositionLocation);var Fe=Z.createBuffer();Z.bindBuffer(Z.ARRAY_BUFFER,Fe),Z.bufferData(Z.ARRAY_BUFFER,new Float32Array(ae),Z.STATIC_DRAW),Z.enableVertexAttribArray(this._stencilPositionLocation),Z.vertexAttribPointer(this._stencilPositionLocation,2,Z.FLOAT,!1,0,0),Z.stencilFunc(Z.ALWAYS,1,255),Z.stencilOp(Z.INVERT,Z.INVERT,Z.INVERT),this._drawClipPolygon(Z,D,G,_,b,i.length),_+s<te.width&&this._drawClipPolygon(Z,D,G,_+s,b,i.length),_-s>-D&&this._drawClipPolygon(Z,D,G,_-s,b,i.length),Z.disableVertexAttribArray(this._stencilPositionLocation)},l.prototype._rasterizeGrid=function(i){var s=this._rasterizeData(i.data,i.size.width,i.size.height);return i._bitmap=s,s},l.prototype._rasterizeData=function(i,s,_){var b=s*_*4,D=new Uint8ClampedArray(b),G=0,Z,te,ae,Pe=this._palette,ve=this._filter,pe=ve.length,Fe=pe>0;for(Z=0,te=0;Z<_&&te<s;te++,Z=te===s?Z+1:Z,te=te===s?te=0:te){var ke=i[G],Ze=[0,0,0,0];if(!isNaN(ke))if(!Fe)Ze=Pe.apply(ke);else for(ae=0;ae<pe;ae++){var at=ve[ae];if(ke>=at.start&&ke<=at.end){Ze=Pe.apply(ke);break}}var Ve=G*4;D[Ve]=Ze[0],D[Ve+1]=Ze[1],D[Ve+2]=Ze[2],D[Ve+3]=Ze[3],G++}var st=new ImageData(D,s,_);return st},l.prototype._textureGrid=function(i){var s;return this._contextGL&&(s=this._loadTexture(this._contextGL,i.data,i.size.width,i.size.height,this._rasterStyle.smoothingEnabled),i._texture=s),s},l.prototype._paintContourGrids=function(i,s,_,b,D,G){var Z=this._contourStyle,te=-(Z.resolution-1)*10,ae=[];i._lastAccessed=performance.now();var Pe=i.size.width,ve=i.size.height,pe=D/Pe,Fe=G/ve;return i.data&&(i._gaussBlurData||(te===0?i._gaussBlurData=i.data:i._gaussBlurData=l.gaussBlur_4(i.data,Pe,ve,te)),Z.isobandsEnabled&&Z.isobands.length&&(this._contextGL?(this._determineGridIsobandLabelLocations(i),ae=ae.concat(this._paintGridIsobandsGL(i,s,pe,Fe,_,b,D,G))):(this._rasterizeGridIsobands(i),ae=ae.concat(this._paintGridIsobands2D(i,s,pe,Fe,_,b,D,G)))),Z.isolinesEnabled&&Z.isolines.length&&(this._contourGridIsolines(i),ae=ae.concat(this._paintGridIsolines2D(i,s,pe,Fe,_,b)))),ae},l.prototype._paintGridIsobandsGL=function(i,s,_,b,D,G,Z,te){var ae=this._contextGL,Pe=this._canvasGL;ae.useProgram(this._isobandProgram),ae.stencilMask(0),ae.colorMask(!0,!0,!0,!0),ae.stencilFunc(ae.NOTEQUAL,0,255),ae.stencilOp(ae.KEEP,ae.KEEP,ae.KEEP),ae.bindBuffer(ae.ARRAY_BUFFER,this._positionBuffer),ae.enableVertexAttribArray(this._rasterPositionLocation),ae.vertexAttribPointer(this._rasterPositionLocation,2,ae.FLOAT,!1,0,0),ae.bindBuffer(ae.ARRAY_BUFFER,this._texcoordBuffer),ae.enableVertexAttribArray(this._rasterTexcoordLocation),ae.vertexAttribPointer(this._rasterTexcoordLocation,2,ae.FLOAT,!1,0,0);var ve=i._blurTexture||this._textureBlurredGrid(i);this._drawIsobands(ae,ve,Z,te,D,G),D+s<Pe.width&&this._drawIsobands(ae,ve,Z,te,D+s,G),D-s>-Z&&this._drawIsobands(ae,ve,Z,te,D-s,G);for(var pe=[],Fe=this._contourStyle.isobands,ke=i._isobandData,Ze=0,at=Fe.length;Ze<at;Ze++){var Ve=Fe[Ze],st=Ve.range.start+"_"+Ve.range.end,Pt=ke[st];if(Pt){var $e=Ve.labels;if($e&&$e.text){var Ct=Pt.labelPoint,At=D+Ct[0]*_,qe=G+Ct[1]*b;pe.push([$e,[At,qe]])}}}return pe},l.prototype._paintGridIsobands2D=function(i,s,_,b,D,G,Z,te){for(var ae=this._context2D,Pe=this._canvas2D,ve=[],pe=i._isobandData,Fe=this.contourStyle.isobands,ke=0,Ze=Fe.length;ke<Ze;ke++){var at=Fe[ke],Ve=at.range.start+"_"+at.range.end,st=pe[Ve];if(st){var Pt=st.bitmap;this._buffer.getContext("2d").putImageData(Pt,0,0),ae.drawImage(this._buffer,D,G,Z,te),D+s<Pe.width&&ae.drawImage(this._buffer,D+s,G,Z,te),D-s>-Z&&ae.drawImage(this._buffer,D-s,G,Z,te);var $e=at.labels;if($e&&$e.text){var Ct=st.labelPoint,At=D+Ct[0]*_,qe=G+Ct[1]*b;ve.push([$e,[At,qe]])}}}return ve},l.prototype._paintGridIsolines2D=function(i,s,_,b,D,G){for(var Z=this._context2D,te=this._canvas2D,ae=[],Pe=i.size.width,ve=i.size.height,pe=new T.E(Pe/2,ve/2),Fe=new T.E(0,0),ke=this.contourStyle.isolines,Ze=0,at=ke.length;Ze<at;Ze++){var Ve=void 0,st=void 0,Pt=ke[Ze],$e=i._isolineData[Pt.value].segments,Ct=Number.MAX_VALUE;Z.beginPath(),Z.strokeStyle=Pt.lineColor,Z.lineWidth=Pt.lineWidth;for(var At=0,qe=$e.length;At<qe;At++){var nt=$e[At],Xe=D+_*nt[0],It=G+b*nt[1],kt=D+_*nt[2],Nt=G+b*nt[3];Xe+s<te.width&&(Xe+=s,kt+=s),Xe-s>0&&(Xe-=s,kt-=s),Fe.x=nt[0],Fe.y=nt[1];var Rt=Fe.distanceTo(pe);Rt<Ct&&(Ct=Rt,Ve=Xe,st=It),!(Xe<-1&&kt<-1||Xe>te.width&&kt>te.width||It<-1&&Nt<-1||It>te.height&&Nt>te.height)&&(Z.moveTo(Xe,It),Z.lineTo(kt,Nt))}Z.stroke();var Qt=Pt.labels;Qt&&Qt.text&&$e.length>0&&ae.push([Qt,[Ve,st]])}return ae},l.prototype._paintContourLabels=function(i){function s(qe,nt){return!(qe[0]<nt[2]||qe[2]>nt[0]||qe[1]>nt[3]||qe[3]<nt[1])}var _=this._context2D,b=20,D=6,G=[],Z=[];if(this._contourStyle.declutterLabels)for(var te=0,ae=i.length;te<ae;te++){for(var Pe=i[te][1],ve=[Pe[1]+D,Pe[0]-b,Pe[1]-D,Pe[0]+b],pe=!1,Fe=0,ke=G.length;Fe<ke;Fe++)if(s(ve,G[Fe])){pe=!0;break}pe||(Z.push(i[te]),G.push(ve))}else Z=i;for(var Ze=0,at=Z.length;Ze<at;Ze++){var Ve=Z[Ze][0],Pe=Z[Ze][1];if(!(Ve.fontSize<=0)){_.save(),_.textAlign="center",_.textBaseline="middle",_.translate(Pe[0],Pe[1]);var st=Ve.fontStyle+" ";st+="normal ",st+=Ve.fontWeight+" ",st+=Ve.fontSize+"px ",st+=Ve.fontFamily||"Arial",_.font=st;var Pt=_.measureText(Ve.text),$e=Pt.width+Ve.backgroundPadding*2,Ct=Ve.fontSize*1.286+Ve.backgroundPadding*2,At=Ve.borderRadius;$e<2*At&&(At=$e/2),Ct<2*At&&(At=Ct/2),_.beginPath(),_.moveTo(At-$e/2,-Ct/2),_.arcTo($e/2,-Ct/2,$e/2,Ct/2,At),_.arcTo($e/2,Ct/2,-$e/2,Ct/2,At),_.arcTo(-$e/2,Ct/2,-$e/2,-Ct/2,At),_.arcTo(-$e/2,-Ct/2,$e/2,-Ct/2,At),_.closePath(),Ve.backgroundColor&&(_.fillStyle=Ve.backgroundColor,_.fill()),Ve.borderWidth&&Ve.borderWidth!==0&&(_.lineWidth=Ve.borderWidth,_.strokeStyle=Ve.borderColor||"rgba(0,0,0,1)",_.stroke()),Ve.strokeWidth&&Ve.strokeWidth!==0&&(_.miterLimit=1,_.lineWidth=Ve.strokeWidth*2,_.strokeStyle=Ve.strokeColor,_.strokeText(Ve.text,0,0)),_.fillStyle=Ve.fontColor,_.fillText(Ve.text,0,0),_.restore()}}},l.prototype._textureBlurredGrid=function(i){if(!!i._gaussBlurData&&this._contextGL){var s=this._loadTexture(this._contextGL,i._gaussBlurData,i.size.width,i.size.height);return i._blurTexture=s,s}},l.prototype._contourGridIsolines=function(i){var s=this._contourStyle.isolines,_=i._gaussBlurData;s.length>0&&!i._isolineData&&(i._isolineData={});for(var b=0,D=s.length;b<D;b++){var G=s[b];G._isChanging=!1,i._isolineData.hasOwnProperty(G.value)||(i._isolineData[G.value]={},i._isolineData[G.value].segments=Uo._determineContourLines(G.value,_,i.size.width,i.size.height,this._invalidDataValue))}},l.prototype._rasterizeGridIsobands=function(i){var s=this._contourStyle.isobands,_=i._gaussBlurData;s.length>0&&!i._isobandData&&(i._isobandData={});for(var b=0,D=s.length;b<D;b++){var G=s[b];G._isChanging=!1;var Z=G.range.start,te=G.range.end,ae=Z+"_"+te;i._isobandData.hasOwnProperty(ae)||(i._isobandData[ae]=Uo._determineIsobandBitmap(G,_,i.size.width,i.size.height))}},l.prototype._determineGridIsobandLabelLocations=function(i){var s=this.contourStyle.isobands,_=i._gaussBlurData,b=i.size.width,D=i.size.height;s.length>0&&!i._isobandData&&(i._isobandData={});for(var G=0,Z=s.length;G<Z;G++){var te=s[G];if(te.labels){var ae=te.range.start,Pe=te.range.end,ve=ae+"_"+Pe;if(!i._isobandData.hasOwnProperty(ve)){for(var pe=-1,Fe=-1,ke=0,Ze=0,at=D;Ze<at;Ze++){for(var Ve=-1,st=0,Pt=0,$e=b;Pt<$e;Pt++){var Ct=Ze*b+Pt,At=_[Ct];(At-Pe)*(At-ae)<=0?(Ve===-1&&(Ve=Pt),st++):(st>ke+10&&(ke=st,Fe=Ze,pe=Ve+st/2),st=0,Ve=-1)}st>=ke&&Math.abs(Fe-at/2)>Math.abs(Ze-at/2)&&(ke=st,Fe=Ze,pe=Ve+st/2)}pe===-1?i._isobandData[ve]=void 0:i._isobandData[ve]={texture:void 0,labelPoint:[pe,Fe]}}}}},l.prototype._paintTextGrids=function(){var i=this.textStyle,s=this._map,_=s.bounds,b=this._context2D,D=this._canvas2D,G=i.colorByPalette,Z=s.zoomLevel,te=Math.floor(Z),ae=i.precision,Pe=i.characterLength;b.fillStyle=i.fontColor;var ve="center";switch(i.alignment){case x.v2.Left:ve="left";break;case x.v2.Right:ve="right";break}b.textAlign=ve;var pe="middle";switch(i.baseline){case x.HW.Top:pe="top";break;case x.HW.Bottom:pe="bottom";break}b.textBaseline=pe;var Fe=i.fontStyle+" ";Fe+="normal ",Fe+=i.fontWeight+" ",Fe+=i.fontSize+"px ",Fe+=i.fontFamily||"Arial",b.font=Fe,i.strokeWidth&&(b.miterLimit=1,b.lineWidth=i.strokeWidth*2,b.strokeStyle=i.strokeColor);for(var ke=this._deriveTextPoints(),Ze=this.palette,at=this.filter,Ve=at.length,st=Bt.x.convertGeoToPixel(_.topLeftGeoPoint,te),Pt=Math.pow(2,Z%1),$e=new T.E(0,0),Ct=Math.pow(2,Z)*256,At=0,qe=ke.length;At<qe;At++){for(var nt=ke[At],Xe=(nt.x-st.x)*Pt,It=(nt.y-st.y)*Pt;Xe<0;)Xe+=Ct;for(;Xe>D.width;)Xe-=Ct;var kt=i.strokeWidth&&i.strokeWidth>0,Nt=this._options.convert;$e.x=Xe,$e.y=It;var Rt=this.inspect($e);if(Rt&&!isNaN(Rt)&&Rt!==this.invalidDataValue){for(var Qt=!!Ve,Jt=0;Jt<Ve;Jt++){var pi=at[Jt];if(Rt>=pi.start&&Rt<=pi.end){Qt=!1;break}}if(Qt)continue;if(G&&Ze){var vi=[0,0,0,0];vi=Ze.apply(Rt),b.fillStyle="rgba("+vi[0]+","+vi[1]+","+vi[2]+","+vi[3]+")"}var gi=Nt?this._options.convert(Rt):Rt,jt="";if(ae>=0){var $t=Math.pow(10,ae);Rt=Math.round(Rt*$t)/$t}Pe>=1?jt=Rt.toPrecision(Pe):jt+=Rt,kt&&b.strokeText(jt,Xe,It),b.fillText(jt,Xe,It)}}},l.prototype._deriveTextPoints=function(){var i=this.textStyle,s=i.spread.width,_=i.spread.height,b=i.staggeredOffset,D=b/s%1,G=this.map,Z=G.bounds;Z.normalize();var te=Math.floor(G.zoomLevel),ae=Math.pow(2,te),Pe=ae*256/s,ve=ae*256/_,pe=[],Fe=Z.west.degrees>=Z.east.degrees;if(Fe){var ke=this._lastLeftWorld;ke.north.radians=Z.north.radians,ke.west.radians=Z.west.radians,ke.south.radians=Z.south.radians,ke.east.degrees=180,pe.push(ke);var Ze=this._lastRightWorld;Ze.north.radians=Z.north.radians,Ze.west.degrees=-180,Ze.south.radians=Z.south.radians,Ze.east.radians=Z.east.radians,pe.push(Ze)}else pe.push(Z);for(var at=[],Ve=0,st=pe.length;Ve<st;Ve++)for(var Pt=pe[Ve],$e=Bt.x.convertGeoToPixel(Pt.topLeftGeoPoint,te,this._lastTopLeftScreenPoint),Ct=Bt.x.convertGeoToPixel(Pt.bottomRightGeoPoint,te,this._lastBottomRightScreenPoint),At=Math.max(Math.floor($e.x/s)-1,0),qe=Math.min(Math.floor(Ct.x/s)+1,Pe),nt=Math.max(Math.floor($e.y/_)-1,0),Xe=Math.min(Math.floor(Ct.y/_)+1,ve),It=Math.ceil(nt)%2!=0,kt=nt;kt<=Xe;kt++){var Nt=At;It&&(Nt+=D);for(var Rt=Nt;Rt<=qe;Rt++){var Qt={x:Rt*s,y:kt*_};at.push(Qt)}It=!It}return at},l.prototype._paintShapeGrids=function(){for(var i=this.shapeStyle,s=this._map,_=s.bounds,b=this._context2D,D=s.zoomLevel,G=Math.floor(D),Z=i.precision,te=i.characterLength,ae=i.vertices===1,Pe=this._palette,ve=Math.pow(2,D%1),pe=i.circumRadius*ve,Fe=Bt.x.convertGeoToPixel(_.topLeftGeoPoint,G,this._lastTopLeftScreenPoint),ke=Bt.x.convertGeoToPixel(_.bottomRightGeoPoint,G,this._lastBottomRightScreenPoint),Ze=Fe.x,at=ke.x+i.spread.width,Ve=Fe.y,st=256*Math.pow(2,G),Pt=this._deriveShapePoints(),$e=this._shapeStyle._shapes,Ct=[],At=0,qe=Pt.length;At<qe;At++){var nt=Pt[At],Xe=nt.key,It=$e[Xe];if(It&&It.interiorPoints){Ct.push(It);continue}var kt=this._determineShapeGeometry(nt,Ze,Ve,ve);kt&&Ct.push(kt)}b.lineWidth=i.strokeWidth,b.strokeStyle=i.strokeColor;for(var At=0,Nt=Ct.length;At<Nt;At++){var kt=Ct[At],Rt=kt.geometry,Qt=Rt.length,Jt=kt.interiorPoints;if(!!Jt.length){var pi=0,vi=i.dataType;switch(vi){case"AVG":pi=Jt.reduce(function(Bn,en){return Bn+en},0)/Jt.length;break;case"MAX":pi=Math.max.apply(Math,Jt);break;case"MIN":pi=Math.min.apply(Math,Jt);break}if(!!pi){for(var gi=kt.x;gi<Ze;)gi+=st;for(;gi>at;)gi-=st;gi=(gi-Ze)*ve;var jt=(kt.y-Ve)*ve;if(b.save(),b.translate(gi,jt),b.beginPath(),ae)b.moveTo(pe,0),b.arc(0,0,pe,0,2*Math.PI);else{var $t=Rt[0].x*ve,Oi=Rt[0].y*ve;b.moveTo($t,Oi);for(var Ui=1;Ui<Qt;Ui++)$t=Rt[Ui].x*ve,Oi=Rt[Ui].y*ve,b.lineTo($t,Oi);b.closePath()}var xi=Pe.apply(pi);if(b.fillStyle="rgba("+xi[0]+","+xi[1]+","+xi[2]+","+xi[3]+")",b.fill(),b.stroke(),i.labelsEnabled){var li=i.labels;this._options.convert&&(pi=this._options.convert(pi));var Fi="";if(Z>=0){var Wi=Math.pow(10,Z);pi=Math.round(pi*Wi)/Wi}te>=1?Fi=pi.toPrecision(te):Fi+=pi,b.textAlign="center",b.textBaseline="middle";var tr=li.fontStyle+" ";tr+="normal ",tr+=li.fontWeight+" ",tr+=li.fontSize+"px ",tr+=li.fontFamily||"Arial",b.font=tr;var Zi=b.measureText(Fi),Yi=Zi.width+li.backgroundPadding*2,ar=li.fontSize*1.286+li.backgroundPadding*2,rr=li.borderRadius;Yi<2*rr&&(rr=Yi/2),ar<2*rr&&(rr=ar/2),b.beginPath(),b.moveTo(rr-Yi/2,-ar/2),b.arcTo(Yi/2,-ar/2,Yi/2,ar/2,rr),b.arcTo(Yi/2,ar/2,-Yi/2,ar/2,rr),b.arcTo(-Yi/2,ar/2,-Yi/2,-ar/2,rr),b.arcTo(-Yi/2,-ar/2,Yi/2,-ar/2,rr),b.closePath(),li.backgroundColor&&(b.fillStyle=li.backgroundColor,b.fill()),li.borderWidth&&li.borderWidth!==0&&(b.lineWidth=li.borderWidth,b.strokeStyle=li.borderColor||"rgba(0,0,0,1)",b.stroke()),li.strokeWidth&&li.strokeWidth!==0&&(b.miterLimit=1,b.lineWidth=li.strokeWidth*2,b.strokeStyle=li.strokeColor,b.strokeText(Fi,0,0)),b.fillStyle=li.fontColor,b.fillText(Fi,0,0)}b.restore()}}}},l.prototype._deriveShapePoints=function(){var i=this.shapeStyle,s=i.spread.width,_=i.spread.height,b=i.staggeredOffset.width,D=b/s%1,G=i.staggeredOffset.height,Z=G/_%1,te=i.rotation.radians,ae=i.staggeredRotation,Pe=this.map,ve=Pe.bounds;ve.normalize();var pe=Math.floor(Pe.zoomLevel),Fe=Math.pow(2,pe),ke=Fe*256/s,Ze=Fe*256/_,at=[],Ve=ve.west.degrees>=ve.east.degrees;if(Ve){var st=this._lastLeftWorld;st.north.radians=ve.north.radians,st.west.radians=ve.west.radians,st.south.radians=ve.south.radians,st.east.degrees=180,at.push(st);var Pt=this._lastRightWorld;Pt.north.radians=ve.north.radians,Pt.west.degrees=-180,Pt.south.radians=ve.south.radians,Pt.east.radians=ve.east.radians,at.push(Pt)}else at.push(ve);for(var $e=[],Ct=0,At=at.length;Ct<At;Ct++)for(var qe=at[Ct],nt=Bt.x.convertGeoToPixel(qe.topLeftGeoPoint,pe,this._lastTopLeftScreenPoint),Xe=Bt.x.convertGeoToPixel(qe.bottomRightGeoPoint,pe,this._lastBottomRightScreenPoint),It=Math.max(Math.floor(nt.x/s)-1,0)+.5,kt=Math.min(Math.floor(Xe.x/s)+1,ke),Nt=Math.max(Math.floor(nt.y/_)-1,0)+.5,Rt=Math.min(Math.floor(Xe.y/_)+1,Ze),Qt=Math.ceil(Nt)%2!=0,Jt=void 0,pi=Math.ceil(It)%2!=0,vi=Nt;vi<=Rt;vi++){Jt=pi;var gi=It;Qt&&(gi+=D,Jt=!Jt);for(var jt=gi;jt<=kt;jt++){var $t=te,Oi=vi;Jt&&(Oi+=Z,$t+=ae.radians);var Ui=pe+"_"+jt+"_"+Oi,xi={x:jt,y:Oi,z:pe,rotation:$t,key:Ui};$e.push(xi),Jt=!Jt}Qt=!Qt}return $e},l.prototype._determineShapeGeometry=function(i,s,_,b){var D=this._shapeStyle,G=D.vertices,Z=D.spread,te=D.circumRadius,ae=i.rotation,Pe=this._invalidDataValue,ve={},pe=[],Fe=i.x*Z.width,ke=i.y*Z.height,Ze=G===1;if(Ze){pe[0]={radius:te};for(var at=[],Ve=new T.E(Fe,ke),st=ke-te;st<ke+te;st++)for(var Pt=Fe-te;Pt<Fe+te;Pt++)if(Math.pow(2,Pt-Fe)+Math.pow(2,st-ke)<=Math.pow(2,te)){var $e=(Pt-s)*b,Ct=(st-_)*b;Ve.x=$e,Ve.y=Ct;var At=this.inspect(Ve);if(isNaN(At)||At===Pe)continue;if(At===null)return null;at.push(At)}at.sort(),ve={x:Fe,y:ke,geometry:pe,interiorPoints:at}}else{for(var qe=void 0,nt=void 0,Xe=0;Xe<G;Xe++)qe=te*Math.cos(Xe*2*Math.PI/G+ae),nt=te*Math.sin(Xe*2*Math.PI/G+ae),pe[Xe]={x:qe,y:nt};for(var at=[],Ve=new T.E(Fe,ke),st=ke-te;st<ke+te;st++)for(var Pt=Fe-te;Pt<Fe+te;Pt++)if(this.pointInPoly(Pt-Fe,st-ke,pe)){var $e=(Pt-s)*b,Ct=(st-_)*b;Ve.x=$e,Ve.y=Ct;var At=this.inspect(Ve);if(isNaN(At)||At===Pe)continue;if(At===null)return null;at.push(At)}at.sort(),ve={x:Fe,y:ke,geometry:pe,interiorPoints:at}}return D._shapes[i.key]=ve,ve},l.prototype.pointInPoly=function(i,s,_){for(var b=!1,D=_.length,G=0,Z=D-1;G<D;Z=G++){var te=_[G].x,ae=_[G].y,Pe=_[Z].x,ve=_[Z].y,pe=ae>s!=ve>s&&i<(Pe-te)*(s-ae)/(ve-ae)+te;pe&&(b=!b)}return b},l.prototype._loadTexture=function(i,s,_,b,D){D===void 0&&(D=!0);var G=i.createTexture();return i.bindTexture(i.TEXTURE_2D,G),D?(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR)):(i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST)),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texImage2D(i.TEXTURE_2D,0,i.LUMINANCE,_,b,0,i.LUMINANCE,i.FLOAT,s),G},l.prototype._drawStencil=function(i,s,_,b,D){var G=Yr.orthographic(0,i.canvas.width,i.canvas.height,0,-1,1);G=Yr.translate(G,b,D,0),G=Yr.scale(G,s,_,1),i.uniformMatrix4fv(this._stencilMatrixLocation,!1,G),i.drawArrays(i.TRIANGLES,0,6)},l.prototype._drawClipPolygon=function(i,s,_,b,D,G){var Z=Yr.orthographic(0,i.canvas.width,i.canvas.height,0,-1,1);Z=Yr.translate(Z,b,D,0),Z=Yr.scale(Z,s,_,1),i.uniformMatrix4fv(this._stencilMatrixLocation,!1,Z),i.drawArrays(i.TRIANGLE_FAN,0,G)},l.prototype._drawImage=function(i,s,_,b,D,G){i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,s),i.activeTexture(i.TEXTURE1),i.bindTexture(i.TEXTURE_2D,this._palette.texture);var Z=Yr.orthographic(0,i.canvas.width,i.canvas.height,0,-1,1);Z=Yr.translate(Z,D,G,0),Z=Yr.scale(Z,_,b,1),i.uniformMatrix4fv(this._rasterMatrixLocation,!1,Z),i.uniform1i(this._tileTextureLocation,0),i.uniform1i(this._paletteTextureLocation,1);var te=this._filter,ae=te.length,Pe=ae>0;if(!Pe)i.drawArrays(i.TRIANGLES,0,6);else for(var ve=0;ve<ae;ve++){var pe=te[ve];i.uniform1f(this._tileTextureLowerBoundLocation,pe.start),i.uniform1f(this._tileTextureUpperBoundLocation,pe.end),i.drawArrays(i.TRIANGLES,0,6)}},l.prototype._drawIsobands=function(i,s,_,b,D,G){i.useProgram(this._isobandProgram),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,s);var Z=Yr.orthographic(0,i.canvas.width,i.canvas.height,0,-1,1);Z=Yr.translate(Z,D,G,0),Z=Yr.scale(Z,_,b,1),i.uniformMatrix4fv(this._isobandMatrixLocation,!1,Z),i.uniform1i(this._tileBlurTextureLocation,0);for(var te=this._contourStyle.isobands,ae=0,Pe=te.length;ae<Pe;ae++){var ve=te[ae],pe=ve.fillColor,Fe=[pe[0]/255,pe[1]/255,pe[2]/255,pe[3]/255];i.uniform1f(this._tileIsobandLowerBoundLocation,ve.range.start),i.uniform1f(this._tileIsobandUpperBoundLocation,ve.range.end),i.uniform4fv(this._tileIsobandColorLocation,Fe),i.drawArrays(i.TRIANGLES,0,6)}},l.prototype._clearGL=function(i){i===void 0&&(i=!1);var s=this._contextGL;if(!!s&&this.map.renderer===Q.Renderer.WebGL){var s=this._contextGL;try{var _=s.getExtension("WEBGL_lose_context");_&&_.loseContext()}catch(D){}}},l.prototype._arrangeData=function(){},l.prototype.addData=function(i){this.insertData(i)},l.prototype.insertData=function(i,s){s===void 0&&(s=null),this._data[i.id]=i;var _=i.id;this._data[_]=i;var b;s!=null?(this._stack.splice(s,0,_),b=s):b=this._stack.push(_)-1,this.shapeStyle._shapes=[],this.update()},l.prototype.removeData=function(i){if(this._data.hasOwnProperty(i)){delete this._data[i];for(var s,_=0,b=this._stack.length;_<b;_++){var D=this._stack[_];if(i===D){s=_;break}}this._stack.splice(s,1),this.shapeStyle._shapes=[],this.update()}},l.prototype.clearData=function(){var i=Object.keys(this._data).length;i>0&&(this._stack=[],this._data={},this.update())},l.prototype.arrangeData=function(i,s){var _=this._stack.length;s>_?s=_-1:s<0&&(s=0);for(var b,D=0;D<_;D++){var G=this._stack[D];G===i&&(b=D)}this._stack.splice(b,1),this._stack.splice(s,0,i),this.update()},l.prototype.arrangeDataUp=function(i){for(var s,_=this._stack.length,b=0;b<_;b++){var D=this._stack[b];D===i&&(s=b)}if(s!==_-1){var G=s+1;this._stack.splice(s,1),this._stack.splice(G,0,i),this.update()}},l.prototype.arrangeDataDown=function(i){for(var s,_=0,b=this._stack.length;_<b;_++){var D=this._stack[_];D===i&&(s=_)}if(!(s<1)){var G=s-1;this._stack.splice(s,1),this._stack.splice(G,0,i),this.update()}},l.prototype.inspect=function(i){var s=null,_=i instanceof T.E?this.map.fromScreenToGeo(i,this._lastInspectionGeoPoint):i;_.normalize();for(var b=this._data,D=this._stack,G=D.length-1;G>=0;G--){var Z=D[G],te=b[Z],ae=te.bounds;if(!!this._validateGrid(te)&&(te.isNormalized||(ae=I.c.fromDegrees(ae.north.degrees,ae.west.degrees,ae.south.degrees,ae.east.degrees),ae.normalize()),ae.containsPoint(_)&&!(te.clipPath&&!te.clipPath.contains(_)))){var Pe=this.map.zoomLevel,ve=Bt.x.convertGeoToPixel(ae.topLeftGeoPoint,Pe,this._lastTopLeftScreenPoint),pe=Bt.x.convertGeoToPixel(ae.bottomRightGeoPoint,Pe,this._lastBottomRightScreenPoint),Fe=pe.x-ve.x,ke=pe.y-ve.y,Ze=Bt.x.convertGeoToPixel(_,Pe,this._lastInspectionPoint),at=Ze.x-ve.x,Ve=Ze.y-ve.y;if(!te.isNormalized){var st=Math.pow(2,this.map.zoomLevel)*256;Fe=(Fe+st)%st,at=(at+st)%st}var Pt=Fe/te.size.width,$e=ke/te.size.height,Ct=Math.floor(at/Pt),At=Math.floor(Ve/$e),qe=At*te.size.width+Ct;s=te.data[qe];break}}return s},l.prototype.update=function(){this._lastRefreshed=performance.now(),this._render(),this.updated.trigger()},l.prototype._loadLeaflet=function(){this._loadLeafletPane(),this._leafletLayer=new q.g(this._leafletPane),this._canvas2D=this._leafletLayer.canvas,this._canvas2D.style["pointer-events"]="none",this._canvas2D.style.background="none !important",this._canvas2D.style.filter="Alpha(opacity=0)",this._canvas2D.style.opacity=this._opacity.toString();var i=this._canvas2D.getContext("2d");i.imageSmoothingEnabled=this.rasterStyle.smoothingEnabled,i.webkitImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,i.mozImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,this._context2D=i;var s={};s.pane=this._leafletPane,this.map.engine.addLayer(this._leafletLayer,s)},l.prototype._unloadLeaflet=function(){this.map.engine.removeLayer(this._leafletLayer),this._leafletLayer=void 0},l.prototype._deriveMapboxCoordinates=function(i){var s=i.topLeftGeoPoint.latitude.degrees,_=i.topLeftGeoPoint.longitude.degrees,b=i.bottomRightGeoPoint.latitude.degrees,D=i.bottomRightGeoPoint.longitude.degrees,G=[[_,s],[D,s],[D,b],[_,b]];return G},l.prototype._loadMapbox=function(){this.map.styled.addListener(this._onMapStyled,this);var i=this.map._mapboxEngine,s=this.map.contextualBounds,_=this._deriveMapboxCoordinates(s),b=this._id2D,D=document.createElement("canvas");D.id="__"+this.map.elementId+"_"+b,D.style.display="none",D.style["pointer-events"]="none",D.style.background="none !important",D.style.filter="Alpha(opacity=0)",this._canvas2D=D;var G=this._canvas2D.getContext("2d");G.imageSmoothingEnabled=this.rasterStyle.smoothingEnabled,G.webkitImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,G.mozImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,this._context2D=G,this.map.element.appendChild(D);var Z={type:"canvas",canvas:this._canvas2D.id,animate:!1,coordinates:_};if(i.addSource(b,Z),this._mapboxSource2D=i.getSource(b),this._mapboxLayer2D={id:b,type:"raster",source:b,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,transition:{duration:0,delay:0},paint:{"raster-opacity":this._opacity,"raster-fade-duration":0,"raster-opacity-transition":{duration:0,delay:0}}},this.rasterStyle.useWebGLContext){var te=this._idGL,ae=document.createElement("canvas");ae.id="__"+this.map.elementId+"_"+te,ae.style.display="none",ae.style["pointer-events"]="none",ae.style.background="none !important",ae.style.filter="Alpha(opacity=0)",this._canvasGL=ae;var Pe=!1,ve=navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&navigator.userAgent.indexOf("CriOS")==-1&&navigator.userAgent.indexOf("FxiOS")==-1;ve&&(Pe=!0);var pe=this._canvasGL.getContext("webgl",{premultipliedAlpha:Pe,stencil:!0});this._contextGL=pe,this.map.element.appendChild(ae);var Fe=this._palette;Fe.gl=pe,pe.getExtension("OES_texture_float"),pe.getExtension("OES_texture_float_linear");var ke={type:"canvas",canvas:this._canvasGL.id,animate:!1,coordinates:_};i.addSource(te,ke),this._mapboxSourceGL=i.getSource(te),this._mapboxLayerGL={id:te,type:"raster",source:te,minzoom:this.minimumZoom,maxzoom:this.maximumZoom,transition:{duration:0,delay:0},paint:{"raster-opacity":this._opacity,"raster-fade-duration":0,"raster-opacity-transition":{duration:0,delay:0}}};var Ze=pe.createShader(pe.VERTEX_SHADER);pe.shaderSource(Ze,l._vertexShaderSrc),pe.compileShader(Ze),pe.getShaderParameter(Ze,pe.COMPILE_STATUS)||console.log(pe.getShaderInfoLog(Ze));var at=pe.createShader(pe.FRAGMENT_SHADER);pe.shaderSource(at,l._stencilShaderSrc),pe.compileShader(at),pe.getShaderParameter(at,pe.COMPILE_STATUS)||console.log(pe.getShaderInfoLog(at));var Ve=pe.createShader(pe.FRAGMENT_SHADER);pe.shaderSource(Ve,l._fragmentShaderSrc),pe.compileShader(Ve),pe.getShaderParameter(Ve,pe.COMPILE_STATUS)||console.log(pe.getShaderInfoLog(Ve));var st=pe.createShader(pe.FRAGMENT_SHADER);pe.shaderSource(st,l._isobandFragmentShaderSrc),pe.compileShader(st),pe.getShaderParameter(st,pe.COMPILE_STATUS)||console.log(pe.getShaderInfoLog(st));var Pt=pe.createProgram();pe.attachShader(Pt,Ze),pe.attachShader(Pt,at),pe.linkProgram(Pt),pe.getProgramParameter(Pt,pe.LINK_STATUS)||console.log(pe.getProgramInfoLog(Pt)),this._stencilProgram=Pt;var $e=pe.createProgram();pe.attachShader($e,Ze),pe.attachShader($e,Ve),pe.linkProgram($e),pe.getProgramParameter($e,pe.LINK_STATUS)||console.log(pe.getProgramInfoLog($e)),pe.useProgram($e),this._rasterProgram=$e;var Ct=pe.createProgram();if(pe.attachShader(Ct,Ze),pe.attachShader(Ct,st),pe.linkProgram(Ct),pe.getProgramParameter(Ct,pe.LINK_STATUS)||console.log(pe.getProgramInfoLog(Ct)),this._isobandProgram=Ct,this._rasterPositionLocation=pe.getAttribLocation($e,"a_position"),this._rasterTexcoordLocation=pe.getAttribLocation($e,"a_texcoord"),this._stencilPositionLocation=pe.getAttribLocation(Pt,"a_position"),this._stencilTexcoordLocation=pe.getAttribLocation(Pt,"a_texcoord"),this._stencilMatrixLocation=pe.getUniformLocation(Pt,"u_matrix"),this._rasterMatrixLocation=pe.getUniformLocation($e,"u_matrix"),this._tileTextureLocation=pe.getUniformLocation($e,"u_tile_texture"),this._paletteTextureLocation=pe.getUniformLocation($e,"u_palette_texture"),this._tileTextureLowerBoundLocation=pe.getUniformLocation($e,"u_tile_data_lower_bound"),this._tileTextureUpperBoundLocation=pe.getUniformLocation($e,"u_tile_data_upper_bound"),this._tileTextureFilterLocation=pe.getUniformLocation($e,"u_tile_data_filter"),this._paletteMinStepLocation=pe.getUniformLocation($e,"u_palette_min_step"),this._paletteMaxStepLocation=pe.getUniformLocation($e,"u_palette_max_step"),this._paletteSizeLocation=pe.getUniformLocation($e,"u_palette_size"),this._paletteExtendMinLocation=pe.getUniformLocation($e,"u_palette_extend_min"),this._paletteExtendMaxLocation=pe.getUniformLocation($e,"u_palette_extend_max"),this._isobandPositionLocation=pe.getAttribLocation(Ct,"a_position"),this._isobandTexcoordLocation=pe.getAttribLocation(Ct,"a_texcoord"),this._isobandMatrixLocation=pe.getUniformLocation(Ct,"u_matrix"),this._tileBlurTextureLocation=pe.getUniformLocation(Ct,"u_tile_blur_texture"),this._tileIsobandLowerBoundLocation=pe.getUniformLocation(Ct,"u_isoband_lower_bound"),this._tileIsobandUpperBoundLocation=pe.getUniformLocation(Ct,"u_isoband_upper_bound"),this._tileIsobandColorLocation=pe.getUniformLocation(Ct,"u_isoband_color"),Fe){pe.uniform1f(this._paletteMinStepLocation,Fe.colors[0].step),pe.uniform1f(this._paletteMaxStepLocation,Fe.colors[Fe.colors.length-1].step),pe.uniform2f(this._paletteSizeLocation,1024,1),pe.uniform1f(this._tileTextureLowerBoundLocation,Fe.colors[0].step),pe.uniform1f(this._tileTextureUpperBoundLocation,Fe.colors[Fe.colors.length-1].step);var At=this.filter.length>0?1:0;pe.uniform1i(this._tileTextureFilterLocation,At);var qe=Fe.extendMinimumColor?1:0,nt=Fe.extendMaximumColor?1:0;pe.uniform1i(this._paletteExtendMinLocation,qe),pe.uniform1i(this._paletteExtendMaxLocation,nt)}this._positionBuffer=pe.createBuffer(),pe.bindBuffer(pe.ARRAY_BUFFER,this._positionBuffer),this._positions=[0,0,0,1,1,0,1,0,0,1,1,1],pe.bufferData(pe.ARRAY_BUFFER,new Float32Array(this._positions),pe.STATIC_DRAW),this._texcoordBuffer=pe.createBuffer(),pe.bindBuffer(pe.ARRAY_BUFFER,this._texcoordBuffer),this._texcoords=[0,0,0,1,1,0,1,0,0,1,1,1],pe.bufferData(pe.ARRAY_BUFFER,new Float32Array(this._texcoords),pe.STATIC_DRAW),pe.bindBuffer(pe.ARRAY_BUFFER,this._positionBuffer),pe.enableVertexAttribArray(this._rasterPositionLocation),pe.vertexAttribPointer(this._rasterPositionLocation,2,pe.FLOAT,!1,0,0),pe.bindBuffer(pe.ARRAY_BUFFER,this._texcoordBuffer),pe.enableVertexAttribArray(this._rasterTexcoordLocation),pe.vertexAttribPointer(this._rasterTexcoordLocation,2,pe.FLOAT,!1,0,0),this._mapboxGroup=[this._mapboxLayerGL,this._mapboxLayer2D]}else this._mapboxGroup=[this._mapboxLayer2D]},l.prototype._unloadMapbox=function(){var i=this.map,s=i.engine;i.styled.removeListener(this._onMapStyled,this),s.getLayer(this._id2D)&&s.removeLayer(this._id2D),s.getSource(this._id2D)&&s.removeSource(this._id2D),s.getLayer(this._idGL)&&s.removeLayer(this._idGL),s.getSource(this._idGL)&&s.removeSource(this._idGL),this._canvas2D.parentNode.removeChild(this._canvas2D),this._canvas2D=void 0,this._context2D=void 0,this._canvasGL&&(this._canvasGL.parentNode.removeChild(this._canvasGL),this._canvasGL=void 0,this._contextGL=void 0),this._mapboxGroup=void 0,this._mapboxLayer2D=void 0,this._mapboxSource2D=void 0,this._mapboxLayerGL=void 0,this._mapboxSourceGL=void 0},l.prototype._onMapZooming=function(i){this._toggleVisibility(),this._render()},l.prototype._onMapZoomed=function(i){this._toggleVisibility(),this._render()},l.prototype._onMapMoving=function(i){this._render()},l.prototype._onMapMoved=function(i){this._render()},l.prototype._onMapResized=function(i){this._resize(this.map.width+2,this.map.height+2)},l.prototype._onPaletteChanged=function(i){if(this._contextGL){var s=this._contextGL;s.useProgram(this._rasterProgram);var _=this._palette,b=_.colors[0].step,D=_.colors[_.colors.length-1].step;s.uniform1f(this._paletteMinStepLocation,b),s.uniform1f(this._paletteMaxStepLocation,D),s.uniform2f(this._paletteSizeLocation,_.steps,1),s.uniform1f(this._tileTextureLowerBoundLocation,b),s.uniform1f(this._tileTextureUpperBoundLocation,D);var G=_.extendMinimumColor?1:0,Z=_.extendMaximumColor?1:0;s.uniform1i(this._paletteExtendMinLocation,G),s.uniform1i(this._paletteExtendMaxLocation,Z)}this._clearTextures(),this._render()},l.prototype._onMapEnabled=function(i){this.update()},l.prototype._onMapDisabled=function(i){},l.prototype._onMapStyled=function(i){switch(this.map.renderer){case Q.Renderer.WebDOM:break;case Q.Renderer.WebGL:this._mapboxSource2D=this.map._mapboxEngine.getSource(this._id2D),this._contextGL&&(this._mapboxSourceGL=this.map._mapboxEngine.getSource(this._idGL));break}this._resize(this.map.width+2,this.map.height+2)},l.prototype._onRasterStyleChanged=function(i){if(i.smoothingEnabled!==void 0){this._contextGL&&this._clearTextures();var s=this._context2D;s.imageSmoothingEnabled=i.smoothingEnabled,s.webkitImageSmoothingEnabled=i.smoothingEnabled,s.mozImageSmoothingEnabled=i.smoothingEnabled}this._render()},l.prototype._onTextStyleChanged=function(i){this._render()},l.prototype._onShapeStyleChanged=function(i){i.geometryChanged&&(this.shapeStyle._shapes=[]),this._render()},l.prototype._onContourStyleChanged=function(i){this._isPainting||(i.action==="remove"&&(i.isoline&&(this._removeGridIsoline(i.old),this._removeTileIsoline(i.old)),i.isoband&&(this._removeGridIsoband(i.old),this._removeTileIsoband(i.old))),i.isolineProperty==="value"&&(this._removeGridIsoline(i.old),this._removeTileIsoline(i.old)),i.isobandProperty==="range"&&(this._removeGridIsoband(i.old),this._removeTileIsoband(i.old)),i.isobandProperty==="fillColor"&&(this._contextGL||(this._removeGridIsoband(i.old),this._removeTileIsoband(i.old))),i.resolutionChanged&&(this._clearGridContours(),this._clearTileContours()),this._render())},l.prototype._onTimeChanged=function(i){if(this._timeMode===x.$i.Relative)this._timeRange._increment();else if(this._timeMode===x.$i.Absolute){var s=i.time;this._timeRange.inRange(s)!==this._timeRange.inRange(s.getTime()-1e3)&&this._render()}if(!!this._enableValidity){var _=performance.now(),b=_-this._lastRefreshed;b>this._refreshRate.totalMilliseconds&&this.update()}},l.prototype._onFrameChanged=function(i){this._enableValidity&&this.update()},l._vertexShaderSrc=`
		attribute vec4 a_position;
		attribute vec2 a_texcoord;
		uniform mat4 u_matrix;
		varying vec2 v_texcoord;
		void main() {
			gl_Position = u_matrix * a_position;
			v_texcoord = a_texcoord;
		}
	`,l._stencilShaderSrc=`
		#extension OES_texture_float : enable
		#extension OES_texture_float_linear : enable
		precision highp float;

		void main() {
			gl_FragColor = vec4(1);
			return;
		}
	`,l._fragmentShaderSrc=`
		#extension OES_texture_float : enable
		#extension OES_texture_float_linear : enable
		precision highp float;
		uniform sampler2D u_tile_texture;
		uniform float     u_tile_data_lower_bound;
		uniform float     u_tile_data_upper_bound;

		uniform sampler2D u_palette_texture;
		uniform float     u_palette_min_step;
		uniform float     u_palette_max_step;
		uniform vec2      u_palette_size;
		varying vec2 			v_texcoord;

		uniform bool     u_tile_data_filter;
		uniform bool     u_palette_extend_min;
		uniform bool     u_palette_extend_max;

		float norm(float value, float lower_bound, float upper_bound) {
				return (value - lower_bound) / (upper_bound - lower_bound);
		}

		// Used for missing data
		// Oleski cautioned risked about this
		bool isNan(float val) {
			return (val < 0.0 || 0.0 < val || val == 0.0) ? false : true;
		}

		// Entry Point
		void main() {

			// Finds the data value at the coordinate (r= index 0, g=index 1 etc)
			float temperature = texture2D(u_tile_texture, v_texcoord).r;

			// Validates anything that's not water is not a number
			if(isNan(temperature)){
				discard;
				return;
			}
			
			// Validates lower boundaries
			if(temperature < u_palette_min_step && !u_palette_extend_min){
				discard;
				return;
			}

			// Validates upper boundaries
			if(temperature > u_palette_max_step && !u_palette_extend_max){
				discard;
				return;
			}

			// Validates Filter
			if(u_tile_data_filter){
				if (temperature < u_tile_data_lower_bound) {
						discard;

						// NOTE
						//
						//  Need to return, because whether discard cancels execution depends entirely on
						//  the hardware.
						return;
				}
				if (temperature > u_tile_data_upper_bound) {
					discard;
					return;
				}
			}

			// Puts the data value on a scale from 0 to 1
			float norm_temperature = norm(temperature, u_palette_min_step, u_palette_max_step);

			// Oleksii magic 
			float min_palette_texel = 0.5 / u_palette_size.x;  // 0.5 * width of 1pixel-high canvas (palette) (deals with texels)
			float max_palette_texel = 1.0 - min_palette_texel; // Sets it on a mini-range, trying to get the palette location

			// Binds data to the color - gets clamped to min/max
			vec2 palette_texcoord =	vec2(clamp(norm_temperature, min_palette_texel, max_palette_texel), 0.0);

			// Setting the coordinates color, the gl_FragColor is being set to the mapping on the palette
			gl_FragColor = texture2D(u_palette_texture, palette_texcoord);
	}`,l._isobandFragmentShaderSrc=`
		#extension OES_texture_float : enable
		#extension OES_texture_float_linear : enable
		precision highp float;
		uniform sampler2D u_tile_blur_texture;
		uniform float     u_isoband_lower_bound;
		uniform float     u_isoband_upper_bound;
		uniform vec4			u_isoband_color;
		varying vec2 v_texcoord;

		bool isNan(float val) {
			return (val < 0.0 || 0.0 < val || val == 0.0) ? false : true;
		}

		void main() {
			float temperature = texture2D(u_tile_blur_texture, v_texcoord).r;

			if(isNan(temperature)){
				discard;
				return;
			}
			if (temperature < u_isoband_lower_bound) {
					discard;

					// NOTE
					//
					//  Need to return, because whether discard cancels execution depends entirely on
					//  the hardware.
					return;
			}
			if (temperature > u_isoband_upper_bound) {
				discard;
				return;
			}

			gl_FragColor = u_isoband_color;
	}`,l}(re.m),Vn=B(64026),pn=function(){function O(l,i,s,_){var b=this;this.id=(0,x.cm)(),this.action=l,this.message=i,this.transfer=s,this.callback=_,this.promise=new Promise(function(D,G){b.resolve=D,b.reject=G})}return O}(),Kn=function(){function O(){}return O._acquireWorker=function(){if(O._available.length!==0){var l=O._available.pop();return O._inUse.push(l),l}else if(O._inUse.length<O._limit){var i="self.onmessage="+O._work.toString(),s=new Blob([i],{type:"application/javascript"}),_=URL.createObjectURL(s),l=new Worker(_);return l.addEventListener("message",O._onMessage.bind(O)),O._inUse.push(l),l}else return null},O._returnWorker=function(l){var i=O._inUse.indexOf(l);O._inUse.splice(i,1),O._available.push(l)},O.execute=function(l,i,s,_){var b=new pn(l,i,s,_);return O._pendingTasks.push(b),O._next(),b.promise},O._next=function(){if(O._pendingTasks.length>0){var l=O._acquireWorker();if(l){var i=O._pendingTasks.shift();O._activeTasks[i.id]=i;var s=i.message;s.__id=i.id,s.__action=i.action,l.postMessage(s,i.transfer)}}},O._onMessage=function(l){var i=l.data.__id,s=O._activeTasks[i];s.callback&&s.callback(l.data),s.resolve(l.data),delete O._activeTasks[i],O._returnWorker(l.target),O._next()},O._available=[],O._inUse=[],O._limit=window.navigator.hardwareConcurrency||8,O._pendingTasks=[],O._activeTasks={},O._work=function(l){var i=l.data,s=i.__action;switch(s){case"add":G(i);break;case"concat":Z(i);break;case"rasterize":_(i);break;case"shape":b(i);break;case"contour":D(i);break}function _(qe){var nt=qe.layerId,Xe=qe.tileKey,It=qe.floatArray,kt=new Float32Array(It),Nt=qe.imageBuffer,Rt=new Uint8ClampedArray(Nt),Qt=qe.colors,Jt=new DataView(Qt),pi=qe.minimumColor,vi=qe.maximumColor,gi=qe.extendMinimumColor,jt=qe.extendMaximumColor,$t=qe.dimension,Oi=qe.precision,Ui=0,xi,li,Fi,Wi=qe.filter,tr=Wi.length,Zi=tr>0;for(xi=0,li=0;xi<$t&&li<$t;li++,xi=li===$t?xi+1:xi,li=li===$t?li=0:li){var Yi=kt[Ui],ar=[0,0,0,0];if(!isNaN(Yi))if(!Zi)ar=te(Yi,Jt,Oi,pi,vi,gi,jt);else for(Fi=0;Fi<tr;Fi++){var rr=Wi[Fi];if(Yi>=rr.start&&Yi<=rr.end){ar=te(Yi,Jt,Oi,pi,vi,gi,jt);break}}var nr=Ui*4;Rt[nr]=ar[0],Rt[nr+1]=ar[1],Rt[nr+2]=ar[2],Rt[nr+3]=ar[3],Ui++}var br={layerId:nt,tileKey:Xe,imageBuffer:Nt,floatArray:It},Bn=[It,Nt];At(br,Bn)}function b(qe){for(var nt=qe.layerId,Xe=qe.tileKey,It=qe.floatArray,kt=new Float32Array(It),Nt=qe.vertices,Rt=qe.shapePoints,Qt=qe.tileX,Jt=qe.tileY,pi=qe.tileZ,vi=qe.dimension,gi=qe.spreadWidth,jt=qe.spreadHeight,$t=qe.staggerWidth,Oi=qe.staggerHeight,Ui=qe.staggeredRotation,xi=Nt===1,li=pe(Qt,Jt,vi,gi,jt,$t,Oi),Fi=[[],[],[],[],[],[],[],[],[]],Wi=[],tr=Ui%(2*Math.PI/Nt)!=0,Zi=0,Yi=li.length;Zi<Yi;Zi++){var ar=li[Zi];xi?ae(Rt,ar,Qt,Jt,pi,vi,kt,Fi,Wi):Pe(Rt,ar,Qt,Jt,pi,vi,kt,Fi,Wi,tr)}var rr={layerId:nt,tileKey:Xe,floatArray:It,shapes:Wi,incompleteShapes:Fi},nr=[It];At(rr,nr)}function D(qe){var nt=qe.layerId,Xe=qe.tileKey,It=qe.floatArray,kt=new Float32Array(It),Nt=qe.isolines,Rt=qe.isobands,Qt=qe.sigma,Jt=qe.dimension,pi=qe.isobandColors,vi=qe.blur,gi={},jt={},$t={},Oi,Ui;vi?(Oi=st(kt,Jt,Jt,Qt),Ui=Oi.buffer):qe.gaussBlurBuffer?(Ui=qe.gaussBlurBuffer,Oi=new Float32Array(Ui)):Oi=kt;for(var xi=0,li=Nt.length;xi<li;xi++){var Fi=Nt[xi];gi[Fi]=Fe(Fi,Oi,Jt,Jt)}for(var Wi=0,tr=Rt.length;Wi<tr;Wi++){var Zi=Rt[Wi],Yi=pi[Wi],ar=Zi[0],rr=Zi[1],nr=ar+"_"+rr,br=at(Zi,Oi,Jt,Jt,Yi);br?(jt[nr]=br.texture,$t[nr]=br.labelPoint):(jt[nr]=void 0,$t[nr]=void 0)}var Bn={layerId:nt,tileKey:Xe,floatArray:It,segments:gi,textures:jt,labels:$t},en=[It];Ui&&(Bn.gaussArray=Ui,en.push(Ui));for(var Oa in jt)jt[Oa]&&en.push(jt[Oa].buffer);At(Bn,en)}function G(qe){var nt=qe.left+qe.right,Xe={result:nt};At(Xe)}function Z(qe){var nt=qe.text.join(" "),Xe={result:nt};At(Xe)}function te(qe,nt,Xe,It,kt,Nt,Rt){var Qt=Math.pow(10,Xe),Jt=(Math.floor(qe*Qt)-Math.ceil(It.step*Qt))*4,pi;if(Jt>=0&&Jt<nt.byteLength){var vi=nt.getUint8(Jt),gi=nt.getUint8(Jt+1),jt=nt.getUint8(Jt+2),$t=nt.getUint8(Jt+3);pi=[vi,gi,jt,$t]}if(!pi){if(Jt==null||isNaN(Jt))return[0,0,0,0];Nt&&Jt<0?pi=It.rgba:Rt&&Jt>=nt.byteLength?pi=kt.rgba:pi=[0,0,0,0]}return pi}function ae(qe,nt,Xe,It,kt,Nt,Rt,Qt,Jt){ve(qe[0],nt,Xe,It,kt,Nt,Rt,Qt,Jt)}function Pe(qe,nt,Xe,It,kt,Nt,Rt,Qt,Jt,pi){pi&&nt.staggered?ve(qe[1],nt,Xe,It,kt,Nt,Rt,Qt,Jt):ve(qe[0],nt,Xe,It,kt,Nt,Rt,Qt,Jt)}function ve(qe,nt,Xe,It,kt,Nt,Rt,Qt,Jt){for(var pi=nt.x,vi=nt.y,gi=Xe*Nt,jt=It*Nt,$t=Math.pow(2,kt)*Nt,Oi=Number.MAX_VALUE,Ui=Number.MIN_VALUE,xi=0,li=0,Fi=[],Wi=[],tr,Zi=0,Yi=qe.length;Zi<Yi;Zi++){var ar=qe[Zi],rr=pi+ar[0],nr=vi+ar[1],br=null;if(!(nr<0||nr>=$t)){if(nr<jt){rr<gi&&(Fi[0]=!0),rr>=gi+Nt?Fi[2]=!0:Fi[1]=!0,Wi.push([rr,nr]);continue}if(nr>=jt+Nt){rr<gi&&(Fi[6]=!0),rr>=gi+Nt?Fi[8]=!0:Fi[7]=!0,Wi.push([rr,nr]);continue}if(rr<gi){Fi[3]=!0,Wi.push([rr,nr]);continue}if(rr>=gi+Nt){Fi[5]=!0,Wi.push([rr,nr]);continue}var Bn=(nr-jt)*Nt+rr-gi;br=Rt[Bn],!isNaN(br)&&(br<Oi&&(Oi=br),br>Ui&&(Ui=br),xi+=br,li++)}}if(tr={min:Oi,max:Ui,sum:xi,nPoints:li,staggered:nt.staggered,missingPoints:Wi,centerX:pi,centerY:vi},tr.missingPoints.length>0)for(var Zi=0,en=Fi.length;Zi<en;Zi++)Fi[Zi]&&Qt[Zi].push(tr);else tr.nPoints>0&&Jt.push(tr)}function pe(qe,nt,Xe,It,kt,Nt,Rt){for(var Qt=[],Jt=qe*Xe,pi=nt*Xe,vi=(qe+1)*Xe,gi=(nt+1)*Xe,jt=Math.ceil(Jt/It),$t=jt*It,Oi=Math.ceil(pi/kt),Ui=Oi*kt,xi=Oi%2!=0,li,Fi=jt%2!=0,Wi=Ui;Wi<gi;Wi+=kt){li=Fi;var tr=$t;xi&&(tr-(It-Nt)>=Jt?tr-=It-Nt:(tr+=Nt,li=!li));for(var Zi=tr;Zi<vi;Zi+=It){var Yi=Wi;li&&(Yi+=Rt);var ar={x:Zi,y:Yi,staggered:li};Qt.push(ar),li=!li}xi=!xi}return Qt}function Fe(qe,nt,Xe,It,kt){for(var Nt=[],Rt=0,Qt=It-1;Rt<Qt;Rt++)for(var Jt=nt[Rt*Xe],pi=nt[(Rt+1)*Xe],vi=void 0,gi=void 0,jt=0,$t=Xe-1;jt<$t;jt++)if(vi=Jt,Jt=nt[Rt*Xe+jt+1],gi=pi,pi=nt[(Rt+1)*Xe+jt+1],!(isNaN(vi)||isNaN(Jt)||isNaN(gi)||isNaN(pi))&&!(kt&&(vi===kt||Jt===kt||gi===kt||pi===kt)))for(var Oi=[vi,Jt,pi,gi],Ui=ke(qe,Oi),xi=Ze(qe,Ui,Oi),li=0,Fi=xi.length;li<Fi;li++){var Wi=jt+xi[li][0][0],tr=Rt+xi[li][0][1],Zi=jt+xi[li][1][0],Yi=Rt+xi[li][1][1],ar=[Wi,tr,Zi,Yi];Nt.push(ar)}return Nt}function ke(qe,nt){var Xe=0;return nt[0]>=qe&&Xe++,Xe=Xe<<1,nt[1]>=qe&&Xe++,Xe=Xe<<1,nt[2]>=qe&&Xe++,Xe=Xe<<1,nt[3]>=qe&&Xe++,Xe}function Ze(qe,nt,Xe){var It,kt,Nt,Rt,Qt=[];switch(nt){case 0:case 15:break;case 1:case 14:It=[0,(qe-Xe[0])/(Xe[3]-Xe[0])],kt=[(qe-Xe[3])/(Xe[2]-Xe[3]),1];break;case 2:case 13:It=[(qe-Xe[3])/(Xe[2]-Xe[3]),1],kt=[1,(qe-Xe[1])/(Xe[2]-Xe[1])];break;case 3:case 12:It=[0,(qe-Xe[0])/(Xe[3]-Xe[0])],kt=[1,(qe-Xe[1])/(Xe[2]-Xe[1])];break;case 4:case 11:It=[(qe-Xe[0])/(Xe[1]-Xe[0]),0],kt=[1,(qe-Xe[1])/(Xe[2]-Xe[1])];break;case 5:case 10:var Jt=Xe.reduce(function(pi,vi){return pi+vi})/4;nt===5&&Jt>=qe||nt===10&&Jt<qe?(It=[0,(qe-Xe[0])/(Xe[3]-Xe[0])],kt=[(qe-Xe[0])/(Xe[1]-Xe[0]),0],Nt=[(qe-Xe[3])/(Xe[2]-Xe[3]),1],Rt=[1,(qe-Xe[1])/(Xe[2]-Xe[1])]):(It=[0,(qe-Xe[0])/(Xe[3]-Xe[0])],kt=[(qe-Xe[3])/(Xe[2]-Xe[3]),1],Nt=[(qe-Xe[0])/(Xe[1]-Xe[0]),0],Rt=[1,(qe-Xe[1])/(Xe[2]-Xe[1])]);break;case 6:case 9:It=[(qe-Xe[3])/(Xe[2]-Xe[3]),1],kt=[(qe-Xe[0])/(Xe[1]-Xe[0]),0];break;case 7:case 8:It=[0,(qe-Xe[0])/(Xe[3]-Xe[0])],kt=[(qe-Xe[0])/(Xe[1]-Xe[0]),0];break}return It&&kt&&Qt.push([It,kt]),Nt&&Rt&&Qt.push([Nt,Rt]),Qt}function at(qe,nt,Xe,It,kt){for(var Nt=Xe*It*4,Rt=new Uint8ClampedArray(Nt),Qt=qe[0],Jt=qe[1],pi=kt,vi=0,gi=0,jt=0,$t=0,Oi=It;$t<Oi;$t++){for(var Ui=-1,xi=0,li=0,Fi=Xe;li<Fi;li++){var Wi=$t*Xe+li,tr=nt[Wi];if((tr-Jt)*(tr-Qt)<=0){Ui===-1&&(Ui=li);var Zi=Wi*4;Rt[Zi]=pi[0],Rt[Zi+1]=pi[1],Rt[Zi+2]=pi[2],Rt[Zi+3]=pi[3],xi++}else xi>jt+10&&(jt=xi,gi=$t,vi=Ui+xi/2),xi=0,Ui=-1}xi>=jt&&Math.abs(gi-Oi/2)>Math.abs($t-Oi/2)&&(jt=xi,gi=$t,vi=Ui+xi/2)}if(vi!==-1)return{texture:Rt,labelPoint:[vi,gi]}}function Ve(qe,nt){var Xe=Math.sqrt(12*qe*qe/nt+1),It=Math.floor(Xe);It%2==0&&It--;for(var kt=It+2,Nt=(12*qe*qe-nt*It*It-4*nt*It-3*nt)/(-4*It-4),Rt=Math.round(Nt),Qt=[],Jt=0;Jt<nt;Jt++)Qt.push(Jt<Rt?It:kt);return Qt}function st(qe,nt,Xe,It){var kt=Ve(It,3),Nt=qe.slice(),Rt=qe.slice();return Pt(Nt,Rt,nt,Xe,(kt[0]-1)/2),Pt(Rt,Nt,nt,Xe,(kt[1]-1)/2),Pt(Nt,Rt,nt,Xe,(kt[2]-1)/2),Rt}function Pt(qe,nt,Xe,It,kt){for(var Nt=0,Rt=qe.length;Nt<Rt;Nt++)nt[Nt]=qe[Nt];$e(nt,qe,Xe,It,kt),Ct(qe,nt,Xe,It,kt)}function $e(qe,nt,Xe,It,kt){for(var Nt=1/(kt+kt+1),Rt=0;Rt<It;Rt++){for(var Qt=Rt*Xe,Jt=Qt,pi=Qt+kt,vi=qe[Qt],gi=qe[Qt+Xe-1],jt=(kt+1)*vi,$t=0;$t<kt;$t++)jt+=qe[Qt+$t];for(var $t=0;$t<=kt;$t++)jt+=qe[pi++]-vi,nt[Qt++]=jt*Nt;for(var $t=kt+1;$t<Xe-kt;$t++)jt+=qe[pi++]-qe[Jt++],nt[Qt++]=jt*Nt;for(var $t=Xe-kt;$t<Xe;$t++)jt+=gi-qe[Jt++],nt[Qt++]=jt*Nt}}function Ct(qe,nt,Xe,It,kt){for(var Nt=1/(kt+kt+1),Rt=0;Rt<Xe;Rt++){for(var Qt=Rt,Jt=Qt,pi=Qt+kt*Xe,vi=qe[Qt],gi=qe[Qt+Xe*(It-1)],jt=(kt+1)*vi,$t=0;$t<kt;$t++)jt+=qe[Qt+$t*Xe];for(var $t=0;$t<=kt;$t++)jt+=qe[pi]-vi,nt[Qt]=jt*Nt,pi+=Xe,Qt+=Xe;for(var $t=kt+1;$t<It-kt;$t++)jt+=qe[pi]-qe[Jt],nt[Qt]=jt*Nt,Jt+=Xe,pi+=Xe,Qt+=Xe;for(var $t=It-kt;$t<It;$t++)jt+=gi-qe[Jt],nt[Qt]=jt*Nt,Jt+=Xe,Qt+=Xe}}function At(qe,nt){qe.__id=l.data.__id,this.postMessage(qe,nt)}},O}(),Ko=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Eo=function(O){Ko(l,O);function l(i){i===void 0&&(i={});var s=O.call(this,i)||this;return s.stencil=void 0,s.productKey=void 0,s.apiKey=void 0,s.gridUrl=void 0,s.infoPollingInterval=void 0,s.infoPollingTimeout=void 0,s.validBackward=void 0,s.validForward=void 0,s.dimension=void 0,s.cacheLimit=void 0,s.pruneInterval=void 0,s.pruneAutomatically=void 0,(0,x.f0)(s,i),s}return l}(da),Hn=function(O){Ko(l,O);function l(i){var s=O.call(this,i instanceof Eo?i:new Eo(i))||this;s._hasMetaData=!1,s._cachedTiles={},s._pendingTiles={},s._pendingTilesCount=0,s._pendingRequests={},s._meta={},s._isAnimate=!1,s._maxNativeZoom=13,s._isFrameChanging=!1,s._isUpdating=!1,s._updatingRequests={},s._paintedTiles=[],s._parentTiles=[],s._shapeTiles=[],s._tilesInUse={},s.modelRunChanged=new W.j,s.metaDataLoaded=new W.j,s.metaDataModified=new W.j,s._apiKey=i.apiKey,s._productKey=i.productKey,s._gridUrl=i.gridUrl,s._infoPollingInterval=i.infoPollingInterval||new Ue.i(6e4),s._infoPollingTimeout=i.infoPollingTimeout||new Ue.i(1e4),s._dimension=i.dimension||256,s._cacheLimit=i.cacheLimit||5e3,s._pruneInterval=i.pruneInterval||new Ue.i(1e4),s._pruneAutomatically=(0,x.le)(i.pruneAutomatically)?!0:i.pruneAutomatically,s._stencil=i.stencil||F.yn.None;var _=s._timeManager=new be.l;return _._validBackward=i.validBackward||Ue.i.min,_._validForward=i.validForward||Ue.i.max,_._timeRange=s._timeRange,s._pruneAutomatically&&(s._pruneTimer=setInterval(function(){return s._pruneTiles()},s._pruneInterval.totalMilliseconds)),s}return Object.defineProperty(l.prototype,"modelRuns",{get:function(){return this._timeManager._modelRuns},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"validTimes",{get:function(){return this._timeManager._validTimes},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"stencil",{get:function(){return this._stencil},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"hasMetaData",{get:function(){return this._hasMetaData},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"currentDiscreteTime",{get:function(){return this._timeManager._currentDiscreteTime},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"pruneInterval",{get:function(){return this._pruneInterval},set:function(i){var s=this;(0,x.le)(i)||i.equals(this._pruneInterval)||(clearInterval(this._pruneTimer),this._pruneInterval=i,this._pruneTimer=setInterval(function(){return s._pruneTiles()},this._pruneInterval.totalMilliseconds))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cacheLimit",{get:function(){return this._cacheLimit},set:function(i){var s=this;(0,x.le)(i)||i===this._cacheLimit||(i<this._cacheLimit&&this._pruneTiles(i),this._cacheLimit=i,clearInterval(this._pruneTimer),this._pruneTimer=setInterval(function(){return s._pruneTiles()},this._pruneInterval.totalMilliseconds))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"pruneAutomatically",{get:function(){return this._pruneAutomatically},set:function(i){var s=this;(0,x.le)(i)||i===this._pruneAutomatically||(this._pruneAutomatically=i,this._pruneAutomatically?this._pruneTimer=setInterval(function(){return s._pruneTiles()},this._pruneInterval.totalMilliseconds):clearInterval(this._pruneTimer))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"timeRange",{get:function(){return this._timeRange},set:function(i){i!==this._timeRange&&(this._timeRange=i,this._convertInfo()&&(this._purge(),this.update()))},enumerable:!0,configurable:!0}),l.prototype._load=function(i){O.prototype._load.call(this,!0),this._infoClient?this._hasMetaData&&this.update():this._startService()},l.prototype._unload=function(){this._hasMetaData=!1,this._timeManager._currentDiscreteTime=void 0,this._stopService();var i=this._pendingRequests,s=this._pendingTiles;for(var _ in i){var b=i[_];b.abort(),delete i[_],delete s[_],this._pendingTilesCount--}this._isAnimate&&(this.map.animator.frameChanging.removeListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.removeListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.removeListener(this._onTimeChanged,this)),this._palette._clearTexture(),O.prototype._unload.call(this)},l.prototype._startService=function(i,s){if(!this._infoClient){var _=s||this._apiKey||this.map.sunApiKey,b=i||this._gridUrl||this.map.sunGridUrl;b=b+"&meta=true",b=b.replace("{productKey}",this._productKey),b=b.replace("{apiKey}",_),this._infoClient=new Br.U(b),this._infoClient.timeout=this._infoPollingTimeout.totalMilliseconds,this._infoClient.pollingInterval=this._infoPollingInterval.totalMilliseconds,this._infoClient.modified.addListener(this._onInfoLoaded,this),this._infoClient.startPolling()}},l.prototype._stopService=function(){this._infoClient&&(this._infoClient.stopPolling(),this._infoClient.modified.removeListener(this._onInfoLoaded,this),delete this._infoClient)},l.prototype._convertInfo=function(){var i=this._infoClient.objectLiteral,s=this._productKey.split(":"),_=i.layers[s[0]][s[1]],b=this._timeManager;if(_.meta){if(this._meta=_.meta,_.meta.ttl){var D=_.meta.ttl*1e3*2.5;b._validForward=new Ue.i(D)}for(var G=0,Z=_.meta.tileset["Web Mercator"].tiles,te=0,ae=Z.length;te<ae;te++){var Pe=Z[te];Pe.lod>G&&(G=Pe.lod)}this._maxNativeZoom=Math.min(G+6,13)}for(var ve=[],pe=[],Fe=_.dimensions.length>0?Math.max(_.dimensions.length-1,1):0,te=0;te<Fe;te++){var ke=_.dimensions[te];if(ke.rt){for(var Ze=parseInt(ke.rt),at=new Date(Ze),Ve=new rt.o(at),st=0,Pt=ke.t.length;st<Pt;st++){var $e=ke.t[st],Ct=parseInt($e);if(this._timeRange.inRange(Ct)){var At=new Date(Ct),qe=new Mt.T(At);Ve.validTimes.push(qe)}}pe.push(Ve)}else{var nt=parseInt(ke.t[0]);if(this._timeRange.inRange(nt)){var Xe=new Date(nt),qe=new Mt.T(Xe);ve.push(qe)}}}var It=!1;if(b._validTimes&&b._validTimes.length>0||ve.length>0){var kt=JSON.stringify(b._validTimes),Nt=JSON.stringify(ve);It=kt!==Nt}else if(b._modelRuns&&b._modelRuns.length>0||pe.length>0){var Rt=JSON.stringify(b._modelRuns),Qt=JSON.stringify(pe);It=Rt!==Qt}return b._modelRuns=pe.length>0?pe:null,b._validTimes=ve.length>0?ve:null,this._isAnimate=pe.length>0||ve.length>0,It},l.prototype._render=function(i){if(i===void 0&&(i=!1),!(!this.map||!this.map.isEnabled||this._isFrameChanging||this._isUpdating||!this._context2D)&&!(this.map.animator.isPaused&&this.map.animator.isPlaying)){this._mapboxSource2D&&this._mapboxSource2D.play(),this._mapboxSourceGL&&this._mapboxSourceGL.play();var s=this._timeManager._currentDiscreteTime;if(!s||!s.validTime){s&&this._changeLoadState(x.jd.Loaded),this._clearSurface(),this._mapboxSource2D&&this._mapboxSource2D.pause(),this._mapboxSourceGL&&this._mapboxSourceGL.pause();return}if(!this._timeRange.inRange(this.map.clock.time)){this._changeLoadState(x.jd.Loaded),this._clearSurface(),this._mapboxSource2D&&this._mapboxSource2D.pause(),this._mapboxSourceGL&&this._mapboxSourceGL.pause();return}if(this._isVisible){this._shapeTiles.length=0,this._paintedTiles.length=0,this._parentTiles.length=0;var _=this._deriveTiles(s),b=this._shapeEnabled?this._deriveShapeTiles(s):[],D=this._cachedTiles,G=_.length,Z=this._pendingRequests,te=this._pendingTiles;for(var ae in Z){var Pe=Z[ae];if(!Pe.isPreserved){for(var ve=!1,pe=0;pe<G;pe++){var Fe=_[pe];if(Fe.key===ae){ve=!0;break}}ve||(Pe.abort(),delete Z[ae],delete te[ae],this._pendingTilesCount--)}}for(var pe=0;pe<G;pe++){var Fe=_[pe],ae=Fe.key,ke=D[ae];if(ke){this._paintedTiles.push(ke);continue}this._requestTile(Fe);for(var Ze=void 0,at=Fe.parent;at&&at.z>0;){var Ve=at.key;if(Ze===void 0&&D.hasOwnProperty(Ve)){Ze=D[Ve];break}at=at.parent}Ze&&this._paintedTiles.indexOf(Ze)===-1&&this._parentTiles.push(Ze)}for(var st=0,Pt=b;st<Pt.length;st++){var $e=Pt[st],Ct=$e.key,ke=D[Ct];if(ke){this._shapeTiles.push(ke);continue}this._requestTile($e,!0)}this._paint()}else this._clearSurface()}},l.prototype._onRasterized=function(i){var s=this._cachedTiles[i.tileKey];if(s){delete this._tilesInUse[i.tileKey];var _=new Uint8ClampedArray(i.imageBuffer);s.dataBuffer=i.floatArray,s.data=new Float32Array(i.floatArray),s.imageBuffer=i.imageBuffer,s.bitmap=new ImageData(_,this._dimension,this._dimension)}},l.prototype._onShaped=function(i){var s=this._cachedTiles[i.tileKey];s&&(delete this._tilesInUse[i.tileKey],s.dataBuffer=i.floatArray,s.data=new Float32Array(i.floatArray),s.shapes=i.shapes,s.incompleteShapes=i.incompleteShapes)},l.prototype._onContoured=function(i){var s=this._cachedTiles[i.tileKey];if(s){delete this._tilesInUse[i.tileKey],s.dataBuffer=i.floatArray,s.data=new Float32Array(i.floatArray),i.gaussArray&&(s.gaussBlurBuffer=i.gaussArray,s.gaussBlurData=new Float32Array(i.gaussArray));for(var _ in i.segments)s.isolineData.hasOwnProperty(_)||(s.isolineData[_]={},s.isolineData[_].segments=i.segments[_]);for(var b in i.textures)if(!s.isobandData.hasOwnProperty(b))if(i.textures[b]){var D=i.textures[b];s.isobandData[b]={},s.isobandData[b].bitmap=new ImageData(D,s.dimension,s.dimension),s.isobandData[b].labelPoint=i.labels[b]}else s.isobandData[b]=void 0}},l.prototype._paint=function(){var i=this;if(!this._isPainting){var s=[],_=this._tilesInUse;if(this._rasterEnabled&&!this._contextGL)for(var b=this._palette,D=this._filter,G=0,Z=this._paintedTiles.length;G<Z;G++){var te=this._paintedTiles[G];if(te.dataBuffer&&te.dataBuffer.byteLength>0&&!te.bitmap&&!_[te.key]){_[te.key]=!0;var ae=b._hash.buffer.slice(0);te.imageBuffer||(te.imageBuffer=new ArrayBuffer(this._dimension*this._dimension*4));var Pe={layerId:this.id,floatArray:te.dataBuffer,imageBuffer:te.imageBuffer,tileKey:te.key,colors:ae,minimumColor:b.colors[0],maximumColor:b.colors[b.colors.length-1],extendMinimumColor:b.extendMinimumColor,extendMaximumColor:b.extendMaximumColor,filter:D,dimension:this._dimension,precision:b.precision},ve=[te.dataBuffer,te.imageBuffer,ae];s.push(Kn.execute("rasterize",Pe,ve,this._onRasterized.bind(this)))}}if(this._shapeEnabled){var pe=this._shapeStyle;pe._shapes.length===0&&this._determineShapeGeometryV2(),pe.keyZooms.length===0&&(this._shapeTiles=this._paintedTiles);for(var G=0,Z=this._shapeTiles.length;G<Z;G++){var te=this._shapeTiles[G];if(te.dataBuffer&&te.dataBuffer.byteLength>0&&!te.shapes&&!_[te.key]){_[te.key]=!0;var Pe={layerId:this.id,floatArray:te.dataBuffer,tileKey:te.key,dimension:te._dimension,vertices:pe.vertices,shapePoints:pe._shapes.slice(),spreadWidth:pe.spread.width,spreadHeight:pe.spread.height,staggerWidth:pe.staggeredOffset.width,staggerHeight:pe.staggeredOffset.height,staggeredRotation:pe.staggeredRotation.radians,tileX:te.x,tileY:te.y,tileZ:te.z},ve=[te.dataBuffer];s.push(Kn.execute("shape",Pe,ve,this._onShaped.bind(this)))}}}if(this._contourEnabled)for(var Fe=this.contourStyle,ke=-(Fe.resolution-1)*10,Ze=0,at=this._paintedTiles.length;Ze<at;Ze++){var te=this._paintedTiles[Ze];if(te.dataBuffer&&te.dataBuffer.byteLength>0&&!_[te.key]){te.dataRange||this._determineTileRange(te);for(var Ve=[],st=0,Pt=Fe.isolines;st<Pt.length;st++){var $e=Pt[st];te.isolineData[$e.value]||($e.value>=te.dataRange[0]&&$e.value<=te.dataRange[1]?Ve.push($e.value):te.isolineData[$e.value]={segments:[]})}var Ct=[],At=[],qe=!1;if(this._contextGL)!te.hasBlurred&&ke>0&&Fe.isobands.length>0&&(qe=!0);else for(var nt=0,Xe=Fe.isobands;nt<Xe.length;nt++){var It=Xe[nt],kt=It.range.start,Nt=It.range.end,Rt=kt+"_"+Nt,Qt=[kt,Nt];kt<=te.dataRange[1]&&te.dataRange[0]<=Nt?te.isobandData.hasOwnProperty(Rt)||(Ct.push(Qt),At.push(It.fillColor)):te.isobandData[Rt]=void 0}if(Ve.length>0||Ct.length>0||qe){ke>0&&!te.hasBlurred&&(te.gaussBlurBuffer||(te.gaussBlurBuffer=new ArrayBuffer(te.data.byteLength)),te.hasBlurred=!0),_[te.key]=!0;var Pe={layerId:this.id,floatArray:te.dataBuffer,tileKey:te.key,dimension:te._dimension,isolines:Ve,isobands:Ct,isobandColors:At,sigma:ke,blur:te.hasBlurred},ve=[te.dataBuffer];te.hasBlurred&&(Pe.gaussBlurBuffer=te.gaussBlurBuffer,ve.push(te.gaussBlurBuffer)),s.push(Kn.execute("contour",Pe,ve,this._onContoured.bind(this)))}}}if(s.length!==0){this._isPainting=!0,Promise.all(s).then(function(Oi){if(i._isPainting=!1,i._paint(),i._shapeStyle.change(),i._contourEnabled){for(var Ui=0,xi=i._contourStyle.isolines;Ui<xi.length;Ui++){var li=xi[Ui];li.change()}for(var Fi=0,Wi=i._contourStyle.isobands;Fi<Wi.length;Fi++){var tr=Wi[Fi];tr.change()}}});return}else{if(this._shapeStyle._isChanging=!1,this._contourEnabled){for(var Jt=0,pi=this._contourStyle.isolines;Jt<pi.length;Jt++){var $e=pi[Jt];$e._isChanging=!1}for(var vi=0,gi=this._contourStyle.isobands;vi<gi.length;vi++){var It=gi[vi];It._isChanging=!1}}var jt=this._paintedTiles;this._applyCanvasViewport(),this._clearSurface();var $t=this._context2D;$t.imageSmoothingEnabled=this.rasterStyle.smoothingEnabled,$t.webkitImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,$t.mozImageSmoothingEnabled=this.rasterStyle.smoothingEnabled,this._rasterEnabled&&(this._contextGL&&this._paintStencilTilesGL(jt),this._paintRasterTiles(jt,this._parentTiles)),this._shapeEnabled&&this._paintShapesAsync(this._shapeTiles),this._contourEnabled&&this._paintContourTilesAsync(jt),this._textEnabled&&this._paintTextTiles(jt),this._pendingTilesCount===0&&this._changeLoadState(x.jd.Loaded)}this._mapboxSource2D&&this._mapboxSource2D.pause(),this._mapboxSourceGL&&this._mapboxSourceGL.pause()}},l.prototype._requestTile=function(i,s){var _=this;if(s===void 0&&(s=!1),!this._pendingTiles.hasOwnProperty(i.key)&&this.map&&i.discreteTime&&i.discreteTime.validTime){var b=this._apiKey||this.map.sunApiKey,D=this._meta["data-href"];D=D.replace("v2/tiler/data","v2/tiler/extras/data"),D+="&stencil={stencil}&interpolation=bicubic",i.discreteTime.modelRun?D=D.replace("{rt}",i.discreteTime.modelRun.value.getTime().toString()):D=D.replace("&rt={rt}",""),D=D.replace("{products}",this._productKey),D=D.replace("{t}",i.discreteTime.validTime.value.getTime().toString()),D=D.replace("{lod}",i.z.toString()),D=D.replace("{x}",i.x.toString()),D=D.replace("{y}",i.y.toString()),D=D.replace("{z}",i.elevation),D=D.replace("{apiKey}",b);var G="false";switch(this._stencil){case F.yn.Land:G="true";break;case F.yn.Water:G="compliment";break}D=D.replace("{stencil}",G),this.loadState!=x.jd.Loading&&this._changeLoadState(x.jd.Loading);var Z=Br.U.createCorsRequest("GET",D,!0,!1);Z.onerror=function(){_._registerTile(i)},Z.timeout=function(){_._registerTile(i)},Z.onabort=function(){_._registerTile(i)},Z.onprogress=function(){},Z.onload=function(){_._registerTile(i),_._formatTile(Z.response,i),_._cachedTiles[i.key]=i,!_._isFrameChanging&&_._validateTile(i)&&_._render()},this._pendingTiles[i.key]=i,this._pendingRequests[i.key]=Z,this._isUpdating&&(this._updatingRequests[i.key]=Z),this._pendingTilesCount++,Z.isPreserved=s,Z.responseType="arraybuffer",Z.send()}},l.prototype._formatTile=function(i,s){if(!(!this.map||!this.map.isEnabled)){var _=s.key;if(!this._cachedTiles[_]){var b=new DataView(i);if(b.byteLength>0){for(var D=new Float32Array(this._dimension*this._dimension),G=0,Z=D.length;G<Z;G++){var te=b.getFloat32(G*4);D[G]=te}s.data=D,s.dataBuffer=D.buffer}else s.data=void 0}}},l.prototype._registerTile=function(i){var s=i.key;this._pendingTiles[s]&&(this._pendingTilesCount--,delete this._pendingTiles[s]),delete this._pendingRequests[s],delete this._updatingRequests[s],this._pendingTilesCount<=0&&this.loadState!=x.jd.Loaded&&(this._pendingTilesCount=0,this._changeLoadState(x.jd.Loaded))},l.prototype._deriveTiles=function(i){for(var s=this.map.zoomLevel<this._maxNativeZoom?this.map.zoomLevel:this._maxNativeZoom,_=this.map._calculateTiles(s,this._dimension,!1,function(Z,te,ae,Pe){return new Vn.K(Z,te,ae,Pe)}),b=0,D=_.length;b<D;b++){var G=_[b];G.discreteTime=i,G.elevation=this._depth}return _},l.prototype._deriveShapeTiles=function(i){for(var s=this._shapeStyle.keyZooms,_=this.map.zoomLevel<this._maxNativeZoom?Math.floor(this.map.zoomLevel):this._maxNativeZoom,b=null,D=0,G=s;D<G.length;D++){var Z=G[D];if(_<Z)break;b=Z}if(b){for(var te=this.map._calculateTiles(b,this._dimension,!1,function(pe,Fe,ke,Ze){return new Vn.K(pe,Fe,ke,Ze)}),ae=0,Pe=te.length;ae<Pe;ae++){var ve=te[ae];ve.discreteTime=i}return te}return[]},l.prototype._validateTile=function(i){var s=this.map.bounds;s.normalize();var _=i.data&&s.intersects(i.bounds);return _},l.prototype._pruneTiles=function(i){var s=this,_=Object.keys(this._cachedTiles),b=(0,x.le)(i)?this._cacheLimit:i;if(_.length>b)for(var D=_.sort(function(Pe,ve){return s._cachedTiles[ve].lastAccessed-s._cachedTiles[Pe].lastAccessed}),G=D.slice(b),Z=0,te=G.length;Z<te;Z++){var ae=G[Z];delete this._cachedTiles[ae]}},l.prototype._preloadTiles=function(i){if(this._isVisible){if(!this._timeRange.inRange(this.map.clock.time))return;for(var s=this._deriveTiles(i),_=this.map.zoomLevel,b=this._maxNativeZoom,D=this._cachedTiles,G=s.length,Z=0;Z<G;Z++){var te=s[Z],ae=te.key;D.hasOwnProperty(ae)||this._pendingTiles.hasOwnProperty(ae)||Math.floor(_)<=Math.floor(b)&&this._requestTile(te)}}},l.prototype._preloadWorldTiles=function(i){var s=this;if(!(!i||!i.validTime)&&this.minimumZoom<2){for(var _=[],b=0;b<2;b++)for(var D=0;D<2;D++){var G=new Vn.K(1,b,D,!1);G.discreteTime=i,this._cachedTiles.hasOwnProperty(G.key)||_.push(G)}setTimeout(function(){for(var Z=0,te=_.length;Z<te;Z++)s._requestTile(_[Z],!0)},10)}},l.prototype._purge=function(){var i=this._timeManager,s=i._modelRuns&&i._modelRuns.length>0,_=i._validTimes&&i._validTimes.length>0,b=[];for(var D in this._cachedTiles){var G=!1,Z=this._cachedTiles[D],te=(0,Le.RQ)(Z.discreteTime.validTime.value),ae=void 0;if(s)for(var Pe=0,ve=i._modelRuns.length;Pe<ve;Pe++)for(var pe=i._modelRuns[Pe],Fe=pe.validTimes,ke=0,Ze=Fe.length;ke<Ze;ke++){var at=Fe[ke];if(ae=(0,Le.RQ)(pe.value)+"_"+(0,Le.RQ)(at.value),te===ae){G=!0;break}}if(_)for(var ke=0,Ze=i._validTimes.length;ke<Ze;ke++){var at=i._validTimes[ke];if(ae=(0,Le.RQ)(at.value),te===ae){G=!0;break}}G||b.push(D)}for(var Pe=0,Ve=b.length;Pe<Ve;Pe++){var st=b[Pe];delete this._cachedTiles[st]}},l.prototype._rasterizeTile=function(i){var s=this._rasterizeData(i.data,i.dimension,i.dimension);return i.bitmap=s,s},l.prototype._textureTile=function(i){var s;return this._contextGL&&(s=this._loadTexture(this._contextGL,i.data,this._dimension,this._dimension,this.rasterStyle.smoothingEnabled),i.texture=s),s},l.prototype._clearTextures=function(){if(!this._isPainting){for(var i in this._cachedTiles){var s=this._cachedTiles[i];s.bitmap=void 0,s.texture=void 0}this._textureStamp=performance.now()}},l.prototype._paintStencilTilesGL=function(i){var s=this._contextGL;s.useProgram(this._stencilProgram),s.enable(s.STENCIL_TEST),s.stencilMask(255),s.colorMask(!1,!1,!1,!1),s.depthMask(!1);var _=this.map,b=this.rasterStyle.clipPaths,D=this.rasterStyle.spotlight;if(b){s.clearStencil(255),s.clear(s.STENCIL_BUFFER_BIT);for(var G=this._dimension*Math.pow(2,_.zoomLevel),Z=0,te=b.polylines.length;Z<te;Z++){for(var ae=b.polylines[Z],Pe=ae.bounds.topLeftGeoPoint,ve=_.fromGeoToScreen(Pe,this._lastTopLeftScreenPoint),pe=ae.bounds.bottomRightGeoPoint,Fe=_.fromGeoToScreen(pe,this._lastBottomRightScreenPoint),ke=[],Ze=0,at=ae.points.length;Ze<at;Ze++){var Ve=ae.points[Ze],st=_.fromGeoToScreen(Ve);ke.push(st)}this._paintClipStencil(ke,G,ve.x,ve.y,Fe.x-ve.x,Fe.y-ve.y)}}else if(D){s.clearStencil(255),s.clear(s.STENCIL_BUFFER_BIT);for(var G=this._dimension*Math.pow(2,_.zoomLevel),Pt=D.geoCenter,$e=_.fromGeoToScreen(Pt),ae=[$e],Ct=$e.x,At=$e.y,qe=D.radius,Ze=0,nt=90;Ze<=nt;Ze++){var Xe=Ze*-2*Math.PI/nt,It=Ct+Math.cos(Xe)*qe,kt=At+Math.sin(Xe)*qe,st=new T.E(It,kt);ae.push(st)}this._paintClipStencil(ae,G,Ct-qe,At-qe,qe*2,qe*2)}else s.clearStencil(0),s.clear(s.STENCIL_BUFFER_BIT);s.stencilOp(s.INCR,s.INCR,s.INCR),s.stencilFunc(s.ALWAYS,1,255);for(var Z=0,Nt=i.length;Z<Nt;Z++){var Rt=i[Z];Rt.data&&this._paintStencilTileGL(Rt)}},l.prototype._paintRasterTiles=function(i,s){this._contextGL?this._paintRasterTilesGL(i,s):(i=s.concat(i),this._paintRasterTiles2D(i))},l.prototype._paintRasterTiles2D=function(i){var s=this._context2D,_=this.rasterStyle.clipPaths,b=this.rasterStyle.spotlight;if(_){s.save(),s.beginPath();for(var D=0,G=_.polylines.length;D<G;D++){var Z=_.polylines[D],te=this.map.fromGeoToScreen(Z.points[0]);s.moveTo(te.x,te.y);for(var ae=1,Pe=Z.points.length;ae<Pe;ae++){var ve=this.map.fromGeoToScreen(Z.points[ae]);s.lineTo(ve.x,ve.y)}}s.clip("evenodd")}else if(b){s.save(),s.beginPath();var ve=this.map.fromGeoToScreen(b.geoCenter);s.moveTo(ve.x,ve.y),s.arc(ve.x,ve.y,b.radius,0,2*Math.PI),s.clip()}for(var D=0,pe=i.length;D<pe;D++){var Fe=i[D];Fe.data&&this._paintRasterTile2D(Fe)}s.restore()},l.prototype._paintRasterTilesGL=function(i,s){var _=this._contextGL;_.useProgram(this._rasterProgram),_.bindBuffer(_.ARRAY_BUFFER,this._positionBuffer),_.bufferData(_.ARRAY_BUFFER,new Float32Array(this._positions),_.STATIC_DRAW),_.enableVertexAttribArray(this._rasterPositionLocation),_.vertexAttribPointer(this._rasterPositionLocation,2,_.FLOAT,!1,0,0),_.bindBuffer(_.ARRAY_BUFFER,this._texcoordBuffer),_.bufferData(_.ARRAY_BUFFER,new Float32Array(this._texcoords),_.STATIC_DRAW),_.enableVertexAttribArray(this._rasterTexcoordLocation),_.vertexAttribPointer(this._rasterTexcoordLocation,2,_.FLOAT,!1,0,0),_.stencilFunc(_.EQUAL,1,255),_.stencilMask(0),_.colorMask(!0,!0,!0,!0);for(var b=0,D=i.length;b<D;b++){var G=i[b];G.data&&this._paintRasterTileGL(G)}_.stencilFunc(_.EQUAL,0,255);for(var b=0,Z=s.length;b<Z;b++){var G=s[b];G.data&&this._paintRasterTileGL(G)}_.disable(_.STENCIL_TEST)},l.prototype._paintRasterTile2D=function(i){var s=this._context2D,_=this._buffer,b=_.getContext("2d"),D=this._canvas2D,G=this.map;i.lastAccessed=performance.now();for(var Z=i.bounds,te=G.fromGeoToScreen(Z.topLeftGeoPoint,this._lastTopLeftScreenPoint),ae=te.x,Pe=G.fromGeoToScreen(Z.bottomRightGeoPoint,this._lastBottomRightScreenPoint),ve=Pe.x-ae,pe=ve*Math.pow(2,i.z);ae<-ve;)ae+=pe;for(;ae>D.width;)ae-=pe;var Fe=te.y,ke=i.bitmap||this._rasterizeTile(i),Ze=this._dimension,at=ke;b.clearRect(0,0,Ze,Ze),b.putImageData(at,0,0),s.clearRect(ae,Fe,ve,ve),s.drawImage(_,ae,Fe,ve,ve),ae+pe<D.width&&(s.clearRect(ae+pe,Fe,ve,ve),s.drawImage(_,ae+pe,Fe,ve,ve)),ae-pe>-ve&&(s.clearRect(ae-pe,Fe,ve,ve),s.drawImage(_,ae-pe,Fe,ve,ve))},l.prototype._paintStencilTileGL=function(i){for(var s=this._contextGL,_=this._canvasGL,b=this.map,D=i.bounds,G=b.fromGeoToScreen(D.topLeftGeoPoint,this._lastTopLeftScreenPoint),Z=G.x,te=b.fromGeoToScreen(D.bottomRightGeoPoint,this._lastBottomRightScreenPoint),ae=te.x-Z,Pe=ae*Math.pow(2,i.z);Z<-ae;)Z+=Pe;for(;Z>_.width;)Z-=Pe;var ve=G.y;s.bindBuffer(s.ARRAY_BUFFER,this._positionBuffer),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this._positions),s.STATIC_DRAW),s.enableVertexAttribArray(this._rasterPositionLocation),s.vertexAttribPointer(this._rasterPositionLocation,2,s.FLOAT,!1,0,0),s.bindBuffer(s.ARRAY_BUFFER,this._texcoordBuffer),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this._texcoords),s.STATIC_DRAW),s.enableVertexAttribArray(this._rasterTexcoordLocation),s.vertexAttribPointer(this._rasterTexcoordLocation,2,s.FLOAT,!1,0,0),this._drawStencil(s,ae,ae,Z,ve),Z+Pe<_.width&&this._drawStencil(s,ae,ae,Z+Pe,ve),Z-Pe>-ae&&this._drawStencil(s,ae,ae,Z-Pe,ve)},l.prototype._paintRasterTileGL=function(i){var s=this._contextGL,_=this._canvasGL,b=this.map;i.lastAccessed=performance.now();for(var D=i.bounds,G=b.fromGeoToScreen(D.topLeftGeoPoint,this._lastTopLeftScreenPoint),Z=G.x,te=b.fromGeoToScreen(D.bottomRightGeoPoint,this._lastBottomRightScreenPoint),ae=te.x-Z,Pe=ae*Math.pow(2,i.z);Z<-ae;)Z+=Pe;for(;Z>_.width;)Z-=Pe;var ve=G.y,pe=i.texture||this._textureTile(i);this._drawImage(s,pe,ae,ae,Z,ve),Z+Pe<_.width&&this._drawImage(s,pe,ae,ae,Z+Pe,ve),Z-Pe>-ae&&this._drawImage(s,pe,ae,ae,Z-Pe,ve)},l.prototype._textureBlurredTile=function(i){var s=i.hasBlurred?i.gaussBlurData:i.data;if(!!s&&this._contextGL){var _=this._loadTexture(this._contextGL,s,this._dimension,this._dimension);return i.blurTexture=_,_}},l.prototype._determineIsobandLabelLocations=function(i){var s=this.contourStyle.isobands,_=this._dimension,b=i.hasBlurred?i.gaussBlurData:i.data;s.length>0&&!i.isobandData&&(i.isobandData={});for(var D=0,G=s.length;D<G;D++){var Z=s[D];if(Z.labels){var te=Z.range.start,ae=Z.range.end,Pe=te+"_"+ae;if(!i.isobandData.hasOwnProperty(Pe))if(te<=i.dataRange[1]&&i.dataRange[0]<=ae){for(var ve=-1,pe=-1,Fe=0,ke=0,Ze=_;ke<Ze;ke++){for(var at=-1,Ve=0,st=0,Pt=_;st<Pt;st++){var $e=ke*_+st,Ct=b[$e];(Ct-ae)*(Ct-te)<=0?(at===-1&&(at=st),Ve++):(Ve>Fe+10&&(Fe=Ve,pe=ke,ve=at+Ve/2),Ve=0,at=-1)}Ve>=Fe&&Math.abs(pe-Ze/2)>Math.abs(ke-Ze/2)&&(Fe=Ve,pe=ke,ve=at+Ve/2)}ve===-1?i.isobandData[Pe]=void 0:i.isobandData[Pe]={texture:void 0,labelPoint:[ve,pe]}}else i.isobandData[Pe]=void 0}}},l.prototype._determineTileRange=function(i){for(var s=i.data,_=s[0],b=s[0],D=0,G=s.length;D<G;D++){var Z=s[D];isNaN(Z)||(_=Z>_?_:Z,b=Z<b?b:Z)}i.dataRange=[_,b]},l.prototype._paintContourTilesAsync=function(i){for(var s=this._contourStyle,_=this._dimension,b=[],D=0,G=i.length;D<G;D++){var Z=i[D],te=this.map,ae=this._canvas2D;Z.lastAccessed=performance.now();for(var Pe=Z.bounds,ve=te.fromGeoToScreen(Pe.topLeftGeoPoint,this._lastTopLeftScreenPoint),pe=te.fromGeoToScreen(Pe.bottomRightGeoPoint,this._lastBottomRightScreenPoint),Fe=(pe.x-ve.x)/_,ke=(pe.y-ve.y)/_,Ze=ve.x,at=ve.y,Ve=pe.x-Ze,st=Math.pow(2,Z.z),Pt=Ve*st;Ze<-Ve;)Ze+=Pt;for(;Ze>ae.width;)Ze-=Pt;var $e={cellWidth:Fe,cellHeight:ke,x:Ze,y:at,d:Ve,dimension:_,worldSize:Pt,nTiles:st};Z.data&&(s.isobandsEnabled&&s.isobands.length&&(this._contextGL?(this._determineIsobandLabelLocations(Z),b=b.concat(this._paintIsobandsGL(Z,$e))):b=b.concat(this._paintIsobands2D(Z,$e))),s.isolinesEnabled&&s.isolines.length&&(b=b.concat(this._paintIsolines2D(Z,$e))))}s.labelsEnabled&&this._paintContourLabels(b)},l.prototype._paintIsobandsGL=function(i,s){var _=this._contextGL;_.useProgram(this._isobandProgram);for(var b=this._canvasGL,D=s.x,G=s.y,Z=s.d,te=s.cellWidth,ae=s.cellHeight,Pe=s.worldSize;D<-Z;)D+=Pe;for(;D>b.width;)D-=Pe;var ve=i.blurTexture||this._textureBlurredTile(i);this._drawIsobands(_,ve,Z,Z,D,G),D+Pe<b.width&&this._drawIsobands(_,ve,Z,Z,D+Pe,G),D-Pe>-Z&&this._drawIsobands(_,ve,Z,Z,D-Pe,G);for(var pe=[],Fe=this._contourStyle.isobands,ke=i.isobandData,Ze=0,at=Fe.length;Ze<at;Ze++){var Ve=Fe[Ze],st=Ve.range.start+"_"+Ve.range.end,Pt=ke[st];if(Pt){var $e=Ve.labels;if($e&&$e.text){var Ct=Pt.labelPoint,At=D+Ct[0]*te,qe=G+Ct[1]*ae;pe.push([$e,[At,qe]])}}}return pe},l.prototype._paintIsobands2D=function(i,s){for(var _=this._context2D,b=this._canvas2D,D=s.x,G=s.y,Z=s.d,te=s.cellWidth,ae=s.cellHeight,Pe=s.worldSize,ve=[],pe=i.isobandData,Fe=this.contourStyle.isobands,ke=0,Ze=Fe.length;ke<Ze;ke++){var at=Fe[ke],Ve=at.range.start+"_"+at.range.end,st=pe[Ve];if(st){var Pt=st.bitmap;this._buffer.getContext("2d").putImageData(Pt,0,0),_.drawImage(this._buffer,D,G,Z,Z),D+Pe<b.width&&_.drawImage(this._buffer,D+Pe,G,Z,Z),D-Pe>-Z&&_.drawImage(this._buffer,D-Pe,G,Z,Z);var $e=at.labels;if($e&&$e.text){var Ct=st.labelPoint,At=D+Ct[0]*te,qe=G+Ct[1]*ae;ve.push([$e,[At,qe]])}}}return ve},l.prototype._paintIsolines2D=function(i,s){var _=this._context2D,b=this._canvas2D,D=s.dimension,G=s.x,Z=s.y,te=s.cellWidth,ae=s.cellHeight,Pe=s.worldSize,ve=b.width,pe=b.height,Fe=s.nTiles,ke=i.isolineData,Ze=i.hasBlurred,at=Ze?i.gaussBlurData:i.data;for(var Ve in ke){var st=ke[Ve];if(!st.topedge){var Pt=i.y-1,$e=i.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_$3_"+Pt.toString()+"_$5");if(Pt>=0&&this._cachedTiles.hasOwnProperty($e)){var Ct=this._cachedTiles[$e];if(Ze===Ct.hasBlurred){var At=Ct.hasBlurred?Ct.gaussBlurData:Ct.data;At&&(Uo._contourTileTopBoundary(parseFloat(Ve),at,At,D,st.segments),st.topedge=!0)}}else Pt<0&&(st.topedge=!0)}if(!st.leftedge){var qe=(i.x+Fe-1)%Fe,nt=i.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+qe.toString()+"_$4_$5");if(this._cachedTiles.hasOwnProperty(nt)){var Xe=this._cachedTiles[nt];if(Ze===Xe.hasBlurred){var It=Xe.hasBlurred?Xe.gaussBlurData:Xe.data;It&&(Uo._contourTileLeftBoundary(parseFloat(Ve),at,It,D,st.segments),st.leftedge=!0)}}}}for(var kt=[],Nt=new T.E(128,128),Rt=new T.E(0,0),Qt=this.contourStyle.isolines,Jt=0,pi=Qt.length;Jt<pi;Jt++){var vi=void 0,gi=void 0,st=Qt[Jt],jt=i.isolineData[st.value].segments,$t=Number.MAX_VALUE;_.beginPath(),_.strokeStyle=st.lineColor,_.lineWidth=st.lineWidth;for(var Oi=0,Ui=jt.length;Oi<Ui;Oi++){var xi=jt[Oi],li=G+te*xi[0],Fi=Z+ae*xi[1],Wi=G+te*xi[2],tr=Z+ae*xi[3];li+Pe<ve&&(li+=Pe,Wi+=Pe),li-Pe>0&&(li-=Pe,Wi-=Pe),Rt.x=xi[0],Rt.y=xi[1];var Zi=Rt.distanceTo(Nt);Zi<$t&&($t=Zi,vi=li,gi=Fi),!(li<-1&&Wi<-1||li>ve&&Wi>ve||Fi<-1&&tr<-1||Fi>pe&&tr>pe)&&(_.moveTo(li,Fi),_.lineTo(Wi,tr))}_.stroke();var Yi=st.labels;Yi&&Yi.text&&jt.length>0&&kt.push([Yi,[vi,gi]])}return kt},l.prototype._paintContourLabels=function(i){function s(qe,nt){return!(qe[0]<nt[2]||qe[2]>nt[0]||qe[1]>nt[3]||qe[3]<nt[1])}var _=this._context2D,b=20,D=6,G=[],Z=[];if(this._contourStyle.declutterLabels)for(var te=0,ae=i.length;te<ae;te++){for(var Pe=i[te][1],ve=[Pe[1]+D,Pe[0]-b,Pe[1]-D,Pe[0]+b],pe=!1,Fe=0,ke=G.length;Fe<ke;Fe++)if(s(ve,G[Fe])){pe=!0;break}pe||(Z.push(i[te]),G.push(ve))}else Z=i;for(var Ze=0,at=Z.length;Ze<at;Ze++){var Ve=Z[Ze][0],Pe=Z[Ze][1];if(!(Ve.fontSize<=0)){_.save(),_.textAlign="center",_.textBaseline="middle",_.translate(Pe[0],Pe[1]);var st=Ve.fontStyle+" ";st+="normal ",st+=Ve.fontWeight+" ",st+=Ve.fontSize+"px ",st+=Ve.fontFamily||"Arial",_.font=st;var Pt=_.measureText(Ve.text),$e=Pt.width+Ve.backgroundPadding*2,Ct=Ve.fontSize*1.286+Ve.backgroundPadding*2,At=Ve.borderRadius;$e<2*At&&(At=$e/2),Ct<2*At&&(At=Ct/2),_.beginPath(),_.moveTo(At-$e/2,-Ct/2),_.arcTo($e/2,-Ct/2,$e/2,Ct/2,At),_.arcTo($e/2,Ct/2,-$e/2,Ct/2,At),_.arcTo(-$e/2,Ct/2,-$e/2,-Ct/2,At),_.arcTo(-$e/2,-Ct/2,$e/2,-Ct/2,At),_.closePath(),Ve.backgroundColor&&(_.fillStyle=Ve.backgroundColor,_.fill()),Ve.borderWidth&&Ve.borderWidth!==0&&(_.lineWidth=Ve.borderWidth,_.strokeStyle=Ve.borderColor||"rgba(0,0,0,1)",_.stroke()),Ve.strokeWidth&&Ve.strokeWidth!==0&&(_.miterLimit=1,_.lineWidth=Ve.strokeWidth*2,_.strokeStyle=Ve.strokeColor,_.strokeText(Ve.text,0,0)),_.fillStyle=Ve.fontColor,_.fillText(Ve.text,0,0),_.restore()}}},l.prototype._removeTileIsoline=function(i){for(var s in this._cachedTiles){var _=this._cachedTiles[s];_.isolineData&&delete _.isolineData[i]}},l.prototype._removeTileIsoband=function(i){for(var s in this._cachedTiles){var _=this._cachedTiles[s];_.isobandData&&delete _.isobandData[i]}},l.prototype._clearTileIsolines=function(){for(var i in this._cachedTiles){var s=this._cachedTiles[i];s.isolineData={}}},l.prototype._clearTileIsobands=function(){for(var i in this._cachedTiles){var s=this._cachedTiles[i];s.isobandData={}}},l.prototype._clearTileContours=function(){for(var i in this._cachedTiles){var s=this._cachedTiles[i];s.isolineData={},s.isobandData={},s.hasBlurred=!1,s.blurTexture=void 0}},l.prototype._paintTextTiles=function(i){this._paintTextTiles2D(i)},l.prototype._paintTextTiles2D=function(i){var s=this.textStyle,_=this._context2D;_.fillStyle=s.fontColor;var b="center";switch(s.alignment){case x.v2.Left:b="left";break;case x.v2.Right:b="right";break}_.textAlign=b;var D="middle";switch(s.baseline){case x.HW.Top:D="top";break;case x.HW.Bottom:D="bottom";break}_.textBaseline=D;var G=s.fontStyle+" ";G+="normal ",G+=s.fontWeight+" ",G+=s.fontSize+"px ",G+=s.fontFamily||"Arial",_.font=G,s.strokeWidth&&(_.miterLimit=1,_.lineWidth=s.strokeWidth*2,_.strokeStyle=s.strokeColor);for(var Z=0,te=i.length;Z<te;Z++){var ae=i[Z];ae.data&&this._paintTextTile2D(ae)}},l.prototype._paintTextTile2D=function(i){var s=this._map,_=this._context2D,b=this._canvas2D;i.lastAccessed=performance.now();var D=this._dimension,G=this.textStyle,Z=G.spread.width,te=G.spread.height,ae=G.staggeredOffset%Z,Pe=G.colorByPalette,ve=s.zoomLevel,pe=G.precision,Fe=G.characterLength;i.textStartOffset||(i.textStartOffset=new T.E(0,0));var ke=s.contextualBounds.topLeftGeoPoint,Ze=Bt.x.convertGeoToPixel(ke,ve,i.textStartOffset);i.textEndOffset||(i.textEndOffset=new T.E(0,0));var at=s.contextualBounds.bottomRightGeoPoint,Ve=Bt.x.convertGeoToPixel(at,ve,i.textEndOffset),st=i.data,Pt=this._palette,$e=this._filter,Ct=$e.length,At=.5,qe=(Math.floor(ve/At)-i.z/At)*At,nt=Math.pow(2,ve%At),Xe=Math.floor(D*Math.pow(2,qe)),It=i.x*Xe,kt=i.y*Xe,Nt=Math.ceil(kt/te)%2!=0,Rt=Math.pow(2,i.z);if(s.isIdlVisible&&i.bounds.bottomLeftGeoPoint.longitude.isGreaterThanOrEqual(at.longitude.normalize(!0)))var Qt=It+Xe*(Rt-i.x)%Z;else var Qt=It+(Z-It%Z)%Z;var Jt=kt+(te-kt%te)%te,pi=(i.x+1)*Xe,vi=(i.y+1)*Xe,gi=s.fromGeoToScreen(i.bounds.topRightGeoPoint,this._lastD).x-s.fromGeoToScreen(i.bounds.topLeftGeoPoint,this._lastTopLeftScreenPoint).x,jt=gi*Math.pow(2,i.z),$t,Oi,Ui=G.strokeWidth&&G.strokeWidth>0,xi=this._options.convert;if(s.zoomLevel>=this._maxNativeZoom){for(;Math.abs(Qt-Ze.x)<Xe&&(Qt+Z*2)*nt<Ze.x;)Qt+=Z;for(;(Jt+te*2)*nt<Ze.y;)Jt+=te,Nt=!Nt;for(;Math.abs(pi-Ve.x)<Xe&&(pi-Z*2)*nt>Ve.x;)pi-=Z;for(;(vi-te*2)*nt>Ve.y;)vi-=te}for(Oi=Jt;Oi<vi;Oi+=te){var li=Qt;for(Nt&&(li=(li+ae-It)%Z+It),$t=li;$t<pi;$t+=Z){for(var Fi=$t*nt-Ze.x,Wi=Oi*nt-Ze.y;Fi<0;)Fi+=jt;for(;Fi>b.width;)Fi-=jt;if(!(Fi<-Z||Fi>b.width+Z||Wi<-te||Wi>b.height+te)){var tr=Math.floor($t%Xe*D/Xe)+Math.floor(Oi%Xe*D/Xe)*D,Zi=st[tr];if(!isNaN(Zi)){for(var Yi=!!Ct,ar=0;ar<Ct;ar++){var rr=$e[ar];if(Zi>=rr.start&&Zi<=rr.end){Yi=!1;break}}if(Yi)continue;if(Pe&&Pt){var nr=[0,0,0,0];nr=Pt.apply(Zi),_.fillStyle="rgba("+nr[0]+","+nr[1]+","+nr[2]+","+nr[3]+")"}var br=xi?this._options.convert(Zi):Zi,Bn="",en=Math.pow(10,pe);br=Math.round(br*en)/en,Fe>=1&&Fe<=100?Bn=br.toPrecision(Fe):Bn+=br,Ui&&_.strokeText(Bn,Fi,Wi),_.fillText(Bn,Fi,Wi)}}}Nt=!Nt}},l.prototype._paintShapesAsync=function(i){for(var s=0,_=i.length;s<_;s++){var b=i[s],D=b.incompleteShapes,G=0;for(var Z in D)G+=D[Z].length;if(G>0){var te=Math.pow(2,b.z),ae=(b.x+te-1)%te,Pe=(b.x+te+1)%te,ve=b.y-1,pe=b.y+1;if(ve>=0){var Fe=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_$3_"+ve.toString()+"_$5"),ke=this._cachedTiles[Fe];ke&&D[1].length>0&&this._missingPoints(b,ke,1);var Ze=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+ae.toString()+"_"+ve.toString()+"_$5"),at=this._cachedTiles[Ze];at&&D[0].length>0&&this._missingPoints(b,at,0);var Ve=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+Pe.toString()+"_"+ve.toString()+"_$5"),st=this._cachedTiles[Ve];st&&D[2].length>0&&this._missingPoints(b,st,2)}if(pe<te){var Pt=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_$3_"+pe.toString()+"_$5"),$e=this._cachedTiles[Pt];$e&&D[7].length>0&&this._missingPoints(b,$e,7);var Ct=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+ae.toString()+"_"+pe.toString()+"_$5"),At=this._cachedTiles[Ct];At&&D[6].length>0&&this._missingPoints(b,At,6);var qe=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+Pe.toString()+"_"+pe.toString()+"_$5"),nt=this._cachedTiles[qe];nt&&D[8].length>0&&this._missingPoints(b,nt,8)}var Xe=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+ae.toString()+"_$4_$5"),It=this._cachedTiles[Xe];It&&D[3].length>0&&this._missingPoints(b,It,3);var kt=b.key.replace(/(\d+_\d+|\d+)_(\d{1,2})_(\d+)_(\d+)_(\d+)/,"$1_$2_"+Pe.toString()+"_$4_$5"),Nt=this._cachedTiles[kt];Nt&&D[5].length>0&&this._missingPoints(b,Nt,5)}b.shapes&&b.shapes.length>0&&this._paintTileShapes2D(b)}},l.prototype._missingPoints=function(i,s,_){var b=i.incompleteShapes[_],D=b.length,G=this._dimension,Z=s.x*G,te=s.y*G,ae=Math.pow(2,i.z)*G,Pe=s.data;if(Pe)for(var ve=0;ve<D;ve++){for(var pe=b[ve],Fe=pe.missingPoints,ke=pe.min,Ze=pe.max,at=pe.sum,Ve=pe.nPoints,st=[],Pt=!0,$e=0,Ct=Fe.length;$e<Ct;$e++){var At=Fe[$e],qe=(At[0]+ae)%ae,nt=At[1];if(qe<Z||qe>=Z+G||nt<te||i>=te+G){st.push(At),Pt=!1;continue}var Xe=(nt-te)*G+qe-Z,It=Pe[Xe];if((0,x.le)(It)){st.push(At),Pt=!1;continue}isNaN(It)||(It<ke&&(ke=It),It>Ze&&(Ze=It),at+=It,Ve++)}pe.min=ke,pe.max=Ze,pe.sum=at,pe.nPoints=Ve,pe.missingPoints=st,Pt&&Ve>0&&i.shapes.push(pe)}i.incompleteShapes[_]=[]},l.prototype._determineShapeGeometryV2=function(){var i=this._shapeStyle,s=i.circumRadius,_=i.vertices,b=i.rotation.radians,D=i.staggeredRotation.radians,G=_===1;if(G){for(var Z=[],te=Math.ceil(s),ae=-te;ae<=te;ae++)for(var Pe=-te;Pe<=te;Pe++)Math.pow(2,Pe)+Math.pow(2,ae)<=Math.pow(2,s)&&Z.push([Pe,ae]);this._shapeStyle._shapes=[Z],this._shapeStyle._geometry=[]}else{for(var ve=[],pe=[],Fe=void 0,ke=void 0,Ze=0;Ze<_;Ze++)Fe=s*Math.cos(Ze*2*Math.PI/_+b),ke=s*Math.sin(Ze*2*Math.PI/_+b),ve[Ze]={x:Fe,y:ke};if(D%(2*Math.PI/_)!=0)for(var Ze=0;Ze<_;Ze++)Fe=s*Math.cos(Ze*2*Math.PI/_+b+D),ke=s*Math.sin(Ze*2*Math.PI/_+b+D),pe[Ze]={x:Fe,y:ke};this._shapeStyle._geometry=[ve,pe];for(var Z=[],at=[],te=Math.ceil(s),ae=-te;ae<=te;ae++)for(var Pe=-te;Pe<=te;Pe++)this.pointInPoly(Pe,ae,ve)&&Z.push([Pe,ae]),this.pointInPoly(Pe,ae,pe)&&at.push([Pe,ae]);this._shapeStyle._shapes=[Z,at]}},l.prototype._paintTileShapes2D=function(i){for(var s=this.shapeStyle,_=this._context2D,b=this._canvas2D,D=s.precision,G=s.characterLength,Z=this._palette,te=this.map,ae=te.zoomLevel,Pe=i.z,ve=Math.pow(2,ae-Pe),pe=s.circumRadius*ve,Fe=Bt.x.convertGeoToPixel(te.bounds.topLeftGeoPoint,Pe,this._lastTopLeftScreenPoint),ke=Fe.x,Ze=Fe.y,at=i.bounds,Ve=te.fromGeoToScreen(at.topLeftGeoPoint,this._lastTopLeftScreenPoint),st=Ve.x,Pt=te.fromGeoToScreen(at.bottomRightGeoPoint,this._lastBottomRightScreenPoint),$e=Pt.x-st,Ct=Math.pow(2,Pe),At=$e*Ct;st<-$e;)st+=At,ke-=Ct*i.dimension;for(;st>b.width;)st-=At,ke+=Ct*i.dimension;for(var qe=s.dataType,nt=s.labels,Xe=i.shapes,It=s.vertices===1,kt=s.labelsEnabled,Nt=s._geometry[0],Rt=s._geometry[1],Qt=s.staggeredRotation.radians%(2*Math.PI/s.vertices)!=0,Jt=0,pi=Xe.length;Jt<pi;Jt++){var vi=Xe[Jt],gi=Qt&&vi.staggered?Rt:Nt,jt=(vi.centerX-ke)*ve,$t=(vi.centerY-Ze)*ve;jt+At<b.width+pe&&(jt+=At),jt-At>-pe&&(jt-=At);var Oi=0;switch(qe){case"AVG":Oi=vi.sum/vi.nPoints;break;case"MAX":Oi=vi.max;break;case"MIN":Oi=vi.min;break}if(_.lineWidth=s.strokeWidth,_.strokeStyle=s.strokeColor,_.beginPath(),It){var Ui=jt,xi=$t;_.arc(Ui,xi,pe,0,2*Math.PI)}else{var Ui=jt+gi[0].x*ve,xi=$t+gi[0].y*ve;_.moveTo(Ui,xi);for(var li=1,Fi=gi.length;li<Fi;li++)Ui=jt+gi[li].x*ve,xi=$t+gi[li].y*ve,_.lineTo(Ui,xi);_.closePath()}var Wi=Z.apply(Oi);if(_.fillStyle="rgba("+Wi[0]+","+Wi[1]+","+Wi[2]+","+Wi[3]+")",_.fill(),_.stroke(),kt){this._options.convert&&(Oi=this._options.convert(Oi));var tr="",Zi=Math.pow(10,D);Oi=Math.round(Oi*Zi)/Zi,G>=1&&G<=100?tr=Oi.toPrecision(G):tr+=Oi,_.textAlign="center",_.textBaseline="middle";var Yi=nt.fontStyle+" ";Yi+="normal ",Yi+=nt.fontWeight+" ",Yi+=nt.fontSize+"px ",Yi+=nt.fontFamily||"Arial",_.font=Yi;var ar=_.measureText(tr),rr=ar.width+nt.backgroundPadding*2,nr=nt.fontSize*1.286+nt.backgroundPadding*2,br=nt.borderRadius;rr<2*br&&(br=rr/2),nr<2*br&&(br=nr/2),_.beginPath(),_.moveTo(br-rr/2+jt,-nr/2+$t),_.arcTo(rr/2+jt,-nr/2+$t,rr/2+jt,nr/2+$t,br),_.arcTo(rr/2+jt,nr/2+$t,-rr/2+jt,nr/2+$t,br),_.arcTo(-rr/2+jt,nr/2+$t,-rr/2+jt,-nr/2+$t,br),_.arcTo(-rr/2+jt,-nr/2+$t,rr/2+jt,-nr/2+$t,br),_.closePath(),_.fillStyle=nt.backgroundColor,_.fill(),nt.borderWidth&&(_.lineWidth=nt.borderWidth,_.strokeStyle=nt.borderColor||"rgba(0,0,0,1)",_.stroke()),nt.strokeWidth&&(_.miterLimit=1,_.lineWidth=nt.strokeWidth*2,_.strokeStyle=nt.strokeColor,_.strokeText(tr,jt,$t)),_.fillStyle=nt.fontColor,_.fillText(tr,jt,$t)}}},l.prototype.prune=function(i){this._pruneTiles(i)},l.prototype.inspect=function(i){var s=null,_=this._timeManager;if(_._currentDiscreteTime){var b=i instanceof T.E?this.map.fromScreenToGeo(i,this._lastInspectionGeoPoint):i,D=this._cachedTiles,G=_._currentDiscreteTime,Z=this._dimension,te=this._lastInspectionPoint,ae=Math.min(Math.floor(this._map.zoomLevel),this._maxNativeZoom);Bt.x.convertGeoToPixel(b,ae,this._lastInspectionPoint);var Pe=(0,x.oY)(Z/256,2),ve=Math.pow(2,ae-Pe),pe=ae,Fe=(Math.floor(te.x/Z)+ve)%ve,ke=Math.floor(te.y/Z),Ze=G.key+"_",at=Ze+pe+"_"+Fe+"_"+ke+"_"+this.depth,Ve=D[at];if(!Ve){pe=pe-1,Fe=Fe>>1,ke=ke>>1;for(var st=Ze+pe+"_"+Fe+"_"+ke+"_"+this.depth;pe>0;){if(D.hasOwnProperty(st)){Ve=D[st];break}pe=pe-1,Fe=Fe>>1,ke=ke>>1,st=Ze+pe+"_"+Fe+"_"+ke+"_"+this.depth}}if(Ve&&Ve.data){Ve.lastAccessed=performance.now(),Bt.x.convertGeoToPixel(b,pe,this._lastInspectionPoint),ve=Math.pow(2,pe-Pe),te.x=(te.x+ve*Z)%(ve*Z);var Pt=Math.floor(te.x)-Ve.x*Z,$e=Math.floor(te.y)-Ve.y*Z,Ct=$e*Z+Pt;s=Ve.data[Ct]}else return null}return this._options.convert&&(s=this._options.convert(s)),s},l.prototype.update=function(){if(this._isUpdating&&Object.keys(this._updatingRequests).length===0)return this._isUpdating=!1,this._render(),this.updated.trigger({id:this.id}),!1;if(this._hasMetaData){var i=this._timeManager,s=this.map.clock.time,_=i._deriveDiscreteTime(s);return!i._currentDiscreteTime||!i._currentDiscreteTime.equals(_)?(i._currentDiscreteTime=_,this._isUpdating=!0,this._preloadTiles(_),!0):!1}else return!1},l.prototype.changeModelRun=function(i){this._timeManager._providedModelRun=i,this.update()},l.prototype.preload=function(i,s){this._infoClient||this._startService(i,s)},l.prototype._onInfoLoaded=function(i){var s=this._convertInfo();this._hasMetaData?s&&(this._purge(),this.metaDataModified.trigger(),this.map&&this.map.isEnabled&&this.update()):(this._hasMetaData=!0,this._infoClient.url=this._infoClient.url.replace("&meta=true",""),this.map&&this.map.isEnabled&&(this._isAnimate&&(this.map.animator.frameChanging.addListener(this._onAnimatorFrameChanging,this),this.map.animator.frameChanged.addListener(this._onAnimatorFrameChanged,this),this.map.clock.timeChanged.addListener(this._onTimeChanged,this)),this.metaDataLoaded.trigger(),this.update()))},l.prototype._onAnimatorFrameChanging=function(i){if(this.map&&this.map.isEnabled){var s=this._timeManager._deriveDiscreteTime(i.time);s.validTime&&(this._isFrameChanging=!0,this._preloadTiles(s))}},l.prototype._onAnimatorFrameChanged=function(i){if(this.map&&this.map.isEnabled){this._isFrameChanging=!1;var s=this.update();s||this._render(!0)}},l.prototype._onShapeStyleChanged=function(i){if(!this._isPainting){if(i.geometryChanged){this._shapeStyle._shapes=[],this._shapeStyle._geometry=[];for(var s in this._cachedTiles){var _=this._cachedTiles[s];_.shapes=void 0,_.topShapes=!1,_.topLeftShapes=!1,_.topRightShapes=!1,_.leftShapes=!1,_.rightShapes=!1,_.bottomShapes=!1,_.bottomLeftShapes=!1,_.bottomRightShapes=!1,_.incompleteShapes=void 0}}this._render()}},l.prototype._onTimeChanged=function(i){if(this._timeMode===x.$i.Relative)this._timeRange._increment();else if(this._timeMode===x.$i.Absolute){var s=i.time;this._timeRange.inRange(s)!==this._timeRange.inRange(s.getTime()-1e3)&&this._render()}this.map&&this.map.isEnabled&&this.update()},l.prototype._onMapMoving=function(i){this._isUpdating=!1,this._render()},l.prototype._onMapEnabled=function(i){this._infoClient.startPolling(),O.prototype._onMapEnabled.call(this,i)},l.prototype._onMapDisabled=function(i){for(var s=this._pendingRequests,_=0,b=s.length;_<b;_++){var D=s[_];D.abort()}this._pendingRequests=[],this._pendingTiles={},this._pendingTilesCount=0,this._infoClient.stopPolling(),this._hasMetaData=!1,this._cachedTiles={},this._timeManager._unload(),O.prototype._onMapDisabled.call(this,i)},l}(fa),qn=B(19161),Mr=function(){function O(l){l===void 0&&(l={}),this.duration=null,this.ease=null,this.isAnimate=!0,this.offset=void 0,(0,x.f0)(this,l)}return O.prototype.toLeaflet=function(){var l={};return this.isAnimate!=null&&(l.animate=this.isAnimate),this.duration!=null&&(l.duration=this.duration),this.ease!=null&&(l.easeLinearity=this.ease),l},O.prototype.toMapbox=function(){var l={};return this.isAnimate!=null&&(l.animate=this.isAnimate),this.duration!=null&&(l.duration=this.duration),this.offset!=null&&(l.offset=this.offset),this.ease!=null&&(l.easing=function(i){return i*(2-i)}),l},O}(),qr=function(){function O(l){l===void 0&&(l={}),this.enabled=!0,this.offset=new T.E(0,0),(0,x.f0)(this,l)}return O.prototype.toLeaflet=function(){var l={};return l.autoPan=this.enabled,l.autoPanPadding=new(gt()).Point(this.offset.x,this.offset.y),l},O}(),Ho=function(){function O(l){l===void 0&&(l={}),this.allowCrossLayerCollision=void 0,this.periodPerFrame=void 0,this.playRate=void 0,this.startTime=void 0,this.time=void 0,this.timeMode=void 0,this.frame=void 0,this.dwell=void 0,this.loadingTimer=void 0,this.enableLooping=void 0,this.endTime=void 0,this.frameCount=void 0,this.renderer=void 0,this.longitude=void 0,this.maximumBounds=void 0,this.maximumZoomLevel=void 0,this.minimumZoomLevel=void 0,this.latitude=void 0,this.zoomLevel=void 0,this.zoomAnimationThreshold=void 0,this.enablePanningInertia=void 0,this.enableZoomingAnimation=void 0,this.panningInertiaDeceleration=void 0,this.panningInertiaMaximumSpeed=void 0,this.scrollWheelZoom=void 0,this.absoluteTimer=void 0,this.slidingTimer=void 0,this.preserveDrawingBuffer=void 0,this.inrixConsumerId=void 0,this.inrixUrl=void 0,this.inrixVendorId=void 0,this.mapboxAccessToken=void 0,this.sunApiKey=void 0,this.sunFeatureUrl=void 0,this.sunVectorUrl=void 0,this.sunSeriesUrl=void 0,this.sunTileUrl=void 0,this.sunGridUrl=void 0,this.sunParticleUrl=void 0,this.sunRadarUrl=void 0,this.tesseraMapKey=void 0,this.tesseraMemberKey=void 0,this.tesseraUrl=void 0,this.layers=void 0,this.style=void 0,(0,x.f0)(this,l)}return O}(),No=function(){function O(l){l===void 0&&(l={}),(0,x.f0)(this,l)}return O}(),_a=function(){function O(l,i,s,_){if(this._isDisposed=!1,this._isEnabled=!1,this._loadState=x.jd.Unloaded,this._resumeAnimating=!1,this._layers={},this._stack=[],this._maxBounds=I.c.fromDegrees(85.05113,-3600,-85.05113,3600),this._isPanning=!1,this._isZooming=!1,this._projection=new Gt._,this._providedMinimumZoom=0,this._popups={},this._computedMinimumZoom=0,this._device=null,this._mouseEventArgs=null,this._lastTopLeftGeoPoint=v.F.fromRadians(0,0),this._lastConversionGeoPoint=v.F.fromRadians(0,0),this._lastMapEvent=new Zn,this._lastNormalizedGeoPoint=v.F.fromRadians(0,0),this._lastConversionPixelPoint=new T.E(0,0),this._lastInputTile=new Kt.n(0,0,0),this._bounds=I.c.fromDegrees(0,0,0,0),this.absoluteTimeout=new W.j,this.contextMenu=new W.j,this.disabled=new W.j,this.enabled=new W.j,this.hovered=new W.j,this.imageAdded=new W.j,this.imageRemoved=new W.j,this.keyDown=new W.j,this.keyPress=new W.j,this.keyUp=new W.j,this.layerAdded=new W.j,this.layerArranged=new W.j,this.layerRemoved=new W.j,this.loaded=new W.j,this.loading=new W.j,this.maximumZoomLevelChanged=new W.j,this.minimumZoomLevelChanged=new W.j,this.mouseClick=new W.j,this.mouseDoubleClick=new W.j,this.mouseDown=new W.j,this.mouseMove=new W.j,this.mouseOut=new W.j,this.mouseOver=new W.j,this.mouseUp=new W.j,this.mouseWheel=new W.j,this.moving=new W.j,this.moved=new W.j,this.panned=new W.j,this.panning=new W.j,this.popupClosed=new W.j,this.popupOpened=new W.j,this.ready=new W.j,this.resized=new W.j,this.slidingTimeout=new W.j,this.styling=new W.j,this.styled=new W.j,this.touchCancel=new W.j,this.touchDoubleTap=new W.j,this.touchEnd=new W.j,this.touchEnter=new W.j,this.touchLeave=new W.j,this.touchMove=new W.j,this.touchStart=new W.j,this.touchTap=new W.j,this.unloaded=new W.j,this.zoomed=new W.j,this.zooming=new W.j,this._lastMapEvent.geoPoint=v.F.fromRadians(0,0),this._lastMapEvent.containerPoint=new T.E(0,0),(0,x.le)(_)&&(_=(0,x.le)(i.renderer)?O._autoDetectRenderer():i.renderer),this._renderer=_,typeof l=="string"||l instanceof String){var b=l;this._elementId=b,this._element=document.getElementById(b)}else this._element=l,l.id||(l.id="__"+(0,x.cm)()),this._elementId=l.id;this.element.style.overflow="hidden";var D=s||{};isNaN(D.absoluteTimeout)?this._absoluteTimeout=i.absoluteTimer||new Ue.i(3600*1e3):this._absoluteTimeout=new Ue.i(D.absoluteTimeout*1e3),isNaN(D.slidingTimeout)?this._slidingTimeout=i.slidingTimer||new Ue.i(600*1e3):this._slidingTimeout=new Ue.i(D.slidingTimeout*1e3),this._inrixConsumerId=i.inrixConsumerId||D.inrixConsumerId,this._inrixUrl=i.inrixUrl||D.inrixUrl,this._inrixVendorId=i.inrixVendorId||D.inrixVendorId,this._mapboxAccessToken=i.mapboxAccessToken||D.mapboxAccessToken,this._sunApiKey=i.sunApiKey||D.sunApiKey,this._sunFeatureUrl=i.sunFeatureUrl||D.sunFeatureUrl,this._sunGridUrl=i.sunGridUrl||D.sunGridUrl,this._sunParticleUrl=i.sunParticleUrl||D.sunParticleUrl,this._sunRadarUrl=i.sunRadarUrl||D.sunRadarUrl,this._sunVectorUrl=i.sunVectorUrl||D.sunVectorUrl,this._sunSeriesUrl=i.sunSeriesUrl||D.sunSeriesUrl,this._sunTileUrl=i.sunTileUrl||D.sunTileUrl,this._tesseraMemberKey=i.tesseraMemberKey||D.tesseraMemberKey,this._tesseraMapKey=i.tesseraMapKey||D.tesseraMapKey,this._tesseraUrl=i.tesseraUrl||D.tesseraUrl,this._options=i instanceof Ho?i:new Ho(i),this._allowCrossLayerCollision=i.allowCrossLayerCollision!==void 0?i.allowCrossLayerCollision:!1,this._loadMap(l,i);var G=new xt;i.time!==void 0&&(G.time=i.time),this._clock=G;var Z=new de(this.clock);i.periodPerFrame!==void 0&&(Z.periodPerFrame=i.periodPerFrame),i.playRate!==void 0&&(Z.playRate=i.playRate),i.timeMode!==void 0&&(Z.timeMode=i.timeMode),i.frameCount!==void 0&&(Z.frameCount=i.frameCount),i.frame!==void 0&&(Z.frame=i.frame),i.dwell!==void 0&&(Z.dwell=i.dwell),i.enableLooping!==void 0&&(Z.enableLooping=i.enableLooping),i.startTime!=null&&i.endTime!=null?Z.modifyRange(i.startTime,i.endTime):(i.startTime!==void 0&&(Z.startTime=i.startTime),i.endTime!==void 0&&(Z.endTime=i.endTime)),this._animator=Z,this._loadingDuration=i.loadingTimer||new Ue.i(0,3,0,0,0),this._keyboard=new qt,this._touches=[],this._mouse=new fi;var te=this._mouse;te._geoPoint=v.F.fromRadians(0,0),te._tmsTile=new Kt.n(0,0,0),te._wmtsTile=new Kt.n(0,0,0),te._screenPoint=new T.E(0,0),W.j.addDomListener(this.element,"keydown",this._onKeyDown,this),W.j.addDomListener(this.element,"keypress",this._onKeyPress,this),W.j.addDomListener(this.element,"keyup",this._onKeyUp,this);var ae=!1;try{var Pe=Object.defineProperty({},"passive",{get:function(){ae=!0}});window.addEventListener("testPassive",null,Pe),window.removeEventListener("testPassive",null,Pe)}catch(ve){}window.navigator.msPointerEnabled?(W.j.addDomListener(this.element,"MSPointerDown",this._onTouchStart,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"MSPointerMove",this._onTouchMove,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"MSPointerUp",this._onTouchEnd,this,ae?{passive:!0}:!1)):(W.j.addDomListener(this.element,"touchstart",this._onTouchStart,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"touchmove",this._onTouchMove,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"touchend",this._onTouchEnd,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"touchenter",this._onTouchEnter,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"touchleave",this._onTouchLeave,this,ae?{passive:!0}:!1),W.j.addDomListener(this.element,"touchcancel",this._onTouchCancel,this,ae?{passive:!0}:!1)),W.j.addDomListener(window,"resize",this._onWindowResize,this),W.j.addDomListener(window,"beforeunload",this._onUnloaded,this),this._graticule=new ot(this),this._idl=new Lt(this),this._tileGrid=new gr(this,{dimension:new m.$(256,256),id:"TMS Tile Grid"}),this._featureTileGrid=new gr(this,{dimension:new m.$(512,512),id:"Feature Tile Grid"}),this._boxZoom=new k(this),this._doubleClickZoom=new z(this),this._dragging=new C(this),this._keyboardNavigation=new Si(this),this._rotate=new cn(this),this._scrollWheelZoom=new Hr(this),this._tilting=new Wn(this),this._touchZoom=new gn(this),this._hover=new Et(this),this._attribution=new yn(this),this._loadState=x.jd.Loaded,this.enable(),this.boxZoom.enable(),this.doubleClickZoom.enable(),this.dragging.enable(),this.keyboardNavigation.enable(),this.scrollWheelZoom.enable(),this.touchZoom.enable(),this._bootStrap(i),this._applyDefaultStyle()}return Object.defineProperty(O.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"allowCrossLayerCollision",{get:function(){return this._allowCrossLayerCollision},set:function(l){throw new Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"engine",{get:function(){return this._engine},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"options",{get:function(){return this._options},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"elementId",{get:function(){return this._elementId},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"loadState",{get:function(){return this._loadState},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"mapState",{get:function(){var l={};l.maximumBounds=this.maximumBounds,l.maximumZoomLevel=this.maximumZoomLevel,l.minimumZoomLevel=this.minimumZoomLevel,l.zoomLevel=this.zoomLevel;var i=this.geoCenter;i.normalize(),l.latitude=i.latitude.degrees,l.longitude=i.longitude.degrees;for(var s=this._stack,_=[],b=0,D=s.length;b<D;b++){var G=s[b],Z=this._layers[G],te=Z.options;te.opacity=Z.opacity,_.push(te)}return l.layers=_,l.style=this.style,l.frame=l.frame=this.animator.frame,l.dwell=this.animator.dwell.totalMilliseconds,l.enableLooping=this.animator.enableLooping,l.time=this.clock.time,l.endTime=this.animator.endTime,l.timeMode=this.animator.timeMode,l.periodPerFrame=this.animator.periodPerFrame.totalMilliseconds,l.playRate=this.animator.playRate.totalMilliseconds,l.frameCount=this.animator.frameCount,l.startTime=this.animator.startTime,l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"renderer",{get:function(){return this._renderer},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"absoluteTimer",{get:function(){return this._absoluteTimeout},set:function(l){if(l){if(this._stopAbsolute(),l instanceof Ue.i)this._absoluteTimeout=l;else if(!isNaN(l)){var i=l*1e3;this._absoluteTimeout=new Ue.i(i)}this._absoluteTimeout.totalMilliseconds>0&&this.isEnabled&&this._startAbsolute()}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"slidingTimer",{get:function(){return this._slidingTimeout},set:function(l){if(l){if(this._stopSliding(),l instanceof Ue.i)this._slidingTimeout=l;else if(!isNaN(l)){var i=l*1e3;this._slidingTimeout=new Ue.i(i)}this._slidingTimeout.totalMilliseconds>0&&this.isEnabled&&this._startSliding()}},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isStyling",{get:function(){throw new Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"style",{get:function(){return this._style},set:function(l){},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"styleOrder",{get:function(){throw new Error("NotImplementedException: styleOrder")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"styleLayers",{get:function(){throw new Error("NotImplementedException: styleLayers")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"styleLanguage",{get:function(){throw new Error("NotImplementedException: styleLanguage")},set:function(l){throw new Error("NotImplementedException: styleLanguage")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"layers",{get:function(){return this._layers},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"stack",{get:function(){for(var l=[],i=0,s=this._stack.length;i<s;i++)l.push(this._stack[i]);return l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isPanning",{get:function(){return this._isPanning},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isZooming",{get:function(){return this._isZooming},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"bounds",{get:function(){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"contextualBounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"cursor",{get:function(){throw Error("NotImplementedException")},set:function(l){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"geoCenter",{get:function(){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"height",{get:function(){return this.size.height},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"attribution",{get:function(){return this._attribution},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"isIdlVisible",{get:function(){var l=this.bounds;l.normalize();var i=l.west.degrees>=l.east.degrees;return i},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"maximumBounds",{get:function(){return this._maxBounds},set:function(l){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"maximumZoomLevel",{get:function(){throw Error("NotImplementedException")},set:function(l){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"minimumZoomLevel",{get:function(){throw Error("NotImplementedException")},set:function(l){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"offset",{get:function(){var l=this.bounds,i=new I.c;i.west=He.o.fromRadians(l.west.radians),i.east=He.o.fromRadians(l.east.radians),i.south=mt.K.fromRadians(l.south.radians),i.north=mt.K.fromRadians(l.north.radians);var s=new Sa;return s.bounds=i,s.left=new Re.R(Qe.rm*Math.round(l.west.radians/Qe.rm)),s.right=new Re.R(Qe.rm*Math.round(l.east.radians/Qe.rm)),s},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"projection",{get:function(){return this._projection},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"quadKeys",{get:function(){for(var l=this._calculateTiles(),i=[],s={},_=0,b=l.length;_<b;_++){var D=l[_],G=Bt.x.convertTileToQuadkey(D);s.hasOwnProperty(G)||(s[G]=null,i.push(G))}return i.sort()},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"scale",{get:function(){var l=this.zoomLevel,i=Bt.x.deriveScale(l);return i},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"screenCenter",{get:function(){var l=this.size;return new T.E(l.width/2,l.height/2)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"size",{get:function(){var l=this._engine.getSize(),i=new m.$(l.x,l.y);return i},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tmsTiles",{get:function(){return this._calculateTiles(null,256,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"width",{get:function(){return this.size.width},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"wmtsTiles",{get:function(){return this._calculateTiles(null,256,!1)},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"zoomLevel",{get:function(){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"loadingTimer",{get:function(){return this._loadingDuration},set:function(l){this._loadingDuration=l},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"animator",{get:function(){return this._animator},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"clock",{get:function(){return this._clock},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"device",{get:function(){return this._device},enumerable:!0,configurable:!0}),O.prototype._setDevice=function(l){this._device=l},Object.defineProperty(O.prototype,"keyboard",{get:function(){return this._keyboard},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"mouse",{get:function(){return this._mouse},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"touches",{get:function(){return this._touches},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"boxZoom",{get:function(){return this._boxZoom},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"doubleClickZoom",{get:function(){return this._doubleClickZoom},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"dragging",{get:function(){return this._dragging},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"featureTileGrid",{get:function(){return this._featureTileGrid},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"graticule",{get:function(){return this._graticule},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"hover",{get:function(){return this._hover},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"idl",{get:function(){return this._idl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"keyboardNavigation",{get:function(){return this._keyboardNavigation},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"rotate",{get:function(){return this._rotate},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"pitch",{get:function(){throw new Error("NotImplementedException")},set:function(l){throw new Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"bearing",{get:function(){throw new Error("NotImplementedException")},set:function(l){throw new Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"scrollWheelZoom",{get:function(){return this._scrollWheelZoom},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"touchZoom",{get:function(){return this._touchZoom},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tileGrid",{get:function(){return this._tileGrid},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tilting",{get:function(){return this._tilting},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"inrixConsumerId",{get:function(){return this._inrixConsumerId},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"inrixUrl",{get:function(){return this._inrixUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"inrixVendorId",{get:function(){return this._inrixVendorId},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"mapboxAccessToken",{get:function(){return this._mapboxAccessToken},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunApiKey",{get:function(){return this._sunApiKey},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunFeatureUrl",{get:function(){return this._sunFeatureUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunGridUrl",{get:function(){return this._sunGridUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunParticleUrl",{get:function(){return this._sunParticleUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunRadarUrl",{get:function(){return this._sunRadarUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunVectorUrl",{get:function(){return this._sunVectorUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunSeriesUrl",{get:function(){return this._sunSeriesUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"sunTileUrl",{get:function(){return this._sunTileUrl},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tesseraMapKey",{get:function(){return this._tesseraMapKey},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tesseraMemberKey",{get:function(){return this._tesseraMemberKey},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"tesseraUrl",{get:function(){return this._tesseraUrl},enumerable:!0,configurable:!0}),O._autoDetectRenderer=function(){var l={failIfMajorPerformanceCaveat:!0},i=document.createElement("canvas"),s=i.getContext("webgl",l)||i.getContext("experimental-webgl",l);return s&&s instanceof WebGLRenderingContext?Q.Renderer.WebGL:Q.Renderer.WebDOM},O.prototype._startSliding=function(){var l=this;this._stopSliding(),this._slidingStart=new Date,this._slidingTimer=window.setTimeout(function(){l._onSlidingTimeout()},this._slidingTimeout.totalMilliseconds)},O.prototype._stopSliding=function(){clearTimeout(this._slidingTimer)},O.prototype._startLoading=function(){var l=this;this._stopLoading(),this._loadingTimer=window.setTimeout(function(){l._onLoadingTimeout()},this._loadingDuration.totalMilliseconds)},O.prototype._stopLoading=function(){clearTimeout(this._loadingTimer)},O.prototype._startAbsolute=function(){var l=this;this._stopAbsolute(),this._absoluteStart=new Date,this._absoluteTimer=window.setTimeout(function(){l._onAbsoluteTimeout()},this._absoluteTimeout.totalMilliseconds)},O.prototype._stopAbsolute=function(){clearTimeout(this._absoluteTimer)},O.prototype._slide=function(){this.isEnabled&&this._slidingTimeout.totalMilliseconds>0&&this._startSliding()},O.prototype._deriveTouches=function(l){var i=[];this._position=ui.findPosition(this.element);for(var s=0,_=l.length;s<_;s++){var b=l[s],D=new Ii,G=b.pageX-this._position.x,Z=b.pageY-this._position.y;D._screenPoint=new T.E(G,Z),D._geoPoint=this.fromScreenToGeo(D.screenPoint);var te=v.F.fromRadians(D._geoPoint.latitude.radians,D._geoPoint.longitude.radians);te.normalize();var ae=Math.pow(2,this.zoomLevel),Pe=Bt.x.convertGeoToTile(te,this.zoomLevel,256,this._lastInputTile),ve=new Kt.n(Pe.z,Pe.x,ae-Pe.y-1);D._tmsTile=Pe,D._wmtsTile=ve,D._tmsTile=Pe,D._wmtsTile=ve,i.push(D)}return i},O.prototype._computeProjectionExtent=function(){var l=v.F.fromRadians(0,Math.PI),i=v.F.fromRadians(0,-Math.PI);return this._projection.geoToMap(l).x-this._projection.geoToMap(i).x},O.prototype._computeMinimumScale=function(l){var i=l||this._computeProjectionExtent(),s=this.width/i;return s},O.prototype._computeMinimumZoomLevel=function(l){var i=l||this._computeMinimumScale(),s=Bt.x.deriveZoomLevelExact(i),_=s;return _},O.prototype._applyDefaultStyle=function(){var l="#"+this.element.id+"{alignment-adjust:initial;alignment-baseline:initial;animation:initial;animation-delay:initial;animation-direction:initial;animation-duration:initial;animation-fill-mode:initial;animation-iteration-count:initial;animation-name:initial;animation-play-state:initial;animation-timing-function:initial;azimuth:initial;backface-visibility:initial;background:initial;background-attachment:initial;background-clip:initial;background-color:initial;background-image:initial;background-origin:initial;background-position:initial;background-position-x:initial;background-position-y:initial;background-repeat:initial;background-size:initial;baseline-shift:initial;behavior:initial;binding:initial;border:initial;border-bottom:initial;border-bottom-color:initial;border-bottom-left-radius:initial;border-bottom-right-radius:initial;border-bottom-style:initial;border-bottom-width:initial;border-collapse:initial;border-color:initial;border-image:initial;border-image-outset:initial;border-image-repeat:initial;border-image-slice:initial;border-image-source:initial;border-image-width:initial;border-left:initial;border-left-color:initial;border-left-style:initial;border-left-width:initial;border-radius:initial;border-right:initial;border-right-color:initial;border-right-style:initial;border-right-width:initial;border-spacing:initial;border-style:initial;border-top:initial;border-top-color:initial;border-top-left-radius:initial;border-top-right-radius:initial;border-top-style:initial;border-top-width:initial;border-width:initial;bottom:initial;box-decoration-break:initial;box-shadow:initial;box-sizing:initial;break-after:initial;break-before:initial;break-inside:initial;caption-side:initial;chains:initial;_clear:initial;clip:initial;color:initial;color-interpolation:initial;color-interpolation-filters:initial;color-rendering:initial;column-count:initial;column-fill:initial;column-gap:initial;column-rule:initial;column-rule-color:initial;column-rule-style:initial;column-rule-width:initial;columns:initial;content:initial;counter-increment:initial;counter-reset:initial;crop:initial;cue:initial;cue-after:initial;cue-before:initial;cursor:initial;direction:initial;display:block;dominant-baseline:initial;drop-initial-after-adjust:initial;drop-initial-after-align:initial;drop-initial-before-adjust:initial;drop-initial-before-align:initial;drop-initial-size:initial;drop-initial-value:initial;elevation:initial;empty-cells:initial;fill:initial;fill-opacity:initial;fill-rule:initial;filter:initial;fit:initial;fit-position:initial;flex-align:initial;flex-flow:initial;flex-line-pack:initial;flex-order:initial;flex-pack:initial;float:initial;font:initial;font-family:initial;font-feature-configuration:initial;font-kerning:initial;font-language-override:initial;font-size:initial;font-size-adjust:initial;font-stretch:initial;font-style:initial;font-synthesis:initial;font-variant:initial;font-variant-alternates:initial;font-variant-caps:initial;font-variant-east-asian:initial;font-variant-ligatures:initial;font-variant-numeric:initial;font-variant-position:initial;font-weight:initial;grid-cell:initial;grid-cell-stacking:initial;grid-column:initial;grid-column-align:initial;grid-column-sizing:initial;grid-column-span:initial;grid-columns:initial;grid-flow:initial;grid-layer:initial;grid-row:initial;grid-row-align:initial;grid-row-sizing:initial;grid-row-span:initial;grid-rows:initial;grid-template:initial;hanging-punctuation:initial;height:initial;hyphens:initial;icon:initial;image-orientation:initial;image-rendering:initial;image-resolution:initial;image-mode:initial;inline-box-align:initial;left:initial;letter-spacing:initial;line-break:initial;line-height:initial;line-stacking:initial;line-stacking-ruby:initial;line-stacking-shift:initial;line-stacking-strategy:initial;list-style:initial;list-style-image:initial;list-style-position:initial;list-style-type:initial;margin:initial;margin-bottom:initial;margin-left:initial;margin-right:initial;margin-top:initial;marker:initial;marker-end:initial;marker-mid:initial;marker-start:initial;marquee-loop:initial;max-height:initial;max-width:initial;min-height:initial;min-width:initial;move-to:initial;nav-down:initial;nav-index:initial;nav-left:initial;nav-right:initial;nav-up:initial;object-fit:initial;object-position:initial;opacity:initial;orphans:initial;outline:initial;outline-color:initial;outline-offset:initial;outline-style:initial;outline-width:initial;overflow:initial;overflow-style:initial;overflow-wrap:initial;overflow-x:initial;overflow-y:initial;padding:initial;padding-bottom:initial;padding-left:initial;padding-right:initial;padding-top:initial;page:initial;page-break-after:initial;page-break-before:initial;page-break-inside:initial;page-policy:initial;pause:initial;pause-after:initial;pause-before:initial;perspective:initial;perspective-origin:initial;pitch:initial;pitch-range:initial;pointer-events:initial;position:initial;presentation-level:initial;quotes:initial;_resize:initial;rest:initial;rest-after:initial;rest-before:initial;richness:initial;right:initial;rotation:initial;rotation-point:initial;ruby-align:initial;ruby-overhang:initial;ruby-position:initial;ruby-span:initial;scrollbar-3dlight-color:initial;scrollbar-arrow-color:initial;scrollbar-base-color:initial;scrollbar-darkshadow-color:initial;scrollbar-face-color:initial;scrollbar-highlight-color:initial;scrollbar-shadow-color:initial;scrollbar-track-color:initial;shape-rendering:initial;speak:initial;speak-as:initial;speak-header:initial;speak-numeral:initial;speak-punctuation:initial;speech-rate:initial;stop-color:initial;stop-opacity:initial;stress:initial;stroke:initial;stroke-dasharray:initial;stroke-dashoffset:initial;stroke-linecap:initial;stroke-linejoin:initial;stroke-miterlimit:initial;stroke-opacity:initial;stroke-width:initial;tab-size:initial;table-layout:initial;target:initial;target-name:initial;target-new:initial;target-position:initial;text-align:initial;text-align-last:initial;text-combine-horizontal:initial;text-combine-mode:initial;text-decoration:initial;text-decoration-color:initial;text-decoration-line:initial;text-decoration-skip:initial;text-decoration-style:initial;text-emphasis:initial;text-emphasis-color:initial;text-emphasis-position:initial;text-emphasis-style:initial;text-height:initial;text-indent:initial;text-justify:initial;text-orientation:initial;text-overflow:initial;text-rendering:initial;text-shadow:initial;text-space-collapse:initial;text-transform:initial;text-underline-position:initial;text-wrap:initial;unicode-bidi:initial;user-select:initial;vertical-align:initial;visibility:initial;voice-balance:initial;voice-duration:initial;voice-family:initial;voice-pitch:initial;voice-range:initial;voice-rate:initial;voice-stress:initial;voice-volume:initial;volume:initial;white-space:initial;widows:initial;width:initial;word-break:initial;word-spacing:initial;word-wrap:initial;writing-mode:initial;z-index:initial;zoom:initial;}.leaflet-map-pane svg{z-index:0;}";l+="#"+this.element.id+" img {max-width:initial;border:initial;min-width:initial;width:initial;height:initial;}",ui.injectCss(l)},O.prototype._bootStrap=function(l){this.maximumZoomLevel=l.maximumZoomLevel||21,this.minimumZoomLevel=l.minimumZoomLevel||1,l.maximumBounds?this.maximumBounds=l.maximumBounds:this.maximumBounds=this._maxBounds;var i=l.latitude||0,s=l.longitude||0,_=l.zoomLevel||3;if(this.move(i,s,_),l.layers)for(var b=0,D=l.layers.length;b<D;b++){var G=l.layers[b],Z=this.createLayer(G);this.addLayer(Z)}this.resize()},O.prototype._calculateTiles=function(l,i,s,_){i===void 0&&(i=256),s===void 0&&(s=!0);var b=l||this.zoomLevel,D=this.bounds,G=Bt.x.deriveTiles(D,b,i,s,_);return G},O.prototype.addLayer=function(l){this.insertLayer(l)},O.prototype.arrangeLayer=function(l,i){if(!(!this.isEnabled||this._layers[l]===void 0)){var s=this._stack.length;i>s?i=s-1:i<0&&(i=0);for(var _,b=0;b<s;b++){var D=this._stack[b];D===l&&(_=b)}this._stack.splice(_,1),this._stack.splice(i,0,l),this._arrangeLayers(),this._slide(),this.layerArranged.trigger({id:l,index:i})}},O.prototype.arrangeLayerDown=function(l){if(!(!this.isEnabled||this._layers[l]===void 0)){for(var i,s=0,_=this._stack.length;s<_;s++){var b=this._stack[s];b===l&&(i=s)}if(!(i<1)){var D=i-1;this._stack.splice(i,1),this._stack.splice(D,0,l),this._arrangeLayers(),this._slide(),this.layerArranged.trigger({id:l,index:D})}}},O.prototype.arrangeLayerUp=function(l){if(!(!this.isEnabled||this._layers[l]===void 0)){for(var i,s=0,_=this._stack.length;s<_;s++){var b=this._stack[s];b===l&&(i=s)}if(i!==this._stack.length-1){var D=i+1;this._stack.splice(i,1),this._stack.splice(D,0,l),this._arrangeLayers(),this._slide(),this.layerArranged.trigger({id:l,index:D})}}},O.prototype.clearLayers=function(){if(!!this.isEnabled)for(var l in this._layers)this.removeLayer(l)},O.prototype.clearPopups=function(){for(var l in this._popups){var i=this._popups[l];this.closePopup(i)}},O.prototype.closePopup=function(l){delete this._popups[l._id],l._removeFromMap(this),this.popupClosed.trigger()},O.prototype.createLayer=function(l){var i=null;if(l instanceof le.x)i=new le.e(l);else if(l instanceof Gi)i=new $i(l);else if(l instanceof ln)i=new co(l);else if(l instanceof Fr.K)i=new Fr.Q(l);else if(l instanceof je)i=new xe(l);else if(l instanceof zr)i=new rn(l);else if(l instanceof se)i=new X(l);else if(l instanceof wr)i=new mn(l);else if(l instanceof yi.z)i=new yi.I(l);else if(l instanceof $.t)i=new $.A(l);else if(l instanceof Eo)i=new Hn(l);else if(l instanceof qn.d)i=new qn.P(l);else if(l instanceof ii)i=new ri(l);else if(l instanceof Ki)i=new un(l);else if(l instanceof Ci.L)i=new Ci.a(l);else if(l instanceof Bi.w)i=new Bi.s(l);else if(l instanceof Ei)i=new Dn(l);else if(l instanceof Yt)i=new ur(l);else throw new Error("InvalidArgumentException: No supported layer for given options.");return i},O.prototype.capture=function(){throw Error("NotImplementedException")},O.prototype.disable=function(){},O.prototype.enable=function(){},O.prototype.dispose=function(){this._isDisposed||(this._isDisposed=!0,this.clearLayers(),this.disable(),W.j.removeDomListener(window,"resize",this._onWindowResize,this),W.j.removeDomListener(window,"beforeunload",this._onUnloaded,this),this._engine.remove())},O.prototype.fetchLayer=function(l){return this._layers.hasOwnProperty(l)?this._layers[l]:null},O.prototype.fetchPopup=function(l){return this._popups.hasOwnProperty(l)?this._popups[l]:null},O.prototype.findFeatures=function(l){for(var i=[],s=0,_=this._stack.length;s<_;s++){var b=this._stack[s],D=this._layers[b];if(D instanceof Ci.a){var G=D;this._detectFeatures(l,G.features,i)}}return i},O.prototype._detectFeature=function(l,i,s){var _=[];if(i instanceof Dt.t){var b=i;_.push(b.point)}else if(i instanceof dt.P){var D=i;_=D.polyline.points}else if(i instanceof ai.L){var G=i;_=G.polygon.polylines[0].points}else return;var Z=new I.c;Z.invalidate();for(var te=0,ae=_.length;te<ae;te++)Z.expand(_[te]);var Pe=l.intersects(Z);if(i instanceof Dt.t)if(Pe)s.push(i);else return;else if(!Pe)return;if(i instanceof ai.L){var ve=new Ft.A(_);if(ve.contains(l.centerPoint)){s.push(i);return}if(ve.contains(l.topLeftGeoPoint)){s.push(i);return}if(ve.contains(l.topRightGeoPoint)){s.push(i);return}if(ve.contains(l.bottomLeftGeoPoint)){s.push(i);return}if(ve.contains(l.bottomRightGeoPoint)){s.push(i);return}}!(i instanceof ai.L||i instanceof ai.L)},O.prototype._detectFeatures=function(l,i,s){for(var _=0,b=i.length;_<b;_++){var D=i[_];this._detectFeature(l,D,s)}},O.prototype.findOverlays=function(l){throw new Error("NotImplementedException")},O.prototype.findVectors=function(l){throw new Error("NotImplementedException")},O.prototype.fit=function(l,i,s,_,b){throw new Error("NotImplementedException")},O.prototype.loadImage=function(l,i){throw new Error("NotImplementedError: loadImage")},O.prototype.addImage=function(l,i){throw new Error("NotImplementedError: addImage")},O.prototype.fetchImage=function(l){throw new Error("NotImplementedError: fetchImage")},O.prototype.removeImage=function(l){throw new Error("NotImplementedError: removeImage")},O.prototype.fromGeoToScreen=function(l,i){var s=this.zoomLevel;i||(i=new T.E(0,0));var _=this.contextualBounds,b=Bt.x.convertLatLngToPixel(_.north,_.west,s,i),D=b.x,G=b.y;return Bt.x.convertLatLngToPixel(l.latitude,l.longitude,s,i),i.x=i.x-D,i.y=i.y-G,i},O.prototype.fromScreenToGeo=function(l,i){var s=this.zoomLevel,_=this.contextualBounds;i||(i=v.F.fromRadians(0,0));var b=Bt.x.convertLatLngToPixel(_.north,_.west,s,this._lastConversionPixelPoint);return b.x=b.x+l.x,b.y=b.y+l.y,Bt.x.convertPixelToGeo(b,s,i),i},O.prototype.insertLayer=function(l,i){if(i===void 0&&(i=null),!(!this.isEnabled||this._layers[l.id]!=null)){var s=l.id;this._layers[s]=l;var _;i!=null?(this._stack.splice(i,0,s),_=i):_=this._stack.push(s)-1,l.loading.addListener(this._onLayerLoading,this),l.loaded.addListener(this._onLayerLoaded,this),l._addToMap(this),this._arrangeLayers(),this._slide();var b={layer:l};this.layerAdded.trigger(b)}},O.prototype.move=function(l,i,s,_,b,D){},O.prototype.openPopup=function(l,i){i===void 0&&(i=!0),i&&this.clearPopups(),this._popups[l.id]=l,l._addToMap(this),this.popupOpened.trigger()},O.prototype.page=function(l,i,s){if(!!this.isEnabled){var _=0;l>1?_=this.width/2:l<1&&(_=-(this.width/2));var b=0;i>1?b=-(this.height/2):i<1&&(b=this.height/2),this.pan(_,b,s)}},O.prototype.pan=function(l,i,s){},O.prototype.removeLayer=function(l){if(!!this.isEnabled){var i=this._layers[l];if(i){try{i._removeFromMap(this)}catch(Z){console.error(Z,Z.message)}delete this._layers[l];for(var s,_=0,b=this._stack.length;_<b;_++){var D=this._stack[_];if(l===D){s=_;break}}this._stack.splice(s,1),this._arrangeLayers(),i.loading.removeListener(this._onLayerLoading,this),i.loaded.removeListener(this._onLayerLoaded,this),this._slide();var G={layer:i};this.layerRemoved.trigger(G)}}},O.prototype.resize=function(l,i){},O.prototype.zoom=function(l,i){},O.prototype.zoomIn=function(l){var i=this.zoomLevel+1;this.zoom(i,l)},O.prototype.zoomOut=function(l){var i=this.zoomLevel-1;this.zoom(i,l)},O.prototype._onSlidingTimeout=function(l){this.disable(),this.slidingTimeout.trigger()},O.prototype._onAbsoluteTimeout=function(l){this.disable(),this.absoluteTimeout.trigger()},O.prototype._onMouseDown=function(l){this._setDevice(ni.Mouse),this.mouse._isDown=!0;var i=this._convertToMapEvent(l),s=this.mouse._lastDownScreenPoint;s.x=i.containerPoint.x,s.y=i.containerPoint.y,this.mouse._downScreenPoint=s,this.mouse._screenPoint=i.containerPoint,this.mouse._geoPoint=i.geoPoint;var _={x:i.containerPoint.x,y:i.containerPoint.y,longitude:i.geoPoint.longitude.degrees,latitude:i.geoPoint.latitude.degrees};this.mouseDown.trigger(_)},O.prototype._onMouseUp=function(l){this._setDevice(ni.Mouse),this.mouse._isDown=!1;var i=this._convertToMapEvent(l);this.mouse._screenPoint=i.containerPoint,this.mouse._geoPoint=i.geoPoint,this.mouse._downScreenPoint=null,this._mouseEventArgs={x:i.containerPoint.x,y:i.containerPoint.y,longitude:i.geoPoint.longitude.degrees,latitude:i.geoPoint.latitude.degrees},this.mouseUp.trigger(this._mouseEventArgs)},O.prototype._onMouseOver=function(l){this._setDevice(ni.Mouse),this.mouse._isOver=!0;var i=this._convertToMapEvent(l);this.mouse._screenPoint=i.containerPoint,this.mouse._geoPoint=i.geoPoint;var s={x:i.containerPoint.x,y:i.containerPoint.y,longitude:i.geoPoint.longitude.degrees,latitude:i.geoPoint.latitude.degrees};this.mouseOver.trigger(s)},O.prototype._onMouseOut=function(l){this._setDevice(ni.Mouse),this.mouse._isOver=!1;var i=this._convertToMapEvent(l);this.mouse._screenPoint=i.containerPoint,this.mouse._geoPoint=i.geoPoint;var s={x:i.containerPoint.x,y:i.containerPoint.y,longitude:i.geoPoint.longitude.degrees,latitude:i.geoPoint.latitude.degrees};this.mouseOut.trigger(s)},O.prototype._onMouseMove=function(l){this._setDevice(ni.Mouse),this.isEnabled&&this._slide();var i={},s=this._convertToMapEvent(l);s.containerPoint&&(this.mouse._screenPoint=s.containerPoint,i.x=s.containerPoint.x,i.y=s.containerPoint.y);var _=this.mouse;if(s.geoPoint){_._geoPoint=s.geoPoint;var b=this._lastNormalizedGeoPoint;b.latitude.radians=s.geoPoint.latitude.radians,b.longitude.radians=s.geoPoint.longitude.radians,b.normalize();var D=Bt.x.convertGeoToTile(b,Math.floor(this.zoomLevel),256,this._lastInputTile);_._tmsTile=D;var G=Math.pow(2,Math.floor(this.zoomLevel)),Z=_._wmtsTile;Z.z=D.z,Z.x=D.x,Z.y=G-D.y-1,i.longitude=s.geoPoint.longitude.degrees,i.latitude=s.geoPoint.latitude.degrees}this.mouseMove.trigger(i)},O.prototype._onDoubleClick=function(l){this.device===ni.Mouse?this.mouseDoubleClick.trigger(this._mouseEventArgs):this.device===ni.Touch&&(this._slide(),this.touchDoubleTap.trigger({touches:this.touches}))},O.prototype._onClick=function(l){this.device===ni.Mouse?this.mouseClick.trigger(this._mouseEventArgs):this.device===ni.Touch&&this.touchTap.trigger({touches:this.touches})},O.prototype._onKeyDown=function(l){this._setDevice(ni.Keyboard);var i={keyCode:l.keyCode,charCode:l.charCode,shiftKey:l.shiftKey,ctrlKey:l.ctrlKey,altKey:l.altKey,metaKey:l.metaKey};this.keyboard._isDown=!0,this.keyDown.trigger(i)},O.prototype._onKeyPress=function(l){this._setDevice(ni.Keyboard);var i={keyCode:l.keyCode,charCode:l.charCode};this.keyboard._lastClicked=new Date,this.keyPress.trigger(i)},O.prototype._onKeyUp=function(l){this._setDevice(ni.Keyboard);var i={keyCode:l.keyCode,charCode:l.charCode};this.keyboard._isDown=!1,this.keyUp.trigger(i)},O.prototype._onTouchEnter=function(l){if(this._setDevice(ni.Touch),this.isEnabled&&this._slide(),l.targetTouches&&l.touches.length===l.targetTouches.length){var i=this._deriveTouches(l.targetTouches);this._touches=i;var s={touches:i};this.touchEnter.trigger(s)}},O.prototype._onTouchStart=function(l){if(this._setDevice(ni.Touch),this.isEnabled&&this._slide(),l.targetTouches&&l.touches.length===l.targetTouches.length){var i=this._deriveTouches(l.targetTouches);this._touches=i;var s={touches:i};this.touchStart.trigger(s)}},O.prototype._onTouchMove=function(l){if(this._setDevice(ni.Touch),this.isEnabled&&this._slide(),l.targetTouches&&l.touches.length===l.targetTouches.length){var i=this._deriveTouches(l.targetTouches);this._touches=i;var s={touches:i};this.touchMove.trigger(s)}},O.prototype._onTouchEnd=function(l){this._setDevice(ni.Touch),this.isEnabled&&this._slide(),this._touches=[],this.touchEnd.trigger()},O.prototype._onTouchLeave=function(l){this._setDevice(ni.Touch),this.isEnabled&&this._slide(),this._touches=[],this.touchLeave.trigger()},O.prototype._onTouchCancel=function(l){this._setDevice(ni.Touch),this.isEnabled&&this._slide(),this._touches=[],this.touchCancel.trigger()},O.prototype._onPanning=function(l){this._isPanning||(this.animator&&this.animator.isPlaying&&this.animator.pause(this._loadingDuration),this._isPanning=!0,this.panning.trigger())},O.prototype._onMoving=function(l){var i={};try{if(i.geoCenter=this.geoCenter,l.originalEvent){var s=l.originalEvent;if(s instanceof MouseEvent)s.x!=null&&s.y!=null?(this.mouse._screenPoint.x=i.x=s.x,this.mouse._screenPoint.y=i.y=s.y):s.clientX!=null&&s.clientY!=null?(this.mouse._screenPoint.x=i.x=s.clientX,this.mouse._screenPoint.y=i.y=s.clientY):s.screenX!=null&&s.screenY!=null&&(this.mouse._screenPoint.x=i.x=s.screenX,this.mouse._screenPoint.y=i.y=s.screenY);else if(s.targetTouches&&s.touches.length===s.targetTouches.length){var _=this._deriveTouches(s.targetTouches);this._touches=_}}}catch(b){}this.moving.trigger(i)},O.prototype._onMoved=function(l){var i={};try{if(i.geoCenter=this.geoCenter,l.originalEvent){var s=l.originalEvent;if(s instanceof MouseEvent)s.x!=null&&s.y!=null?(this.mouse._screenPoint.x=i.x=s.x,this.mouse._screenPoint.y=i.y=s.y):s.clientX!=null&&s.clientY!=null?(this.mouse._screenPoint.x=i.x=s.clientX,this.mouse._screenPoint.y=i.y=s.clientY):s.screenX!=null&&s.screenY!=null&&(this.mouse._screenPoint.x=i.x=s.screenX,this.mouse._screenPoint.y=i.y=s.screenY);else if(s.targetTouches&&s.touches.length===s.targetTouches.length){var _=this._deriveTouches(s.targetTouches);this._touches=_}}}catch(b){}this.moved.trigger(i)},O.prototype._onPanned=function(l){this._isPanning&&(this.animator&&this.animator.isPlaying&&this.loadState===x.jd.Loaded&&this.animator.unpause(),this._isPanning=!1,this.panned.trigger())},O.prototype._onMouseWheel=function(l){this._setDevice(ni.Mouse),l||(l=window.event);var i=0;l.wheelDelta&&(i=l.wheelDelta/120),l.detail&&(i=-l.detail/3);var s={delta:i};this.mouseWheel.trigger(s)},O.prototype._onLayerLoading=function(l){this._loadState!=x.jd.Loading&&(this._loadState=x.jd.Loading,this.animator.pause(this._loadingDuration),this._startLoading(),this.loading.trigger(this))},O.prototype._onLayerLoaded=function(l){if(this._loadState!=x.jd.Loaded){var i=!0;for(var s in this._layers){var _=this._layers[s];if(_.loadState!=x.jd.Loaded){i=!1;break}}i&&(this._loadState=x.jd.Loaded,this.loaded.trigger(this),this.animator.unpause())}},O.prototype._onLoadingTimeout=function(l){if(this._loadState!=x.jd.Loaded){var i=!0;for(var s in this._layers){var _=this._layers[s];if(_.loadState!=x.jd.Loaded){i=!1;break}}i?(this._loadState=x.jd.Loaded,this._stopLoading(),this.loaded.trigger(this),this.animator.unpause()):this._startLoading()}},O.prototype._onZooming=function(l){this.animator&&this.animator.isPlaying&&this.animator.pause(this._loadingDuration);var i=this.mouse;if(i._geoPoint){var s=this._lastNormalizedGeoPoint;s.latitude.radians=i.geoPoint.latitude.radians,s.longitude.radians=i.geoPoint.longitude.radians,s.normalize();var _=Bt.x.convertGeoToTile(s,Math.floor(this.zoomLevel),256,this._lastInputTile);i._tmsTile=_;var b=Math.pow(2,Math.floor(this.zoomLevel)),D=i._wmtsTile;D.z=_.z,D.x=_.x,D.y=b-_.y-1}this._isZooming=!0,this.zooming.trigger()},O.prototype._onZoomed=function(l){this.animator&&this.animator.isPlaying&&this.loadState===x.jd.Loaded&&this.animator.unpause();var i=this.mouse;if(i._geoPoint){var s=this._lastNormalizedGeoPoint;s.latitude.radians=i.geoPoint.latitude.radians,s.longitude.radians=i.geoPoint.longitude.radians,s.normalize();var _=Bt.x.convertGeoToTile(s,Math.floor(this.zoomLevel),256,this._lastInputTile);i._tmsTile=_;var b=Math.pow(2,Math.floor(this.zoomLevel)),D=i._wmtsTile;D.z=_.z,D.x=_.x,D.y=b-_.y-1}this._isZooming=!1;var G=this.zoomLevel,Z={zoomLevel:G};this.zoomed.trigger(Z)},O.prototype._onPopupClose=function(l){this.popupClosed.trigger(l),l.popup.parent.closed.trigger(l)},O.prototype._onPopupOpen=function(l){this.popupOpened.trigger(l),l.popup.parent.opened.trigger(l)},O.prototype._onContextMenu=function(l){this.contextMenu.trigger(l)},O.prototype._onWindowResize=function(l){this.resize()},O.prototype._onUnloaded=function(l){this.unloaded.trigger(),this.dispose()},O.prototype._onAnimatorStarted=function(l){this._engine._isAnimating=!0},O.prototype._onAnimatorStopped=function(l){this._engine._isAnimating=!1},O}(),Ca=B(61955),ma=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Za=function(O){ma(l,O);function l(){var i=O!==null&&O.apply(this,arguments)||this;return i._lastFindScreenPoint=new T.E(0,0),i}return l.prototype._setDevice=function(i){var s=i===ni.Touch;if(s!=ui.isTouching)try{ui.isTouching=s}catch(_){}O.prototype._setDevice.call(this,i)},Object.defineProperty(l.prototype,"bounds",{get:function(){var i=this._engine.getBounds(),s=i.getNorthEast(),_=i.getSouthWest(),b=I.c.fromDegrees(s.lat,_.lng,_.lat,s.lng);return b},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"contextualBounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cursor",{get:function(){return this._cursor},set:function(i){if(i!==this._cursor){var s=this._engine.getContainer(),_=s.style.cssText;if(this._cursor=i,this._cursor==="inherit"){if(/cursor/gi.test(_)){var b=_.indexOf("cursor");s.style.cssText=_.slice(0,b)}}else s.style.cssText=_+";cursor:"+this._cursor+" !important"}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"geoCenter",{get:function(){var i=this._engine.getCenter(),s=v.F.fromLeaflet(i);return s},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumBounds",{get:function(){return this._maxBounds},set:function(i){i.north.isGreaterThan(this._maxBounds.north)&&(i.north=this._maxBounds.north),i.south.isLessThan(this._maxBounds.south)&&(i.south=this._maxBounds.south),i.east.isGreaterThan(this._maxBounds.east)&&(i.east=this._maxBounds.east),i.west.isLessThan(this._maxBounds.west)&&(i.west=this._maxBounds.west),this._maxBounds=i;var s=new(gt()).LatLng(i.south.degrees,i.west.degrees),_=new(gt()).LatLng(i.north.degrees,i.east.degrees),b=new(gt()).LatLngBounds(s,_);this._engine.setMaxBounds(b)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumZoomLevel",{get:function(){return this._engine.getMaxZoom()},set:function(i){var s=this.maximumZoomLevel,_=i,b=this._engine;b.setMaxZoom(_),this.maximumZoomLevelChanged.trigger({oldMaximumZoomLevel:s,newMaximumZoomLevel:_})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"minimumZoomLevel",{get:function(){return this._engine.getMinZoom()},set:function(i){if(this._providedMinimumZoom!=i){var s=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this._providedMinimumZoom=i;var _=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this.zoomLevel<_&&this.zoom(_);var b=this._engine;b.setMinZoom(_),s!=_&&this.minimumZoomLevelChanged.trigger({oldMinimumZoomLevel:s,newMinimumZoomLevel:_})}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"size",{get:function(){var i=this._engine.getSize(),s=new m.$(i.x,i.y);return s},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"style",{get:function(){return this._style},set:function(i){if(!i&&this._styleLayer){this._leafletEngine.removeLayer(this._styleLayer);return}i=i.replace("mapbox://styles/",""),this._style!==i&&(this._styleLayer&&this._leafletEngine.removeLayer(this._styleLayer),this._style=i,this._styleLayer=gt().tileLayer("https://api.mapbox.com/styles/v1/"+i+"/tiles/{z}/{x}/{y}?access_token="+this._mapboxAccessToken,{id:i,tileSize:512,zoomOffset:-1,zIndex:1}),this.engine.addLayer(this._styleLayer),this.styled.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"zoomLevel",{get:function(){return this._engine.getZoom()},enumerable:!0,configurable:!0}),l.prototype._arrangeLayers=function(){for(var i=0,s=this._stack.length;i<s;i++){var _=this._stack[i],b=this._layers[_];b._setZIndex((i+2)*2)}},l.prototype._convertToMapEvent=function(i){var s=this._lastMapEvent,_=i.containerPoint;_&&(s.containerPoint.x=_.x,s.containerPoint.y=_.y);var b=i.latlng;return b&&(s.geoPoint.latitude.degrees=b.lat,s.geoPoint.longitude.degrees=b.lng),s},l.prototype._loadMap=function(i,s){var _=this;try{ui.webkit3d=!1}catch(Z){}var b={zoomControl:!1,attributionControl:!1,closePopupOnClick:!0,maxZoom:31,minZoom:0};if(b.keyboardPanOffset=50,s.enablePanningInertia!==void 0&&(b.inertia=this._enablePanningInertia=s.enablePanningInertia),s.panningInertiaDeceleration!==void 0&&(b.inertiaDeceleration=this._panningInertiaDeceleration=s.panningInertiaDeceleration),s.panningInertiaMaximumSpeed!==void 0&&(b.inertiaMaxSpeed=this._panningInertiaMaximumSpeed=s.panningInertiaMaximumSpeed),s.enableZoomingAnimation!=null&&(b.zoomAnimation=this._enableZoomingAnimation=s.enableZoomingAnimation||!0),s.zoomAnimationThreshold!=null&&(b.zoomAnimationThreshold=this._zoomAnimationThreshold=s.zoomAnimationThreshold),s.scrollWheelZoom!=null){var D=s.scrollWheelZoom;b.scrollWheelZoom=D||!0}var G=new(gt()).Map(this.element,b);this._engine=G,this._leafletEngine=G,s.style&&(this.style=s.style),this._engine._panes.tilePane.style.zIndex=1,this._engine._panes.popupPane.style.zIndex=1e3,this._engine.on("click",this._onClick,this),this._engine.on("dblclick",this._onDoubleClick,this),this._engine.on("contextmenu",this._onContextMenu,this),this._engine.on("mousemove",this._onMouseMove,this),this._engine.on("mouseout",this._onMouseOut,this),this._engine.on("mouseover",this._onMouseOver,this),this._engine.on("mouseup",this._onMouseUp,this),this._engine.on("mousedown",this._onMouseDown,this),gt().DomEvent.on(this._engine._container,"mousewheel",this._onMouseWheel,this),gt().DomEvent.on(this._engine._container,"MozMousePixelScroll",gt().DomEvent.preventDefault,this),ui.injectCss(l._leafletCss),setTimeout(function(){_.ready.trigger()},1)},l.prototype._detectOverlays=function(i,s,_){for(var b=0,D=s.length;b<D;b++){var G=s[b];if(G instanceof Ca.Q){var Z=G;this._detectOverlayGroup(i,Z,_)}else this._detectOverlay(i,G,_)}},l.prototype._detectOverlayGroup=function(i,s,_){for(var b=0,D=s.overlays.length;b<D;b++){var G=s.overlays[b];if(G._detectLeafletOverlay(i)){_.push(s);break}}},l.prototype._detectOverlay=function(i,s,_){s._detectLeafletOverlay(i)&&_.push(s)},l.prototype._deriveBounds=function(){try{var i=this._engine.getBounds(),s=this._bounds,_=i._northEast,b=i._southWest;s.north.degrees=_.lat,s.west.degrees=b.lng,s.south.degrees=b.lat,s.east.degrees=_.lng}catch(D){}},l.prototype.fit=function(i,s){var _=i.toLeaflet(),b=s?s.toLeaflet():void 0;this._engine.fitBounds(_,b),this.panned.trigger()},l.prototype.findOverlays=function(i){var s;if(i instanceof v.F){var _=i;s=this.fromGeoToScreen(_,this._lastFindScreenPoint)}else s=i;for(var b=[],D=[],G=0,Z=this._stack.length;G<Z;G++){var te=this._stack[G],ae=this._layers[te];if(ae instanceof Ci.a){for(var Pe=ae,ve=Pe._retrieveValidFeatures(),pe=Pe.clusterEnabled?Pe._clusters:null,Fe=0,ke=ve.length;Fe<ke;Fe++){var Ze=ve[Fe];if(Ze.overlay instanceof Ca.Q)for(var at=Ze.overlay.overlays,Ve=0,st=at.length;Ve<st;Ve++){var Pt=at[Ve];if(Pt._leafletLeftLayer&&Pt._leafletLeftLayer.isAdded||Pt._leafletRightLayer&&Pt._leafletRightLayer.isAdded){D.push(Ze.overlay);break}}else Ze.overlay&&(Ze.overlay._leafletLeftLayer&&Ze.overlay._leafletLeftLayer.isAdded||Ze.overlay._leafletRightLayer&&Ze.overlay._leafletRightLayer.isAdded)&&D.push(Ze.overlay)}pe&&(D=D.concat(pe))}else if(ae instanceof Bi.s){var $e=ae;D=D.concat($e.overlays)}}return this._detectOverlays(s,D,b),b},l.prototype.move=function(i,s,_,b,D,G){if(!!this.isEnabled){_||(_=this.zoomLevel||4),G&&!(G instanceof Mr)&&(G=new Mr(G));var Z=G?G.toLeaflet():{animate:!1},te=new(gt()).LatLng(i,s);if(b||D){this._engine.setView(te,_,{animate:!1});var ae=this.size,Pe=b?ae.width-b:ae.width/2,ve=D?ae.height-D:ae.height/2,pe=new T.E(Pe,ve),Fe=this.fromScreenToGeo(pe);this._engine.setView(Fe.toLeaflet(),_,Z)}else this._engine.setView(te,_,Z);this.panned.trigger()}},l.prototype.pan=function(i,s,_){if(!!this.isEnabled){var b=_?_.toLeaflet():{animate:!1},D=new(gt()).Point(i,s);this._engine.panBy(D,_),this.panned.trigger()}},l.prototype.resize=function(i,s){this._engine.invalidateSize(!1),this._slide(),i&&(this.element.style.width=i+"px"),s&&(this.element.style.height=s+"px"),this._position=ui.findPosition(this.element),this._projectionExtent=this._computeProjectionExtent();var _=this._computeMinimumZoomLevel();if(_!=this._computedMinimumZoom){var b=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this._computedMinimumZoom=_;var D=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this.zoomLevel<D&&this.zoom(D),this._engine.options.minZoom=D,b!=D&&this.minimumZoomLevelChanged.trigger({oldMinimumZoomLevel:b,newMinimumZoomLevel:D})}this._engine.invalidateSize(!1);var G={size:this.size};this.resized.trigger(G)},l.prototype.zoom=function(i,s){if(!(!this.isEnabled||i<this._providedMinimumZoom)){i<this._computedMinimumZoom&&(i=this._computedMinimumZoom),s&&(s=s instanceof Mr?s:new Mr(s));var _=s?s.toLeaflet():void 0;this._engine.setZoom(i,_)}},l.prototype.enable=function(){if(this._isDisposed)throw new Error("Unable to recreate a disposed map");this.isEnabled||(this._isEnabled=!0,this.clock.startSliding(),this.clock.startTicking(),this._engine.on("movestart",this._onMoving,this),this._engine.on("move",this._onMoving,this),this._engine.on("moveend",this._onMoved,this),this._engine.on("dragstart",this._onPanning,this),this._engine.on("dragend",this._onPanned,this),this._engine.on("zoomend",this._onZoomed,this),this._engine.on("zoomstart",this._onZooming,this),this._engine.on("popupopen",this._onPopupOpen,this),this._engine.on("popupclose",this._onPopupClose,this),this.animator.started.addListener(this._onAnimatorStarted,this),this.animator.stopped.addListener(this._onAnimatorStopped,this),this._slidingTimeout.totalMilliseconds>0&&this._startSliding(),this._absoluteTimeout.totalMilliseconds>0&&this._startAbsolute(),this.enabled.trigger())},l.prototype.disable=function(){this.isEnabled&&(this._isEnabled=!1,this.animator.stop(),this.clock.stopSliding(),this.clock.stopTicking(),this._engine.off("movestart",this._onMoving,this),this._engine.off("move",this._onMoving,this),this._engine.off("moveend",this._onMoved,this),this._engine.off("dragstart",this._onPanning,this),this._engine.off("dragend",this._onPanned,this),this._engine.off("zoomend",this._onZoomed,this),this._engine.off("zoomstart",this._onZooming,this),this._engine.off("popupopen",this._onPopupOpen,this),this._engine.off("popupclose",this._onPopupClose,this),this.animator.started.removeListener(this._onAnimatorStarted,this),this.animator.stopped.removeListener(this._onAnimatorStopped,this),this._stopSliding(),this._stopAbsolute(),this.disabled.trigger())},l.prototype._onMoving=function(i){this._deriveBounds(),O.prototype._onMoving.call(this,i)},l.prototype._onMoved=function(i){this._deriveBounds(),O.prototype._onMoved.call(this,i)},l._leafletCss='.leaflet-pane, .leaflet-tile, .leaflet-marker-icon, .leaflet-marker-shadow, .leaflet-tile-container, .leaflet-pane > svg, .leaflet-pane > canvas, .leaflet-zoom-box, .leaflet-image-layer, .leaflet-layer {position: absolute; left: 0; top: 0;}.leaflet-container {overflow: hidden;}.leaflet-tile, .leaflet-marker-icon, .leaflet-marker-shadow {-webkit-user-select: none;-moz-user-select: none;user-select: none;-webkit-user-drag: none;}.leaflet-safari .leaflet-tile {image-rendering: -webkit-optimize-contrast;}.leaflet-safari .leaflet-tile-container {width: 1600px;height: 1600px;-webkit-transform-origin: 0 0;}.leaflet-marker-icon, .leaflet-marker-shadow {display: block;}.leaflet-container .leaflet-overlay-pane svg, .leaflet-container .leaflet-marker-pane img, .leaflet-container .leaflet-shadow-pane img, .leaflet-container .leaflet-tile-pane img, .leaflet-container img.leaflet-image-layer {max-width: none !important;max-height: none !important;}.leaflet-container.leaflet-touch-zoom {-ms-touch-action: pan-x pan-y;touch-action: pan-x pan-y;}.leaflet-container.leaflet-touch-drag {-ms-touch-action: pinch-zoom;}.leaflet-container.leaflet-touch-drag.leaflet-touch-zoom {-ms-touch-action: none;touch-action: none;}.leaflet-container {-webkit-tap-highlight-color: transparent;}.leaflet-container a {-webkit-tap-highlight-color: rgba(51, 181, 229, 0.4);}.leaflet-tile {filter: inherit;visibility: hidden;}.leaflet-tile-loaded {visibility: inherit;}.leaflet-zoom-box {width: 0;height: 0;-moz-box-sizing: border-box;box-sizing: border-box;z-index: 800;}.leaflet-overlay-pane svg {-moz-user-select: none;}.leaflet-pane {z-index: 400;}.leaflet-tile-pane {z-index: 200;}.leaflet-overlay-pane {z-index: 400;}.leaflet-shadow-pane {z-index: 500;}.leaflet-marker-pane {z-index: 600;}.leaflet-tooltip-pane {z-index: 650;}.leaflet-popup-pane {z-index: 700;}.leaflet-map-pane canvas {z-index: 100;}.leaflet-map-pane svg {z-index: 200;}.leaflet-vml-shape {width: 1px;height: 1px;}.lvml {behavior: url(#default#VML);display: inline-block;position: absolute;}.leaflet-control {position: relative;z-index: 800;pointer-events: visiblePainted;pointer-events: auto;}.leaflet-top, .leaflet-bottom {position: absolute;z-index: 1000;pointer-events: none;}.leaflet-top {top: 0;}.leaflet-right {right: 0;}.leaflet-bottom {bottom: 0;}.leaflet-left {left: 0;}.leaflet-control {float: left;clear: both;}.leaflet-right .leaflet-control {float: right;}.leaflet-top .leaflet-control {margin-top: 10px;}.leaflet-bottom .leaflet-control {margin-bottom: 10px;}.leaflet-left .leaflet-control {margin-left: 10px;}.leaflet-right .leaflet-control {margin-right: 10px;}.leaflet-fade-anim .leaflet-tile {will-change: opacity;}.leaflet-fade-anim .leaflet-popup {opacity: 0;-webkit-transition: opacity 0.2s linear;-moz-transition: opacity 0.2s linear;-o-transition: opacity 0.2s linear;transition: opacity 0.2s linear;}.leaflet-fade-anim .leaflet-map-pane .leaflet-popup {opacity: 1;}.leaflet-zoom-animated {-webkit-transform-origin: 0 0;-ms-transform-origin: 0 0;transform-origin: 0 0;}.leaflet-zoom-anim .leaflet-zoom-animated {will-change: transform;}.leaflet-zoom-anim .leaflet-zoom-animated {-webkit-transition: -webkit-transform 0.25s cubic-bezier(0,0,0.25,1);-moz-transition: -moz-transform 0.25s cubic-bezier(0,0,0.25,1);-o-transition: -o-transform 0.25s cubic-bezier(0,0,0.25,1);transition: transform 0.25s cubic-bezier(0,0,0.25,1);}.leaflet-zoom-anim .leaflet-tile, .leaflet-pan-anim .leaflet-tile {-webkit-transition: none;-moz-transition: none;-o-transition: none;transition: none;}.leaflet-zoom-anim .leaflet-zoom-hide {visibility: hidden;}.leaflet-interactive {cursor: pointer;}.leaflet-grab {cursor: -webkit-grab;cursor: -moz-grab;}.leaflet-crosshair, .leaflet-crosshair .leaflet-interactive {cursor: crosshair;}.leaflet-popup-pane, .leaflet-control {cursor: auto;}.leaflet-dragging .leaflet-grab, .leaflet-dragging .leaflet-grab .leaflet-interactive, .leaflet-dragging .leaflet-marker-draggable {cursor: move;cursor: -webkit-grabbing;cursor: -moz-grabbing;}.leaflet-marker-icon.leaflet-interactive, .leaflet-image-layer.leaflet-interactive, .leaflet-pane > svg path.leaflet-interactive {pointer-events: visiblePainted;pointer-events: auto;}.leaflet-container {background: #ddd;outline: 0;}.leaflet-container a {color: #0078A8;}.leaflet-container a.leaflet-active {outline: 2px solid orange;}.leaflet-zoom-box {border: 2px dotted #38f;background: rgba(255,255,255,0.5);}.leaflet-container {font: 12px/1.5 "Helvetica Neue", Arial, Helvetica, sans-serif;}.leaflet-bar {box-shadow: 0 1px 5px rgba(0,0,0,0.65);border-radius: 4px;}.leaflet-bar a, .leaflet-bar a:hover {background-color: #fff;border-bottom: 1px solid #ccc;width: 26px;height: 26px;line-height: 26px;display: block;text-align: center;text-decoration: none;color: black;}.leaflet-bar a, .leaflet-control-layers-toggle {background-position: 50% 50%;background-repeat: no-repeat;display: block;}.leaflet-bar a:hover {background-color: #f4f4f4;}.leaflet-bar a:first-child {border-top-left-radius: 4px;border-top-right-radius: 4px;}.leaflet-bar a:last-child {border-bottom-left-radius: 4px;border-bottom-right-radius: 4px;border-bottom: none;}.leaflet-bar a.leaflet-disabled {cursor: default;background-color: #f4f4f4;color: #bbb;}.leaflet-touch .leaflet-bar a {width: 30px;height: 30px;line-height: 30px;}.leaflet-touch .leaflet-bar a:first-child {border-top-left-radius: 2px;border-top-right-radius: 2px;}.leaflet-touch .leaflet-bar a:last-child {border-bottom-left-radius: 2px;border-bottom-right-radius: 2px;}.leaflet-control-zoom-in, .leaflet-control-zoom-out {font: bold 18px "Lucida Console", Monaco, monospace;text-indent: 1px;}.leaflet-touch .leaflet-control-zoom-in, .leaflet-touch .leaflet-control-zoom-out {font-size: 22px;}.leaflet-control-layers {box-shadow: 0 1px 5px rgba(0,0,0,0.4);background: #fff;border-radius: 5px;}.leaflet-control-layers-toggle {background-image: url(images/layers.png);width: 36px;height: 36px;}.leaflet-retina .leaflet-control-layers-toggle {background-image: url(images/layers-2x.png);background-size: 26px 26px;}.leaflet-touch .leaflet-control-layers-toggle {width: 44px;height: 44px;}.leaflet-control-layers .leaflet-control-layers-list, .leaflet-control-layers-expanded .leaflet-control-layers-toggle {display: none;}.leaflet-control-layers-expanded .leaflet-control-layers-list {display: block;position: relative;}.leaflet-control-layers-expanded {padding: 6px 10px 6px 6px;color: #333;background: #fff;}.leaflet-control-layers-scrollbar {overflow-y: scroll;overflow-x: hidden;padding-right: 5px;}.leaflet-control-layers-selector {margin-top: 2px;position: relative;top: 1px;}.leaflet-control-layers label {display: block;}.leaflet-control-layers-separator {height: 0;border-top: 1px solid #ddd;margin: 5px -10px 5px -6px;}.leaflet-default-icon-path {background-image: url(images/marker-icon.png);}.leaflet-container .leaflet-control-attribution {background: #fff;background: rgba(255, 255, 255, 0.7);margin: 0;}.leaflet-control-attribution, .leaflet-control-scale-line {padding: 0 5px;color: #333;}.leaflet-control-attribution a {text-decoration: none;}.leaflet-control-attribution a:hover {text-decoration: underline;}.leaflet-container .leaflet-control-attribution, .leaflet-container .leaflet-control-scale {font-size: 11px;}.leaflet-left .leaflet-control-scale {margin-left: 5px;}.leaflet-bottom .leaflet-control-scale {margin-bottom: 5px;}.leaflet-control-scale-line {border: 2px solid #777;border-top: none;line-height: 1.1;padding: 2px 5px 1px;font-size: 11px;white-space: nowrap;overflow: hidden;-moz-box-sizing: border-box;box-sizing: border-box;background: #fff;background: rgba(255, 255, 255, 0.5);}.leaflet-control-scale-line:not(:first-child) {border-top: 2px solid #777;border-bottom: none;margin-top: -2px;}.leaflet-control-scale-line:not(:first-child):not(:last-child) {border-bottom: 2px solid #777;}.leaflet-touch .leaflet-control-attribution, .leaflet-touch .leaflet-control-layers, .leaflet-touch .leaflet-bar {box-shadow: none;}.leaflet-touch .leaflet-control-layers, .leaflet-touch .leaflet-bar {border: 2px solid rgba(0,0,0,0.2);background-clip: padding-box;}.leaflet-popup {position: absolute;text-align: center;margin-bottom: 20px;}.leaflet-popup-content-wrapper {padding: 1px;text-align: left;border-radius: 12px;}.leaflet-popup-content {margin: 13px 19px;line-height: 1.4;}.leaflet-popup-content p {margin: 18px 0;}.leaflet-popup-tip-container {width: 40px;height: 20px;position: absolute;left: 50%;margin-left: -20px;overflow: hidden;pointer-events: none;}.leaflet-popup-tip {width: 17px;height: 17px;padding: 1px;margin: -10px auto 0;-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);-ms-transform: rotate(45deg);-o-transform: rotate(45deg);transform: rotate(45deg);}.leaflet-popup-content-wrapper, .leaflet-popup-tip {background: white;color: #333;box-shadow: 0 3px 14px rgba(0,0,0,0.4);}.leaflet-container a.leaflet-popup-close-button {position: absolute;top: 0;right: 0;padding: 4px 4px 0 0;border: none;text-align: center;width: 18px;height: 14px;font: 16px/14px Tahoma, Verdana, sans-serif;color: #c3c3c3;text-decoration: none;font-weight: bold;background: transparent;}.leaflet-container a.leaflet-popup-close-button:hover {color: #999;}.leaflet-popup-scrolled {overflow: auto;border-bottom: 1px solid #ddd;border-top: 1px solid #ddd;}.leaflet-oldie .leaflet-popup-content-wrapper {zoom: 1;}.leaflet-oldie .leaflet-popup-tip {width: 24px;margin: 0 auto;-ms-filter: "progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678)";filter: progid:DXImageTransform.Microsoft.Matrix(M11=0.70710678, M12=0.70710678, M21=-0.70710678, M22=0.70710678);}.leaflet-oldie .leaflet-popup-tip-container {margin-top: -1px;}.leaflet-oldie .leaflet-control-zoom, .leaflet-oldie .leaflet-control-layers, .leaflet-oldie .leaflet-popup-content-wrapper, .leaflet-oldie .leaflet-popup-tip {border: 1px solid #999;}.leaflet-div-icon {background: none;border: none;}.leaflet-tooltip {position: absolute;padding: 6px;background-color: #fff;border: 1px solid #fff;border-radius: 3px;color: #222;white-space: nowrap;-webkit-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;pointer-events: none;box-shadow: 0 1px 3px rgba(0,0,0,0.4);}.leaflet-tooltip.leaflet-clickable {cursor: pointer;pointer-events: auto;}.leaflet-tooltip-top:before, .leaflet-tooltip-bottom:before, .leaflet-tooltip-left:before, .leaflet-tooltip-right:before {position: absolute;pointer-events: none;border: 6px solid transparent;background: transparent;content: "";}.leaflet-tooltip-bottom {margin-top: 6px;}.leaflet-tooltip-top {margin-top: -6px;}.leaflet-tooltip-bottom:before, .leaflet-tooltip-top:before {left: 50%;margin-left: -6px;}.leaflet-tooltip-top:before {bottom: 0;margin-bottom: -12px;border-top-color: #fff;}.leaflet-tooltip-bottom:before {top: 0;margin-top: -12px;margin-left: -6px;border-bottom-color: #fff;}.leaflet-tooltip-left {margin-left: -6px;}.leaflet-tooltip-right {margin-left: 6px;}.leaflet-tooltip-left:before, .leaflet-tooltip-right:before {top: 50%;margin-top: -6px;}.leaflet-tooltip-left:before {right: 0;margin-right: -12px;border-left-color: #fff;}.leaflet-tooltip-right:before {left: 0;margin-left: -12px;border-right-color: #fff;}',l}(_a),so=function(){function O(l){l===void 0&&(l={}),this.className=void 0,this.displayCloseButton=void 0,this.enableCloseOnClick=void 0,this.id=void 0,this.maximumHeight=void 0,this.maximumWidth=void 0,this.minimumWidth=void 0,this.offset=void 0,this.panning=void 0,(0,x.f0)(this,l)}return O.prototype.toLeaflet=function(){var l={};if(this.maximumHeight!=null&&(l.maxHeight=this.maximumHeight),this.minimumWidth!=null&&(l.minWidth=this.minimumWidth),this.maximumWidth!=null&&(l.maxWidth=this.maximumWidth),this.displayCloseButton!=null&&(l.closeButton=this.displayCloseButton),this.enableCloseOnClick!=null&&(l.closeOnClick=this.enableCloseOnClick),this.panning!=null){var i=this.panning.toLeaflet();l.autoPan=i.autoPan,l.autoPanPadding=i.autoPanPadding}else l.autoPan=!1;if(l.keepInView=!1,this.offset!=null){var s=new(gt()).Point(this.offset.x,this.offset.y);l.offset=s}else{var s=new(gt()).Point(0,0);l.offset=s}return this.className!=null&&(l.className=this.className),l},O.prototype.toMapbox=function(){var l={};if(this.displayCloseButton!=null&&(l.closeButton=this.displayCloseButton),this.enableCloseOnClick!=null&&(l.closeOnClick=this.enableCloseOnClick),this.offset!=null)l.offset=new(Cr()).Point(this.offset.x,this.offset.y);else{var i=new(Cr()).Point(0,0);l.offset=i}return this.className!=null&&(l.className=this.className),this.maximumWidth!=null&&(l.maxWidth=this.maximumWidth+"px"),this.minimumWidth!=null&&this.minimumWidth>240&&(l.maxWidth=this.minimumWidth+"px"),l},O}(),na=function(){function O(l){this._isOver=!1,this._map=null,this._loadState=x.jd.Unloaded,this.click=new W.j,this.closed=new W.j,this.contextMenu=new W.j,this.doubleClick=new W.j,this.mouseDown=new W.j,this.mouseOut=new W.j,this.mouseOver=new W.j,this.mouseUp=new W.j,this.moved=new W.j,this.opened=new W.j,l=l instanceof so?l:new so(l),this._id=l.id||(0,x.cm)(),this._className=l.className,this._displayCloseButton=l.displayCloseButton!=null?l.displayCloseButton:!0,this._enableCloseOnClick=l.enableCloseOnClick!=null?l.enableCloseOnClick:!0,this._maximumHeight=l.maximumHeight,this._maximumWidth=l.maximumWidth!=null?l.maximumWidth:400,this._minimumWidth=l.minimumWidth,this._offset=l.offset,this._panning=l.panning}return Object.defineProperty(O.prototype,"className",{get:function(){throw Error("NotImplmentedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"displayCloseButton",{get:function(){return this._displayCloseButton},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"enableCloseOnClick",{get:function(){return this._enableCloseOnClick},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"maximumHeight",{get:function(){throw Error("NotImplmentedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"maximumWidth",{get:function(){throw Error("NotImplmentedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"minimumWidth",{get:function(){throw Error("NotImplmentedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"offset",{get:function(){return this._offset},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"panning",{get:function(){return this._panning},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"content",{get:function(){throw Error("NotImplementedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"container",{get:function(){throw Error("NotImplmentedException")},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"geoPoint",{get:function(){return this._geoPoint},set:function(l){(!this._geoPoint||!this._geoPoint.equals(l))&&(l.normalize(),this._geoPoint=l,this.update(),this.moved.trigger())},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"loadState",{get:function(){return this._loadState},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"map",{get:function(){return this._map},enumerable:!0,configurable:!0}),O.prototype._unshift=function(){this._shiftedGeoPoint=null,this._update(this._geoPoint)},O.prototype._shift=function(l,i){var s=this._shiftedGeoPoint||this._geoPoint,_=[];_[0]=s;var b=(0,Qe.uY)(_,l,i);b=b,this._shiftedGeoPoint=b[0],this._update(this._shiftedGeoPoint)},O.prototype._onMapZoomed=function(l){this.update()},O.prototype._onMapPanned=function(l){this.update()},O.prototype._onMouseOver=function(l){this._isOver||l.target===this._wrapper&&(this._isOver=!0,this.mouseOver.trigger(l))},O.prototype._onMouseOut=function(l){if(this._isOver){for(var i=!1,s=l.target;s.parentNode;)if(s===this._wrapper){i=!0;break}else s=s.parentNode;i||(this._isOver=!1,this.mouseOut.trigger(l))}},O.prototype._onMouseUp=function(l){this.mouseUp.trigger(l)},O.prototype._onMouseDown=function(l){this.mouseDown.trigger(l)},O.prototype._onClick=function(l){this.click.trigger(l)},O.prototype._onDoubleClick=function(l){this.doubleClick.trigger(l)},O.prototype._onContextMenu=function(l){this.contextMenu.trigger(l)},O}(),Va=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),Ea=function(O){Va(l,O);function l(i){var s=O.call(this,i=i instanceof so?i:new so(i))||this,_=i?i.toLeaflet():new so({}).toLeaflet();return s._popup=new(gt()).Popup(_),s._popup.parent=s,s}return Object.defineProperty(l.prototype,"className",{get:function(){return this._className},set:function(i){if(i!==this._className){var s=this._className,_=this._popup._contentNode.parentNode;this._className=i,_&&(s?_.classList.replace(s,i):_.classList.add(i))}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"content",{get:function(){var i=this._popup.getContent();return i.outerHTML},set:function(i){this._popup.setContent(i.toString())},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"container",{get:function(){return this._popup._wrapper},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumHeight",{get:function(){return this._maximumHeight},set:function(i){if(i!==this._maximumHeight){var s=this._popup._contentNode;this._maximumHeight=i,s&&(s.style.maxHeight=i)}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumWidth",{get:function(){return this._maximumWidth},set:function(i){if(i!==this._maximumHeight){var s=this._popup._contentNode;this._maximumHeight=i,s&&(s.style.maxWidth=i)}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"minimumWidth",{get:function(){return this._minimumWidth},set:function(i){if(i!==this._maximumHeight){var s=this._popup._contentNode;this._maximumHeight=i,s&&(s.style.minWidth=i)}},enumerable:!0,configurable:!0}),l.prototype._update=function(i){var s=i.toLeaflet();this._popup.setLatLng(s)},l.prototype._addToMap=function(i){var s=this;this.loadState===x.jd.Unloaded&&(this._map=i,this.update(),this.map.engine.addLayer(this._popup),this.map.zoomed.addListener(this._onMapZoomed,this),this.map.panned.addListener(this._onMapPanned,this),this._wrapper=this._popup._wrapper,this._displayCloseButton&&W.j.addDomListener(this._popup._closeButton,"click",function(){return s.map.closePopup(s),!1}),W.j.addDomListener(this._wrapper,"mouseover",this._onMouseOver,this),W.j.addDomListener(this._wrapper,"mouseout",this._onMouseOut,this),W.j.addDomListener(this._wrapper,"mouseup",this._onMouseUp,this),W.j.addDomListener(this._wrapper,"mousedown",this._onMouseDown,this),W.j.addDomListener(this._wrapper,"click",this._onClick,this),W.j.addDomListener(this._wrapper,"doubleclick",this._onDoubleClick,this),W.j.addDomListener(this._wrapper,"contextmenu",this._onContextMenu,this),this._loadState=x.jd.Loaded,this.opened.trigger())},l.prototype._removeFromMap=function(i){this.loadState!=x.jd.Unloaded&&this.map===i&&(this.map.engine.removeLayer(this._popup),this.map.zoomed.removeListener(this._onMapZoomed,this),this.map.panned.removeListener(this._onMapPanned,this),this._map=null,this._loadState=x.jd.Unloaded,W.j.removeDomListener(this._wrapper,"mouseover",this._onMouseOver,this),W.j.removeDomListener(this._wrapper,"mouseout",this._onMouseOut,this),W.j.removeDomListener(this._wrapper,"mouseup",this._onMouseUp,this),W.j.removeDomListener(this._wrapper,"mousedown",this._onMouseDown,this),W.j.removeDomListener(this._wrapper,"click",this._onClick,this),W.j.removeDomListener(this._wrapper,"doubleclick",this._onDoubleClick,this),W.j.removeDomListener(this._wrapper,"contextmenu",this._onContextMenu,this),this.closed.trigger())},l.prototype.update=function(){if(this.map){var i=this.map.offset,s=new Re.R,_,b=this.geoPoint,D=new v.F;if(D.latitude.radians=b.latitude.radians,D.longitude.radians=b.longitude.radians+i.right.radians,i.bounds.containsPoint(D)){_=Re.R.fromRadians(i.right.radians),this._unshift(),this._shift(s,_),this._popup.update();return}if(i.left!=i.right&&(D.longitude.radians=b.longitude.radians+i.left.radians,i.bounds.containsPoint(D))){_=Re.R.fromRadians(i.left.radians),this._unshift(),this._shift(s,_),this._popup.update();return}this._unshift(),this._popup.update()}this._popup.update()},l}(na),Ds=B(14740),Oo=B(81797),ga=B(86330),Ka=B(27098),$r=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),qo=function(){return qo=Object.assign||function(O){for(var l,i=1,s=arguments.length;i<s;i++){l=arguments[i];for(var _ in l)Object.prototype.hasOwnProperty.call(l,_)&&(O[_]=l[_])}return O},qo.apply(this,arguments)},io=function(O){$r(l,O);function l(){var i=O!==null&&O.apply(this,arguments)||this;return i._originalStyleOrder=[],i._pendingSources=[],i._isStyling=!1,i._styleLength=0,i._isReady=!1,i._images={},i._lastFindScreenPoint=new T.E(0,0),i._styleLanguage=void 0,i}return Object.defineProperty(l.prototype,"bounds",{get:function(){var i=this._engine.getBounds(),s=i.getNorthEast(),_=i.getSouthWest(),b=I.c.fromDegrees(s.lat,_.lng,_.lat,s.lng);return b},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"contextualBounds",{get:function(){return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"cursor",{get:function(){return this._cursor},set:function(i){if(i!==this._cursor){var s=this._engine.getCanvas(),_=s.style.cssText;if(this._cursor=i,this._cursor==="inherit"){if(/cursor/gi.test(_)){var b=_.indexOf("cursor");s.style.cssText=_.slice(0,b)}}else s.style.cssText=_+";cursor:"+this._cursor+" !important;"}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"geoCenter",{get:function(){var i=this._engine.getCenter(),s=v.F.fromMapbox(i);return s},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"isStyling",{get:function(){return this._isStyling},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumBounds",{get:function(){return this._maxBounds},set:function(i){i.north.isGreaterThan(this._maxBounds.north)&&(i.north=this._maxBounds.north),i.south.isLessThan(this._maxBounds.south)&&(i.south=this._maxBounds.south),i.east.isGreaterThan(this._maxBounds.east)&&(i.east=this._maxBounds.east),i.west.isLessThan(this._maxBounds.west)&&(i.west=this._maxBounds.west),this._maxBounds=i;var s=new(Cr()).LngLat(i.west.degrees,i.south.degrees),_=new(Cr()).LngLat(i.east.degrees,i.north.degrees),b=new(Cr()).LngLatBounds(s,_);this._engine.setMaxBounds(b)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumZoomLevel",{get:function(){return this._engine.transform.maxZoom+1},set:function(i){var s=this.maximumZoomLevel,_=i-1,b=this._engine;b.setMaxZoom(_),this.maximumZoomLevelChanged.trigger({oldMaximumZoomLevel:s,newMaximumZoomLevel:_})},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"minimumZoomLevel",{get:function(){return this._engine.transform.minZoom+1},set:function(i){if(this._providedMinimumZoom!=i){var s=this._computedMinimumZoom-1,_=this._providedMinimumZoom-1,b=i-1,D=s>_?s:_;this._providedMinimumZoom=b;var G=s>this._providedMinimumZoom?s:this._providedMinimumZoom,Z=this._engine;Z.setMinZoom(G+1),this.zoomLevel<G&&this.zoom(G+1),D!=G&&this.minimumZoomLevelChanged.trigger({oldMinimumZoomLevel:D,newMinimumZoomLevel:G})}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"size",{get:function(){var i=this._element,s=i.clientHeight,_=i.clientWidth,b=new m.$(_,s);return b},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"style",{get:function(){return this._style},set:function(i){this._style=i;for(var s=this._mapboxEngine,_=this._stack,b=this._layers,D=0,G=_.length;D<G;D++){var Z=_[D],te=b[Z];te instanceof Fr.Q&&this.removeLayer(Z)}for(var ae=[],Pe=this._styleLength,ve=s.style._order.length;Pe<ve;Pe++){var pe=this._mapboxEngine.style._order[Pe],Fe=this._mapboxEngine.style._layers[pe],ke=this._mapboxEngine.getSource(Fe.source);ke.type=Fe.type,ae.push(ke)}this._pendingSources=ae,this._styleLength=0,this._isStyling=!0,this._engine.setStyle(i,{diff:!1}),this._mapboxEngine.once("styledata",this._onLoaded.bind(this))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"styleLanguage",{get:function(){return this._styleLanguage},set:function(i){this._styleLanguage=i;var s=this._mapboxEngine;for(var _ in s.style._layers)try{var b=s.getLayoutProperty(_,"text-field"),D=!1;typeof b!="string"&&(b=JSON.stringify(b),D=!0),b=b.replace(/name_([a-z]{2,3}(?:-[a-zA-Z]{4})?(?:-[A-Z]{2,3})?)/gi,"name_"+i),D&&(b=JSON.parse(b)),s.setLayoutProperty(_,"text-field",b),console.log(_,b)}catch(G){}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"styleOrder",{get:function(){return this._mapboxEngine.style._order},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"styleLayers",{get:function(){return this._mapboxEngine.style._layers},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"zoomLevel",{get:function(){var i=this._engine.getZoom()+1;return i},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"pitch",{get:function(){return this._engine.getPitch()},set:function(i){var s=i;this._engine.setPitch(s)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"bearing",{get:function(){return this._engine.getBearing()},set:function(i){var s=i;this._engine.setBearing(s)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"allowCrossLayerCollision",{get:function(){return this._allowCrossLayerCollision},set:function(i){this._allowCrossLayerCollision!==i&&(this._allowCrossLayerCollision=i,this.engine._crossSourceCollisions=i,this.engine._render())},enumerable:!0,configurable:!0}),l.prototype._deriveBeforeId=function(i){var s=this._mapboxEngine,_=s.style._order;if(!(_.length<=i)){var b=_[i],D=s.style._layers[b],G;return D.metadata&&D.metadata.group?G=Cr().layerGroups.getGroupFirstLayer(s,D.metadata.group):G=b,G}},l.prototype._arrangeLayers=function(){for(var i=this._mapboxEngine,s=this._styleLength,_=Cr().layerGroups,b=0,D,G=0,Z=this._stack.length;G<Z;G++){var te=this._stack[G],ae=this._layers[te];s+=b,D=G+s,ae._setZIndex(D);var Pe=_.getGroupFirstLayerIndex(i,te),ve=_.getGroupLastLayerIndex(i,te);b=ve-Pe}},l.prototype._convertToMapEvent=function(i){var s=this._lastMapEvent;if(i.point?(s.containerPoint.x=i.point.x,s.containerPoint.y=i.point.y):i.x!=null&&i.y!=null?(s.containerPoint.x=i.x,s.containerPoint.y=i.y):i.clientX!=null&&i.clientY!=null?(s.containerPoint.x=i.clientX,s.containerPoint.y=i.clientY):i.screenX!=null&&i.screenY!=null?(s.containerPoint.x=i.screenX,s.containerPoint.y=i.screenY):console.log("Map Event Container Point Conversion Error: ",i),i.lngLat)s.geoPoint.latitude.degrees=i.lngLat.lat,s.geoPoint.longitude.degrees=i.lngLat.lng;else try{var _=new(Cr()).Point(s.containerPoint.x,s.containerPoint.y),b=this._engine.unproject(_);s.geoPoint.latitude.degrees=b.lat,s.geoPoint.longitude.degrees=b.lng}catch(D){console.log("Map Event Geo Point Conversion Error: ",D,i)}return s},l.prototype._loadMap=function(i,s){var _=this;this._style=s.style,Object.getOwnPropertyDescriptor(Cr(),"accessToken").set(this.mapboxAccessToken);var b={attributionControl:!1,maxZoom:31,minZoom:0,maxTileCacheSize:1e4};b.failIfMajorPerformanceCaveat=!0,b.transition={duration:0,delay:0},b.pitchWithRotate=!1,b.dragRotate=!1,b.refreshExpiredTiles=!1,b.crossSourceCollisions=this._allowCrossLayerCollision,b.preserveDrawingBuffer=s.preserveDrawingBuffer!==void 0?s.preserveDrawingBuffer:!1;var D;s.scrollWheelZoom==="center"?D={around:"center"}:D=s.scrollWheelZoom!==void 0?s.scrollWheelZoom:!0,b.scrollZoom=D,b.style={version:8,transition:{duration:0,delay:0},sources:{},layers:[]},b.container=this.elementId;var G=new(Cr()).Map(b);if(!G)throw new Error("Unable to create WebGL map");G.on("load",function(){_._style?_.style=_._style:(_._isReady=!0,_._deriveBounds(),_.ready.trigger())}),this._engine=G,this._mapboxEngine=G,this._mapboxEngine.on("styledataloading",this._onLoading.bind(this)),this._engine.on("click",this._onClick.bind(this)),this._engine.on("dblclick",this._onDoubleClick.bind(this)),this._engine.on("contextmenu",this._onContextMenu.bind(this)),this._engine.on("mousemove",this._onMouseMove.bind(this)),W.j.addDomListener(this.element,"mouseout",this._onMouseOut,this),W.j.addDomListener(this.element,"mouseover",this._onMouseOver,this),this._engine.on("mouseup",this._onMouseUp.bind(this)),this._engine.on("mousedown",this._onMouseDown.bind(this)),W.j.addDomListener(this.element,"mousewheel",this._onMouseWheel,this,{passive:!0}),ui.injectCss(l._mapboxCss),this.styling=new W.j,this.styled=new W.j,this.imageAdded=new W.j,this.imageRemoved=new W.j},l.prototype._computeMinimumZoomLevel=function(i){var s=i||this._computeMinimumScale(),_=Bt.x.deriveZoomLevelExact(s),b=_;return Math.max(b-1,0)},l.prototype._deriveBounds=function(){var i=this._engine.getBounds(),s=this._bounds,_=i._ne,b=i._sw;s.north.degrees=_.lat,s.west.degrees=b.lng,s.south.degrees=b.lat,s.east.degrees=_.lng},l.prototype.capture=function(){if(this._options.preserveDrawingBuffer){var i=this._mapboxEngine.getCanvas(),s=i.toDataURL("image/png"),_=new Image;return _.src=s,_}else throw new Error("ConfigurationException: preserveDrawingBuffer option is false")},l.prototype.loadImage=function(i,s){this._mapboxEngine.loadImage(i,s)},l.prototype.addImage=function(i,s){this._mapboxEngine.addImage(i,s),this._images[i]=s,this.imageAdded.trigger({image:s,name:i})},l.prototype.fetchImage=function(i){var s=this._images[i];return s},l.prototype.removeImage=function(i){this._mapboxEngine.removeImage(i),delete this._images[i],this.imageRemoved.trigger({name:i})},l.prototype.fit=function(i,s,_,b,D){var G=i.toMapbox(),Z={};s&&(s.isAnimate!==void 0&&(Z.animate=s.isAnimate),s.ease!==void 0&&(Z.easing=s.ease),s.offset!==void 0&&(Z.offset=s.offset),s.duration&&(Z.duration=s.duration),_!==void 0&&(Z.padding=_),b!==void 0&&(Z.offset=[b.x,b.y]),D!==void 0&&(Z.maxZoom=D)),this._engine.fitBounds(G,Z),this.panned.trigger()},l.prototype.findOverlays=function(i){var s;if(i instanceof v.F){var _=i;s=this.fromGeoToScreen(_,this._lastFindScreenPoint)}else s=i;for(var b=this._mapboxEngine,D=new(Cr()).Point(s.x,s.y),G=b.queryRenderedFeatures(D),Z={},te=0,ae=G.length;te<ae;te++){var Pe=G[te];if(Pe.properties.layerId){var ve=this.layers[Pe.properties.layerId];if(ve){var pe=Pe.properties.layerId+"."+Pe.properties.id,Fe=ve._index[Pe.properties.id];if(Fe)Z[pe]=Fe;else for(var ke=Object.keys(ve._index),Ze=0,at=ke.length;Ze<at;Ze++){var Ve=ke[Ze],st=ve._index[Ve];if(st.overlays)for(var Pt=st.overlays,$e=0,Ct=Pt.length;$e<Ct;$e++){var At=Pt[$e];if(At.id===Pe.properties.id&&At.group){Z[At.group.id]=At.group;break}}}}}}var qe=[];for(var Ve in Z){var nt=Z[Ve];qe.push(nt)}return qe.reverse()},l.prototype.findVectors=function(i){var s=[],_;if(i instanceof T.E){var b=i;_=[b.x,b.y]}else if(i instanceof v.F){var b=this.fromGeoToScreen(i);_=[b.x,b.y]}else if(i instanceof I.c){var D=i,G=D.topLeftGeoPoint,Z=this.fromGeoToScreen(G),te=D.bottomRightGeoPoint,ae=this.fromGeoToScreen(te);_=[[ae.x,ae.y],[Z.x,Z.y]]}for(var Pe=this._mapboxEngine,ve=Pe.queryRenderedFeatures(_),pe=0,Fe=ve.length;pe<Fe;pe++){var ke=ve[pe],Ze=ke.layer.metadata?ke.layer.metadata.group:"",at=this.layers[Ze];if(at instanceof rn||at instanceof Ka.C){var _=ke.geometry,Ve;switch(_.type.toUpperCase()){case"POINT":Ve=Dt.t.fromGeoJson(ke);break;case"LINESTRING":Ve=dt.P.fromGeoJson(ke);break;case"POLYGON":Ve=ai.L.fromGeoJson(ke);break;case"MULTIPOINT":Ve=Ds.f.fromGeoJson(ke);break;case"MULTILINESTRING":Ve=Oo.m.fromGeoJson(ke);break;case"MULTIPOLYGON":Ve=ga.f.fromGeoJson(ke);break}if(Ve._layer=at,ke.properties.validTime){var st=new Date(ke.properties.validTime);Ve.validTime=new Mt.T(st)}ke.state&&(Ve.state=ke.state),s.push(Ve)}}return s},l.prototype.move=function(i,s,_,b,D,G){if(!!this.isEnabled){_||(_=this.zoomLevel||4);var Z=_-1,te=new(Cr()).LngLat(s,i),ae;if(b!==void 0||D!==void 0){var Pe=this.size,ve=b!==void 0?Pe.width/2-b:0,pe=D!==void 0?Pe.height/2-D:0,Fe=Bt.x.convertLatLngToPixel(mt.K.fromDegrees(i),He.o.fromDegrees(s),_,this._lastFindScreenPoint),ke=new T.E(Fe.x+ve,Fe.y+pe),Ze=Bt.x.convertPixelToGeo(ke,_),at=Ze.toMapbox();ae={center:at,zoom:Z}}else ae={center:te,zoom:Z};if(G&&G.isAnimate){var Ve=qo({},ae,G);this._engine.easeTo(Ve)}else this._engine.jumpTo(ae);this.panned.trigger()}},l.prototype.pan=function(i,s,_){if(!!this.isEnabled){var b=_?_ instanceof Mr?_:new Mr(_):new Mr({isAnimate:!1}),D=new(Cr()).Point(i,s);this._engine.panBy([D.x,D.y],b.toMapbox()),this.panned.trigger()}},l.prototype.resize=function(i,s){this._slide(),i&&(this.element.style.width=i+"px"),s&&(this.element.style.height=s+"px"),this._position=ui.findPosition(this.element),this._projectionExtent=this._computeProjectionExtent();var _=this._computeMinimumZoomLevel();if(_!==this._computedMinimumZoom){var b=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this._computedMinimumZoom=_;var D=this._computedMinimumZoom>this._providedMinimumZoom?this._computedMinimumZoom:this._providedMinimumZoom;this.zoomLevel<D&&this.zoom(D),this._engine.setMinZoom(D),b!=D&&this.minimumZoomLevelChanged.trigger({oldMinimumZoomLevel:b,newMinimumZoomLevel:D})}this._engine.resize();var G={size:this.size};this.resized.trigger(G)},l.prototype.zoom=function(i,s){if(!(!this.isEnabled||i<this._computedMinimumZoom||i<this._providedMinimumZoom)){s&&(s=s instanceof Mr?s:new Mr(s));var _=i-1,b=s?s.toMapbox():void 0;this._engine.zoomTo(_,b)}},l.prototype.enable=function(){if(this._isDisposed)throw new Error("Unable to recreate a disposed map");this.isEnabled||(this._isEnabled=!0,this.clock.startSliding(),this.clock.startTicking(),this._engine.on("movestart",this._onMoving.bind(this)),this._engine.on("move",this._onMoving.bind(this)),this._engine.on("moveend",this._onMoved.bind(this)),this._engine.on("dragstart",this._onPanning.bind(this)),this._engine.on("dragend",this._onPanned.bind(this)),this._engine.on("zoomend",this._onZoomed.bind(this)),this._engine.on("zoom",this._onZooming.bind(this)),this._engine.on("zoomstart",this._onZooming.bind(this)),this.animator.started.addListener(this._onAnimatorStarted,this),this.animator.stopped.addListener(this._onAnimatorStopped,this),this._slidingTimeout.totalMilliseconds>0&&this._startSliding(),this._absoluteTimeout.totalMilliseconds>0&&this._startAbsolute(),this.enabled.trigger())},l.prototype.disable=function(){this.isEnabled&&(this._isEnabled=!1,this.animator.stop(),this.clock.stopSliding(),this.clock.stopTicking(),this._engine.off("movestart",this._onMoving.bind(this)),this._engine.off("move",this._onMoving.bind(this)),this._engine.off("moveend",this._onMoved.bind(this)),this._engine.off("dragstart",this._onPanning.bind(this)),this._engine.off("dragend",this._onPanned.bind(this)),this._engine.off("zoomend",this._onZoomed.bind(this)),this._engine.off("zoomstart",this._onZooming.bind(this)),this.animator.started.removeListener(this._onAnimatorStarted,this),this.animator.stopped.removeListener(this._onAnimatorStopped,this),this._stopSliding(),this._stopAbsolute(),this.disabled.trigger())},l.prototype.insertLayer=function(i,s){if(s===void 0&&(s=null),this._isStyling)throw new Error("Cannot add/insert layers while map is styling");O.prototype.insertLayer.call(this,i,s)},l.prototype._onLoading=function(i){i.dataType==="style"&&(this.styling.trigger(),this._isStyling=!0)},l.prototype._onLoaded=function(i){if(i.dataType==="style"){var s=this._mapboxEngine;this._styleLength=s.style._order.length,this._originalStyleOrder=s.style._order.slice();for(var _=0,b=this._pendingSources.length;_<b;_++){var D=this._pendingSources[_],G=D.options||D._eventedParent.options;D._data&&(G.data=D._data),s.getSource(D.id)||(s.addSource(D.id,G),s.getSource(D.id)._key=D._key)}for(var Z in this._images)if(!s.style.imageManager.images[Z]){var te=this._images[Z];s.addImage(Z,te)}this._pendingSources=[],this._isStyling=!1,s.style.glyphManager.url="mapbox://fonts/weather/{fontstack}/{range}.pbf",this._arrangeLayers(),this.resize(),this.styled.trigger(),this._isReady||(this._isReady=!0,this.ready.trigger())}},l.prototype._onMoving=function(i){this._deriveBounds(),O.prototype._onMoving.call(this,i)},l.prototype._onMoved=function(i){this._deriveBounds(),O.prototype._onMoved.call(this,i)},l._mapboxCss=`.mapboxgl-map{font:12px/20px Helvetica Neue,Arial,Helvetica,sans-serif !important;overflow:hidden !important;position:relative !important;-webkit-tap-highlight-color:rgba(0,0,0,0) !important;text-align:left !important;}.mapboxgl-map:-webkit-full-screen{width:100% !important;height:100% !important;}.mapboxgl-canary{background-color:salmon}.mapboxgl-canvas-container.mapboxgl-interactive,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass{cursor:pointer !important;-moz-user-select:none !important;-webkit-user-select:none !important;-ms-user-select:none !important;user-select:none !important;}.mapboxgl-canvas-container.mapboxgl-interactive.mapboxgl-track-pointer{cursor:pointer}.mapboxgl-canvas-container.mapboxgl-interactive:active,.mapboxgl-ctrl-group button.mapboxgl-ctrl-compass:active{cursor:-webkit-grabbing;cursor:-moz-grabbing;cursor:grabbing}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate .mapboxgl-canvas{touch-action:pan-x pan-y}.mapboxgl-canvas-container.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:pinch-zoom}.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan,.mapboxgl-canvas-container.mapboxgl-touch-zoom-rotate.mapboxgl-touch-drag-pan .mapboxgl-canvas{touch-action:none}.mapboxgl-ctrl-bottom-left,.mapboxgl-ctrl-bottom-right,.mapboxgl-ctrl-top-left,.mapboxgl-ctrl-top-right{position:absolute;pointer-events:none;z-index:2}.mapboxgl-ctrl-top-left{top:0;left:0}.mapboxgl-ctrl-top-right{top:0;right:0}.mapboxgl-ctrl-bottom-left{bottom:0;left:0}.mapboxgl-ctrl-bottom-right{right:0;bottom:0}.mapboxgl-ctrl{clear:both;pointer-events:auto;transform:translate(0)}.mapboxgl-ctrl-top-left .mapboxgl-ctrl{margin:10px 0 0 10px;float:left}.mapboxgl-ctrl-top-right .mapboxgl-ctrl{margin:10px 10px 0 0;float:right}.mapboxgl-ctrl-bottom-left .mapboxgl-ctrl{margin:0 0 10px 10px;float:left}.mapboxgl-ctrl-bottom-right .mapboxgl-ctrl{margin:0 10px 10px 0;float:right}.mapboxgl-ctrl-group{border-radius:4px;background:#fff}.mapboxgl-ctrl-group:not(:empty){-moz-box-shadow:0 0 2px rgba(0,0,0,.1);-webkit-box-shadow:0 0 2px rgba(0,0,0,.1);box-shadow:0 0 0 2px rgba(0,0,0,.1)}@media (-ms-high-contrast:active){.mapboxgl-ctrl-group:not(:empty){box-shadow:0 0 0 2px ButtonText}}.mapboxgl-ctrl-group button{width:29px;height:29px;display:block;padding:0;outline:none;border:0;box-sizing:border-box;background-color:transparent;cursor:pointer}.mapboxgl-ctrl-group button+button{border-top:1px solid #ddd}.mapboxgl-ctrl button .mapboxgl-ctrl-icon{display:block;width:100%;height:100%;background-repeat:no-repeat;background-position:50%}@media (-ms-high-contrast:active){.mapboxgl-ctrl-icon{background-color:transparent}.mapboxgl-ctrl-group button+button{border-top:1px solid ButtonText}}.mapboxgl-ctrl button::-moz-focus-inner{border:0;padding:0}.mapboxgl-ctrl-group button:focus{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl button:disabled{cursor:not-allowed}.mapboxgl-ctrl button:disabled .mapboxgl-ctrl-icon{opacity:.25}.mapboxgl-ctrl button:not(:disabled):hover{background-color:rgba(0,0,0,.05)}.mapboxgl-ctrl-group button:focus:focus-visible{box-shadow:0 0 2px 2px #0096ff}.mapboxgl-ctrl-group button:focus:not(:focus-visible){box-shadow:none}.mapboxgl-ctrl-group button:focus:first-child{border-radius:4px 4px 0 0}.mapboxgl-ctrl-group button:focus:last-child{border-radius:0 0 4px 4px}.mapboxgl-ctrl-group button:focus:only-child{border-radius:inherit}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-out .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 13c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h9c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-9z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-zoom-in .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M14.5 8.5c-.75 0-1.5.75-1.5 1.5v3h-3c-.75 0-1.5.75-1.5 1.5S9.25 16 10 16h3v3c0 .75.75 1.5 1.5 1.5S16 19.75 16 19v-3h3c.75 0 1.5-.75 1.5-1.5S19.75 13 19 13h-3v-3c0-.75-.75-1.5-1.5-1.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-fullscreen .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M24 16v5.5c0 1.75-.75 2.5-2.5 2.5H16v-1l3-1.5-4-5.5 1-1 5.5 4 1.5-3h1zM6 16l1.5 3 5.5-4 1 1-4 5.5 3 1.5v1H7.5C5.75 24 5 23.25 5 21.5V16h1zm7-11v1l-3 1.5 4 5.5-1 1-5.5-4L6 13H5V7.5C5 5.75 5.75 5 7.5 5H13zm11 2.5c0-1.75-.75-2.5-2.5-2.5H16v1l3 1.5-4 5.5 1 1 5.5-4 1.5 3h1V7.5z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-shrink .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M18.5 16c-1.75 0-2.5.75-2.5 2.5V24h1l1.5-3 5.5 4 1-1-4-5.5 3-1.5v-1h-5.5zM13 18.5c0-1.75-.75-2.5-2.5-2.5H5v1l3 1.5L4 24l1 1 5.5-4 1.5 3h1v-5.5zm3-8c0 1.75.75 2.5 2.5 2.5H24v-1l-3-1.5L25 5l-1-1-5.5 4L17 5h-1v5.5zM10.5 13c1.75 0 2.5-.75 2.5-2.5V5h-1l-1.5 3L5 4 4 5l4 5.5L5 12v1h5.5z'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23999'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-compass .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E")}}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23aaa'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-waiting .mapboxgl-ctrl-icon{-webkit-animation:mapboxgl-spin 2s linear infinite;-moz-animation:mapboxgl-spin 2s infinite linear;-o-animation:mapboxgl-spin 2s infinite linear;-ms-animation:mapboxgl-spin 2s infinite linear;animation:mapboxgl-spin 2s linear infinite}@media (-ms-high-contrast:active){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23fff'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23999'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-active-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e58978'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%2333b5e5'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate.mapboxgl-ctrl-geolocate-background-error .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23e54e33'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3C/svg%3E")}.mapboxgl-ctrl button.mapboxgl-ctrl-geolocate:disabled .mapboxgl-ctrl-icon{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill='%23666'%3E%3Cpath d='M10 4C9 4 9 5 9 5v.1A5 5 0 005.1 9H5s-1 0-1 1 1 1 1 1h.1A5 5 0 009 14.9v.1s0 1 1 1 1-1 1-1v-.1a5 5 0 003.9-3.9h.1s1 0 1-1-1-1-1-1h-.1A5 5 0 0011 5.1V5s0-1-1-1zm0 2.5a3.5 3.5 0 110 7 3.5 3.5 0 110-7z'/%3E%3Ccircle cx='10' cy='10' r='2'/%3E%3Cpath d='M14 5l1 1-9 9-1-1 9-9z' fill='red'/%3E%3C/svg%3E")}}@-webkit-keyframes mapboxgl-spin{0%{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(1turn)}}@-moz-keyframes mapboxgl-spin{0%{-moz-transform:rotate(0deg)}to{-moz-transform:rotate(1turn)}}@-o-keyframes mapboxgl-spin{0%{-o-transform:rotate(0deg)}to{-o-transform:rotate(1turn)}}@-ms-keyframes mapboxgl-spin{0%{-ms-transform:rotate(0deg)}to{-ms-transform:rotate(1turn)}}@keyframes mapboxgl-spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}a.mapboxgl-ctrl-logo{width:88px;height:23px;margin:0 0 -4px -4px;display:block;background-repeat:no-repeat;cursor:pointer;overflow:hidden;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg opacity='.3' stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg opacity='.9' fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}a.mapboxgl-ctrl-logo.mapboxgl-compact{width:23px}@media (-ms-high-contrast:active){a.mapboxgl-ctrl-logo{background-color:transparent;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23000' stroke-width='3'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cg fill='%23fff'%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/g%3E%3C/svg%3E")}}@media (-ms-high-contrast:black-on-white){a.mapboxgl-ctrl-logo{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='88' height='23' viewBox='0 0 88 23' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' fill-rule='evenodd'%3E%3Cdefs%3E%3Cpath id='a' d='M11.5 2.25c5.105 0 9.25 4.145 9.25 9.25s-4.145 9.25-9.25 9.25-9.25-4.145-9.25-9.25 4.145-9.25 9.25-9.25zM6.997 15.983c-.051-.338-.828-5.802 2.233-8.873a4.395 4.395 0 013.13-1.28c1.27 0 2.49.51 3.39 1.42.91.9 1.42 2.12 1.42 3.39 0 1.18-.449 2.301-1.28 3.13C12.72 16.93 7 16 7 16l-.003-.017zM15.3 10.5l-2 .8-.8 2-.8-2-2-.8 2-.8.8-2 .8 2 2 .8z'/%3E%3Cpath id='b' d='M50.63 8c.13 0 .23.1.23.23V9c.7-.76 1.7-1.18 2.73-1.18 2.17 0 3.95 1.85 3.95 4.17s-1.77 4.19-3.94 4.19c-1.04 0-2.03-.43-2.74-1.18v3.77c0 .13-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V8.23c0-.12.1-.23.23-.23h1.4zm-3.86.01c.01 0 .01 0 .01-.01.13 0 .22.1.22.22v7.55c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V15c-.7.76-1.69 1.19-2.73 1.19-2.17 0-3.94-1.87-3.94-4.19 0-2.32 1.77-4.19 3.94-4.19 1.03 0 2.02.43 2.73 1.18v-.75c0-.12.1-.23.23-.23h1.4zm26.375-.19a4.24 4.24 0 00-4.16 3.29c-.13.59-.13 1.19 0 1.77a4.233 4.233 0 004.17 3.3c2.35 0 4.26-1.87 4.26-4.19 0-2.32-1.9-4.17-4.27-4.17zM60.63 5c.13 0 .23.1.23.23v3.76c.7-.76 1.7-1.18 2.73-1.18 1.88 0 3.45 1.4 3.84 3.28.13.59.13 1.2 0 1.8-.39 1.88-1.96 3.29-3.84 3.29-1.03 0-2.02-.43-2.73-1.18v.77c0 .12-.1.23-.23.23h-1.4c-.13 0-.23-.1-.23-.23V5.23c0-.12.1-.23.23-.23h1.4zm-34 11h-1.4c-.13 0-.23-.11-.23-.23V8.22c.01-.13.1-.22.23-.22h1.4c.13 0 .22.11.23.22v.68c.5-.68 1.3-1.09 2.16-1.1h.03c1.09 0 2.09.6 2.6 1.55.45-.95 1.4-1.55 2.44-1.56 1.62 0 2.93 1.25 2.9 2.78l.03 5.2c0 .13-.1.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.8 0-1.46.7-1.59 1.62l.01 4.68c0 .13-.11.23-.23.23h-1.41c-.13 0-.23-.11-.23-.23v-4.59c0-.98-.74-1.71-1.62-1.71-.85 0-1.54.79-1.6 1.8v4.5c0 .13-.1.23-.23.23zm53.615 0h-1.61c-.04 0-.08-.01-.12-.03-.09-.06-.13-.19-.06-.28l2.43-3.71-2.39-3.65a.213.213 0 01-.03-.12c0-.12.09-.21.21-.21h1.61c.13 0 .24.06.3.17l1.41 2.37 1.4-2.37a.34.34 0 01.3-.17h1.6c.04 0 .08.01.12.03.09.06.13.19.06.28l-2.37 3.65 2.43 3.7c0 .05.01.09.01.13 0 .12-.09.21-.21.21h-1.61c-.13 0-.24-.06-.3-.17l-1.44-2.42-1.44 2.42a.34.34 0 01-.3.17zm-7.12-1.49c-1.33 0-2.42-1.12-2.42-2.51 0-1.39 1.08-2.52 2.42-2.52 1.33 0 2.42 1.12 2.42 2.51 0 1.39-1.08 2.51-2.42 2.52zm-19.865 0c-1.32 0-2.39-1.11-2.42-2.48v-.07c.02-1.38 1.09-2.49 2.4-2.49 1.32 0 2.41 1.12 2.41 2.51 0 1.39-1.07 2.52-2.39 2.53zm-8.11-2.48c-.01 1.37-1.09 2.47-2.41 2.47s-2.42-1.12-2.42-2.51c0-1.39 1.08-2.52 2.4-2.52 1.33 0 2.39 1.11 2.41 2.48l.02.08zm18.12 2.47c-1.32 0-2.39-1.11-2.41-2.48v-.06c.02-1.38 1.09-2.48 2.41-2.48s2.42 1.12 2.42 2.51c0 1.39-1.09 2.51-2.42 2.51z'/%3E%3C/defs%3E%3Cmask id='c'%3E%3Crect width='100%25' height='100%25' fill='%23fff'/%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/mask%3E%3Cg stroke='%23fff' stroke-width='3' fill='%23fff'%3E%3Ccircle mask='url(%23c)' cx='11.5' cy='11.5' r='9.25'/%3E%3Cuse xlink:href='%23b' mask='url(%23c)'/%3E%3C/g%3E%3Cuse xlink:href='%23a'/%3E%3Cuse xlink:href='%23b'/%3E%3C/svg%3E")}}.mapboxgl-ctrl.mapboxgl-ctrl-attrib{padding:0 5px;background-color:hsla(0,0%,100%,.5);margin:0}@media screen{.mapboxgl-ctrl-attrib.mapboxgl-compact{min-height:20px;padding:0;margin:10px;position:relative;background-color:#fff;border-radius:3px 12px 12px 3px}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 24px 2px 4px;visibility:visible;margin-top:6px}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover,.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:hover{padding:2px 4px 2px 24px;border-radius:12px 3px 3px 12px}.mapboxgl-ctrl-attrib.mapboxgl-compact .mapboxgl-ctrl-attrib-inner{display:none}.mapboxgl-ctrl-attrib.mapboxgl-compact:hover .mapboxgl-ctrl-attrib-inner{display:block}.mapboxgl-ctrl-attrib.mapboxgl-compact:after{content:"";cursor:pointer;position:absolute;background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E");background-color:hsla(0,0%,100%,.5);width:24px;height:24px;box-sizing:border-box;border-radius:12px}.mapboxgl-ctrl-bottom-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;right:0}.mapboxgl-ctrl-top-right>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;right:0}.mapboxgl-ctrl-top-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{top:0;left:0}.mapboxgl-ctrl-bottom-left>.mapboxgl-ctrl-attrib.mapboxgl-compact:after{bottom:0;left:0}}@media screen and (-ms-high-contrast:active){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd' fill='%23fff'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}@media screen and (-ms-high-contrast:black-on-white){.mapboxgl-ctrl-attrib.mapboxgl-compact:after{background-image:url("data:image/svg+xml;charset=utf-8,%3Csvg width='24' height='24' viewBox='0 0 20 20' xmlns='http://www.w3.org/2000/svg' fill-rule='evenodd'%3E%3Cpath d='M4 10a6 6 0 1012 0 6 6 0 10-12 0m5-3a1 1 0 102 0 1 1 0 10-2 0m0 3a1 1 0 112 0v3a1 1 0 11-2 0'/%3E%3C/svg%3E")}}.mapboxgl-ctrl-attrib a{color:rgba(0,0,0,.75);text-decoration:none}.mapboxgl-ctrl-attrib a:hover{color:inherit;text-decoration:underline}.mapboxgl-ctrl-attrib .mapbox-improve-map{font-weight:700;margin-left:2px}.mapboxgl-attrib-empty{display:none}.mapboxgl-ctrl-scale{background-color:hsla(0,0%,100%,.75);font-size:10px;border:2px solid #333;border-top:#333;padding:0 5px;color:#333;box-sizing:border-box}.mapboxgl-popup{position:absolute;top:0;left:0;display:-webkit-flex;display:flex;will-change:transform;pointer-events:none}.mapboxgl-popup-anchor-top,.mapboxgl-popup-anchor-top-left,.mapboxgl-popup-anchor-top-right{-webkit-flex-direction:column;flex-direction:column}.mapboxgl-popup-anchor-bottom,.mapboxgl-popup-anchor-bottom-left,.mapboxgl-popup-anchor-bottom-right{-webkit-flex-direction:column-reverse;flex-direction:column-reverse}.mapboxgl-popup-anchor-left{-webkit-flex-direction:row;flex-direction:row}.mapboxgl-popup-anchor-right{-webkit-flex-direction:row-reverse;flex-direction:row-reverse}.mapboxgl-popup-tip{width:0;height:0;border:10px solid transparent;z-index:1}.mapboxgl-popup-anchor-top .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-top:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;align-self:flex-start;border-top:none;border-left:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;align-self:flex-end;border-top:none;border-right:none;border-bottom-color:#fff}.mapboxgl-popup-anchor-bottom .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-bottom:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-tip{-webkit-align-self:flex-start;align-self:flex-start;border-bottom:none;border-left:none;border-top-color:#fff}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-tip{-webkit-align-self:flex-end;align-self:flex-end;border-bottom:none;border-right:none;border-top-color:#fff}.mapboxgl-popup-anchor-left .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-left:none;border-right-color:#fff}.mapboxgl-popup-anchor-right .mapboxgl-popup-tip{-webkit-align-self:center;align-self:center;border-right:none;border-left-color:#fff}.mapboxgl-popup-close-button{position:absolute;right:0;top:0;border:0;border-radius:0 3px 0 0;cursor:pointer;background-color:transparent}.mapboxgl-popup-close-button:hover{background-color:rgba(0,0,0,.05)}.mapboxgl-popup-content{position:relative;background:#fff;border-radius:3px;box-shadow:0 1px 2px rgba(0,0,0,.1);padding:10px 10px 15px;pointer-events:auto}.mapboxgl-popup-anchor-top-left .mapboxgl-popup-content{border-top-left-radius:0}.mapboxgl-popup-anchor-top-right .mapboxgl-popup-content{border-top-right-radius:0}.mapboxgl-popup-anchor-bottom-left .mapboxgl-popup-content{border-bottom-left-radius:0}.mapboxgl-popup-anchor-bottom-right .mapboxgl-popup-content{border-bottom-right-radius:0}.mapboxgl-popup-track-pointer{display:none}.mapboxgl-popup-track-pointer *{pointer-events:none;user-select:none}.mapboxgl-map:hover .mapboxgl-popup-track-pointer{display:flex}.mapboxgl-map:active .mapboxgl-popup-track-pointer{display:none}.mapboxgl-marker{position:absolute;top:0;left:0;will-change:transform}.mapboxgl-user-location-dot{background-color:#1da1f2;width:15px;height:15px;border-radius:50%}.mapboxgl-user-location-dot:before{background-color:#1da1f2;content:"";width:15px;height:15px;border-radius:50%;position:absolute;-webkit-animation:mapboxgl-user-location-dot-pulse 2s infinite;-moz-animation:mapboxgl-user-location-dot-pulse 2s infinite;-ms-animation:mapboxgl-user-location-dot-pulse 2s infinite;animation:mapboxgl-user-location-dot-pulse 2s infinite}.mapboxgl-user-location-dot:after{border-radius:50%;border:2px solid #fff;content:"";height:19px;left:-2px;position:absolute;top:-2px;width:19px;box-sizing:border-box;box-shadow:0 0 3px rgba(0,0,0,.35)}@-webkit-keyframes mapboxgl-user-location-dot-pulse{0%{-webkit-transform:scale(1);opacity:1}70%{-webkit-transform:scale(3);opacity:0}to{-webkit-transform:scale(1);opacity:0}}@-ms-keyframes mapboxgl-user-location-dot-pulse{0%{-ms-transform:scale(1);opacity:1}70%{-ms-transform:scale(3);opacity:0}to{-ms-transform:scale(1);opacity:0}}@keyframes mapboxgl-user-location-dot-pulse{0%{transform:scale(1);opacity:1}70%{transform:scale(3);opacity:0}to{transform:scale(1);opacity:0}}.mapboxgl-user-location-dot-stale{background-color:#aaa}.mapboxgl-user-location-dot-stale:after{display:none}.mapboxgl-user-location-accuracy-circle{background-color:rgba(29,161,242,.2);width:1px;height:1px;border-radius:100%}.mapboxgl-crosshair,.mapboxgl-crosshair .mapboxgl-interactive,.mapboxgl-crosshair .mapboxgl-interactive:active{cursor:crosshair}.mapboxgl-boxzoom{position:absolute;top:0;left:0;width:0;height:0;background:#fff;border:2px dotted #202020;opacity:.5}@media print{.mapbox-improve-map{display:none}}`,l}(_a),Io=function(){var O=function(l,i){return O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(s,_){s.__proto__=_}||function(s,_){for(var b in _)_.hasOwnProperty(b)&&(s[b]=_[b])},O(l,i)};return function(l,i){O(l,i);function s(){this.constructor=l}l.prototype=i===null?Object.create(i):(s.prototype=i.prototype,new s)}}(),po=function(O){Io(l,O);function l(i){var s=O.call(this,i=i instanceof so?i:new so(i))||this;s._content="";var _=i?i.toMapbox():new so({}).toMapbox();return s._popup=new(Cr()).Popup(_),s._popup.parent=s,s}return Object.defineProperty(l.prototype,"className",{get:function(){return this._className},set:function(i){if(i!==this._className){var s=this._className,_=this._popup._content.parentNode;this._className=i,_&&(s?_.classList.replace(s,i):_.classList.add(i))}},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"container",{get:function(){return this._popup._content.parentNode||this._popup._content},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"content",{get:function(){return this._content},set:function(i){this._content=i,this._popup.setHTML(i)},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumHeight",{get:function(){return this._maximumHeight},set:function(i){i!==this._maximumHeight&&(this._maximumHeight=i,this._wrapper.style.maxHeight=i+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"maximumWidth",{get:function(){return this._maximumWidth},set:function(i){i!==this._maximumWidth&&(this._maximumWidth=i,this._popup.setMaxWidth(i+"px"))},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"minimumWidth",{get:function(){return this._minimumWidth},set:function(i){i!==this._minimumWidth&&(this._minimumWidth=i,this._wrapper.style.minWidth=i+"px")},enumerable:!0,configurable:!0}),l.prototype._onClosed=function(){this.map.fetchPopup(this.id)&&this.map.closePopup(this)},l.prototype._update=function(i){var s=new(Cr()).LngLat(i.longitude.degrees,i.latitude.degrees);this._popup.setLngLat(s)},l.prototype._addToMap=function(i){this.loadState===x.jd.Unloaded&&(this._map=i,this._popup.addTo(i._mapboxEngine),this.update(),this.map.zoomed.addListener(this._onMapZoomed,this),this.map.panned.addListener(this._onMapPanned,this),this._wrapper=this._popup._content,this.maximumHeight!==null&&(this._wrapper.style.maxHeight=this.maximumHeight+"px"),this.minimumWidth!==null&&(this._wrapper.style.minWidth=this.minimumWidth+"px"),this.maximumWidth!==null&&(this._wrapper.style.maxWidth=this.maximumWidth+"px"),this.className&&this._wrapper.classList.add(this.className),this._popup.once("close",this._onClosed.bind(this)),W.j.addDomListener(this._wrapper,"mouseover",this._onMouseOver,this),W.j.addDomListener(this._wrapper,"mouseout",this._onMouseOut,this),W.j.addDomListener(this._wrapper,"mouseup",this._onMouseUp,this),W.j.addDomListener(this._wrapper,"mousedown",this._onMouseDown,this),W.j.addDomListener(this._wrapper,"click",this._onClick,this),W.j.addDomListener(this._wrapper,"doubleclick",this._onDoubleClick,this),W.j.addDomListener(this._wrapper,"contextmenu",this._onContextMenu,this),this._loadState=x.jd.Loaded,this.opened.trigger())},l.prototype._removeFromMap=function(i){this.loadState!=x.jd.Unloaded&&this.map===i&&(this._popup.remove(),this.map.zoomed.removeListener(this._onMapZoomed,this),this.map.panned.removeListener(this._onMapPanned,this),this._map=null,this._loadState=x.jd.Unloaded,W.j.removeDomListener(this._wrapper,"mouseover",this._onMouseOver,this),W.j.removeDomListener(this._wrapper,"mouseout",this._onMouseOut,this),W.j.removeDomListener(this._wrapper,"mouseup",this._onMouseUp,this),W.j.removeDomListener(this._wrapper,"mousedown",this._onMouseDown,this),W.j.removeDomListener(this._wrapper,"click",this._onClick,this),W.j.removeDomListener(this._wrapper,"doubleclick",this._onDoubleClick,this),W.j.removeDomListener(this._wrapper,"contextmenu",this._onContextMenu,this),this.closed.trigger())},l.prototype.update=function(){if(this.map){var i=this.map.offset,s=new Re.R,_,b=this.geoPoint,D=new v.F;if(D.latitude.radians=b.latitude.radians,D.longitude.radians=b.longitude.radians+i.right.radians,i.bounds.containsPoint(D)){_=Re.R.fromRadians(i.right.radians),this._unshift(),this._shift(s,_),this._popup._update();return}if(i.left!=i.right&&(D.longitude.radians=b.longitude.radians+i.left.radians,i.bounds.containsPoint(D))){_=Re.R.fromRadians(i.left.radians),this._unshift(),this._shift(s,_),this._popup._update();return}this._unshift(),this._popup._update()}this._popup._update()},l}(na);function Jo(O,l,i,s){switch(s==null&&(s=l.renderer!==void 0?l.renderer:_a._autoDetectRenderer()),s===Q.Renderer.Auto&&(s=_a._autoDetectRenderer()),s){case Q.Renderer.WebDOM:return new Za(O,l,i,s);case Q.Renderer.WebGL:return new io(O,l,i,s);default:throw new Error("invalid renderer type")}}function fo(O,l){switch(O._renderer){case Q.Renderer.WebDOM:return new Ea(l);default:return new po(l)}}var Lo={BoxZoom:k,DoubleClickZoom:z,Dragging:C,Graticule:ot,Hover:Et,Idl:Lt,KeyboardNavigation:Si,LeafletMap:Za,LeafletPopup:Ea,Map:Jo,MapOptions:Ho,MapConfiguration:No,MapBase:_a,AnimationOptions:Mr,PanningOptions:qr,MapBehavior:h,MapboxAttribution:yn,MapboxMap:io,MapboxPopup:po,MapEvent:Zn,MapOffset:Sa,Popup:fo,PopupBase:na,PopupOptions:so,ScrollWheelZoom:Hr,TileGrid:gr,TouchZoom:gn},Go=Object.keys(Q);Go.forEach(function(O){Object.defineProperty(Lo,O,{value:Q[O],writable:!1,enumerable:!0,configurable:!1})});const ko=Lo},69011:(ct,Ye,B)=>{"use strict";B.r(Ye),B.d(Ye,{Renderer:()=>h,MapEngineType:()=>h,applyRtlTextPlugin:()=>K});var Q=B(84922),W=B.n(Q),h;(function(k){k[k.WebDOM=0]="WebDOM",k[k.WebGL=1]="WebGL",k[k.Auto=2]="Auto"})(h||(h={}));function K(k){W().setRTLTextPlugin(k,null)}},41626:(ct,Ye,B)=>{"use strict";B.d(Ye,{v:()=>z,c:()=>R});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(69011),k=B(70032),A=function(){var C=function(x,v){return C=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,T){m.__proto__=T}||function(m,T){for(var I in T)T.hasOwnProperty(I)&&(m[I]=T[I])},C(x,v)};return function(x,v){C(x,v);function m(){this.constructor=x}x.prototype=v===null?Object.create(v):(m.prototype=v.prototype,new m)}}(),z=function(){function C(x){x===void 0&&(x={}),this.dashArray=void 0,this.enableFill=void 0,this.enableStroke=void 0,this.fillColor=void 0,this.fillOpacity=void 0,this.fillRule=void 0,this.radius=void 0,this.strokeColor=void 0,this.strokeOpacity=void 0,this.strokeWidth=void 0,(0,h.f0)(this,x)}return C}(),R=function(C){A(x,C);function x(v,m){var T=C.call(this,m)||this;return m instanceof z||(m=new z(m)),T._geoPoints[0]=v,T._geoCenter=v,T._dashArray=m.dashArray,T._enableFill=m.enableFill!==void 0?m.enableFill:!0,T._enableStroke=m.enableStroke!==void 0?m.enableStroke:!0,T._fillColor=m.fillColor||"rgba(0, 0, 255, 1)",T._fillOpacity=m.fillOpacity!==void 0?m.fillOpacity:.2,T._fillRule=m.fillRule,T._radius=m.radius!==void 0?m.radius:10,T._strokeColor=m.strokeColor||"rgba(0, 0, 255, 1)",T._strokeOpacity=m.strokeOpacity!==void 0?m.strokeOpacity:1,T._strokeWidth=m.strokeWidth!==void 0?m.strokeWidth:1,T}return Object.defineProperty(x.prototype,"dashArray",{get:function(){return this._dashArray},set:function(v){if(this._dashArray!==v&&((0,h.le)(v)&&(v=void 0),this._dashArray=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.dashArray=v,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"enableFill",{get:function(){return this._enableFill},set:function(v){if(this._enableFill!==v&&((0,h.le)(v)&&(v=!0),this._enableFill=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.fill=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxFillOpacity(this._fillOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"enableStroke",{get:function(){return this._enableStroke},set:function(v){if(this._enableStroke!==v&&((0,h.le)(v)&&(v=!0),this._enableStroke=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.stroke=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxStrokeOpacity(this._strokeOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"fillColor",{get:function(){return this._fillColor},set:function(v){if(this._fillColor!==v&&((0,h.le)(v)&&(v="rgba(0, 0, 255, 1)"),this._fillColor=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.fillColor=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxFillColor(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(v){if(this._fillOpacity!==v&&((0,h.le)(v)&&(v=.2),this._fillOpacity=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.fillOpacity=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxFillOpacity(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"fillRule",{get:function(){return this._fillRule},set:function(v){if(this._fillRule!==v&&((0,h.le)(v)&&(v=void 0),this._fillRule=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.fillRule=v,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"geoCenter",{get:function(){return this._geoCenter},set:function(v){if(!this._geoCenter.equals(v)){if((0,h.le)(v))throw new Error("Value is required");if(this._geoCenter=v,this._geoPoints[0]=v,this._isBoundsDirty=!0,this._layer)switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._setLeafletGeoCenter();break;case K.Renderer.WebGL:this._setMapboxGeoCenter(v),this._layer._updateMapboxData();break}}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"radius",{get:function(){return this._radius},set:function(v){if(this._radius!==v&&((0,h.le)(v)&&(v=10),this._radius=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._setLeafletRadius(v);break;case K.Renderer.WebGL:this._setMapboxRadius(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(v){if(this._strokeColor!==v&&((0,h.le)(v)&&(v="rgba(0, 0, 255, 1)"),this._strokeColor=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.color=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxStrokeColor(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(v){if(this._strokeOpacity!==v&&((0,h.le)(v)&&(v=1),this._strokeOpacity=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.opacity=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxStrokeOpacity(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(v){if(this._strokeWidth!==v&&((0,h.le)(v)&&(v=1),this._strokeWidth=v,this._layer))switch(this._layer.map.renderer){case K.Renderer.WebDOM:this._leafletOptions.weight=v,this._setLeafletStyle(this._leafletOptions);break;case K.Renderer.WebGL:this._setMapboxStrokeWidth(v),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),x.prototype._loadLeaflet=function(){var v=this._geoCenter.toLeaflet();this._leafletOptions=this._deriveLeafletOptions(),this._leafletLeftLayer=W().circleMarker(v,this._leafletOptions),this._leafletRightLayer=W().circleMarker(v,this._leafletOptions),C.prototype._loadLeaflet.call(this)},x.prototype._showLeaflet=function(){this._setLeafletRadius(this.radius),C.prototype._showLeaflet.call(this)},x.prototype._deriveLeafletOptions=function(){var v={};return(0,h.le)(this.enableStroke)||(v.stroke=this.enableStroke),(0,h.le)(this.strokeColor)||(v.color=this.strokeColor),(0,h.le)(this.strokeWidth)||(v.weight=this.strokeWidth),(0,h.le)(this.strokeOpacity)||(v.opacity=this.strokeOpacity),(0,h.le)(this.enableFill)||(v.fill=this.enableFill),(0,h.le)(this.fillColor)||(v.fillColor=this.fillColor),(0,h.le)(this.fillOpacity)||(v.fillOpacity=this.fillOpacity),(0,h.le)(this.dashArray)||(v.dashArray=this.dashArray),(0,h.le)(this.fillRule)||(v.fillRule=this.fillRule),v.pane=this._layer._leafletCirclePane,v.renderer=this._layer._leafletCircleRenderer,v},x.prototype._setLeafletStyle=function(v){this._leafletLeftLayer.setStyle(v),this._leafletRightLayer.setStyle(v)},x.prototype._setLeafletRadius=function(v){this._leafletLeftLayer.setRadius(v),this._leafletRightLayer.setRadius(v)},x.prototype._setLeafletGeoCenter=function(){this._unshiftLeft(),this._unshiftRight()},x.prototype._updateLeafletOverlay=function(v,m){var T=m[0].toLeaflet();v.setLatLng(T)},x.prototype._loadMapbox=function(){this._mapboxGeoJSON={id:this._id,type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"CircleMarker"},geometry:{type:"Point",coordinates:[]}},this._setMapboxGeoCenter(this.geoCenter),this._setMapboxRadius(this.radius),this._setMapboxFillColor(this.fillColor),this._setMapboxFillOpacity(this.fillOpacity),this._setMapboxStrokeColor(this.strokeColor),this._setMapboxStrokeWidth(this.strokeWidth),this._setMapboxStrokeOpacity(this.strokeOpacity)},x.prototype._applyMapboxOpacity=function(){this._layer.map.renderer===K.Renderer.WebGL&&(this._setMapboxFillOpacity(this._fillOpacity),this._setMapboxStrokeOpacity(this._strokeOpacity))},x.prototype._setMapboxRadius=function(v){var m=v>0?v:0;this._mapboxGeoJSON.properties["circle-radius"]=m},x.prototype._setMapboxFillColor=function(v){this._mapboxGeoJSON.properties["circle-color"]=v},x.prototype._setMapboxFillOpacity=function(v){var m=this._enableFill?v*this._layer.opacity:0;this._mapboxGeoJSON.properties["circle-opacity"]=m},x.prototype._setMapboxStrokeColor=function(v){this._mapboxGeoJSON.properties["circle-stroke-color"]=v},x.prototype._setMapboxStrokeWidth=function(v){var m=v>0?v:0;this._mapboxGeoJSON.properties["circle-stroke-width"]=m},x.prototype._setMapboxStrokeOpacity=function(v){var m=this._enableStroke?v*this._layer.opacity:0;this._mapboxGeoJSON.properties["circle-stroke-opacity"]=m},x.prototype._setMapboxGeoCenter=function(v){var m=v.longitude.degrees,T=v.latitude.degrees;this._mapboxGeoJSON.geometry.coordinates=[m,T]},x}(k.a)},89443:(ct,Ye,B)=>{"use strict";B.d(Ye,{s:()=>v});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(96002),k=B(58326),A=B(22236),z=B(69011),R=B(70032),C=function(){var m=function(T,I){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(F,q){F.__proto__=q}||function(F,q){for(var re in q)q.hasOwnProperty(re)&&(F[re]=q[re])},m(T,I)};return function(T,I){m(T,I);function F(){this.constructor=T}T.prototype=I===null?Object.create(I):(F.prototype=I.prototype,new F)}}(),x=function(){function m(T){T===void 0&&(T={}),this.dashArray=void 0,this.enableFill=void 0,this.enableStroke=void 0,this.fillColor=void 0,this.fillOpacity=void 0,this.fillRule=void 0,this.radius=void 0,this.strokeColor=void 0,this.strokeOpacity=void 0,this.strokeWidth=void 0,(0,h.f0)(this,T)}return m}(),v=function(m){C(T,m);function T(I,F){var q=m.call(this,F)||this;return F instanceof x||(F=new x(F)),q._geoPoints[0]=I,q._geoCenter=I,q._dashArray=F.dashArray,q._enableFill=F.enableFill!==void 0?F.enableFill:!0,q._enableStroke=F.enableStroke!==void 0?F.enableStroke:!0,q._fillColor=F.fillColor||"rgba(0, 0, 255, 1)",q._fillOpacity=F.fillOpacity!==void 0?F.fillOpacity:.2,q._fillRule=F.fillRule,q._radius=F.radius!==void 0?F.radius:10,q._strokeColor=F.strokeColor||"rgba(0, 0, 255, 1)",q._strokeOpacity=F.strokeOpacity!==void 0?F.strokeOpacity:1,q._strokeWidth=F.strokeWidth!==void 0?F.strokeWidth:1,q}return Object.defineProperty(T.prototype,"dashArray",{get:function(){return this._dashArray},set:function(I){if(this._dashArray!==I&&((0,h.le)(I)&&(I=void 0),this._dashArray=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.dashArray=I,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"enableFill",{get:function(){return this._enableFill},set:function(I){if(this._enableFill!==I&&((0,h.le)(I)&&(I=!0),this._enableFill=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.fill=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxFillOpacity(this._fillOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"enableStroke",{get:function(){return this._enableStroke},set:function(I){if(this._enableStroke!==I&&((0,h.le)(I)&&(I=!0),this._enableStroke=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.stroke=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxStrokeOpacity(this._strokeOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"fillColor",{get:function(){return this._fillColor},set:function(I){if(this._fillColor!==I&&((0,h.le)(I)&&(I="rgba(0, 0, 255, 1)"),this._fillColor=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.fillColor=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxFillColor(I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(I){if(this._fillOpacity!==I&&((0,h.le)(I)&&(I=.2),this._fillOpacity=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.fillOpacity=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxFillOpacity(I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"fillRule",{get:function(){return this._fillRule},set:function(I){if(this._fillRule!==I&&((0,h.le)(I)&&(I=void 0),this._fillRule=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.fillRule=I,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"geoCenter",{get:function(){return this._geoCenter},set:function(I){if(!this._geoCenter.equals(I)){if((0,h.le)(I))throw new Error("Value is required");if(this._geoCenter=I,this._isBoundsDirty=!0,this._layer)switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._geoPoints[0]=I,this._setLeafletGeoCenter();break;case z.Renderer.WebGL:this._setMapboxPolygon(I,this.radius),this._layer._updateMapboxData();break}}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"radius",{get:function(){return this._radius},set:function(I){if(this._radius!==I&&((0,h.le)(I)&&(I=10),this._radius=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._setLeafletRadius(I);break;case z.Renderer.WebGL:this._setMapboxPolygon(this.geoCenter,I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(I){if(this._strokeColor!==I&&((0,h.le)(I)&&(I="rgba(0, 0, 255, 1)"),this._strokeColor=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.color=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxStrokeColor(I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(I){if(this._strokeOpacity!==I&&((0,h.le)(I)&&(I=1),this._strokeOpacity=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.opacity=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxStrokeOpacity(I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(I){if(this._strokeWidth!==I&&((0,h.le)(I)&&(I=1),this._strokeWidth=I,this._layer))switch(this._layer.map.renderer){case z.Renderer.WebDOM:this._leafletOptions.weight=I,this._setLeafletStyle(this._leafletOptions);break;case z.Renderer.WebGL:this._setMapboxStrokeWidth(I),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),T.prototype._loadLeaflet=function(){var I=this._geoCenter.toLeaflet(),F=this._leafletOptions=this._deriveLeafletOptions();this._leafletLeftLayer=W().circle(I,0,F),this._leafletRightLayer=W().circle(I,0,F),m.prototype._loadLeaflet.call(this)},T.prototype._showLeaflet=function(){this._setLeafletRadius(this.radius),m.prototype._showLeaflet.call(this)},T.prototype._deriveLeafletOptions=function(){var I={};return(0,h.le)(this.enableStroke)||(I.stroke=this.enableStroke),(0,h.le)(this.strokeColor)||(I.color=this.strokeColor),(0,h.le)(this.strokeWidth)||(I.weight=this.strokeWidth),(0,h.le)(this.strokeOpacity)||(I.opacity=this.strokeOpacity),(0,h.le)(this.enableFill)||(I.fill=this.enableFill),(0,h.le)(this.fillColor)||(I.fillColor=this.fillColor),(0,h.le)(this.fillOpacity)||(I.fillOpacity=this.fillOpacity),(0,h.le)(this.dashArray)||(I.dashArray=this.dashArray),(0,h.le)(this.fillRule)||(I.fillRule=this.fillRule),I.pane=this._layer._leafletCirclePane,I.renderer=this._layer._leafletCircleRenderer,I},T.prototype._setLeafletStyle=function(I){this._leafletLeftLayer.setStyle(I),this._leafletRightLayer.setStyle(I)},T.prototype._setLeafletRadius=function(I){this._leafletLeftLayer.setRadius(I),this._leafletRightLayer.setRadius(I)},T.prototype._setLeafletGeoCenter=function(){this._unshiftLeft(),this._unshiftRight()},T.prototype._updateLeafletOverlay=function(I,F){var q=F[0].toLeaflet();I.setLatLng(q)},T.prototype._loadMapbox=function(){this._mapboxGeoJSON={type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"CirclePath"},geometry:{type:"Polygon",coordinates:[]}},this._setMapboxPolygon(this.geoCenter,this.radius),this._setMapboxFillColor(this.fillColor),this._setMapboxFillOpacity(this.fillOpacity),this._setMapboxStrokeColor(this.strokeColor),this._setMapboxStrokeWidth(this.strokeWidth),this._setMapboxStrokeOpacity(this.strokeOpacity)},T.prototype._applyMapboxOpacity=function(){this._layer.map.renderer===z.Renderer.WebGL&&(this._setMapboxFillOpacity(this._fillOpacity),this._setMapboxStrokeOpacity(this._strokeOpacity))},T.prototype._setMapboxPolygon=function(I,F){if(!((0,h.le)(I)||(0,h.le)(F))){for(var q=F>0?F:0,re=A.r.fromMeters(q),ne=k.R.fromDegrees(0),se=[],X=[],ce=90,Me=0;Me<ce;Me++){ne.degrees=Me*-360/ce;var Be=(0,K.Nr)(I,ne,re);se.push(Be);var ot=Be.longitude.degrees,Ue=Be.latitude.degrees;X.push([ot,Ue])}se.push(se[0]),X.push(X[0]),this._geoPoints=se,this._mapboxGeoJSON.geometry.coordinates=[X]}},T.prototype._setMapboxFillColor=function(I){(0,h.le)(I)||(this._mapboxGeoJSON.properties["fill-color"]=I)},T.prototype._setMapboxFillOpacity=function(I){if(!(0,h.le)(I)){var F=this._enableFill?I*this._layer.opacity:0;this._mapboxGeoJSON.properties["fill-opacity"]=F}},T.prototype._setMapboxStrokeColor=function(I){(0,h.le)(I)||(this._mapboxGeoJSON.properties["line-color"]=I)},T.prototype._setMapboxStrokeWidth=function(I){if(!(0,h.le)(I)){var F=I>0?I:0;this._mapboxGeoJSON.properties["line-width"]=F}},T.prototype._setMapboxStrokeOpacity=function(I){if(!(0,h.le)(I)){var F=this._enableStroke?I*this._layer.opacity:0;this._mapboxGeoJSON.properties["line-opacity"]=F}},T.prototype.intersects=function(I){var F=this.geoCenter,q=this.radius;return A.r.fromPoints(I.centerPoint,F).meters<=q||A.r.fromPoints(I.topLeftGeoPoint,F).meters<=q||A.r.fromPoints(I.topRightGeoPoint,F).meters<=q||A.r.fromPoints(I.bottomRightGeoPoint,F).meters<=q||A.r.fromPoints(I.bottomLeftGeoPoint,F).meters<=q},T}(R.a)},56448:(ct,Ye,B)=>{"use strict";B.d(Ye,{L:()=>W});var Q=B(66071),W=function(){function h(K,k){this._weight=0,this._expires=null,this._computed={},this._isVisible=!1,this._properties={},this._isShown=!1,this.properties=K,this.id=k&&!(0,Q.le)(k.id)?k.id:(0,Q.cm)()}return Object.defineProperty(h.prototype,"bounds",{get:function(){throw new Error("NotImplementedException: getBounds")},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"expires",{get:function(){return this._expires},set:function(K){this._expires=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"computed",{get:function(){return this._computed},set:function(K){this._computed=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"geoCenter",{get:function(){throw new Error("NotImplementedException: getGeoCenter")},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"id",{get:function(){return this._id},set:function(K){this._id=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"isVisible",{get:function(){return this._isVisible},set:function(K){this._isVisible=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"layer",{get:function(){return this._layer?this._layer:null},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"overlay",{get:function(){return this._overlay},set:function(K){this._overlay=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"properties",{get:function(){return this._properties},set:function(K){this._properties=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"source",{get:function(){return this._source},set:function(K){this._source=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"validTime",{get:function(){return this._validTime},set:function(K){this._validTime=K},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"weight",{get:function(){return this._weight},set:function(K){this._weight=K},enumerable:!0,configurable:!0}),h}()},1197:(ct,Ye,B)=>{"use strict";B.d(Ye,{X:()=>x});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(93126),k=B(19501),A=B(69011),z=B(70032),R=function(){var v=function(m,T){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(I,F){I.__proto__=F}||function(I,F){for(var q in F)F.hasOwnProperty(q)&&(I[q]=F[q])},v(m,T)};return function(m,T){v(m,T);function I(){this.constructor=m}m.prototype=T===null?Object.create(T):(I.prototype=T.prototype,new I)}}(),C=function(){function v(m){m===void 0&&(m={}),this.anchor=void 0,this.offset=void 0,this.retinaSource=void 0,this.size=void 0,this.opacity=void 0,this.scale=void 0,this.rotation=void 0,(0,h.f0)(this,m)}return v}(),x=function(v){R(m,v);function m(T,I,F){var q=v.call(this,F)||this;return q._isListening=!1,F instanceof C||(F=new C(F)),q._geoPoints[0]=T,q._geoCenter=T,q._size=F.size,q._scale=F.scale!==void 0?F.scale:1,q._offset=F.offset!==void 0?F.offset:new K.E(0,0),q._retinaSource=F.retinaSource,q._source=I,q._opacity=F.opacity!==void 0?F.opacity:1,q._rotation=F.rotation,q._anchor=F.anchor!==void 0?F.anchor:h.ee.Center,q}return Object.defineProperty(m.prototype,"anchor",{get:function(){return this._anchor},set:function(T){if(T!==this._anchor&&(this._anchor=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:var I=this._deriveLeafletIcon();this._setLeafletIcon(I);break;case A.Renderer.WebGL:this._setMapboxAnchor(T),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"offset",{get:function(){return this._offset},set:function(T){if(T.toString()!==this._offset.toString()&&((0,h.le)(T)&&(T=void 0),this._offset=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:var I=this._deriveLeafletIcon();this._setLeafletIcon(I);break;case A.Renderer.WebGL:this._setMapboxOffset(T),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"geoCenter",{get:function(){var T=this._geoPoints;return T[0]},set:function(T){if(!this._geoCenter.equals(T)){if((0,h.le)(T))throw new Error("Value is required");if(this._geoCenter=T,this._geoPoints[0]=T,this._isBoundsDirty=!0,this._layer)switch(this._layer.map.renderer){case A.Renderer.WebDOM:this._setLeafletGeoCenter();break;case A.Renderer.WebGL:this._setMapboxGeoCenter(T),this._layer._updateMapboxData();break}}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"opacity",{get:function(){return this._opacity},set:function(T){if(this._opacity!==T&&((0,h.le)(T)&&(T=1),this._opacity=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:this._setLeafletOpacity(T);break;case A.Renderer.WebGL:this._setMapboxOpacity(T),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"retinaSource",{get:function(){return this._retinaSource},set:function(T){if(this._retinaSource!==T&&((0,h.le)(T)&&(T=void 0),this._retinaSource=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:this._showLeaflet();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"rotation",{get:function(){return this._rotation},set:function(T){if(T!==this._rotation&&((0,h.le)(T)&&(T=void 0),this._rotation=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:var I=this._deriveLeafletIcon();this._setLeafletIcon(I);break;case A.Renderer.WebGL:this._setMapboxRotation(T),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"source",{get:function(){return this._source},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"scale",{get:function(){return this._scale},set:function(T){if(this._scale!==T&&((0,h.le)(T)&&(T=1),this._scale=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:var I=this._deriveLeafletIcon();this._setLeafletIcon(I);break;case A.Renderer.WebGL:this._setMapboxScale(T),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"size",{get:function(){return this._size},set:function(T){if(((0,h.le)(this._size)||this._size.toString()!==T.toString())&&((0,h.le)(T)&&(T=void 0),this._size=T,this._layer))switch(this._layer.map.renderer){case A.Renderer.WebDOM:var I=this._deriveLeafletIcon();this._setLeafletIcon(I);break}},enumerable:!0,configurable:!0}),m.prototype._detectLeafletOverlay=function(T){var I=null,F=!1;if(!(0,h.le)(this._leafletLeftLayer)&&this._leafletLeftLayer._map?I=this._leafletLeftLayer:!(0,h.le)(this._leafletRightLayer)&&this._leafletRightLayer._map&&(I=this._leafletRightLayer),!(0,h.le)(I)){var q=I._map._mapPane,re=I.getElement(),ne=window.getComputedStyle(re.firstChild.firstChild),se=parseInt(ne.getPropertyValue("width"),10),X=parseInt(ne.getPropertyValue("height"),10),ce=this.offset,Me={x:0,y:0};switch(this.anchor){case h.ee.TopLeft:Me.x=0,Me.y=0;break;case h.ee.Top:Me.x=-(se/2),Me.y=0;break;case h.ee.TopRight:Me.x=-se,Me.y=0;break;case h.ee.Right:Me.x=-se,Me.y=-(X/2);break;case h.ee.BottomRight:Me.x=-se,Me.y=-X;break;case h.ee.Bottom:Me.x=-(se/2),Me.y=-X;break;case h.ee.BottomLeft:Me.x=0,Me.y=-X;break;case h.ee.Left:Me.x=0,Me.y=-(X/2);break;case h.ee.Center:Me.x=-(se/2),Me.y=-(X/2);break}var Be=parseInt(re.style.marginLeft,10)||0,ot=parseInt(re.style.marginTop,10)||0,Ue=re._leaflet_pos.y+ot+q._leaflet_pos.y+ce.y+Me.y,ht=Ue+X,Et=re._leaflet_pos.x-Be+q._leaflet_pos.x+ce.x+Me.x,bi=Et+se;F=T.x>=Et&&T.x<=bi&&T.y>=Ue&&T.y<=ht}return F},m.prototype._loadLeaflet=function(){var T=this.geoCenter.toLeaflet(),I=this._deriveLeafletOptions();this._leafletLeftLayer=new(W()).Marker(T,I),this._leafletRightLayer=new(W()).Marker(T,I),v.prototype._loadLeaflet.call(this)},m.prototype._showLeaflet=function(){this._setLeafletOpacity(this._opacity),v.prototype._showLeaflet.call(this)},m.prototype._setLeafletGeoCenter=function(){this._unshiftLeft(),this._unshiftRight()},m.prototype._deriveLeafletIcon=function(){var T=this,I={};if((0,h.le)(this._size)){var re=new Image;re.addEventListener("load",function(Me){T.size=new k.$(re.width,re.height);var Be=T._deriveLeafletIcon();T._setLeafletIcon(Be)}),re.src=this._source}else{var F=this._size.width*this.scale,q=this._size.height*this.scale;I.iconSize=new(W()).Point(F,q)}var ne;switch(this._anchor){case h.ee.TopLeft:ne="0%, 0%";break;case h.ee.Top:ne="-50%, 0%";break;case h.ee.TopRight:ne="-100%, 0%";break;case h.ee.Right:ne="-100%, -50%";break;case h.ee.BottomRight:ne="-100%, -100%";break;case h.ee.Bottom:ne="-50%, -100%";break;case h.ee.BottomLeft:ne="0, -100%";break;case h.ee.Left:ne="0, -50%";break;case h.ee.Center:default:ne="-50%, -50%";break}var se='<img src="'+this._source+'" style="';F&&(se+="width:"+F+"px;"),q&&(se+="height:"+q+"px;"),se+="display:block;margin:0;padding:0;",se+='">';var X="<div style='border:none;background:none;padding:0;margin:0;white-space:nowrap;";X+="opacity:"+this._opacity+";",X+="transform-origin:"+this._offset.x*-1+"px "+this._offset.y*-1+"px;",X+="transform:translate3d("+this._offset.x+"px, "+this._offset.y+"px, 0) rotateZ("+(this._rotation||0)+"deg);",X+="'><div style='display:inline-block;overflow:hidden;transform-origin:0% 0%;transform:translate("+ne+");",X+="'>"+se+"</div></div>",I.html=X,I.iconSize=[0,0];var ce=new(W()).DivIcon(I);return ce},m.prototype._deriveLeafletOptions=function(){var T={};return T.pane=this._layer._leafletImagePane,T.renderer=this._layer._leafletImageRenderer,T.icon=this._deriveLeafletIcon(),T},m.prototype._setLeafletIcon=function(T){this._leafletLeftLayer.setIcon(T),this._leafletRightLayer.setIcon(T)},m.prototype._setLeafletOpacity=function(T){this._leafletLeftLayer.setOpacity(T),this._leafletRightLayer.setOpacity(T)},m.prototype._updateLeafletOverlay=function(T,I){var F=I[0].toLeaflet();T.setLatLng(F)},m.prototype._loadMapbox=function(){var T=this;this._mapboxGeoJSON={type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"ImageMarker"},geometry:{type:"Point",coordinates:[]}};var I=this._layer.map,F=I._images[this._source];I._mapboxEngine.on("styleimagemissing",function(q){var re=q.id,ne=I._images[re];ne&&ne!==h.jd.Loading&&I.addImage(re,ne)}),F?this._setMapboxAttributes():(this._isListening=!0,I.imageAdded.addListener(this._onImageAdded,this),I._images[this._source]=h.jd.Loading,I.loadImage(this._source,function(q,re){q?console.log(T):I.addImage(T._source,re)}))},m.prototype._applyMapboxOpacity=function(){this._layer.map.renderer===A.Renderer.WebGL&&this._setMapboxOpacity(this._opacity)},m.prototype._setMapboxAttributes=function(){this._setMapboxGeoCenter(this.geoCenter),this._setMapboxImage(this.source),this._setMapboxAnchor(this.anchor),this._setMapboxOffset(this.offset),this._setMapboxOpacity(this.opacity),this._setMapboxScale(this.scale),this._setMapboxRotation(this.rotation)},m.prototype._setMapboxGeoCenter=function(T){if(!(0,h.le)(T)){var I=T.longitude.degrees,F=T.latitude.degrees;this._mapboxGeoJSON.geometry.coordinates=[I,F]}},m.prototype._setMapboxImage=function(T){(0,h.le)(T)||(this._mapboxGeoJSON.properties["icon-image"]=T)},m.prototype._setMapboxAnchor=function(T){if(!(0,h.le)(T)){var I="";switch(T){case h.ee.TopLeft:I="top-left";break;case h.ee.Top:I="top";break;case h.ee.TopRight:I="top-right";break;case h.ee.Right:I="right";break;case h.ee.BottomRight:I="bottom-right";break;case h.ee.Bottom:I="bottom";break;case h.ee.BottomLeft:I="bottom-left";break;case h.ee.Left:I="left";break;case h.ee.Center:default:I="center";break}this._mapboxGeoJSON.properties["icon-anchor"]=I}},m.prototype._setMapboxOffset=function(T){if(!(0,h.le)(T)){var I=T?[T.x,T.y]:[0,0];this._mapboxGeoJSON.properties["icon-offset"]=I}},m.prototype._setMapboxOpacity=function(T){if(!(0,h.le)(T)){var I=T*this._layer.opacity;this._mapboxGeoJSON.properties["icon-opacity"]=I}},m.prototype._setMapboxScale=function(T){(0,h.le)(T)||(this._mapboxGeoJSON.properties["icon-size"]=T)},m.prototype._setMapboxRotation=function(T){(0,h.le)(T)||(this._mapboxGeoJSON.properties["icon-rotate"]=T)},m.prototype._unloadMapbox=function(){if(this._isListening&&this._layer){var T=this._layer.map;T.imageAdded.removeListener(this._onImageAdded,this),this._isListening=!1}v.prototype._unloadMapbox.call(this)},m.prototype._onImageAdded=function(T){if(T.name===this.source&&this._layer){var I=this._layer;this._setMapboxAttributes(),I._updateMapboxData();var F=I.map;F.imageAdded.removeListener(this._onImageAdded,this),this._isListening=!1}},m}(z.a)},14740:(ct,Ye,B)=>{"use strict";B.d(Ye,{f:()=>k});var Q=B(9654),W=B(50042),h=B(56448),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(R,C,x){var v=A.call(this,C,x)||this;return v.points=R,v}return Object.defineProperty(z.prototype,"bounds",{get:function(){for(var R=new W.c,C=0,x=this._points.length;C<x;C++){var v=this._points[C];R.expand(v)}return R},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"geoCenter",{get:function(){var R=this.bounds,C=R.centerPoint;return C},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"points",{get:function(){return this._points},set:function(R){this._points=R},enumerable:!0,configurable:!0}),z.fromGeoJson=function(R){for(var C=R.geometry,x=C.coordinates,v=[],m=0,T=x.length;m<T;m++){var I=x[m],F=I[0],q=I[1],re=Q.F.fromDegrees(q,F);v.push(re)}var ne=R.properties,se=new z(v,ne);return R.id?se.id=R.id:R.properties.id&&(se.id=R.properties.id),se},z}(h.L)},86330:(ct,Ye,B)=>{"use strict";B.d(Ye,{f:()=>z});var Q=B(50042),W=B(9654),h=B(29227),K=B(24940),k=B(56448),A=function(){var R=function(C,x){return R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,m){v.__proto__=m}||function(v,m){for(var T in m)m.hasOwnProperty(T)&&(v[T]=m[T])},R(C,x)};return function(C,x){R(C,x);function v(){this.constructor=C}C.prototype=x===null?Object.create(x):(v.prototype=x.prototype,new v)}}(),z=function(R){A(C,R);function C(x,v,m){var T=R.call(this,v,m)||this;return T._polygons=x,T}return Object.defineProperty(C.prototype,"bounds",{get:function(){for(var x=new Q.c,v=0,m=this._polygons.length;v<m;v++){var T=this._polygons[v];x.expand(T.bounds.topLeftGeoPoint),x.expand(T.bounds.bottomRightGeoPoint)}return x},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"geoCenter",{get:function(){var x=this.bounds,v=x.centerPoint;return v},enumerable:!0,configurable:!0}),Object.defineProperty(C.prototype,"polygons",{get:function(){return this._polygons},set:function(x){this._polygons=x},enumerable:!0,configurable:!0}),C.fromGeoJson=function(x){for(var v=x.properties,m=x.geometry.coordinates,T=[],I=0,F=m.length;I<F;I++){for(var q=m[I],re=new K.h,ne=[],se=0,X=q.length;se<X;se++){for(var ce=q[se],Me=new h.A,Be=0,ot=ce.length;Be<ot;Be++){var Ue=ce[Be],ht=Ue[0],Et=Ue[1],bi=W.F.fromDegrees(Et,ht);Me.add(bi)}ne.push(Me)}re.polylines=ne,T.push(re)}var gt=new C(T,v);return x.id?gt.id=x.id:x.properties.id&&(gt.id=x.properties.id),gt},C}(k.L)},7388:(ct,Ye,B)=>{"use strict";B.d(Ye,{H:()=>k});var Q=B(66071),W=B(61955),h=B(81891),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(R,C){var x=A.call(this,[],C)||this;x._isNormalized=C.isNormalized!==void 0?C.isNormalized:!1,x._dashArray=C.dashArray,x._enableFill=C.enableFill!==void 0?C.enableFill:!0,x._enableStroke=C.enableStroke!==void 0?C.enableStroke:!0,x._fillColor=C.fillColor||"rgba(0, 0, 255, 1)",x._fillOpacity=C.fillOpacity!==void 0?C.fillOpacity:.2,x._fillRule=C.fillRule,x._isClipped=C.isClipped,x._lineCap=C.lineCap,x._lineJoin=C.lineJoin,x._smoothFactor=C.smoothFactor!==void 0?C.smoothFactor:1,x._strokeColor=C.strokeColor||"rgba(0, 0, 255, 1)",x._strokeOpacity=C.strokeOpacity!==void 0?C.strokeOpacity:1,x._strokeWidth=C.strokeWidth!==void 0?C.strokeWidth:1;for(var v=[],m=0,T=R.length;m<T;m++){var I=R[m],F=new h.n(I,C);F._group=x,v.push(F)}return x._overlays=v,x}return Object.defineProperty(z.prototype,"isNormalized",{get:function(){return this._isNormalized},set:function(R){if(this._isNormalized!==R){(0,Q.le)(R)&&(R=!0),this._isNormalized=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.isNormalized=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"dashArray",{get:function(){return this._dashArray},set:function(R){if(this._dashArray!==R){(0,Q.le)(R)&&(R=void 0),this._dashArray=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.dashArray=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"enableFill",{get:function(){return this._enableFill},set:function(R){if(this._enableFill!==R){(0,Q.le)(R)&&(R=!0),this._enableFill=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.enableFill=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"enableStroke",{get:function(){return this._enableStroke},set:function(R){if(this._enableStroke!==R){(0,Q.le)(R)&&(R=!0),this._enableStroke=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.enableStroke=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"fillColor",{get:function(){return this._fillColor},set:function(R){if(this._fillColor!==R){(0,Q.le)(R)&&(R="rgba(0, 0, 255, 1)"),this._fillColor=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.fillColor=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(R){if(this._fillOpacity!==R){(0,Q.le)(R)&&(R=.2),this._fillOpacity=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.fillOpacity=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"fillRule",{get:function(){return this._fillRule},set:function(R){if(this._fillRule!==R){(0,Q.le)(R)&&(R=void 0),this._fillRule=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.fillRule=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"isClipped",{get:function(){return this._isClipped},set:function(R){if(this._isClipped!==R){(0,Q.le)(R)&&(R=!0),this._isClipped=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.isClipped=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"lineCap",{get:function(){return this._lineCap},set:function(R){if(this._lineCap!==R){this._lineCap=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.lineCap=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(R){if(this._lineJoin!==R){(0,Q.le)(R)&&(R=void 0),this._lineJoin=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.lineJoin=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"smoothFactor",{get:function(){return this._smoothFactor},set:function(R){if(this._smoothFactor!==R){(0,Q.le)(R)&&(R=1),this._smoothFactor=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.smoothFactor=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(R){if(this._strokeColor!==R){(0,Q.le)(R)&&(R="rgba(0, 0, 255, 1)"),this._strokeColor=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.strokeColor=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(R){if(this._strokeOpacity!==R){(0,Q.le)(R)&&(R=1),this._strokeOpacity=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.strokeOpacity=R}}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(R){if(this._strokeWidth!==R){(0,Q.le)(R)&&(R=1),this._strokeWidth=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.strokeWidth=R}}},enumerable:!0,configurable:!0}),z}(W.Q)},81797:(ct,Ye,B)=>{"use strict";B.d(Ye,{m:()=>A});var Q=B(56448),W=B(9654),h=B(50042),K=B(29227),k=function(){var z=function(R,C){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,v){x.__proto__=v}||function(x,v){for(var m in v)v.hasOwnProperty(m)&&(x[m]=v[m])},z(R,C)};return function(R,C){z(R,C);function x(){this.constructor=R}R.prototype=C===null?Object.create(C):(x.prototype=C.prototype,new x)}}(),A=function(z){k(R,z);function R(C,x,v){var m=z.call(this,x)||this;return m._polylines=C,m}return Object.defineProperty(R.prototype,"bounds",{get:function(){for(var C=new h.c,x=0,v=this._polylines.length;x<v;x++){var m=this._polylines[x];C.expand(m.bounds.topLeftGeoPoint),C.expand(m.bounds.bottomRightGeoPoint)}return C},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"geoCenter",{get:function(){var C=this.bounds,x=C.centerPoint;return x},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"polylines",{get:function(){return this._polylines},set:function(C){this._polylines=C},enumerable:!0,configurable:!0}),R.fromGeoJson=function(C){for(var x=C.properties,v=C.geometry.coordinates,m=[],T=0,I=v.length;T<I;T++){for(var F=v[T],q=new K.A,re=0,ne=F.length;re<ne;re++){var se=F[re],X=se[0],ce=se[1],Me=W.F.fromDegrees(ce,X);q.add(Me)}m.push(q)}var Be=new R(m,x);return C.id?Be.id=C.id:C.properties.id&&(Be.id=C.properties.id),Be},R}(Q.L)},70032:(ct,Ye,B)=>{"use strict";B.d(Ye,{a:()=>C});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(28360),k=B(96002),A=B(58326),z=B(50042),R=B(69011),C=function(){function x(v){this._geoPoints=[],this._bounds=new z.c,this._isBoundsDirty=!0,this._crossesIdl=!1,this._feature=null,this._cluster=null,this._isVisible=!1,this._isLoaded=!1,this._group=null,this._zIndex=0,this._transitions={},this._leafletLeftShiftedGeoPoints=null,this._leafletRightShiftedGeoPoints=null,this.propertyChanged=new K.j,this.hidden=new K.j,this.shown=new K.j,this._id=v&&!(0,h.le)(v.id)?v.id:(0,h.cm)()}return Object.defineProperty(x.prototype,"transitions",{get:function(){return this._transitions},enumerable:!0,configurable:!0}),x.prototype._getGeoPoints=function(){return this._geoPoints},x.prototype._getBounds=function(){if(this._isBoundsDirty){var v=this._bounds;v.invalidate();var m=this._geoPoints;(0,h.Oq)(m)&&(m=m[0]);for(var T=0,I=m.length;T<I;T++){var F=m[T];v.expand(F)}}return this._bounds},Object.defineProperty(x.prototype,"bounds",{get:function(){return this._getBounds()},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"cluster",{get:function(){return this._cluster},set:function(v){this._cluster=v},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"crossesIdl",{get:function(){return this._crossesIdl},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"geoCenter",{get:function(){var v=this.bounds,m=v.centerPoint;return m},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"geoPoints",{get:function(){return this._getGeoPoints()},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"feature",{get:function(){return this._feature},set:function(v){this._feature=v},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"group",{get:function(){return this._group},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"id",{get:function(){return this._id},set:function(v){this._id=v},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"isVisible",{get:function(){return this._isVisible},enumerable:!0,configurable:!0}),Object.defineProperty(x.prototype,"layer",{get:function(){return this._layer?this._layer:null},enumerable:!0,configurable:!0}),x.prototype._addToLayer=function(v){this._layer=v,this._load()},x.prototype._removeFromlayer=function(v){this._layer===v&&(this._unload(),this._layer=void 0)},x.prototype._load=function(){if(!this._isLoaded){switch(this._layer.map.renderer){case R.Renderer.WebDOM:this._loadLeaflet();break;case R.Renderer.WebGL:this._loadMapbox();break}this._isLoaded=!0}},x.prototype._unload=function(){if(this._isLoaded){switch(this._layer.map.renderer){case R.Renderer.WebDOM:this._unloadLeaflet();break;case R.Renderer.WebGL:this._unloadMapbox();break}this._isLoaded=!1,this.hidden.clearListeners(),this.shown.clearListeners(),this.propertyChanged.clearListeners();for(var v in this.__transitions){var m=this.__transitions[v];m.dispose()}delete this.__transitions;for(var v in this._transitions){var m=this._transitions[v];m.dispose()}this._transitions={}}},x.prototype.show=function(){if(!this._isVisible&&this._layer){switch(this._layer.map.renderer){case R.Renderer.WebDOM:this._showLeaflet();break;case R.Renderer.WebGL:this._showMapbox();break}this._isVisible=!0,this.shown.trigger()}},x.prototype.hide=function(){if(this._isVisible&&this._layer){switch(this._layer.map.renderer){case R.Renderer.WebDOM:this._hideLeaflet();break;case R.Renderer.WebGL:this._hideMapbox();break}this._isVisible=!1,this.hidden.trigger()}},x.prototype._loadLeaflet=function(){this._lastShiftedBounds=new z.c,this._lastOffsetLatitude=new A.R,this._lastOffsetLongitude=new A.R},x.prototype._unloadLeaflet=function(){this._leafletLeftLayer=void 0,this._leafletRightLayer=void 0,this._lastShiftedBounds=void 0,this._lastOffsetLatitude=void 0,this._lastOffsetLongitude=void 0},x.prototype._showLeaflet=function(){var v=this._layer.map.offset,m=this._lastOffsetLatitude,T=this._lastOffsetLongitude,I=this.bounds,F=this._lastShiftedBounds;F.north.radians=I.north.radians,F.south.radians=I.south.radians,F.east.radians=I.east.radians+v.right.radians,F.west.radians=I.west.radians+v.right.radians,v.bounds.intersects(F)?(T.radians=v.right.radians,this._unshiftRight(),this._shiftRight(m,T),this._addLeafletOverlay(this._leafletRightLayer)):this._removeLeafletOverlay(this._leafletRightLayer),v.left.notEquals(v.right)?(F.east.radians=I.east.radians+v.left.radians,F.west.radians=I.west.radians+v.left.radians,v.bounds.intersects(F)?(T.radians=v.left.radians,this._unshiftLeft(),this._shiftLeft(m,T),this._addLeafletOverlay(this._leafletLeftLayer)):this._removeLeafletOverlay(this._leafletLeftLayer)):this._removeLeafletOverlay(this._leafletLeftLayer)},x.prototype._hideLeaflet=function(){this._removeLeafletOverlay(this._leafletLeftLayer),this._removeLeafletOverlay(this._leafletRightLayer)},x.prototype._detectLeafletOverlay=function(v){if(this._leafletLeftLayer!=null&&this._leafletLeftLayer.isAdded&&this._leafletLeftLayer._map!=null&&this._leafletLeftLayer.hasOwnProperty("_pxBounds")){var m=this._leafletLeftLayer._map._panes.mapPane._leaflet_pos,T=new(W()).Point(v.x-m.x,v.y-m.y);if(this._leafletLeftLayer._containsPoint(T))return!0}else if(this._leafletRightLayer!=null&&this._leafletRightLayer.isAdded&&this._leafletRightLayer._map!=null&&this._leafletRightLayer.hasOwnProperty("_pxBounds")){var m=this._leafletRightLayer._map._panes.mapPane._leaflet_pos,T=new(W()).Point(v.x-m.x,v.y-m.y);if(this._leafletRightLayer._containsPoint(T))return!0}return!1},x.prototype._addLeafletOverlay=function(v){if(!v.isAdded&&(this._layer._leafletLayer.addLayer(v),v.isAdded=!0,v.options.zIndex)){var m=v.getElement();m.style.zIndex=v.options.zIndex}},x.prototype._removeLeafletOverlay=function(v){v.isAdded&&(this._layer._leafletLayer.removeLayer(v),v.isAdded=!1)},x.prototype._shiftLeft=function(v,m){var T=this._leafletLeftShiftedGeoPoints||this._geoPoints;this._leafletLeftShiftedGeoPoints=(0,k.uY)(T,v,m),this._updateLeafletOverlay(this._leafletLeftLayer,this._leafletLeftShiftedGeoPoints)},x.prototype._shiftRight=function(v,m){var T=this._leafletRightShiftedGeoPoints||this._geoPoints;this._leafletRightShiftedGeoPoints=(0,k.uY)(T,v,m),this._updateLeafletOverlay(this._leafletRightLayer,this._leafletRightShiftedGeoPoints)},x.prototype._unshiftLeft=function(){this._leafletLeftShiftedGeoPoints=null,this._updateLeafletOverlay(this._leafletLeftLayer,this._geoPoints)},x.prototype._unshiftRight=function(){this._leafletRightShiftedGeoPoints=null,this._updateLeafletOverlay(this._leafletRightLayer,this._geoPoints)},x.prototype._loadMapbox=function(){},x.prototype._unloadMapbox=function(){},x.prototype._showMapbox=function(){this._mapboxGeoJSON.properties.zIndex=this._zIndex,this._layer._mapboxFeatures[this.id]=this._mapboxGeoJSON},x.prototype._hideMapbox=function(){delete this._layer._mapboxFeatures[this.id]},x.prototype._applyMapboxOpacity=function(){},x._iteration=0,x}()},61955:(ct,Ye,B)=>{"use strict";B.d(Ye,{Q:()=>k});var Q=B(66071),W=B(50042),h=B(70032),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(R,C){var x=A.call(this,C)||this;x._overlays=R,x._geoPoints=void 0;for(var v=0,m=R.length;v<m;v++){var T=R[v];T._group=x}return x}return z.prototype._getGeoPoints=function(){if(!this._geoPoints){for(var R=[],C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C],m=v.geoPoints;(0,Q.Oq)(m)?R=[].concat.apply([],m):R=R.concat(m)}this._geoPoints=R}return this._geoPoints},Object.defineProperty(z.prototype,"bounds",{get:function(){if(this._isBoundsDirty){this._bounds=new W.c;for(var R=0,C=this._overlays.length;R<C;R++){var x=this._overlays[R],v=x.bounds;this._bounds.expand(v.topLeftGeoPoint),this._bounds.expand(v.bottomRightGeoPoint)}}return this._bounds},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"overlays",{get:function(){return this._overlays},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"feature",{get:function(){return this._feature},set:function(R){this._feature=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.feature=R}},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"cluster",{get:function(){return this._cluster},set:function(R){this._cluster=R;for(var C=0,x=this._overlays.length;C<x;C++){var v=this._overlays[C];v.cluster=R}},enumerable:!0,configurable:!0}),z.prototype._updateLeafletOverlay=function(R,C){},z.prototype._addToLayer=function(R){this._layer=R;for(var C=this.overlays,x=0,v=C.length;x<v;x++){var m=C[x];m._addToLayer(R)}},z.prototype._removeFromlayer=function(R){if(this._layer===R){this._layer=void 0;for(var C=this.overlays,x=0,v=C.length;x<v;x++){var m=C[x];m._removeFromlayer(R)}}},z.prototype._loadLeaflet=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._loadLeaflet()}},z.prototype._unloadLeaflet=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._unloadLeaflet()}},z.prototype._showLeaflet=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._showLeaflet()}},z.prototype._hideLeaflet=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._hideLeaflet()}},z.prototype._loadMapbox=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._loadMapbox()}},z.prototype._unloadMapbox=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._unloadMapbox()}},z.prototype._showMapbox=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._showMapbox()}},z.prototype._hideMapbox=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._hideMapbox()}},z.prototype._applyMapboxOpacity=function(){for(var R=this.overlays,C=0,x=R.length;C<x;C++){var v=R[C];v._applyMapboxOpacity()}},z}(h.a)},14734:(ct,Ye,B)=>{"use strict";B.d(Ye,{t:()=>k});var Q=B(9654),W=B(50042),h=B(56448),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(R,C,x){var v=A.call(this,C,x)||this;return v.point=R,v}return Object.defineProperty(z.prototype,"bounds",{get:function(){var R=new W.c(this.point.latitude,this.point.longitude,this.point.latitude,this.point.longitude);return R},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"geoCenter",{get:function(){return this.point},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"point",{get:function(){return this._point},set:function(R){this._point=R},enumerable:!0,configurable:!0}),z.fromGeoJson=function(R){var C=R.geometry,x=C.coordinates[0],v=C.coordinates[1],m=Q.F.fromDegrees(v,x),T=R.properties,I=new z(m,T);return R.id?I.id=R.id:R.properties.id&&(I.id=R.properties.id),I},z}(h.L)},3660:(ct,Ye,B)=>{"use strict";B.d(Ye,{L:()=>A});var Q=B(9654),W=B(29227),h=B(24940),K=B(56448),k=function(){var z=function(R,C){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(x,v){x.__proto__=v}||function(x,v){for(var m in v)v.hasOwnProperty(m)&&(x[m]=v[m])},z(R,C)};return function(R,C){z(R,C);function x(){this.constructor=R}R.prototype=C===null?Object.create(C):(x.prototype=C.prototype,new x)}}(),A=function(z){k(R,z);function R(C,x,v){var m=z.call(this,x,v)||this;return m.polygon=C,m}return Object.defineProperty(R.prototype,"bounds",{get:function(){return this.polygon.bounds},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"geoCenter",{get:function(){var C=this.bounds;return C.centerPoint},enumerable:!0,configurable:!0}),Object.defineProperty(R.prototype,"polygon",{get:function(){return this._polygon},set:function(C){this._polygon=C},enumerable:!0,configurable:!0}),R.fromGeoJson=function(C){for(var x=C.properties,v=[],m=C.geometry,T=m.coordinates,I=T.length,F=0;F<I;F++){for(var q=T[F],re=q.length,ne=new W.A,se=0;se<re;se++){var X=q[se],ce=X[0],Me=X[1],Be=Q.F.fromDegrees(Me,ce);ne.add(Be)}v.push(ne)}var ot=new h.h;ot.polylines=v;var Ue=new R(ot,x);return C.id?Ue.id=C.id:C.properties.id&&(Ue.id=C.properties.id),Ue},R}(K.L)},81891:(ct,Ye,B)=>{"use strict";B.d(Ye,{V:()=>R,n:()=>C});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(96002),k=B(69011),A=B(70032),z=function(){var x=function(v,m){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,I){T.__proto__=I}||function(T,I){for(var F in I)I.hasOwnProperty(F)&&(T[F]=I[F])},x(v,m)};return function(v,m){x(v,m);function T(){this.constructor=v}v.prototype=m===null?Object.create(m):(T.prototype=m.prototype,new T)}}(),R=function(){function x(v){v===void 0&&(v={}),this.isNormalized=void 0,this.dashArray=void 0,this.enableFill=void 0,this.enableStroke=void 0,this.fillColor=void 0,this.fillOpacity=void 0,this.fillRule=void 0,this.lineCap=void 0,this.lineJoin=void 0,this.strokeColor=void 0,this.strokeOpacity=void 0,this.strokeWidth=void 0,this.isClipped=void 0,this.smoothFactor=void 0,(0,h.f0)(this,v)}return x}(),C=function(x){z(v,x);function v(m,T){for(var I=x.call(this,T)||this,F=[],q=0,re=m.polylines.length;q<re;q++){var ne=m.polylines[q];F.push(ne.points)}return T instanceof R||(T=new R(T)),I._isNormalized=T.isNormalized!==void 0?T.isNormalized:!1,I.geoPoints=F,I._options=T,I._dashArray=T.dashArray,I._enableFill=T.enableFill!==void 0?T.enableFill:!0,I._enableStroke=T.enableStroke!==void 0?T.enableStroke:!0,I._fillColor=T.fillColor||"rgba(0, 0, 255, 1)",I._fillOpacity=T.fillOpacity!==void 0?T.fillOpacity:.2,I._fillRule=T.fillRule,I._isClipped=T.isClipped!==void 0?T.isClipped:!0,I._lineCap=T.lineCap,I._lineJoin=T.lineJoin,I._smoothFactor=T.smoothFactor!==void 0?T.smoothFactor:1,I._strokeColor=T.strokeColor||"rgba(0, 0, 255, 1)",I._strokeOpacity=T.strokeOpacity!==void 0?T.strokeOpacity:1,I._strokeWidth=T.strokeWidth!==void 0?T.strokeWidth:1,I}return Object.defineProperty(v.prototype,"isNormalized",{get:function(){return this._isNormalized},set:function(m){if(this._isNormalized!==m&&((0,h.le)(m)&&(m=!1),this._isNormalized=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._setLeafletGeoPoints();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"dashArray",{get:function(){return this._dashArray},set:function(m){if(this._dashArray!==m&&((0,h.le)(m)&&(m=void 0),this._dashArray=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.dashArray=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"enableFill",{get:function(){return this._enableFill},set:function(m){if(this._enableFill!==m&&((0,h.le)(m)&&(m=!0),this._enableFill=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.fill=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxFillOpacity(this._fillOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"enableStroke",{get:function(){return this._enableStroke},set:function(m){if(this._enableStroke!==m&&((0,h.le)(m)&&(m=!0),this._enableStroke=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.stroke=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeOpacity(this._strokeOpacity),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fillColor",{get:function(){return this._fillColor},set:function(m){if(this._fillColor!==m&&((0,h.le)(m)&&(m="rgba(0, 0, 255, 1)"),this._fillColor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.fillColor=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxFillColor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fillOpacity",{get:function(){return this._fillOpacity},set:function(m){if(this._fillOpacity!==m&&((0,h.le)(m)&&(m=.2),this._fillOpacity=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.fillOpacity=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxFillOpacity(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fillRule",{get:function(){return this._fillRule},set:function(m){if(this._fillRule!==m&&((0,h.le)(m)&&(m=void 0),this._fillRule=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.fillRule=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"geoPoints",{get:function(){var m=this._getGeoPoints();return m},set:function(m){if(this._isBoundsDirty=!0,this.isNormalized)this._geoPoints=m;else{for(var T=[],I=0,F=m.length;I<F;I++){var q=m[I],re=(0,K.h8)(q);re?(this._crossesIdl=!0,T.push(re)):(T.push(q),this._crossesIdl=!1)}this._geoPoints=T}if(this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._setLeafletGeoPoints();break;case k.Renderer.WebGL:this._setMapboxGeoPoints(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isClipped",{get:function(){return this._isClipped},set:function(m){if(this._isClipped!==m&&((0,h.le)(m)&&(m=!0),this._isClipped=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.noClip=!m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lineCap",{get:function(){return this._lineCap},set:function(m){if(this._lineCap!==m&&((0,h.le)(m)&&(m=void 0),this._lineCap=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.lineCap=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(m){if(this._lineJoin!==m&&((0,h.le)(m)&&(m=void 0),this._lineJoin=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.lineJoin=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"smoothFactor",{get:function(){return this._smoothFactor},set:function(m){if(this._smoothFactor!==m&&((0,h.le)(m)&&(m=1),this._smoothFactor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.smoothFactor=this.smoothFactor,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(m){if(this._strokeColor!==m&&((0,h.le)(m)&&(m="rgba(0, 0, 255, 1)"),this._strokeColor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.color=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeColor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(m){if(this._strokeOpacity!==m&&((0,h.le)(m)&&(m=1),this._strokeOpacity=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.opacity=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeOpacity(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(m){if(this._strokeWidth!==m&&((0,h.le)(m)&&(m=1),this._strokeWidth=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.weight=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeWidth(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),v.prototype._intersectsGeoPolyline=function(m,T){if(T.contains(m.centerPoint)||T.contains(m.topLeftGeoPoint)||T.contains(m.topRightGeoPoint)||T.contains(m.bottomLeftGeoPoint)||T.contains(m.bottomRightGeoPoint))return!0},v.prototype._loadLeaflet=function(){this._leafletOptions=this._deriveLeafletOptions(),this._leafletLeftLayer=new(W()).Polygon([],this._leafletOptions),this._leafletRightLayer=new(W()).Polygon([],this._leafletOptions),x.prototype._loadLeaflet.call(this)},v.prototype._deriveLeafletOptions=function(){var m={};return(0,h.le)(this.smoothFactor)||(m.smoothFactor=this.smoothFactor),(0,h.le)(this.isClipped)?m.noClip=!0:m.noClip=!this.isClipped,(0,h.le)(this.enableStroke)||(m.stroke=this.enableStroke),(0,h.le)(this.strokeColor)||(m.color=this.strokeColor),(0,h.le)(this.strokeWidth)||(m.weight=this.strokeWidth),(0,h.le)(this.strokeOpacity)||(m.opacity=this.strokeOpacity),(0,h.le)(this.enableFill)||(m.fill=this.enableFill),(0,h.le)(this.fillColor)||(m.fillColor=this.fillColor),(0,h.le)(this.fillOpacity)||(m.fillOpacity=this.fillOpacity),(0,h.le)(this.lineJoin)||(m.lineJoin=this.lineJoin),(0,h.le)(this.dashArray)||(m.dashArray=this.dashArray),(0,h.le)(this.fillRule)||(m.fillRule=this.fillRule),m.pane=this._layer._leafletPolygonPane,m.renderer=this._layer._leafletPolygonRenderer,m},v.prototype._setLeafletStyle=function(m){this._leafletLeftLayer.setStyle(m),this._leafletRightLayer.setStyle(m)},v.prototype._setLeafletGeoPoints=function(){this._unshiftLeft(),this._unshiftRight()},v.prototype._updateLeafletOverlay=function(m,T){for(var I=[],F=0,q=T.length;F<q;F++){for(var re=T[F],ne=[],se=0,X=re.length;se<X;se++){var ce=re[se],Me=ce.toLeaflet();ne.push(Me)}I.push(ne)}m.setLatLngs(I)},v.prototype._loadMapbox=function(){this._mapboxGeoJSON={type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"PolygonPath"},geometry:{type:"Polygon",coordinates:[]}},this._setMapboxGeoPoints(this.geoPoints),this._setMapboxFillColor(this.fillColor),this._setMapboxFillOpacity(this.fillOpacity),this._setMapboxStrokeColor(this.strokeColor),this._setMapboxStrokeOpacity(this.strokeOpacity),this._setMapboxStrokeWidth(this.strokeWidth)},v.prototype._applyMapboxOpacity=function(){this._layer.map.renderer===k.Renderer.WebGL&&(this._setMapboxFillOpacity(this._fillOpacity),this._setMapboxStrokeOpacity(this._strokeOpacity))},v.prototype._setMapboxFillColor=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["fill-color"]=m)},v.prototype._setMapboxFillOpacity=function(m){if(!(0,h.le)(m)){var T=this._enableFill?m*this._layer.opacity:0;this._mapboxGeoJSON.properties["fill-opacity"]=T}},v.prototype._setMapboxStrokeColor=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["line-color"]=m)},v.prototype._setMapboxStrokeOpacity=function(m){if(!(0,h.le)(m)){var T=this._enableStroke?m*this._layer.opacity:0;this._mapboxGeoJSON.properties["line-opacity"]=T}},v.prototype._setMapboxStrokeWidth=function(m){if(!(0,h.le)(m)){var T=m>0?m:0;this._mapboxGeoJSON.properties["line-width"]=T}},v.prototype._setMapboxGeoPoints=function(m){var T=m.map(function(I){var F=I[0],q=I[I.length-1];return q.equals(F)||(I[I.length]=F),I.map(function(re){return[re.longitude.degrees,re.latitude.degrees]})});this._mapboxGeoJSON.geometry.coordinates=T},v}(A.a)},54071:(ct,Ye,B)=>{"use strict";B.d(Ye,{P:()=>k});var Q=B(9654),W=B(29227),h=B(56448),K=function(){var A=function(z,R){return A=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,x){C.__proto__=x}||function(C,x){for(var v in x)x.hasOwnProperty(v)&&(C[v]=x[v])},A(z,R)};return function(z,R){A(z,R);function C(){this.constructor=z}z.prototype=R===null?Object.create(R):(C.prototype=R.prototype,new C)}}(),k=function(A){K(z,A);function z(R,C,x){var v=A.call(this,C,x)||this;return v.polyline=R,v}return Object.defineProperty(z.prototype,"bounds",{get:function(){var R=this.polyline.bounds;return R},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"geoCenter",{get:function(){var R=this.bounds;return R.centerPoint},enumerable:!0,configurable:!0}),Object.defineProperty(z.prototype,"polyline",{get:function(){return this._polyline},set:function(R){this._polyline=R},enumerable:!0,configurable:!0}),z.fromGeoJson=function(R){for(var C=R.properties,x=new W.A,v=R.geometry.coordinates,m=v.length,T=0;T<m;T++){var I=v[T],F=I[0],q=I[1],re=Q.F.fromDegrees(q,F);x.add(re)}var ne=new z(x,C);return R.id?ne.id=R.id:R.properties.id&&(ne.id=R.properties.id),ne},z}(h.L)},51959:(ct,Ye,B)=>{"use strict";B.d(Ye,{C:()=>R,E:()=>C});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(96002),k=B(69011),A=B(70032),z=function(){var x=function(v,m){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,I){T.__proto__=I}||function(T,I){for(var F in I)I.hasOwnProperty(F)&&(T[F]=I[F])},x(v,m)};return function(v,m){x(v,m);function T(){this.constructor=v}v.prototype=m===null?Object.create(m):(T.prototype=m.prototype,new T)}}(),R=function(){function x(v){v===void 0&&(v={}),this.isNormalized=void 0,this.dashArray=void 0,this.lineJoin=void 0,this.lineCap=void 0,this.strokeColor=void 0,this.strokeOpacity=void 0,this.strokeWidth=void 0,this.isClipped=void 0,this.smoothFactor=void 0,(0,h.f0)(this,v)}return x}(),C=function(x){z(v,x);function v(m,T){var I=x.call(this,T)||this;return I._isListening=!1,T instanceof R||(T=new R(T)),I._isNormalized=T.isNormalized!==void 0?T.isNormalized:!1,I.geoPoints=m.points,I._options=T,I._dashArray=T.dashArray,I._isClipped=T.isClipped!==void 0?T.isClipped:!0,I._smoothFactor=T.smoothFactor!==void 0?T.smoothFactor:1,I._strokeColor=T.strokeColor!==void 0?T.strokeColor:"rgba(0, 0, 255, 1)",I._strokeOpacity=T.strokeOpacity!==void 0?T.strokeOpacity:1,I._strokeWidth=T.strokeWidth!==void 0?T.strokeWidth:1,I._lineCap=T.lineCap,I._lineJoin=T.lineJoin,I}return Object.defineProperty(v.prototype,"isNormalized",{get:function(){return this._isNormalized},set:function(m){if(this._isNormalized!==m&&((0,h.le)(m)&&(m=!1),this._isNormalized=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._setLeafletGeoPoints();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"dashArray",{get:function(){return this._dashArray},set:function(m){if(this._dashArray!==m&&((0,h.le)(m)&&(m=void 0),this._dashArray=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.dashArray=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"geoPoints",{get:function(){var m=this._getGeoPoints();return m},set:function(m){if(this._isBoundsDirty=!0,m.length>1&&!this.isNormalized){var T=(0,K.h8)(m);T?(this._crossesIdl=!0,this._geoPoints=T):(this._geoPoints=m,this._crossesIdl=!1)}if(this._layer)switch(this._layer.map._renderer){case k.Renderer.WebDOM:this._setLeafletGeoPoints();break;case k.Renderer.WebGL:this._setMapboxGeoPoints(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isClipped",{get:function(){return this._isClipped},set:function(m){if(this._isClipped!==m&&((0,h.le)(m)&&(m=!0),this._isClipped=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.noClip=!m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lineCap",{get:function(){return this._lineCap},set:function(m){if(this._lineCap!==m&&((0,h.le)(m)&&(m=void 0),this._lineCap=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.lineCap=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(m){if(this._lineJoin!==m&&((0,h.le)(m)&&(m=void 0),this._lineJoin=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.lineJoin=m,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"smoothFactor",{get:function(){return this._smoothFactor},set:function(m){if(this._smoothFactor!==m&&((0,h.le)(m)&&(m=1),this._smoothFactor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.smoothFactor=this.smoothFactor,this._setLeafletStyle(this._leafletOptions);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(m){if(this._strokeColor!==m&&((0,h.le)(m)&&(m="rgba(255, 255, 255, 1)"),this._strokeColor=m,this._layer))switch(this._layer.map._renderer){case k.Renderer.WebDOM:this._leafletOptions.color=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeColor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeOpacity",{get:function(){return this._strokeOpacity},set:function(m){if(this._strokeOpacity!==m&&((0,h.le)(m)&&(m=1),this._strokeOpacity=m,this._layer))switch(this._layer.map._renderer){case k.Renderer.WebDOM:this._leafletOptions.opacity=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeOpacity(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(m){if(this._strokeWidth!==m&&((0,h.le)(m)&&(m=1),this._strokeWidth=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._leafletOptions.weight=m,this._setLeafletStyle(this._leafletOptions);break;case k.Renderer.WebGL:this._setMapboxStrokeWidth(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),v.prototype._loadLeaflet=function(){var m=this._leafletOptions=this._deriveLeafletOptions();this._leafletLeftLayer=new(W()).Polyline([],m),this._leafletRightLayer=new(W()).Polyline([],m),x.prototype._loadLeaflet.call(this)},v.prototype._deriveLeafletOptions=function(){var m={};return m.fill=!1,(0,h.le)(this.smoothFactor)||(m.smoothFactor=this.smoothFactor),(0,h.le)(this.isClipped)?m.noClip=!0:m.noClip=!this.isClipped,(0,h.le)(this.strokeColor)||(m.color=this.strokeColor),(0,h.le)(this.strokeWidth)||(m.weight=this.strokeWidth),(0,h.le)(this.strokeOpacity)||(m.opacity=this.strokeOpacity),(0,h.le)(this.lineCap)||(m.lineCap=this.lineCap),(0,h.le)(this.lineJoin)||(m.lineJoin=this.lineJoin),(0,h.le)(this.dashArray)||(m.dashArray=this.dashArray),m.pane=this._layer._leafletPolylinePane,m.renderer=this._layer._leafletPolylineRenderer,m},v.prototype._setLeafletStyle=function(m){this._leafletLeftLayer.setStyle(m),this._leafletRightLayer.setStyle(m)},v.prototype._setLeafletGeoPoints=function(){this._unshiftLeft(),this._unshiftRight()},v.prototype._updateLeafletOverlay=function(m,T){for(var I=[],F=0,q=T.length;F<q;F++){var re=T[F],ne=re.toLeaflet();I.push(ne)}m.setLatLngs(I)},v.prototype._loadMapbox=function(){var m=this;if(this._mapboxGeoJSON={type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"PolylinePath"},geometry:{type:"LineString",coordinates:[]}},this._linePattern){var T=this._layer.map,I=T._images[this._linePattern];I?this._setMapboxAttributes():(this._isListening=!0,T.imageAdded.addListener(this._onImageAdded,this),T._images[this._linePattern]=h.jd.Loading,T.loadImage(this._linePattern,function(F,q){!F&&m._layer&&T.addImage(m._linePattern,q)}))}else this._setMapboxAttributes()},v.prototype._applyMapboxOpacity=function(){this._layer.map._renderer===k.Renderer.WebGL&&this._setMapboxStrokeOpacity(this._strokeOpacity)},v.prototype._setMapboxStrokeColor=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["line-color"]=m)},v.prototype._setMapboxStrokeOpacity=function(m){if(!(0,h.le)(m)){var T=m*this._layer.opacity;this._mapboxGeoJSON.properties["line-opacity"]=T}},v.prototype._setMapboxStrokeWidth=function(m){if(!(0,h.le)(m)){var T=m>0?m:0;this._mapboxGeoJSON.properties["line-width"]=T}},v.prototype._setMapboxGeoPoints=function(m){for(var T=[],I=0,F=m.length;I<F;I++){var q=m[I].longitude.degrees,re=m[I].latitude.degrees;T.push([q,re])}this._mapboxGeoJSON.geometry.coordinates=T},v.prototype._setMapboxLinePattern=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["line-pattern"]=m)},v.prototype._setMapboxAttributes=function(){this._setMapboxGeoPoints(this.geoPoints),this._setMapboxStrokeColor(this.strokeColor),this._setMapboxStrokeOpacity(this.strokeOpacity),this._setMapboxStrokeWidth(this.strokeWidth)},v.prototype._onImageAdded=function(m){if(m.name===this._linePattern&&this._layer){var T=this._layer;this._setMapboxAttributes(),T._updateMapboxData();var I=T.map;I.imageAdded.removeListener(this._onImageAdded,this),this._isListening=!1}},v}(A.a)},40355:(ct,Ye,B)=>{"use strict";B.d(Ye,{u:()=>R,N:()=>C});var Q=B(96302),W=B.n(Q),h=B(66071),K=B(93126),k=B(69011),A=B(70032),z=function(){var x=function(v,m){return x=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,I){T.__proto__=I}||function(T,I){for(var F in I)I.hasOwnProperty(F)&&(T[F]=I[F])},x(v,m)};return function(v,m){x(v,m);function T(){this.constructor=v}v.prototype=m===null?Object.create(m):(T.prototype=m.prototype,new T)}}(),R=function(){function x(v){v===void 0&&(v={}),this.offset=void 0,this.anchor=void 0,this.alignment=void 0,this.className=void 0,this.fontColor=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.fontWeight=void 0,this.fontStyle=void 0,this.letterSpacing=void 0,this.lineHeight=void 0,this.maxWidth=void 0,this.opacity=void 0,this.strokeColor=void 0,this.strokeWidth=void 0,this.size=void 0,this.rotation=void 0,(0,h.f0)(this,v)}return x}(),C=function(x){z(v,x);function v(m,T,I){var F=x.call(this,I)||this;return I instanceof R||(I=new R(I)),F._offset=I.offset!==void 0?I.offset:new K.E(0,0),F._anchor=I.anchor!==void 0?I.anchor:h.ee.Center,F._alignment=I.alignment||h.v2.Left,F._geoPoints[0]=m,F._geoCenter=m,F._className=I.className,F._fontFamily=I.fontFamily,F._fontSize=I.fontSize!==void 0?I.fontSize:12,F._fontColor=I.fontColor,F._fontWeight=I.fontWeight!=null?I.fontWeight.toLowerCase():"normal",F._fontStyle=I.fontStyle!==void 0?I.fontStyle.toLowerCase():"normal",F._letterSpacing=I.letterSpacing,F._lineHeight=I.lineHeight,F._maxWidth=I.maxWidth!==void 0?I.maxWidth:150,F._strokeColor=I.strokeColor,F._strokeWidth=I.strokeWidth,F._opacity=I.opacity!==void 0?I.opacity:1,F._text=T,F._rotation=I.rotation!==void 0?I.rotation:0,F._size=I.size,F}return Object.defineProperty(v.prototype,"anchor",{get:function(){return this._anchor},set:function(m){if(m!==this._anchor&&(this._anchor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxAnchor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"alignment",{get:function(){return this._alignment},set:function(m){if(m!==this._alignment&&((0,h.le)(m)&&(m=void 0),this._alignment=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxAlignment(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"className",{get:function(){return this._className},set:function(m){if(this._className!==m&&((0,h.le)(m)&&(m=void 0),this._className=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fontColor",{get:function(){return this._fontColor},set:function(m){if(this._fontColor!==m&&((0,h.le)(m)&&(m=void 0),this._fontColor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontColor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(m){if(this._fontFamily!==m&&((0,h.le)(m)&&(m=void 0),this._fontFamily=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontName(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fontSize",{get:function(){return this._fontSize},set:function(m){if(this._fontSize!==m&&((0,h.le)(m)&&(m=12),this._fontSize=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxMaxWidth(this._maxWidth),this._setMapboxFontSize(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fontWeight",{get:function(){return this._fontWeight.toLowerCase()},set:function(m){if((0,h.le)(m)?m="normal":this._fontWeight=m.toLowerCase(),this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontName(this._fontFamily,this._fontWeight,this._fontStyle),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"fontStyle",{get:function(){return this._fontStyle.toLowerCase()},set:function(m){if((0,h.le)(m)?m="normal":this._fontStyle=m.toLowerCase(),this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontName(this._fontFamily,this._fontWeight,this._fontStyle),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"geoCenter",{get:function(){return this._geoCenter},set:function(m){if(!this._geoCenter.equals(m)){if((0,h.le)(m))throw new Error("Value is required");if(this._geoCenter=m,this._geoPoints[0]=m,this._isBoundsDirty=!0,this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:this._setLeafletGeoCenter();break;case k.Renderer.WebGL:this._setMapboxGeoCenter(m),this._layer._updateMapboxData();break}}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isBold",{get:function(){switch(this._fontWeight){case"bold":case"600":case"700":case"800":case"900":return!0;default:return!1}},set:function(m){if((0,h.le)(m)&&(m=void 0),this._fontWeight=m?"bold":"normal",this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontName(this._fontFamily,this._fontWeight,this._fontStyle),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"isItalic",{get:function(){var m=this._fontStyle==="italic";return m},set:function(m){if((0,h.le)(m)&&(m=void 0),this._fontStyle=m?"italic":"normal",this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxFontName(this._fontFamily,this._fontWeight,this._fontStyle),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(m){if(this._letterSpacing!==m&&((0,h.le)(m)&&(m=void 0),this._letterSpacing=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxLetterSpacing(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(m){if(this._lineHeight!==m&&((0,h.le)(m)&&(m=void 0),this._lineHeight=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxLineHeight(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"maxWidth",{get:function(){return this._maxWidth},set:function(m){if(this._maxWidth!==m)switch((0,h.le)(m)&&(m=void 0),this._maxWidth=m,this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxMaxWidth(m),this._setMapboxFontSize(this._fontSize),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"opacity",{get:function(){return this._opacity},set:function(m){if(this._opacity!==m&&((0,h.le)(m)&&(m=1),this._opacity=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxOpacity(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"offset",{get:function(){return this._offset},set:function(m){if(m.toString()!==this._offset.toString()&&((0,h.le)(m)&&(m=void 0),this._offset=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxOffset(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"rotation",{get:function(){return this._rotation},set:function(m){if(m!==this._rotation&&((0,h.le)(m)&&(m=void 0),this._rotation=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxRotation(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeColor",{get:function(){return this._strokeColor},set:function(m){if(this._strokeColor!==m&&((0,h.le)(m)&&(m=void 0),this._strokeColor=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebGL:this._setMapboxStrokeColor(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"strokeWidth",{get:function(){return this._strokeWidth},set:function(m){if(this._strokeWidth!==m&&((0,h.le)(m)&&(m=void 0),this._strokeWidth=m,this._layer))switch(this._layer.map.renderer){case k.Renderer.WebGL:this._setMapboxStrokeWidth(m),this._layer._updateMapboxData();break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"size",{get:function(){return this._size},set:function(m){if(this._size!==m&&((0,h.le)(m)&&(m=void 0),this._size=m,this._layer))switch(this._layer.map._engineType){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break}},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"text",{get:function(){return this._text},set:function(m){if(this._text!==m){if((0,h.le)(m))throw new Error("Value is required");if(this._text=m,this._layer)switch(this._layer.map.renderer){case k.Renderer.WebDOM:var T=this._deriveLeafletIcon();this._setLeafletIcon(T);break;case k.Renderer.WebGL:this._setMapboxText(m),this._layer._updateMapboxData();break}}},enumerable:!0,configurable:!0}),v.prototype._calculateTextWidth=function(){var m=this._fontWeight+" "+this._fontSize+"px "+this._fontFamily,T=v._textWidthCanvasCtx;T.font=m;var I=T.measureText(this._text);return I.width},v.prototype._detectLeafletOverlay=function(m){var T=null,I=!1;if(!(0,h.le)(this._leafletLeftLayer)&&this._leafletLeftLayer._map?T=this._leafletLeftLayer:!(0,h.le)(this._leafletRightLayer)&&this._leafletRightLayer._map&&(T=this._leafletRightLayer),!(0,h.le)(T)){var F=T._map._mapPane,q=T.getElement(),re=window.getComputedStyle(q.firstChild.firstChild),ne=parseInt(re.getPropertyValue("width"),10),se=parseInt(re.getPropertyValue("height"),10),X=this.offset,ce={x:0,y:0};switch(this.anchor){case h.ee.TopLeft:ce.x=0,ce.y=0;break;case h.ee.Top:ce.x=-(ne/2),ce.y=0;break;case h.ee.TopRight:ce.x=-ne,ce.y=0;break;case h.ee.Right:ce.x=-ne,ce.y=-(se/2);break;case h.ee.BottomRight:ce.x=-ne,ce.y=-se;break;case h.ee.Bottom:ce.x=-(ne/2),ce.y=-se;break;case h.ee.BottomLeft:ce.x=0,ce.y=-se;break;case h.ee.Left:ce.x=0,ce.y=-(se/2);break;case h.ee.Center:ce.x=-(ne/2),ce.y=-(se/2);break}var Me=parseInt(q.style.marginLeft,10)||0,Be=parseInt(q.style.marginTop,10)||0,ot=q._leaflet_pos.y+Be+F._leaflet_pos.y+X.y+ce.y,Ue=ot+se,ht=q._leaflet_pos.x-Me+F._leaflet_pos.x+X.x+ce.x,Et=ht+ne;I=m.x>=ht&&m.x<=Et&&m.y>=ot&&m.y<=Ue}return I},v.prototype._loadLeaflet=function(){var m=this._geoCenter.toLeaflet(),T=this._deriveLeafletOptions();this._leafletLeftLayer=new(W()).Marker(m,T),this._leafletRightLayer=new(W()).Marker(m,T),this._fontFamily||(this._fontFamily="Times New Roman"),x.prototype._loadLeaflet.call(this)},v.prototype._showLeaflet=function(){this._setLeafletOpacity(this._opacity),x.prototype._showLeaflet.call(this)},v.prototype._setLeafletGeoCenter=function(){this._unshiftLeft(),this._unshiftRight()},v.prototype._deriveLeafletIcon=function(){var m={};(0,h.le)(this._className)||(m.className=this._className);var T;switch(this._alignment){case h.v2.Center:T="center";break;case h.v2.Right:T="right";break;case h.v2.Left:default:T="left";break}var I;switch(this._anchor){case h.ee.TopLeft:I="0%, 0%";break;case h.ee.Top:I="-50%, 0%";break;case h.ee.TopRight:I="-100%, 0%";break;case h.ee.Right:I="-100%, -50%";break;case h.ee.BottomRight:I="-100%, -100%";break;case h.ee.Bottom:I="-50%, -100%";break;case h.ee.BottomLeft:I="0, -100%";break;case h.ee.Left:I="0, -50%";break;case h.ee.Center:default:I="-50%, -50%";break}var F=this._text.replace(/([\r\n])/g,"<br/>"),q=this._calculateTextWidth(),re="<div style='border:none;background:none;padding:0;margin:0;white-space:nowrap;";re+="max-width:"+(this.maxWidth!==void 0?this.maxWidth+"px":"inherit")+";",re+="-webkit-text-stroke-color:"+(this._strokeColor||"inherit")+";",re+="-webkit-text-stroke-width:"+(this._strokeWidth+"px"||0)+";",re+="opacity:"+this._opacity+";",re+="color:"+(this._fontColor||"inherit")+";",re+="text-align:"+T+";",re+='font-family:"'+(this._fontFamily||"inherit")+'";',re+="font-size:"+(this._fontSize?this._fontSize+"px":"inherit")+";",re+="font-weight:"+this._fontWeight+";",re+="font-style:"+this._fontStyle+";",re+="letter-spacing:"+(this._letterSpacing?this._letterSpacing+"em":"inherit")+";",re+="line-height:"+(this._lineHeight||"inherit")+";",re+="transform-origin:"+this._offset.x*-1+"px "+this._offset.y*-1+"px;",re+="transform:translate3d("+this._offset.x+"px, "+this._offset.y+"px, 0) rotate("+this._rotation+"deg);",re+="'><div style='width:"+Math.ceil(q)+"px;overflow:hidden;transform-origin:0% 0%;transform:translate("+I+");",re+="max-width:"+(this.maxWidth!==void 0?this.maxWidth+"px":"inherit")+";'>"+F+"</div></div>",m.html=re,m.iconSize=[0,0];var ne=new(W()).DivIcon(m);return ne},v.prototype._deriveLeafletOptions=function(){var m={};return m.pane=this._layer._leafletTextPane,m.renderer=this._layer._leafletTextRenderer,m.icon=this._deriveLeafletIcon(),m},v.prototype._setLeafletIcon=function(m){this._leafletLeftLayer.setIcon(m),this._leafletRightLayer.setIcon(m)},v.prototype._setLeafletOpacity=function(m){this._leafletLeftLayer.setOpacity(m),this._leafletRightLayer.setOpacity(m)},v.prototype._updateLeafletOverlay=function(m,T){var I=T[0].toLeaflet();m.setLatLng(I)},v.prototype._loadMapbox=function(){this._mapboxGeoJSON={type:"Feature",properties:{id:this._id,layerId:this._layer.id,type:"TextMarker"},geometry:{type:"Point",coordinates:[]}},this._fontFamily||(this._fontFamily="Open Sans"),this._setMapboxAnchor(this.anchor),this._setMapboxGeoCenter(this.geoCenter),this._setMapboxText(this.text),this._setMapboxFontColor(this.fontColor),this._setMapboxFontName(this.fontFamily,this.fontWeight,this.fontStyle),this._setMapboxFontSize(this.fontSize),this._setMapboxLetterSpacing(this.letterSpacing),this._setMapboxLineHeight(this.lineHeight),this._setMapboxMaxWidth(this.maxWidth),this._setMapboxOpacity(this.opacity),this._setMapboxStrokeColor(this.strokeColor),this._setMapboxStrokeWidth(this.strokeWidth),this._setMapboxOffset(this.offset),this._setMapboxAlignment(this.alignment),this._setMapboxRotation(this.rotation)},v.prototype._applyOpacity=function(){this._layer.map.renderer===k.Renderer.WebGL&&this._setMapboxOpacity(this._opacity)},v.prototype._setMapboxAnchor=function(m){if(!(0,h.le)(m)){var T="center";switch(m){case h.ee.TopLeft:T="top-left";break;case h.ee.Top:T="top";break;case h.ee.TopRight:T="top-right";break;case h.ee.Right:T="right";break;case h.ee.BottomRight:T="bottom-right";break;case h.ee.Bottom:T="bottom";break;case h.ee.BottomLeft:T="bottom-left";break;case h.ee.Left:T="left";break}this._mapboxGeoJSON.properties["text-anchor"]=T}},v.prototype._setMapboxFontColor=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-color"]=m)},v.prototype._setMapboxFontName=function(m,T,I){if(T===void 0&&(T="normal"),I===void 0&&(I="normal"),!(0,h.le)(m)){var F=[m,T,I].join(" ");this._mapboxGeoJSON.properties["text-font"]=F}},v.prototype._setMapboxFontSize=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-size"]=m)},v.prototype._setMapboxLetterSpacing=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-letter-spacing"]=m)},v.prototype._setMapboxLineHeight=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-line-height"]=m)},v.prototype._setMapboxMaxWidth=function(m){if(!(0,h.le)(m)){var T=m/this.fontSize;this._mapboxGeoJSON.properties["text-max-width"]=T}},v.prototype._setMapboxOpacity=function(m){if(!(0,h.le)(m)){var T=m*this._layer.opacity;this._mapboxGeoJSON.properties["text-opacity"]=T}},v.prototype._setMapboxStrokeColor=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-halo-color"]=m)},v.prototype._setMapboxStrokeWidth=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-halo-width"]=m)},v.prototype._setMapboxText=function(m){this._mapboxGeoJSON.properties["text-field"]=m},v.prototype._setMapboxGeoCenter=function(m){var T=m.longitude.degrees,I=m.latitude.degrees;this._mapboxGeoJSON.geometry.coordinates=[T,I]},v.prototype._setMapboxOffset=function(m){var T=m||new K.E(0,0),I=this._calculateMapboxOffset(T);this._mapboxGeoJSON.properties["text-offset"]=I},v.prototype._setMapboxAlignment=function(m){if(!(0,h.le)(m)){var T;switch(m){case h.v2.Center:T="center";break;case h.v2.Right:T="right";break;case h.v2.Left:default:T="left";break}this._mapboxGeoJSON.properties["text-justify"]=T}},v.prototype._setMapboxRotation=function(m){(0,h.le)(m)||(this._mapboxGeoJSON.properties["text-rotate"]=m)},v.prototype._unloadMapbox=function(){x.prototype._unloadMapbox.call(this)},v.prototype._calculateMapboxOffset=function(m){var T=this._fontSize,I=new K.E(m.x,m.y),F=I.x/T,q=I.y/T,re=[F,q];return re},v.prototype._applyMapboxOpacity=function(){this._layer.map.renderer===k.Renderer.WebGL&&this._setMapboxOpacity(this._layer.opacity)},v._ctor=function(){v._textWidthCanvasCtx=document.createElement("canvas").getContext("2d")}(),v}(A.a)},44427:(ct,Ye,B)=>{"use strict";B.d(Ye,{x:()=>x,p:()=>m});var Q=B(59687),W=B(14734),h=B(54071),K=B(3660),k=B(14740),A=B(81797),z=B(86330),R=null,C=null;function x(T){for(var I=[],F=T.features,q=F.length,re=0;re<q;re++){var ne=F[re],se=v(ne);se!=null&&I.push(se)}return I}function v(T){var I,F=T.geometry;switch(F.type.toLowerCase()){case"point":I=W.t.fromGeoJson(T);break;case"linestring":I=h.P.fromGeoJson(T);break;case"polygon":I=K.L.fromGeoJson(T);break;case"multipoint":I=k.f.fromGeoJson(T);break;case"multilinestring":I=A.m.fromGeoJson(T);break;case"multipolygon":I=z.f.fromGeoJson(T);break;default:return null}var q=I.properties.vt||I.properties.validTime;if(q){var re=typeof q=="string"?parseInt(q):q,ne=new Date(re);I.validTime=new Q.T(ne)}return I.source=T,I}function m(T){var I;typeof T=="string"?I=JSON.parse(T):I=T;var F=x(I);return F}},72779:(ct,Ye)=>{var B,Q;/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/(function(){"use strict";var W={}.hasOwnProperty;function h(){for(var K=[],k=0;k<arguments.length;k++){var A=arguments[k];if(!!A){var z=typeof A;if(z==="string"||z==="number")K.push(A);else if(Array.isArray(A)&&A.length){var R=h.apply(null,A);R&&K.push(R)}else if(z==="object")for(var C in A)W.call(A,C)&&A[C]&&K.push(C)}}return K.join(" ")}ct.exports?(h.default=h,ct.exports=h):(B=[],Q=function(){return h}.apply(Ye,B),Q!==void 0&&(ct.exports=Q))})()},82609:ct=>{"use strict";ct.exports=function(Ye){var B=[];return B.toString=function(){return this.map(function(W){var h=Ye(W);return W[2]?"@media ".concat(W[2]," {").concat(h,"}"):h}).join("")},B.i=function(Q,W,h){typeof Q=="string"&&(Q=[[null,Q,""]]);var K={};if(h)for(var k=0;k<this.length;k++){var A=this[k][0];A!=null&&(K[A]=!0)}for(var z=0;z<Q.length;z++){var R=[].concat(Q[z]);h&&K[R[0]]||(W&&(R[2]?R[2]="".concat(W," and ").concat(R[2]):R[2]=W),B.push(R))}},B}},71177:ct=>{"use strict";/*! Isomorphic Style Loader | MIT License | https://github.com/kriasoft/isomorphic-style-loader */var Ye={};function B(h){return btoa(encodeURIComponent(h).replace(/%([0-9A-F]{2})/g,function(K,k){return String.fromCharCode("0x"+k)}))}function Q(h){h.forEach(function(K){if(--Ye[K]<=0){var k=document.getElementById(K);k&&k.parentNode.removeChild(k)}})}function W(h,K){for(var k=K===void 0?{}:K,A=k.replace,z=A===void 0?!1:A,R=k.prepend,C=R===void 0?!1:R,x=k.prefix,v=x===void 0?"s":x,m=[],T=0;T<h.length;T++){var I=h[T],F=I[0],q=I[1],re=I[2],ne=I[3],se=""+v+F+"-"+T;if(m.push(se),Ye[se]&&!z){Ye[se]++;continue}Ye[se]=1;var X=document.getElementById(se),ce=!1;X||(ce=!0,X=document.createElement("style"),X.setAttribute("type","text/css"),X.id=se,re&&X.setAttribute("media",re));var Me=q;ne&&typeof btoa=="function"&&(Me+=`
/*# sourceMappingURL=data:application/json;base64,`+B(JSON.stringify(ne))+"*/",Me+=`
/*# sourceURL=`+ne.file+"?"+se+"*/"),"textContent"in X?X.textContent=Me:X.styleSheet.cssText=Me,ce&&(C?document.head.insertBefore(X,document.head.childNodes[0]):document.head.appendChild(X))}return Q.bind(null,m)}ct.exports=W},6110:(ct,Ye,B)=>{"use strict";/*! Isomorphic Style Loader | MIT License | https://github.com/kriasoft/isomorphic-style-loader */var Q=B(2784),W=B(73463),h=B(96616);function K(A,z){A.prototype=Object.create(z.prototype),A.prototype.constructor=A,A.__proto__=z}function k(){for(var A=arguments.length,z=new Array(A),R=0;R<A;R++)z[R]=arguments[R];return function(x){var v=function(T){K(I,T);function I(q,re){var ne;return ne=T.call(this,q,re)||this,ne.removeCss=re.insertCss.apply(re,z),ne}var F=I.prototype;return F.componentWillUnmount=function(){this.removeCss&&setTimeout(this.removeCss,0)},F.render=function(){return Q.createElement(x,this.props)},I}(Q.PureComponent),m=x.displayName||x.name||"Component";return v.displayName="WithStyles("+m+")",v.contextType=h,v.ComposedComponent=x,W(v,x)}}ct.exports=k},81207:ct=>{function Ye(B,Q,W,h){var K=-1,k=B==null?0:B.length;for(h&&k&&(W=B[++K]);++K<k;)W=Q(W,B[K],K,B);return W}ct.exports=Ye},60091:(ct,Ye,B)=>{var Q=B(13940),W=B(41225),h=Object.prototype,K=h.hasOwnProperty;function k(A,z,R){var C=A[z];(!(K.call(A,z)&&W(C,R))||R===void 0&&!(z in A))&&Q(A,z,R)}ct.exports=k},13940:(ct,Ye,B)=>{var Q=B(83043);function W(h,K,k){K=="__proto__"&&Q?Q(h,K,{configurable:!0,enumerable:!0,value:k,writable:!0}):h[K]=k}ct.exports=W},24303:(ct,Ye,B)=>{var Q=B(26548),W=B(92019),h=W(Q);ct.exports=h},15308:(ct,Ye,B)=>{var Q=B(55463),W=Q();ct.exports=W},26548:(ct,Ye,B)=>{var Q=B(15308),W=B(90249);function h(K,k){return K&&Q(K,k,W)}ct.exports=h},20187:ct=>{function Ye(B,Q){return B!=null&&Q in Object(B)}ct.exports=Ye},88656:(ct,Ye,B)=>{var Q=B(26548);function W(h,K,k,A){return Q(h,function(z,R,C){K(A,k(z),R,C)}),A}ct.exports=W},37036:(ct,Ye,B)=>{var Q=B(86571),W=B(88746),h=1,K=2;function k(A,z,R,C){var x=R.length,v=x,m=!C;if(A==null)return!v;for(A=Object(A);x--;){var T=R[x];if(m&&T[2]?T[1]!==A[T[0]]:!(T[0]in A))return!1}for(;++x<v;){T=R[x];var I=T[0],F=A[I],q=T[1];if(m&&T[2]){if(F===void 0&&!(I in A))return!1}else{var re=new Q;if(C)var ne=C(F,q,I,A,z,re);if(!(ne===void 0?W(q,F,h|K,C,re):ne))return!1}}return!0}ct.exports=k},68286:(ct,Ye,B)=>{var Q=B(26423),W=B(74716),h=B(23059),K=B(86152),k=B(65798);function A(z){return typeof z=="function"?z:z==null?h:typeof z=="object"?K(z)?W(z[0],z[1]):Q(z):k(z)}ct.exports=A},26423:(ct,Ye,B)=>{var Q=B(37036),W=B(49882),h=B(73477);function K(k){var A=W(k);return A.length==1&&A[0][2]?h(A[0][0],A[0][1]):function(z){return z===k||Q(z,k,A)}}ct.exports=K},74716:(ct,Ye,B)=>{var Q=B(88746),W=B(72579),h=B(95041),K=B(21401),k=B(28792),A=B(73477),z=B(33812),R=1,C=2;function x(v,m){return K(v)&&k(m)?A(z(v),m):function(T){var I=W(T,v);return I===void 0&&I===m?h(T,v):Q(m,I,R|C)}}ct.exports=x},20256:ct=>{function Ye(B){return function(Q){return Q==null?void 0:Q[B]}}ct.exports=Ye},82952:(ct,Ye,B)=>{var Q=B(13324);function W(h){return function(K){return Q(K,h)}}ct.exports=W},5877:ct=>{function Ye(B,Q,W,h,K){return K(B,function(k,A,z){W=h?(h=!1,k):Q(W,k,A,z)}),W}ct.exports=Ye},39872:ct=>{function Ye(B,Q,W){var h=-1,K=B.length;Q<0&&(Q=-Q>K?0:K+Q),W=W>K?K:W,W<0&&(W+=K),K=Q>W?0:W-Q>>>0,Q>>>=0;for(var k=Array(K);++h<K;)k[h]=B[h+Q];return k}ct.exports=Ye},51704:(ct,Ye,B)=>{var Q=B(52153),W=/^\s+/;function h(K){return K&&K.slice(0,Q(K)+1).replace(W,"")}ct.exports=h},29078:(ct,Ye,B)=>{var Q=B(17297),W=B(56974),h=B(62721),K=B(33812);function k(A,z){return z=Q(z,A),A=h(A,z),A==null||delete A[K(W(z))]}ct.exports=k},92019:(ct,Ye,B)=>{var Q=B(67878);function W(h,K){return function(k,A){if(k==null)return k;if(!Q(k))return h(k,A);for(var z=k.length,R=K?z:-1,C=Object(k);(K?R--:++R<z)&&A(C[R],R,C)!==!1;);return k}}ct.exports=W},55463:ct=>{function Ye(B){return function(Q,W,h){for(var K=-1,k=Object(Q),A=h(Q),z=A.length;z--;){var R=A[B?z:++K];if(W(k[R],R,k)===!1)break}return Q}}ct.exports=Ye},98776:(ct,Ye,B)=>{var Q=B(68286),W=B(67878),h=B(90249);function K(k){return function(A,z,R){var C=Object(A);if(!W(A)){var x=Q(z,3);A=h(A),z=function(m){return x(C[m],m,C)}}var v=k(A,z,R);return v>-1?C[x?A[v]:v]:void 0}}ct.exports=K},40933:(ct,Ye,B)=>{var Q=B(88656);function W(h,K){return function(k,A){return Q(k,h,K(A),{})}}ct.exports=W},52672:(ct,Ye,B)=>{var Q=B(97030);function W(h){return Q(h)?void 0:h}ct.exports=W},29097:(ct,Ye,B)=>{var Q=B(35676),W=B(43114),h=B(75251);function K(k){return h(W(k,void 0,Q),k+"")}ct.exports=K},49882:(ct,Ye,B)=>{var Q=B(28792),W=B(90249);function h(K){for(var k=W(K),A=k.length;A--;){var z=k[A],R=K[z];k[A]=[z,R,Q(R)]}return k}ct.exports=h},1369:(ct,Ye,B)=>{var Q=B(17297),W=B(79631),h=B(86152),K=B(39045),k=B(61158),A=B(33812);function z(R,C,x){C=Q(C,R);for(var v=-1,m=C.length,T=!1;++v<m;){var I=A(C[v]);if(!(T=R!=null&&x(R,I)))break;R=R[I]}return T||++v!=m?T:(m=R==null?0:R.length,!!m&&k(m)&&K(I,m)&&(h(R)||W(R)))}ct.exports=z},28792:(ct,Ye,B)=>{var Q=B(29259);function W(h){return h===h&&!Q(h)}ct.exports=W},73477:ct=>{function Ye(B,Q){return function(W){return W==null?!1:W[B]===Q&&(Q!==void 0||B in Object(W))}}ct.exports=Ye},62721:(ct,Ye,B)=>{var Q=B(13324),W=B(39872);function h(K,k){return k.length<2?K:Q(K,W(k,0,-1))}ct.exports=h},52153:ct=>{var Ye=/\s/;function B(Q){for(var W=Q.length;W--&&Ye.test(Q.charAt(W)););return W}ct.exports=B},9850:(ct,Ye,B)=>{var Q=B(18874),W=1,h=4;function K(k){return Q(k,W|h)}ct.exports=K},54073:(ct,Ye,B)=>{var Q=B(29259),W=B(61100),h=B(7642),K="Expected a function",k=Math.max,A=Math.min;function z(R,C,x){var v,m,T,I,F,q,re=0,ne=!1,se=!1,X=!0;if(typeof R!="function")throw new TypeError(K);C=h(C)||0,Q(x)&&(ne=!!x.leading,se="maxWait"in x,T=se?k(h(x.maxWait)||0,C):T,X="trailing"in x?!!x.trailing:X);function ce(Qe){var we=v,Ae=m;return v=m=void 0,re=Qe,I=R.apply(Ae,we),I}function Me(Qe){return re=Qe,F=setTimeout(Ue,C),ne?ce(Qe):I}function Be(Qe){var we=Qe-q,Ae=Qe-re,it=C-we;return se?A(it,T-Ae):it}function ot(Qe){var we=Qe-q,Ae=Qe-re;return q===void 0||we>=C||we<0||se&&Ae>=T}function Ue(){var Qe=W();if(ot(Qe))return ht(Qe);F=setTimeout(Ue,Be(Qe))}function ht(Qe){return F=void 0,X&&v?ce(Qe):(v=m=void 0,I)}function Et(){F!==void 0&&clearTimeout(F),re=0,v=q=m=F=void 0}function bi(){return F===void 0?I:ht(W())}function gt(){var Qe=W(),we=ot(Qe);if(v=arguments,m=this,q=Qe,we){if(F===void 0)return Me(q);if(se)return clearTimeout(F),F=setTimeout(Ue,C),ce(q)}return F===void 0&&(F=setTimeout(Ue,C)),I}return gt.cancel=Et,gt.flush=bi,gt}ct.exports=z},55281:(ct,Ye,B)=>{var Q=B(98776),W=B(12982),h=Q(W);ct.exports=h},12982:(ct,Ye,B)=>{var Q=B(21359),W=B(68286),h=B(38101),K=Math.max;function k(A,z,R){var C=A==null?0:A.length;if(!C)return-1;var x=R==null?0:h(R);return x<0&&(x=K(C+x,0)),Q(A,W(z,3),x)}ct.exports=k},35676:(ct,Ye,B)=>{var Q=B(62034);function W(h){var K=h==null?0:h.length;return K?Q(h,1):[]}ct.exports=W},95041:(ct,Ye,B)=>{var Q=B(20187),W=B(1369);function h(K,k){return K!=null&&W(K,k,Q)}ct.exports=h},35380:(ct,Ye,B)=>{var Q=B(86874),W=B(40933),h=B(23059),K=Object.prototype,k=K.toString,A=W(function(z,R,C){R!=null&&typeof R.toString!="function"&&(R=k.call(R)),z[R]=C},Q(h));ct.exports=A},80537:(ct,Ye,B)=>{var Q=B(53366),W=B(15125),h="[object Number]";function K(k){return typeof k=="number"||W(k)&&Q(k)==h}ct.exports=K},97030:(ct,Ye,B)=>{var Q=B(53366),W=B(47353),h=B(15125),K="[object Object]",k=Function.prototype,A=Object.prototype,z=k.toString,R=A.hasOwnProperty,C=z.call(Object);function x(v){if(!h(v)||Q(v)!=K)return!1;var m=W(v);if(m===null)return!0;var T=R.call(m,"constructor")&&m.constructor;return typeof T=="function"&&T instanceof T&&z.call(T)==C}ct.exports=x},84336:ct=>{function Ye(B){return B===void 0}ct.exports=Ye},56974:ct=>{function Ye(B){var Q=B==null?0:B.length;return Q?B[Q-1]:void 0}ct.exports=Ye},34519:(ct,Ye,B)=>{var Q=B(13940),W=B(26548),h=B(68286);function K(k,A){var z={};return A=h(A,3),W(k,function(R,C,x){Q(z,C,A(R,C,x))}),z}ct.exports=K},61100:(ct,Ye,B)=>{var Q=B(37772),W=function(){return Q.Date.now()};ct.exports=W},17620:(ct,Ye,B)=>{var Q=B(50343),W=B(18874),h=B(29078),K=B(17297),k=B(752),A=B(52672),z=B(29097),R=B(76939),C=1,x=2,v=4,m=z(function(T,I){var F={};if(T==null)return F;var q=!1;I=Q(I,function(ne){return ne=K(ne,T),q||(q=ne.length>1),ne}),k(T,R(T),F),q&&(F=W(F,C|x|v,A));for(var re=I.length;re--;)h(F,I[re]);return F});ct.exports=m},65798:(ct,Ye,B)=>{var Q=B(20256),W=B(82952),h=B(21401),K=B(33812);function k(A){return h(A)?Q(K(A)):W(A)}ct.exports=k},58215:(ct,Ye,B)=>{var Q=B(81207),W=B(24303),h=B(68286),K=B(5877),k=B(86152);function A(z,R,C){var x=k(z)?Q:K,v=arguments.length<3;return x(z,h(R,4),C,v,W)}ct.exports=A},12436:(ct,Ye,B)=>{var Q=B(54073),W=B(29259),h="Expected a function";function K(k,A,z){var R=!0,C=!0;if(typeof k!="function")throw new TypeError(h);return W(z)&&(R="leading"in z?!!z.leading:R,C="trailing"in z?!!z.trailing:C),Q(k,A,{leading:R,maxWait:A,trailing:C})}ct.exports=K},5707:(ct,Ye,B)=>{var Q=B(7642),W=1/0,h=17976931348623157e292;function K(k){if(!k)return k===0?k:0;if(k=Q(k),k===W||k===-W){var A=k<0?-1:1;return A*h}return k===k?k:0}ct.exports=K},38101:(ct,Ye,B)=>{var Q=B(5707);function W(h){var K=Q(h),k=K%1;return K===K?k?K-k:K:0}ct.exports=W},7642:(ct,Ye,B)=>{var Q=B(51704),W=B(29259),h=B(4795),K=0/0,k=/^[-+]0x[0-9a-f]+$/i,A=/^0b[01]+$/i,z=/^0o[0-7]+$/i,R=parseInt;function C(x){if(typeof x=="number")return x;if(h(x))return K;if(W(x)){var v=typeof x.valueOf=="function"?x.valueOf():x;x=W(v)?v+"":v}if(typeof x!="string")return x===0?x:+x;x=Q(x);var m=A.test(x);return m||z.test(x)?R(x.slice(2),m?2:8):k.test(x)?K:+x}ct.exports=C}}]);})();

//# sourceMappingURL=7878.7878.f7b7ff45d392a7c6e323.js.map